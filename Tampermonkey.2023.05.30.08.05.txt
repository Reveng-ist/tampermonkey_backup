{"created_by":"Tampermonkey","version":"1","scripts":[{"name":"gimkitcheat","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://www.gimkit.com/join*"],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685021797980,"data":{"cssVars":"s{\"menu-bg-color\":\"rgba(0, 0, 0, 1)\",\"menu-border-color\":\"rgba(0, 255, 30, 1)\",\"text-color\":\"rgba(255, 255, 255, 1)\",\"button-bg-color\":\"rgba(0, 0, 0, 1)\",\"button-border-color\":\"rgba(0, 255, 30, 1)\",\"menu-controls-bg-color\":\"rgba(0, 0, 0, 1)\",\"menu-controls-text-color\":\"rgba(0, 255, 30, 1)\",\"textinput-border-color\":\"rgba(0, 255, 30, 1)\",\"textinput-bg-color\":\"rgba(0, 0, 0, 1)\",\"toggle-bg-color\":\"rgba(0, 0, 0, 1)\",\"toggle-border-color\":\"rgba(0, 255, 30, 1)\",\"dropdown-bg-color\":\"rgba(0, 0, 0, 1)\",\"dropdown-border-color\":\"rgba(0, 255, 30, 1)\",\"keybind-editor-bg-color\":\"rgba(0, 0, 0, 1)\",\"keybind-editor-border-color\":\"rgba(0, 255, 30, 1)\"}","menuTransforms":"s{\"HUD Customization\":{\"top\":10,\"left\":10,\"width\":341.5,\"height\":332.5,\"minimized\":true},\"Devtools\":{\"top\":342.5,\"left\":10,\"width\":341.5,\"height\":332.5,\"minimized\":true},\"General Cheats\":{\"top\":10,\"left\":475.3333333333333,\"width\":341.5,\"height\":332.5,\"minimized\":true},\"Cheats for gamemodes\":{\"top\":346,\"left\":475,\"width\":341.5,\"height\":332.5,\"minimized\":true}}"}},"enabled":true,"position":1,"file_url":"https://raw.githubusercontent.com/TheLazySquid/GimkitCheat/main/build/bundle.user.js","uuid":"66d6a07c-3d77-4b4d-9583-e9be7a1f8c2b","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIGdpbWtpdGNoZWF0Ci8vIEBkZXNjcmlwdGlvbiBBIHVzZXJzY3JpcHQgdGhhdCBhbGxvd3MgeW91IHRvIGNoZWF0IGFjcm9zcyB2YXJpb3VzIGdpbWtpdCBnYW1lcwovLyBAbmFtZXNwYWNlICAgaHR0cHM6Ly93d3cuZ2l0aHViLmNvbS9UaGVMYXp5U3F1aWQvR2lta2l0Q2hlYXQKLy8gQG1hdGNoICAgICAgIGh0dHBzOi8vd3d3LmdpbWtpdC5jb20vam9pbioKLy8gQHJ1bi1hdCAgICAgIGRvY3VtZW50LXN0YXJ0Ci8vIEBpY29uVVJMICAgICBodHRwczovL3d3dy5naW1raXQuY29tL2Zhdmljb24ucG5nCi8vIEBhdXRob3IgICAgICBUaGVMYXp5U3F1aWQKLy8gQHVwZGF0ZVVSTCAgIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9UaGVMYXp5U3F1aWQvR2lta2l0Q2hlYXQvbWFpbi9idWlsZC9idW5kbGUudXNlci5qcwovLyBAZG93bmxvYWRVUkwgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1RoZUxhenlTcXVpZC9HaW1raXRDaGVhdC9tYWluL2J1aWxkL2J1bmRsZS51c2VyLmpzCi8vIEB2ZXJzaW9uICAgICAwLjMuNQovLyBAbGljZW5zZSAgICAgSVNDCi8vIEBncmFudCAgICAgICBHTV9nZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgR01fc2V0VmFsdWUKLy8gQGdyYW50ICAgICAgIEdNX2RlbGV0ZVZhbHVlCi8vID09L1VzZXJTY3JpcHQ9PQooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgdmFyIHZlcnNpb24gPSAiMC4zLjUiOwoKICBmdW5jdGlvbiB1dGY4UmVhZCQxKGJ5dGVzLCBvZmZzZXQsIGxlbmd0aCkgewogIAl2YXIgc3RyaW5nID0gJycsIGNociA9IDA7CiAgCWZvciAodmFyIGkgPSBvZmZzZXQsIGVuZCA9IG9mZnNldCArIGxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7CiAgCQl2YXIgYnl0ZSA9IGJ5dGVzW2ldOwogIAkJaWYgKChieXRlICYgMHg4MCkgPT09IDB4MDApIHsKICAJCQlzdHJpbmcgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlKTsKICAJCQljb250aW51ZTsKICAJCX0KICAJCWlmICgoYnl0ZSAmIDB4ZTApID09PSAweGMwKSB7CiAgCQkJc3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoCiAgCQkJCSgoYnl0ZSAmIDB4MWYpIDw8IDYpIHwKICAJCQkJKGJ5dGVzWysraV0gJiAweDNmKQogIAkJCSk7CiAgCQkJY29udGludWU7CiAgCQl9CiAgCQlpZiAoKGJ5dGUgJiAweGYwKSA9PT0gMHhlMCkgewogIAkJCXN0cmluZyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKAogIAkJCQkoKGJ5dGUgJiAweDBmKSA8PCAxMikgfAogIAkJCQkoKGJ5dGVzWysraV0gJiAweDNmKSA8PCA2KSB8CiAgCQkJCSgoYnl0ZXNbKytpXSAmIDB4M2YpIDw8IDApCiAgCQkJKTsKICAJCQljb250aW51ZTsKICAJCX0KICAJCWlmICgoYnl0ZSAmIDB4ZjgpID09PSAweGYwKSB7CiAgCQkJY2hyID0gKChieXRlICYgMHgwNykgPDwgMTgpIHwKICAJCQkJKChieXRlc1srK2ldICYgMHgzZikgPDwgMTIpIHwKICAJCQkJKChieXRlc1srK2ldICYgMHgzZikgPDwgNikgfAogIAkJCQkoKGJ5dGVzWysraV0gJiAweDNmKSA8PCAwKTsKICAJCQlpZiAoY2hyID49IDB4MDEwMDAwKSB7IC8vIHN1cnJvZ2F0ZSBwYWlyCiAgCQkJCWNociAtPSAweDAxMDAwMDsKICAJCQkJc3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGNociA+Pj4gMTApICsgMHhEODAwLCAoY2hyICYgMHgzRkYpICsgMHhEQzAwKTsKICAJCQl9IGVsc2UgewogIAkJCQlzdHJpbmcgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjaHIpOwogIAkJCX0KICAJCQljb250aW51ZTsKICAJCX0KCiAgCQljb25zb2xlLmVycm9yKCdJbnZhbGlkIGJ5dGUgJyArIGJ5dGUudG9TdHJpbmcoMTYpKTsKICAJCS8vIChkbyBub3QgdGhyb3cgZXJyb3IgdG8gYXZvaWQgc2VydmVyL2NsaWVudCBmcm9tIGNyYXNoaW5nIGR1ZSB0byBoYWNrIGF0dGVtcHMpCiAgCQkvLyB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYnl0ZSAnICsgYnl0ZS50b1N0cmluZygxNikpOwogIAl9CiAgCXJldHVybiBzdHJpbmc7CiAgfQoKICBmdW5jdGlvbiBpbnQ4KGJ5dGVzLCBpdCkgewogIAlyZXR1cm4gdWludDgoYnl0ZXMsIGl0KSA8PCAyNCA+PiAyNDsKICB9CiAgZnVuY3Rpb24gdWludDgoYnl0ZXMsIGl0KSB7CiAgCXJldHVybiBieXRlc1tpdC5vZmZzZXQrK107CiAgfQogIGZ1bmN0aW9uIGludDE2KGJ5dGVzLCBpdCkgewogIAlyZXR1cm4gdWludDE2KGJ5dGVzLCBpdCkgPDwgMTYgPj4gMTY7CiAgfQogIGZ1bmN0aW9uIHVpbnQxNihieXRlcywgaXQpIHsKICAJcmV0dXJuIGJ5dGVzW2l0Lm9mZnNldCsrXSB8IGJ5dGVzW2l0Lm9mZnNldCsrXSA8PCA4OwogIH0KICBmdW5jdGlvbiBpbnQzMihieXRlcywgaXQpIHsKICAJcmV0dXJuIGJ5dGVzW2l0Lm9mZnNldCsrXSB8IGJ5dGVzW2l0Lm9mZnNldCsrXSA8PCA4IHwgYnl0ZXNbaXQub2Zmc2V0KytdIDw8IDE2IHwgYnl0ZXNbaXQub2Zmc2V0KytdIDw8IDI0OwogIH0KICBmdW5jdGlvbiB1aW50MzIoYnl0ZXMsIGl0KSB7CiAgCXJldHVybiBpbnQzMihieXRlcywgaXQpID4+PiAwOwogIH0KICBmdW5jdGlvbiBpbnQ2NChieXRlcywgaXQpIHsKICAJY29uc3QgbG93ID0gdWludDMyKGJ5dGVzLCBpdCk7CiAgCWNvbnN0IGhpZ2ggPSBpbnQzMihieXRlcywgaXQpICogTWF0aC5wb3coMiwgMzIpOwogIAlyZXR1cm4gaGlnaCArIGxvdzsKICB9CiAgZnVuY3Rpb24gdWludDY0KGJ5dGVzLCBpdCkgewogIAljb25zdCBsb3cgPSB1aW50MzIoYnl0ZXMsIGl0KTsKICAJY29uc3QgaGlnaCA9IHVpbnQzMihieXRlcywgaXQpICogTWF0aC5wb3coMiwgMzIpOwogIAlyZXR1cm4gaGlnaCArIGxvdzsKICB9Y29uc3QgX2ludDMyID0gbmV3IEludDMyQXJyYXkoMik7CiAgY29uc3QgX2Zsb2F0MzIgPSBuZXcgRmxvYXQzMkFycmF5KF9pbnQzMi5idWZmZXIpOwogIGNvbnN0IF9mbG9hdDY0ID0gbmV3IEZsb2F0NjRBcnJheShfaW50MzIuYnVmZmVyKTsKCiAgZnVuY3Rpb24gcmVhZEZsb2F0MzIoYnl0ZXMsIGl0KSB7CiAgCV9pbnQzMlswXSA9IGludDMyKGJ5dGVzLCBpdCk7CiAgCXJldHVybiBfZmxvYXQzMlswXTsKICB9CiAgZnVuY3Rpb24gcmVhZEZsb2F0NjQoYnl0ZXMsIGl0KSB7CiAgCV9pbnQzMlswIF0gPSBpbnQzMihieXRlcywgaXQpOwogIAlfaW50MzJbMSBdID0gaW50MzIoYnl0ZXMsIGl0KTsKICAJcmV0dXJuIF9mbG9hdDY0WzBdOwogIH0KICBmdW5jdGlvbiBzdHJpbmcoYnl0ZXMsIGl0KSB7CiAgCWNvbnN0IHByZWZpeCA9IGJ5dGVzW2l0Lm9mZnNldCsrXTsKICAJbGV0IGxlbmd0aDsKCiAgCWlmIChwcmVmaXggPCAweGMwKSB7CiAgCQkvLyBmaXhzdHIKICAJCWxlbmd0aCA9IHByZWZpeCAmIDB4MWY7CgogIAl9IGVsc2UgaWYgKHByZWZpeCA9PT0gMHhkOSkgewogIAkJbGVuZ3RoID0gdWludDgoYnl0ZXMsIGl0KTsKCiAgCX0gZWxzZSBpZiAocHJlZml4ID09PSAweGRhKSB7CiAgCQlsZW5ndGggPSB1aW50MTYoYnl0ZXMsIGl0KTsKCiAgCX0gZWxzZSBpZiAocHJlZml4ID09PSAweGRiKSB7CiAgCQlsZW5ndGggPSB1aW50MzIoYnl0ZXMsIGl0KTsKICAJfQoKICAJY29uc3QgdmFsdWUgPSB1dGY4UmVhZCQxKGJ5dGVzLCBpdC5vZmZzZXQsIGxlbmd0aCk7CiAgCWl0Lm9mZnNldCArPSBsZW5ndGg7CgogIAlyZXR1cm4gdmFsdWU7CiAgfQoKICBmdW5jdGlvbiBzdHJpbmdDaGVjayhieXRlcywgaXQpIHsKICAJY29uc3QgcHJlZml4ID0gYnl0ZXNbaXQub2Zmc2V0XTsKICAJcmV0dXJuICgKICAJCS8vIGZpeHN0cgogIAkJKHByZWZpeCA8IDB4YzAgJiYgcHJlZml4ID4gMHhhMCkgfHwKICAJCS8vIHN0ciA4CiAgCQlwcmVmaXggPT09IDB4ZDkgfHwKICAJCS8vIHN0ciAxNgogIAkJcHJlZml4ID09PSAweGRhIHx8CiAgCQkvLyBzdHIgMzIKICAJCXByZWZpeCA9PT0gMHhkYgogIAkpOwogIH0KCiAgZnVuY3Rpb24gbnVtYmVyKGJ5dGVzLCBpdCkgewogIAljb25zdCBwcmVmaXggPSBieXRlc1tpdC5vZmZzZXQrK107CgogIAlpZiAocHJlZml4IDwgMHg4MCkgewogIAkJLy8gcG9zaXRpdmUgZml4aW50CiAgCQlyZXR1cm4gcHJlZml4OwoKICAJfSBlbHNlIGlmIChwcmVmaXggPT09IDB4Y2EpIHsKICAJCS8vIGZsb2F0IDMyCiAgCQlyZXR1cm4gcmVhZEZsb2F0MzIoYnl0ZXMsIGl0KTsKCiAgCX0gZWxzZSBpZiAocHJlZml4ID09PSAweGNiKSB7CiAgCQkvLyBmbG9hdCA2NAogIAkJcmV0dXJuIHJlYWRGbG9hdDY0KGJ5dGVzLCBpdCk7CgogIAl9IGVsc2UgaWYgKHByZWZpeCA9PT0gMHhjYykgewogIAkJLy8gdWludCA4CiAgCQlyZXR1cm4gdWludDgoYnl0ZXMsIGl0KTsKCiAgCX0gZWxzZSBpZiAocHJlZml4ID09PSAweGNkKSB7CiAgCQkvLyB1aW50IDE2CiAgCQlyZXR1cm4gdWludDE2KGJ5dGVzLCBpdCk7CgogIAl9IGVsc2UgaWYgKHByZWZpeCA9PT0gMHhjZSkgewogIAkJLy8gdWludCAzMgogIAkJcmV0dXJuIHVpbnQzMihieXRlcywgaXQpOwoKICAJfSBlbHNlIGlmIChwcmVmaXggPT09IDB4Y2YpIHsKICAJCS8vIHVpbnQgNjQKICAJCXJldHVybiB1aW50NjQoYnl0ZXMsIGl0KTsKCiAgCX0gZWxzZSBpZiAocHJlZml4ID09PSAweGQwKSB7CiAgCQkvLyBpbnQgOAogIAkJcmV0dXJuIGludDgoYnl0ZXMsIGl0KTsKCiAgCX0gZWxzZSBpZiAocHJlZml4ID09PSAweGQxKSB7CiAgCQkvLyBpbnQgMTYKICAJCXJldHVybiBpbnQxNihieXRlcywgaXQpOwoKICAJfSBlbHNlIGlmIChwcmVmaXggPT09IDB4ZDIpIHsKICAJCS8vIGludCAzMgogIAkJcmV0dXJuIGludDMyKGJ5dGVzLCBpdCk7CgogIAl9IGVsc2UgaWYgKHByZWZpeCA9PT0gMHhkMykgewogIAkJLy8gaW50IDY0CiAgCQlyZXR1cm4gaW50NjQoYnl0ZXMsIGl0KTsKCiAgCX0gZWxzZSBpZiAocHJlZml4ID4gMHhkZikgewogIAkJLy8gbmVnYXRpdmUgZml4aW50CiAgCQlyZXR1cm4gKDB4ZmYgLSBwcmVmaXggKyAxKSAqIC0xCiAgCX0KICB9CgogIGNvbnN0IFByb3RvY29sID0gewogICAgICAvLyBSb29tLXJlbGF0ZWQgKDEwfjE5KQogICAgICBKT0lOX1JPT006IDEwLAogICAgICBFUlJPUjogMTEsCiAgICAgIExFQVZFX1JPT006IDEyLAogICAgICBST09NX0RBVEE6IDEzLAogICAgICBST09NX1NUQVRFOiAxNCwKICAgICAgUk9PTV9TVEFURV9QQVRDSDogMTUsCiAgICAgIFJPT01fREFUQV9TQ0hFTUE6IDE2CiAgfTsKCiAgZnVuY3Rpb24gRGVjb2RlcihidWZmZXIsIG9mZnNldCkgewogICAgICB0aGlzLl9vZmZzZXQgPSBvZmZzZXQ7CiAgICAgIGlmIChidWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgewogICAgICAgICAgdGhpcy5fYnVmZmVyID0gYnVmZmVyOwogICAgICAgICAgdGhpcy5fdmlldyA9IG5ldyBEYXRhVmlldyh0aGlzLl9idWZmZXIpOwogICAgICB9CiAgICAgIGVsc2UgaWYgKEFycmF5QnVmZmVyLmlzVmlldyhidWZmZXIpKSB7CiAgICAgICAgICB0aGlzLl9idWZmZXIgPSBidWZmZXIuYnVmZmVyOwogICAgICAgICAgdGhpcy5fdmlldyA9IG5ldyBEYXRhVmlldyh0aGlzLl9idWZmZXIsIGJ1ZmZlci5ieXRlT2Zmc2V0LCBidWZmZXIuYnl0ZUxlbmd0aCk7CiAgICAgIH0KICAgICAgZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYXJndW1lbnQnKTsKICAgICAgfQogIH0KICBmdW5jdGlvbiB1dGY4UmVhZCh2aWV3LCBvZmZzZXQsIGxlbmd0aCkgewogICAgICB2YXIgc3RyaW5nID0gJycsIGNociA9IDA7CiAgICAgIGZvciAodmFyIGkgPSBvZmZzZXQsIGVuZCA9IG9mZnNldCArIGxlbmd0aDsgaSA8IGVuZDsgaSsrKSB7CiAgICAgICAgICB2YXIgYnl0ZSA9IHZpZXcuZ2V0VWludDgoaSk7CiAgICAgICAgICBpZiAoKGJ5dGUgJiAweDgwKSA9PT0gMHgwMCkgewogICAgICAgICAgICAgIHN0cmluZyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ5dGUpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgICAgaWYgKChieXRlICYgMHhlMCkgPT09IDB4YzApIHsKICAgICAgICAgICAgICBzdHJpbmcgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoKGJ5dGUgJiAweDFmKSA8PCA2KSB8CiAgICAgICAgICAgICAgICAgICh2aWV3LmdldFVpbnQ4KCsraSkgJiAweDNmKSk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoKGJ5dGUgJiAweGYwKSA9PT0gMHhlMCkgewogICAgICAgICAgICAgIHN0cmluZyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYnl0ZSAmIDB4MGYpIDw8IDEyKSB8CiAgICAgICAgICAgICAgICAgICgodmlldy5nZXRVaW50OCgrK2kpICYgMHgzZikgPDwgNikgfAogICAgICAgICAgICAgICAgICAoKHZpZXcuZ2V0VWludDgoKytpKSAmIDB4M2YpIDw8IDApKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICgoYnl0ZSAmIDB4ZjgpID09PSAweGYwKSB7CiAgICAgICAgICAgICAgY2hyID0gKChieXRlICYgMHgwNykgPDwgMTgpIHwKICAgICAgICAgICAgICAgICAgKCh2aWV3LmdldFVpbnQ4KCsraSkgJiAweDNmKSA8PCAxMikgfAogICAgICAgICAgICAgICAgICAoKHZpZXcuZ2V0VWludDgoKytpKSAmIDB4M2YpIDw8IDYpIHwKICAgICAgICAgICAgICAgICAgKCh2aWV3LmdldFVpbnQ4KCsraSkgJiAweDNmKSA8PCAwKTsKICAgICAgICAgICAgICBpZiAoY2hyID49IDB4MDEwMDAwKSB7IC8vIHN1cnJvZ2F0ZSBwYWlyCiAgICAgICAgICAgICAgICAgIGNociAtPSAweDAxMDAwMDsKICAgICAgICAgICAgICAgICAgc3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGNociA+Pj4gMTApICsgMHhEODAwLCAoY2hyICYgMHgzRkYpICsgMHhEQzAwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgIHN0cmluZyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNocik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGJ5dGUgJyArIGJ5dGUudG9TdHJpbmcoMTYpKTsKICAgICAgfQogICAgICByZXR1cm4gc3RyaW5nOwogIH0KICBEZWNvZGVyLnByb3RvdHlwZS5fYXJyYXkgPSBmdW5jdGlvbiAobGVuZ3RoKSB7CiAgICAgIHZhciB2YWx1ZSA9IG5ldyBBcnJheShsZW5ndGgpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YWx1ZVtpXSA9IHRoaXMuX3BhcnNlKCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbHVlOwogIH07CiAgRGVjb2Rlci5wcm90b3R5cGUuX21hcCA9IGZ1bmN0aW9uIChsZW5ndGgpIHsKICAgICAgdmFyIGtleSA9ICcnLCB2YWx1ZSA9IHt9OwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBrZXkgPSB0aGlzLl9wYXJzZSgpOwogICAgICAgICAgdmFsdWVba2V5XSA9IHRoaXMuX3BhcnNlKCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbHVlOwogIH07CiAgRGVjb2Rlci5wcm90b3R5cGUuX3N0ciA9IGZ1bmN0aW9uIChsZW5ndGgpIHsKICAgICAgdmFyIHZhbHVlID0gdXRmOFJlYWQodGhpcy5fdmlldywgdGhpcy5fb2Zmc2V0LCBsZW5ndGgpOwogICAgICB0aGlzLl9vZmZzZXQgKz0gbGVuZ3RoOwogICAgICByZXR1cm4gdmFsdWU7CiAgfTsKICBEZWNvZGVyLnByb3RvdHlwZS5fYmluID0gZnVuY3Rpb24gKGxlbmd0aCkgewogICAgICB2YXIgdmFsdWUgPSB0aGlzLl9idWZmZXIuc2xpY2UodGhpcy5fb2Zmc2V0LCB0aGlzLl9vZmZzZXQgKyBsZW5ndGgpOwogICAgICB0aGlzLl9vZmZzZXQgKz0gbGVuZ3RoOwogICAgICByZXR1cm4gdmFsdWU7CiAgfTsKICBEZWNvZGVyLnByb3RvdHlwZS5fcGFyc2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBwcmVmaXggPSB0aGlzLl92aWV3LmdldFVpbnQ4KHRoaXMuX29mZnNldCsrKTsKICAgICAgdmFyIHZhbHVlLCBsZW5ndGggPSAwLCB0eXBlID0gMCwgaGkgPSAwLCBsbyA9IDA7CiAgICAgIGlmIChwcmVmaXggPCAweGMwKSB7CiAgICAgICAgICAvLyBwb3NpdGl2ZSBmaXhpbnQKICAgICAgICAgIGlmIChwcmVmaXggPCAweDgwKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHByZWZpeDsKICAgICAgICAgIH0KICAgICAgICAgIC8vIGZpeG1hcAogICAgICAgICAgaWYgKHByZWZpeCA8IDB4OTApIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbWFwKHByZWZpeCAmIDB4MGYpOwogICAgICAgICAgfQogICAgICAgICAgLy8gZml4YXJyYXkKICAgICAgICAgIGlmIChwcmVmaXggPCAweGEwKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5KHByZWZpeCAmIDB4MGYpOwogICAgICAgICAgfQogICAgICAgICAgLy8gZml4c3RyCiAgICAgICAgICByZXR1cm4gdGhpcy5fc3RyKHByZWZpeCAmIDB4MWYpOwogICAgICB9CiAgICAgIC8vIG5lZ2F0aXZlIGZpeGludAogICAgICBpZiAocHJlZml4ID4gMHhkZikgewogICAgICAgICAgcmV0dXJuICgweGZmIC0gcHJlZml4ICsgMSkgKiAtMTsKICAgICAgfQogICAgICBzd2l0Y2ggKHByZWZpeCkgewogICAgICAgICAgLy8gbmlsCiAgICAgICAgICBjYXNlIDB4YzA6CiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAvLyBmYWxzZQogICAgICAgICAgY2FzZSAweGMyOgogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIC8vIHRydWUKICAgICAgICAgIGNhc2UgMHhjMzoKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIC8vIGJpbgogICAgICAgICAgY2FzZSAweGM0OgogICAgICAgICAgICAgIGxlbmd0aCA9IHRoaXMuX3ZpZXcuZ2V0VWludDgodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gMTsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmluKGxlbmd0aCk7CiAgICAgICAgICBjYXNlIDB4YzU6CiAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5fdmlldy5nZXRVaW50MTYodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gMjsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmluKGxlbmd0aCk7CiAgICAgICAgICBjYXNlIDB4YzY6CiAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5fdmlldy5nZXRVaW50MzIodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gNDsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmluKGxlbmd0aCk7CiAgICAgICAgICAvLyBleHQKICAgICAgICAgIGNhc2UgMHhjNzoKICAgICAgICAgICAgICBsZW5ndGggPSB0aGlzLl92aWV3LmdldFVpbnQ4KHRoaXMuX29mZnNldCk7CiAgICAgICAgICAgICAgdHlwZSA9IHRoaXMuX3ZpZXcuZ2V0SW50OCh0aGlzLl9vZmZzZXQgKyAxKTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gMjsKICAgICAgICAgICAgICByZXR1cm4gW3R5cGUsIHRoaXMuX2JpbihsZW5ndGgpXTsKICAgICAgICAgIGNhc2UgMHhjODoKICAgICAgICAgICAgICBsZW5ndGggPSB0aGlzLl92aWV3LmdldFVpbnQxNih0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHR5cGUgPSB0aGlzLl92aWV3LmdldEludDgodGhpcy5fb2Zmc2V0ICsgMik7CiAgICAgICAgICAgICAgdGhpcy5fb2Zmc2V0ICs9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIFt0eXBlLCB0aGlzLl9iaW4obGVuZ3RoKV07CiAgICAgICAgICBjYXNlIDB4Yzk6CiAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5fdmlldy5nZXRVaW50MzIodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0eXBlID0gdGhpcy5fdmlldy5nZXRJbnQ4KHRoaXMuX29mZnNldCArIDQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSA1OwogICAgICAgICAgICAgIHJldHVybiBbdHlwZSwgdGhpcy5fYmluKGxlbmd0aCldOwogICAgICAgICAgLy8gZmxvYXQKICAgICAgICAgIGNhc2UgMHhjYToKICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuX3ZpZXcuZ2V0RmxvYXQzMih0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSA0OwogICAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICAgIGNhc2UgMHhjYjoKICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuX3ZpZXcuZ2V0RmxvYXQ2NCh0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSA4OwogICAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICAgIC8vIHVpbnQKICAgICAgICAgIGNhc2UgMHhjYzoKICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuX3ZpZXcuZ2V0VWludDgodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gMTsKICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICBjYXNlIDB4Y2Q6CiAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLl92aWV3LmdldFVpbnQxNih0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSAyOwogICAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICAgIGNhc2UgMHhjZToKICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuX3ZpZXcuZ2V0VWludDMyKHRoaXMuX29mZnNldCk7CiAgICAgICAgICAgICAgdGhpcy5fb2Zmc2V0ICs9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgICAgY2FzZSAweGNmOgogICAgICAgICAgICAgIGhpID0gdGhpcy5fdmlldy5nZXRVaW50MzIodGhpcy5fb2Zmc2V0KSAqIE1hdGgucG93KDIsIDMyKTsKICAgICAgICAgICAgICBsbyA9IHRoaXMuX3ZpZXcuZ2V0VWludDMyKHRoaXMuX29mZnNldCArIDQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSA4OwogICAgICAgICAgICAgIHJldHVybiBoaSArIGxvOwogICAgICAgICAgLy8gaW50CiAgICAgICAgICBjYXNlIDB4ZDA6CiAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLl92aWV3LmdldEludDgodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gMTsKICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICBjYXNlIDB4ZDE6CiAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLl92aWV3LmdldEludDE2KHRoaXMuX29mZnNldCk7CiAgICAgICAgICAgICAgdGhpcy5fb2Zmc2V0ICs9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgICAgY2FzZSAweGQyOgogICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5fdmlldy5nZXRJbnQzMih0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSA0OwogICAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICAgIGNhc2UgMHhkMzoKICAgICAgICAgICAgICBoaSA9IHRoaXMuX3ZpZXcuZ2V0SW50MzIodGhpcy5fb2Zmc2V0KSAqIE1hdGgucG93KDIsIDMyKTsKICAgICAgICAgICAgICBsbyA9IHRoaXMuX3ZpZXcuZ2V0VWludDMyKHRoaXMuX29mZnNldCArIDQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSA4OwogICAgICAgICAgICAgIHJldHVybiBoaSArIGxvOwogICAgICAgICAgLy8gZml4ZXh0CiAgICAgICAgICBjYXNlIDB4ZDQ6CiAgICAgICAgICAgICAgdHlwZSA9IHRoaXMuX3ZpZXcuZ2V0SW50OCh0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSAxOwogICAgICAgICAgICAgIGlmICh0eXBlID09PSAweDAwKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSAxOwogICAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCAwOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gW3R5cGUsIHRoaXMuX2JpbigxKV07CiAgICAgICAgICBjYXNlIDB4ZDU6CiAgICAgICAgICAgICAgdHlwZSA9IHRoaXMuX3ZpZXcuZ2V0SW50OCh0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSAxOwogICAgICAgICAgICAgIHJldHVybiBbdHlwZSwgdGhpcy5fYmluKDIpXTsKICAgICAgICAgIGNhc2UgMHhkNjoKICAgICAgICAgICAgICB0eXBlID0gdGhpcy5fdmlldy5nZXRJbnQ4KHRoaXMuX29mZnNldCk7CiAgICAgICAgICAgICAgdGhpcy5fb2Zmc2V0ICs9IDE7CiAgICAgICAgICAgICAgcmV0dXJuIFt0eXBlLCB0aGlzLl9iaW4oNCldOwogICAgICAgICAgY2FzZSAweGQ3OgogICAgICAgICAgICAgIHR5cGUgPSB0aGlzLl92aWV3LmdldEludDgodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gMTsKICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gMHgwMCkgewogICAgICAgICAgICAgICAgICBoaSA9IHRoaXMuX3ZpZXcuZ2V0SW50MzIodGhpcy5fb2Zmc2V0KSAqIE1hdGgucG93KDIsIDMyKTsKICAgICAgICAgICAgICAgICAgbG8gPSB0aGlzLl92aWV3LmdldFVpbnQzMih0aGlzLl9vZmZzZXQgKyA0KTsKICAgICAgICAgICAgICAgICAgdGhpcy5fb2Zmc2V0ICs9IDg7CiAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShoaSArIGxvKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIFt0eXBlLCB0aGlzLl9iaW4oOCldOwogICAgICAgICAgY2FzZSAweGQ4OgogICAgICAgICAgICAgIHR5cGUgPSB0aGlzLl92aWV3LmdldEludDgodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gMTsKICAgICAgICAgICAgICByZXR1cm4gW3R5cGUsIHRoaXMuX2JpbigxNildOwogICAgICAgICAgLy8gc3RyCiAgICAgICAgICBjYXNlIDB4ZDk6CiAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5fdmlldy5nZXRVaW50OCh0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSAxOwogICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdHIobGVuZ3RoKTsKICAgICAgICAgIGNhc2UgMHhkYToKICAgICAgICAgICAgICBsZW5ndGggPSB0aGlzLl92aWV3LmdldFVpbnQxNih0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSAyOwogICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdHIobGVuZ3RoKTsKICAgICAgICAgIGNhc2UgMHhkYjoKICAgICAgICAgICAgICBsZW5ndGggPSB0aGlzLl92aWV3LmdldFVpbnQzMih0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSA0OwogICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdHIobGVuZ3RoKTsKICAgICAgICAgIC8vIGFycmF5CiAgICAgICAgICBjYXNlIDB4ZGM6CiAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5fdmlldy5nZXRVaW50MTYodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gMjsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkobGVuZ3RoKTsKICAgICAgICAgIGNhc2UgMHhkZDoKICAgICAgICAgICAgICBsZW5ndGggPSB0aGlzLl92aWV3LmdldFVpbnQzMih0aGlzLl9vZmZzZXQpOwogICAgICAgICAgICAgIHRoaXMuX29mZnNldCArPSA0OwogICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcnJheShsZW5ndGgpOwogICAgICAgICAgLy8gbWFwCiAgICAgICAgICBjYXNlIDB4ZGU6CiAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5fdmlldy5nZXRVaW50MTYodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gMjsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbWFwKGxlbmd0aCk7CiAgICAgICAgICBjYXNlIDB4ZGY6CiAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5fdmlldy5nZXRVaW50MzIodGhpcy5fb2Zmc2V0KTsKICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQgKz0gNDsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbWFwKGxlbmd0aCk7CiAgICAgIH0KICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgcGFyc2UnKTsKICB9OwogIGZ1bmN0aW9uIGRlY29kZSQxKGJ1ZmZlciwgb2Zmc2V0KSB7CiAgICAgIGlmIChvZmZzZXQgPT09IHZvaWQgMCkgeyBvZmZzZXQgPSAwOyB9CiAgICAgIHZhciBkZWNvZGVyID0gbmV3IERlY29kZXIoYnVmZmVyLCBvZmZzZXQpOwogICAgICB2YXIgdmFsdWUgPSBkZWNvZGVyLl9wYXJzZSgpOwogICAgICBpZiAoZGVjb2Rlci5fb2Zmc2V0ICE9PSBidWZmZXIuYnl0ZUxlbmd0aCkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKChidWZmZXIuYnl0ZUxlbmd0aCAtIGRlY29kZXIuX29mZnNldCkgKyAnIHRyYWlsaW5nIGJ5dGVzJyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbHVlOwogIH0KICAvLyAKICAvLyBFTkNPREVSCiAgLy8gCiAgZnVuY3Rpb24gdXRmOFdyaXRlKHZpZXcsIG9mZnNldCwgc3RyKSB7CiAgICAgIHZhciBjID0gMDsKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBzdHIubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSk7CiAgICAgICAgICBpZiAoYyA8IDB4ODApIHsKICAgICAgICAgICAgICB2aWV3LnNldFVpbnQ4KG9mZnNldCsrLCBjKTsKICAgICAgICAgIH0KICAgICAgICAgIGVsc2UgaWYgKGMgPCAweDgwMCkgewogICAgICAgICAgICAgIHZpZXcuc2V0VWludDgob2Zmc2V0KyssIDB4YzAgfCAoYyA+PiA2KSk7CiAgICAgICAgICAgICAgdmlldy5zZXRVaW50OChvZmZzZXQrKywgMHg4MCB8IChjICYgMHgzZikpOwogICAgICAgICAgfQogICAgICAgICAgZWxzZSBpZiAoYyA8IDB4ZDgwMCB8fCBjID49IDB4ZTAwMCkgewogICAgICAgICAgICAgIHZpZXcuc2V0VWludDgob2Zmc2V0KyssIDB4ZTAgfCAoYyA+PiAxMikpOwogICAgICAgICAgICAgIHZpZXcuc2V0VWludDgob2Zmc2V0KyssIDB4ODAgfCAoYyA+PiA2KSAmIDB4M2YpOwogICAgICAgICAgICAgIHZpZXcuc2V0VWludDgob2Zmc2V0KyssIDB4ODAgfCAoYyAmIDB4M2YpKTsKICAgICAgICAgIH0KICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICBjID0gMHgxMDAwMCArICgoKGMgJiAweDNmZikgPDwgMTApIHwgKHN0ci5jaGFyQ29kZUF0KGkpICYgMHgzZmYpKTsKICAgICAgICAgICAgICB2aWV3LnNldFVpbnQ4KG9mZnNldCsrLCAweGYwIHwgKGMgPj4gMTgpKTsKICAgICAgICAgICAgICB2aWV3LnNldFVpbnQ4KG9mZnNldCsrLCAweDgwIHwgKGMgPj4gMTIpICYgMHgzZik7CiAgICAgICAgICAgICAgdmlldy5zZXRVaW50OChvZmZzZXQrKywgMHg4MCB8IChjID4+IDYpICYgMHgzZik7CiAgICAgICAgICAgICAgdmlldy5zZXRVaW50OChvZmZzZXQrKywgMHg4MCB8IChjICYgMHgzZikpOwogICAgICAgICAgfQogICAgICB9CiAgfQogIGZ1bmN0aW9uIHV0ZjhMZW5ndGgoc3RyKSB7CiAgICAgIHZhciBjID0gMCwgbGVuZ3RoID0gMDsKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBzdHIubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSk7CiAgICAgICAgICBpZiAoYyA8IDB4ODApIHsKICAgICAgICAgICAgICBsZW5ndGggKz0gMTsKICAgICAgICAgIH0KICAgICAgICAgIGVsc2UgaWYgKGMgPCAweDgwMCkgewogICAgICAgICAgICAgIGxlbmd0aCArPSAyOwogICAgICAgICAgfQogICAgICAgICAgZWxzZSBpZiAoYyA8IDB4ZDgwMCB8fCBjID49IDB4ZTAwMCkgewogICAgICAgICAgICAgIGxlbmd0aCArPSAzOwogICAgICAgICAgfQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgIGxlbmd0aCArPSA0OwogICAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBsZW5ndGg7CiAgfQogIGZ1bmN0aW9uIF9lbmNvZGUoYnl0ZXMsIGRlZmVycywgdmFsdWUpIHsKICAgICAgdmFyIHR5cGUgPSB0eXBlb2YgdmFsdWUsIGkgPSAwLCBsID0gMCwgaGkgPSAwLCBsbyA9IDAsIGxlbmd0aCA9IDAsIHNpemUgPSAwOwogICAgICBpZiAodHlwZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIGxlbmd0aCA9IHV0ZjhMZW5ndGgodmFsdWUpOwogICAgICAgICAgLy8gZml4c3RyCiAgICAgICAgICBpZiAobGVuZ3RoIDwgMHgyMCkgewogICAgICAgICAgICAgIGJ5dGVzLnB1c2gobGVuZ3RoIHwgMHhhMCk7CiAgICAgICAgICAgICAgc2l6ZSA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICAvLyBzdHIgOAogICAgICAgICAgZWxzZSBpZiAobGVuZ3RoIDwgMHgxMDApIHsKICAgICAgICAgICAgICBieXRlcy5wdXNoKDB4ZDksIGxlbmd0aCk7CiAgICAgICAgICAgICAgc2l6ZSA9IDI7CiAgICAgICAgICB9CiAgICAgICAgICAvLyBzdHIgMTYKICAgICAgICAgIGVsc2UgaWYgKGxlbmd0aCA8IDB4MTAwMDApIHsKICAgICAgICAgICAgICBieXRlcy5wdXNoKDB4ZGEsIGxlbmd0aCA+PiA4LCBsZW5ndGgpOwogICAgICAgICAgICAgIHNpemUgPSAzOwogICAgICAgICAgfQogICAgICAgICAgLy8gc3RyIDMyCiAgICAgICAgICBlbHNlIGlmIChsZW5ndGggPCAweDEwMDAwMDAwMCkgewogICAgICAgICAgICAgIGJ5dGVzLnB1c2goMHhkYiwgbGVuZ3RoID4+IDI0LCBsZW5ndGggPj4gMTYsIGxlbmd0aCA+PiA4LCBsZW5ndGgpOwogICAgICAgICAgICAgIHNpemUgPSA1OwogICAgICAgICAgfQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTdHJpbmcgdG9vIGxvbmcnKTsKICAgICAgICAgIH0KICAgICAgICAgIGRlZmVycy5wdXNoKHsgX3N0cjogdmFsdWUsIF9sZW5ndGg6IGxlbmd0aCwgX29mZnNldDogYnl0ZXMubGVuZ3RoIH0pOwogICAgICAgICAgcmV0dXJuIHNpemUgKyBsZW5ndGg7CiAgICAgIH0KICAgICAgaWYgKHR5cGUgPT09ICdudW1iZXInKSB7CiAgICAgICAgICAvLyBUT0RPOiBlbmNvZGUgdG8gZmxvYXQgMzI/CiAgICAgICAgICAvLyBmbG9hdCA2NAogICAgICAgICAgaWYgKE1hdGguZmxvb3IodmFsdWUpICE9PSB2YWx1ZSB8fCAhaXNGaW5pdGUodmFsdWUpKSB7CiAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweGNiKTsKICAgICAgICAgICAgICBkZWZlcnMucHVzaCh7IF9mbG9hdDogdmFsdWUsIF9sZW5ndGg6IDgsIF9vZmZzZXQ6IGJ5dGVzLmxlbmd0aCB9KTsKICAgICAgICAgICAgICByZXR1cm4gOTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh2YWx1ZSA+PSAwKSB7CiAgICAgICAgICAgICAgLy8gcG9zaXRpdmUgZml4bnVtCiAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHg4MCkgewogICAgICAgICAgICAgICAgICBieXRlcy5wdXNoKHZhbHVlKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIHVpbnQgOAogICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4MTAwKSB7CiAgICAgICAgICAgICAgICAgIGJ5dGVzLnB1c2goMHhjYywgdmFsdWUpOwogICAgICAgICAgICAgICAgICByZXR1cm4gMjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gdWludCAxNgogICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4MTAwMDApIHsKICAgICAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweGNkLCB2YWx1ZSA+PiA4LCB2YWx1ZSk7CiAgICAgICAgICAgICAgICAgIHJldHVybiAzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyB1aW50IDMyCiAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHgxMDAwMDAwMDApIHsKICAgICAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweGNlLCB2YWx1ZSA+PiAyNCwgdmFsdWUgPj4gMTYsIHZhbHVlID4+IDgsIHZhbHVlKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIDU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIHVpbnQgNjQKICAgICAgICAgICAgICBoaSA9ICh2YWx1ZSAvIE1hdGgucG93KDIsIDMyKSkgPj4gMDsKICAgICAgICAgICAgICBsbyA9IHZhbHVlID4+PiAwOwogICAgICAgICAgICAgIGJ5dGVzLnB1c2goMHhjZiwgaGkgPj4gMjQsIGhpID4+IDE2LCBoaSA+PiA4LCBoaSwgbG8gPj4gMjQsIGxvID4+IDE2LCBsbyA+PiA4LCBsbyk7CiAgICAgICAgICAgICAgcmV0dXJuIDk7CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAvLyBuZWdhdGl2ZSBmaXhudW0KICAgICAgICAgICAgICBpZiAodmFsdWUgPj0gLTB4MjApIHsKICAgICAgICAgICAgICAgICAgYnl0ZXMucHVzaCh2YWx1ZSk7CiAgICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBpbnQgOAogICAgICAgICAgICAgIGlmICh2YWx1ZSA+PSAtMHg4MCkgewogICAgICAgICAgICAgICAgICBieXRlcy5wdXNoKDB4ZDAsIHZhbHVlKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIDI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIGludCAxNgogICAgICAgICAgICAgIGlmICh2YWx1ZSA+PSAtMHg4MDAwKSB7CiAgICAgICAgICAgICAgICAgIGJ5dGVzLnB1c2goMHhkMSwgdmFsdWUgPj4gOCwgdmFsdWUpOwogICAgICAgICAgICAgICAgICByZXR1cm4gMzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gaW50IDMyCiAgICAgICAgICAgICAgaWYgKHZhbHVlID49IC0weDgwMDAwMDAwKSB7CiAgICAgICAgICAgICAgICAgIGJ5dGVzLnB1c2goMHhkMiwgdmFsdWUgPj4gMjQsIHZhbHVlID4+IDE2LCB2YWx1ZSA+PiA4LCB2YWx1ZSk7CiAgICAgICAgICAgICAgICAgIHJldHVybiA1OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBpbnQgNjQKICAgICAgICAgICAgICBoaSA9IE1hdGguZmxvb3IodmFsdWUgLyBNYXRoLnBvdygyLCAzMikpOwogICAgICAgICAgICAgIGxvID0gdmFsdWUgPj4+IDA7CiAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweGQzLCBoaSA+PiAyNCwgaGkgPj4gMTYsIGhpID4+IDgsIGhpLCBsbyA+PiAyNCwgbG8gPj4gMTYsIGxvID4+IDgsIGxvKTsKICAgICAgICAgICAgICByZXR1cm4gOTsKICAgICAgICAgIH0KICAgICAgfQogICAgICBpZiAodHlwZSA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgIC8vIG5pbAogICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweGMwKTsKICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgICAgICAgICAgIGxlbmd0aCA9IHZhbHVlLmxlbmd0aDsKICAgICAgICAgICAgICAvLyBmaXhhcnJheQogICAgICAgICAgICAgIGlmIChsZW5ndGggPCAweDEwKSB7CiAgICAgICAgICAgICAgICAgIGJ5dGVzLnB1c2gobGVuZ3RoIHwgMHg5MCk7CiAgICAgICAgICAgICAgICAgIHNpemUgPSAxOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBhcnJheSAxNgogICAgICAgICAgICAgIGVsc2UgaWYgKGxlbmd0aCA8IDB4MTAwMDApIHsKICAgICAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweGRjLCBsZW5ndGggPj4gOCwgbGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgc2l6ZSA9IDM7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIGFycmF5IDMyCiAgICAgICAgICAgICAgZWxzZSBpZiAobGVuZ3RoIDwgMHgxMDAwMDAwMDApIHsKICAgICAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweGRkLCBsZW5ndGggPj4gMjQsIGxlbmd0aCA+PiAxNiwgbGVuZ3RoID4+IDgsIGxlbmd0aCk7CiAgICAgICAgICAgICAgICAgIHNpemUgPSA1OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBcnJheSB0b28gbGFyZ2UnKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgIHNpemUgKz0gX2VuY29kZShieXRlcywgZGVmZXJzLCB2YWx1ZVtpXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBzaXplOwogICAgICAgICAgfQogICAgICAgICAgLy8gZml4ZXh0IDggLyBEYXRlCiAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7CiAgICAgICAgICAgICAgdmFyIHRpbWUgPSB2YWx1ZS5nZXRUaW1lKCk7CiAgICAgICAgICAgICAgaGkgPSBNYXRoLmZsb29yKHRpbWUgLyBNYXRoLnBvdygyLCAzMikpOwogICAgICAgICAgICAgIGxvID0gdGltZSA+Pj4gMDsKICAgICAgICAgICAgICBieXRlcy5wdXNoKDB4ZDcsIDAsIGhpID4+IDI0LCBoaSA+PiAxNiwgaGkgPj4gOCwgaGksIGxvID4+IDI0LCBsbyA+PiAxNiwgbG8gPj4gOCwgbG8pOwogICAgICAgICAgICAgIHJldHVybiAxMDsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7CiAgICAgICAgICAgICAgbGVuZ3RoID0gdmFsdWUuYnl0ZUxlbmd0aDsKICAgICAgICAgICAgICAvLyBiaW4gOAogICAgICAgICAgICAgIGlmIChsZW5ndGggPCAweDEwMCkgewogICAgICAgICAgICAgICAgICBieXRlcy5wdXNoKDB4YzQsIGxlbmd0aCk7CiAgICAgICAgICAgICAgICAgIHNpemUgPSAyOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgIC8vIGJpbiAxNgogICAgICAgICAgICAgIGlmIChsZW5ndGggPCAweDEwMDAwKSB7CiAgICAgICAgICAgICAgICAgIGJ5dGVzLnB1c2goMHhjNSwgbGVuZ3RoID4+IDgsIGxlbmd0aCk7CiAgICAgICAgICAgICAgICAgIHNpemUgPSAzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgIC8vIGJpbiAzMgogICAgICAgICAgICAgIGlmIChsZW5ndGggPCAweDEwMDAwMDAwMCkgewogICAgICAgICAgICAgICAgICBieXRlcy5wdXNoKDB4YzYsIGxlbmd0aCA+PiAyNCwgbGVuZ3RoID4+IDE2LCBsZW5ndGggPj4gOCwgbGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgc2l6ZSA9IDU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0J1ZmZlciB0b28gbGFyZ2UnKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZGVmZXJzLnB1c2goeyBfYmluOiB2YWx1ZSwgX2xlbmd0aDogbGVuZ3RoLCBfb2Zmc2V0OiBieXRlcy5sZW5ndGggfSk7CiAgICAgICAgICAgICAgcmV0dXJuIHNpemUgKyBsZW5ndGg7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlLnRvSlNPTiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgIHJldHVybiBfZW5jb2RlKGJ5dGVzLCBkZWZlcnMsIHZhbHVlLnRvSlNPTigpKTsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBrZXlzID0gW10sIGtleSA9ICcnOwogICAgICAgICAgdmFyIGFsbEtleXMgPSBPYmplY3Qua2V5cyh2YWx1ZSk7CiAgICAgICAgICBmb3IgKGkgPSAwLCBsID0gYWxsS2V5cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgICAgICBrZXkgPSBhbGxLZXlzW2ldOwogICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWVba2V5XSAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgICBrZXlzLnB1c2goa2V5KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBsZW5ndGggPSBrZXlzLmxlbmd0aDsKICAgICAgICAgIC8vIGZpeG1hcAogICAgICAgICAgaWYgKGxlbmd0aCA8IDB4MTApIHsKICAgICAgICAgICAgICBieXRlcy5wdXNoKGxlbmd0aCB8IDB4ODApOwogICAgICAgICAgICAgIHNpemUgPSAxOwogICAgICAgICAgfQogICAgICAgICAgLy8gbWFwIDE2CiAgICAgICAgICBlbHNlIGlmIChsZW5ndGggPCAweDEwMDAwKSB7CiAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweGRlLCBsZW5ndGggPj4gOCwgbGVuZ3RoKTsKICAgICAgICAgICAgICBzaXplID0gMzsKICAgICAgICAgIH0KICAgICAgICAgIC8vIG1hcCAzMgogICAgICAgICAgZWxzZSBpZiAobGVuZ3RoIDwgMHgxMDAwMDAwMDApIHsKICAgICAgICAgICAgICBieXRlcy5wdXNoKDB4ZGYsIGxlbmd0aCA+PiAyNCwgbGVuZ3RoID4+IDE2LCBsZW5ndGggPj4gOCwgbGVuZ3RoKTsKICAgICAgICAgICAgICBzaXplID0gNTsKICAgICAgICAgIH0KICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT2JqZWN0IHRvbyBsYXJnZScpOwogICAgICAgICAgfQogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAga2V5ID0ga2V5c1tpXTsKICAgICAgICAgICAgICBzaXplICs9IF9lbmNvZGUoYnl0ZXMsIGRlZmVycywga2V5KTsKICAgICAgICAgICAgICBzaXplICs9IF9lbmNvZGUoYnl0ZXMsIGRlZmVycywgdmFsdWVba2V5XSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gc2l6ZTsKICAgICAgfQogICAgICAvLyBmYWxzZS90cnVlCiAgICAgIGlmICh0eXBlID09PSAnYm9vbGVhbicpIHsKICAgICAgICAgIGJ5dGVzLnB1c2godmFsdWUgPyAweGMzIDogMHhjMik7CiAgICAgICAgICByZXR1cm4gMTsKICAgICAgfQogICAgICAvLyBmaXhleHQgMSAvIHVuZGVmaW5lZAogICAgICBpZiAodHlwZSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIGJ5dGVzLnB1c2goMHhkNCwgMCwgMCk7CiAgICAgICAgICByZXR1cm4gMzsKICAgICAgfQogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBlbmNvZGUnKTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlJDEodmFsdWUpIHsKICAgICAgdmFyIGJ5dGVzID0gW107CiAgICAgIHZhciBkZWZlcnMgPSBbXTsKICAgICAgdmFyIHNpemUgPSBfZW5jb2RlKGJ5dGVzLCBkZWZlcnMsIHZhbHVlKTsKICAgICAgdmFyIGJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcihzaXplKTsKICAgICAgdmFyIHZpZXcgPSBuZXcgRGF0YVZpZXcoYnVmKTsKICAgICAgdmFyIGRlZmVySW5kZXggPSAwOwogICAgICB2YXIgZGVmZXJXcml0dGVuID0gMDsKICAgICAgdmFyIG5leHRPZmZzZXQgPSAtMTsKICAgICAgaWYgKGRlZmVycy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBuZXh0T2Zmc2V0ID0gZGVmZXJzWzBdLl9vZmZzZXQ7CiAgICAgIH0KICAgICAgdmFyIGRlZmVyLCBkZWZlckxlbmd0aCA9IDAsIG9mZnNldCA9IDA7CiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gYnl0ZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICB2aWV3LnNldFVpbnQ4KGRlZmVyV3JpdHRlbiArIGksIGJ5dGVzW2ldKTsKICAgICAgICAgIGlmIChpICsgMSAhPT0gbmV4dE9mZnNldCkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgICAgZGVmZXIgPSBkZWZlcnNbZGVmZXJJbmRleF07CiAgICAgICAgICBkZWZlckxlbmd0aCA9IGRlZmVyLl9sZW5ndGg7CiAgICAgICAgICBvZmZzZXQgPSBkZWZlcldyaXR0ZW4gKyBuZXh0T2Zmc2V0OwogICAgICAgICAgaWYgKGRlZmVyLl9iaW4pIHsKICAgICAgICAgICAgICB2YXIgYmluID0gbmV3IFVpbnQ4QXJyYXkoZGVmZXIuX2Jpbik7CiAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBkZWZlckxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgIHZpZXcuc2V0VWludDgob2Zmc2V0ICsgaiwgYmluW2pdKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIGlmIChkZWZlci5fc3RyKSB7CiAgICAgICAgICAgICAgdXRmOFdyaXRlKHZpZXcsIG9mZnNldCwgZGVmZXIuX3N0cik7CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIGlmIChkZWZlci5fZmxvYXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIHZpZXcuc2V0RmxvYXQ2NChvZmZzZXQsIGRlZmVyLl9mbG9hdCk7CiAgICAgICAgICB9CiAgICAgICAgICBkZWZlckluZGV4Kys7CiAgICAgICAgICBkZWZlcldyaXR0ZW4gKz0gZGVmZXJMZW5ndGg7CiAgICAgICAgICBpZiAoZGVmZXJzW2RlZmVySW5kZXhdKSB7CiAgICAgICAgICAgICAgbmV4dE9mZnNldCA9IGRlZmVyc1tkZWZlckluZGV4XS5fb2Zmc2V0OwogICAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBidWY7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVFeHBvcnQocGFja2V0KSB7CiAgICAgIGNvbnN0IHU4YXJyID0gbmV3IFVpbnQ4QXJyYXkocGFja2V0KTsKICAgICAgY29uc3QgYnl0ZXMgPSBBcnJheS5mcm9tKHU4YXJyKTsKICAgICAgY29uc3QgcHJlZml4ID0gYnl0ZXNbMF07CgogICAgICBpZihwcmVmaXggPT0gUHJvdG9jb2wuUk9PTV9EQVRBKSB7CiAgICAgICAgICBsZXQgaXQgPSB7IG9mZnNldDogMSB9OwoKICAgICAgICAgIHN0cmluZ0NoZWNrKGJ5dGVzLCBpdCkgPyBzdHJpbmcoYnl0ZXMsIGl0KSA6IG51bWJlcihieXRlcywgaXQpOwogICAgICAgICAgbGV0IHBhcnNlZCA9IGRlY29kZSQxKHBhY2tldCwgaXQub2Zmc2V0KTsKICAgICAgICAgIHJldHVybiBwYXJzZWQKICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBudWxsOyAvLyBob3BlZnVsbHkgaXNuJ3QgaW1wb3J0YW50IGxvbAogICAgICB9CiAgfQoKICBmdW5jdGlvbiBlbmNvZGVFeHBvcnQoY2hhbm5lbCwgcGFja2V0KSB7CiAgICAgIGxldCBoZWFkZXIgPSBbUHJvdG9jb2wuUk9PTV9EQVRBXTsKICAgICAgbGV0IGNoYW5uZWxFbmNvZGVkID0gZW5jb2RlJDEoY2hhbm5lbCk7CiAgICAgIGxldCBwYWNrZXRFbmNvZGVkID0gZW5jb2RlJDEocGFja2V0KTsKCiAgICAgIC8vIGNvbWJpbmUgdGhlIGFycmF5YnVmZmVycwogICAgICBsZXQgY29tYmluZWQgPSBuZXcgVWludDhBcnJheShjaGFubmVsRW5jb2RlZC5ieXRlTGVuZ3RoICsgcGFja2V0RW5jb2RlZC5ieXRlTGVuZ3RoICsgaGVhZGVyLmxlbmd0aCk7CiAgICAgIGNvbWJpbmVkLnNldChoZWFkZXIpOwogICAgICBjb21iaW5lZC5zZXQobmV3IFVpbnQ4QXJyYXkoY2hhbm5lbEVuY29kZWQpLCBoZWFkZXIubGVuZ3RoKTsKICAgICAgY29tYmluZWQuc2V0KG5ldyBVaW50OEFycmF5KHBhY2tldEVuY29kZWQpLCBoZWFkZXIubGVuZ3RoICsgY2hhbm5lbEVuY29kZWQuYnl0ZUxlbmd0aCk7CgogICAgICByZXR1cm4gY29tYmluZWQuYnVmZmVyCiAgfQoKICB2YXIgY29seXNldXMgPSB7CiAgICAgIGRlY29kZTogZGVjb2RlRXhwb3J0LAogICAgICBlbmNvZGU6IGVuY29kZUV4cG9ydAogIH07CgogIC8vIHRoaXMgY29kZSB3YXMgc3RvbGVuIGZyb20gdGhlIG9yaWdpbmFsIEdpbWtpdCBVdGlsIGV4dGVuc2lvbgogIGZ1bmN0aW9uIG4odCwgZSwgbikgewogICAgICBmb3IgKHZhciBpID0gMCwgcyA9IDAsIG8gPSBuLmxlbmd0aDsgcyA8IG87IHMrKykoaSA9IG4uY2hhckNvZGVBdChzKSkgPCAxMjggPyB0LnNldFVpbnQ4KGUrKywgaSkgOiAoaSA8IDIwNDggPyB0LnNldFVpbnQ4KGUrKywgMTkyIHwgaSA+PiA2KSA6IChpIDwgNTUyOTYgfHwgNTczNDQgPD0gaSA/IHQuc2V0VWludDgoZSsrLCAyMjQgfCBpID4+IDEyKSA6IChzKyssIGkgPSA2NTUzNiArICgoMTAyMyAmIGkpIDw8IDEwIHwgMTAyMyAmIG4uY2hhckNvZGVBdChzKSksIHQuc2V0VWludDgoZSsrLCAyNDAgfCBpID4+IDE4KSwgdC5zZXRVaW50OChlKyssIDEyOCB8IGkgPj4gMTIgJiA2MykpLCB0LnNldFVpbnQ4KGUrKywgMTI4IHwgaSA+PiA2ICYgNjMpKSwgdC5zZXRVaW50OChlKyssIDEyOCB8IDYzICYgaSkpOwogIH0KCiAgZnVuY3Rpb24gZW5jb2RlKHQsIGUsIHMpIHsKICAgICAgY29uc3QgbyA9IHsKICAgICAgICAgIHR5cGU6IDIsCiAgICAgICAgICBkYXRhOiBbImJsdWVib2F0X1NFTkRfTUVTU0FHRSIsIHsKICAgICAgICAgICAgICByb29tOiBzLAogICAgICAgICAgICAgIGtleTogdCwKICAgICAgICAgICAgICBkYXRhOiBlCiAgICAgICAgICB9XSwKICAgICAgICAgIG9wdGlvbnM6IHsKICAgICAgICAgICAgICBjb21wcmVzczogITAKICAgICAgICAgIH0sCiAgICAgICAgICBuc3A6ICIvIgogICAgICB9OwogICAgICByZXR1cm4gZnVuY3Rpb24odCkgewogICAgICAgICAgdmFyIGUgPSBbXSwKICAgICAgICAgICAgICBpID0gW10sCiAgICAgICAgICAgICAgcyA9IGZ1bmN0aW9uIHQoZSwgbiwgaSkgewogICAgICAgICAgICAgICAgICB2YXIgcyA9IHR5cGVvZiBpLAogICAgICAgICAgICAgICAgICAgICAgbyA9IDAsCiAgICAgICAgICAgICAgICAgICAgICByID0gMCwKICAgICAgICAgICAgICAgICAgICAgIGEgPSAwLAogICAgICAgICAgICAgICAgICAgICAgYyA9IDAsCiAgICAgICAgICAgICAgICAgICAgICBsID0gMCwKICAgICAgICAgICAgICAgICAgICAgIHUgPSAwOwogICAgICAgICAgICAgICAgICBpZiAoInN0cmluZyIgPT09IHMpIHsKICAgICAgICAgICAgICAgICAgICAgIGlmICgobCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZSA9IDAsIG4gPSAwLCBpID0gMCwgcyA9IHQubGVuZ3RoOyBpIDwgczsgaSsrKShlID0gdC5jaGFyQ29kZUF0KGkpKSA8IDEyOCA/IG4gKz0gMSA6IGUgPCAyMDQ4ID8gbiArPSAyIDogZSA8IDU1Mjk2IHx8IDU3MzQ0IDw9IGUgPyBuICs9IDMgOiAoaSsrLCBuICs9IDQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbgogICAgICAgICAgICAgICAgICAgICAgICAgIH0oaSkpIDwgMzIpIGUucHVzaCgxNjAgfCBsKSwgdSA9IDE7CiAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChsIDwgMjU2KSBlLnB1c2goMjE3LCBsKSwgdSA9IDI7CiAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChsIDwgNjU1MzYpIGUucHVzaCgyMTgsIGwgPj4gOCwgbCksIHUgPSAzOwogICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEobCA8IDQyOTQ5NjcyOTYpKSB0aHJvdyBuZXcgRXJyb3IoIlN0cmluZyB0b28gbG9uZyIpOwogICAgICAgICAgICAgICAgICAgICAgICAgIGUucHVzaCgyMTksIGwgPj4gMjQsIGwgPj4gMTYsIGwgPj4gOCwgbCksIHUgPSA1OwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4ucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaDogaSwKICAgICAgICAgICAgICAgICAgICAgICAgICB1OiBsLAogICAgICAgICAgICAgICAgICAgICAgICAgIHQ6IGUubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICB9KSwgdSArIGwKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoIm51bWJlciIgPT09IHMpIHJldHVybiBNYXRoLmZsb29yKGkpID09PSBpICYmIGlzRmluaXRlKGkpID8gMCA8PSBpID8gaSA8IDEyOCA/IChlLnB1c2goaSksIDEpIDogaSA8IDI1NiA/IChlLnB1c2goMjA0LCBpKSwgMikgOiBpIDwgNjU1MzYgPyAoZS5wdXNoKDIwNSwgaSA+PiA4LCBpKSwgMykgOiBpIDwgNDI5NDk2NzI5NiA/IChlLnB1c2goMjA2LCBpID4+IDI0LCBpID4+IDE2LCBpID4+IDgsIGkpLCA1KSA6IChhID0gaSAvIE1hdGgucG93KDIsIDMyKSA+PiAwLCBjID0gaSA+Pj4gMCwgZS5wdXNoKDIwNywgYSA+PiAyNCwgYSA+PiAxNiwgYSA+PiA4LCBhLCBjID4+IDI0LCBjID4+IDE2LCBjID4+IDgsIGMpLCA5KSA6IC0zMiA8PSBpID8gKGUucHVzaChpKSwgMSkgOiAtMTI4IDw9IGkgPyAoZS5wdXNoKDIwOCwgaSksIDIpIDogLTMyNzY4IDw9IGkgPyAoZS5wdXNoKDIwOSwgaSA+PiA4LCBpKSwgMykgOiAtMjE0NzQ4MzY0OCA8PSBpID8gKGUucHVzaCgyMTAsIGkgPj4gMjQsIGkgPj4gMTYsIGkgPj4gOCwgaSksIDUpIDogKGEgPSBNYXRoLmZsb29yKGkgLyBNYXRoLnBvdygyLCAzMikpLCBjID0gaSA+Pj4gMCwgZS5wdXNoKDIxMSwgYSA+PiAyNCwgYSA+PiAxNiwgYSA+PiA4LCBhLCBjID4+IDI0LCBjID4+IDE2LCBjID4+IDgsIGMpLCA5KSA6IChlLnB1c2goMjAzKSwgbi5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgIG86IGksCiAgICAgICAgICAgICAgICAgICAgICB1OiA4LAogICAgICAgICAgICAgICAgICAgICAgdDogZS5sZW5ndGgKICAgICAgICAgICAgICAgICAgfSksIDkpOwogICAgICAgICAgICAgICAgICBpZiAoIm9iamVjdCIgPT09IHMpIHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09PSBpKSByZXR1cm4gZS5wdXNoKDE5MiksIDE7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgobCA9IGkubGVuZ3RoKSA8IDE2KSBlLnB1c2goMTQ0IHwgbCksIHUgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGwgPCA2NTUzNikgZS5wdXNoKDIyMCwgbCA+PiA4LCBsKSwgdSA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGwgPCA0Mjk0OTY3Mjk2KSkgdGhyb3cgbmV3IEVycm9yKCJBcnJheSB0b28gbGFyZ2UiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKDIyMSwgbCA+PiAyNCwgbCA+PiAxNiwgbCA+PiA4LCBsKSwgdSA9IDU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobyA9IDA7IG8gPCBsOyBvKyspIHUgKz0gdChlLCBuLCBpW29dKTsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgaWYgKGkgaW5zdGFuY2VvZiBEYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBpLmdldFRpbWUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSA9IE1hdGguZmxvb3IoaCAvIE1hdGgucG93KDIsIDMyKSksIGMgPSBoID4+PiAwLCBlLnB1c2goMjE1LCAwLCBhID4+IDI0LCBhID4+IDE2LCBhID4+IDgsIGEsIGMgPj4gMjQsIGMgPj4gMTYsIGMgPj4gOCwgYyksIDEwCiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICBpZiAoaSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChsID0gaS5ieXRlTGVuZ3RoKSA8IDI1NikgZS5wdXNoKDE5NiwgbCksIHUgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGwgPCA2NTUzNikgZS5wdXNoKDE5NywgbCA+PiA4LCBsKSwgdSA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGwgPCA0Mjk0OTY3Mjk2KSkgdGhyb3cgbmV3IEVycm9yKCJCdWZmZXIgdG9vIGxhcmdlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHVzaCgxOTgsIGwgPj4gMjQsIGwgPj4gMTYsIGwgPj4gOCwgbCksIHUgPSA1OwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbDogaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTogbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdDogZS5sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgdSArIGwKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGlmICgiZnVuY3Rpb24iID09IHR5cGVvZiBpLnRvSlNPTikgcmV0dXJuIHQoZSwgbiwgaS50b0pTT04oKSk7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gT2JqZWN0LmtleXMoaSk7CiAgICAgICAgICAgICAgICAgICAgICBmb3IgKG8gPSAwLCByID0gcC5sZW5ndGg7IG8gPCByOyBvKyspICJmdW5jdGlvbiIgIT0gdHlwZW9mIGlbZiA9IHBbb11dICYmIGQucHVzaChmKTsKICAgICAgICAgICAgICAgICAgICAgIGlmICgobCA9IGQubGVuZ3RoKSA8IDE2KSBlLnB1c2goMTI4IHwgbCksIHUgPSAxOwogICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobCA8IDY1NTM2KSBlLnB1c2goMjIyLCBsID4+IDgsIGwpLCB1ID0gMzsKICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGwgPCA0Mjk0OTY3Mjk2KSkgdGhyb3cgbmV3IEVycm9yKCJPYmplY3QgdG9vIGxhcmdlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKDIyMywgbCA+PiAyNCwgbCA+PiAxNiwgbCA+PiA4LCBsKSwgdSA9IDU7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICBmb3IgKG8gPSAwOyBvIDwgbDsgbysrKSB1ICs9IHQoZSwgbiwgZiA9IGRbb10pLCB1ICs9IHQoZSwgbiwgaVtmXSk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmICgiYm9vbGVhbiIgPT09IHMpIHJldHVybiBlLnB1c2goaSA/IDE5NSA6IDE5NCksIDE7CiAgICAgICAgICAgICAgICAgIGlmICgidW5kZWZpbmVkIiA9PT0gcykgcmV0dXJuIGUucHVzaCgyMTIsIDAsIDApLCAzOwogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNvdWxkIG5vdCBlbmNvZGUiKQogICAgICAgICAgICAgIH0oZSwgaSwgdCksCiAgICAgICAgICAgICAgbyA9IG5ldyBBcnJheUJ1ZmZlcihzKSwKICAgICAgICAgICAgICByID0gbmV3IERhdGFWaWV3KG8pLAogICAgICAgICAgICAgIGEgPSAwLAogICAgICAgICAgICAgIGMgPSAwLAogICAgICAgICAgICAgIGwgPSAtMTsKICAgICAgICAgIDAgPCBpLmxlbmd0aCAmJiAobCA9IGlbMF0udCk7CiAgICAgICAgICBmb3IgKHZhciB1LCBoID0gMCwgZCA9IDAsIGYgPSAwLCBwID0gZS5sZW5ndGg7IGYgPCBwOyBmKyspCiAgICAgICAgICAgICAgaWYgKHIuc2V0VWludDgoYyArIGYsIGVbZl0pLCBmICsgMSA9PT0gbCkgewogICAgICAgICAgICAgICAgICBpZiAoaCA9ICh1ID0gaVthXSkudSwgZCA9IGMgKyBsLCB1LmwpCiAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBnID0gbmV3IFVpbnQ4QXJyYXkodS5sKSwgRSA9IDA7IEUgPCBoOyBFKyspIHIuc2V0VWludDgoZCArIEUsIGdbRV0pOwogICAgICAgICAgICAgICAgICBlbHNlIHUuaCA/IG4ociwgZCwgdS5oKSA6IHZvaWQgMCAhPT0gdS5vICYmIHIuc2V0RmxvYXQ2NChkLCB1Lm8pOwogICAgICAgICAgICAgICAgICBjICs9IGgsIGlbKythXSAmJiAobCA9IGlbYV0udCk7CiAgICAgICAgICAgICAgfSBsZXQgeSA9IEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkobykpOwogICAgICAgICAgeS51bnNoaWZ0KDQpOwogICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KHkpLmJ1ZmZlciAKICAgICAgfShvKQogIH0KCiAgZnVuY3Rpb24gZGVjb2RlKHBhY2tldCkgewogICAgICBmdW5jdGlvbiBlKHQpIHsKICAgICAgICAgIGlmICh0aGlzLnQgPSAwLCB0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHRoaXMuaSA9IHQsIHRoaXMucyA9IG5ldyBEYXRhVmlldyh0aGlzLmkpOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgaWYgKCFBcnJheUJ1ZmZlci5pc1ZpZXcodCkpIHJldHVybiBudWxsOwogICAgICAgICAgICAgIHRoaXMuaSA9IHQuYnVmZmVyLCB0aGlzLnMgPSBuZXcgRGF0YVZpZXcodGhpcy5pLCB0LmJ5dGVPZmZzZXQsIHQuYnl0ZUxlbmd0aCk7CiAgICAgICAgICB9CiAgICAgIH0KCiAgICAgIGUucHJvdG90eXBlLmcgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICBmb3IgKHZhciBlID0gbmV3IEFycmF5KHQpLCBuID0gMDsgbiA8IHQ7IG4rKykgZVtuXSA9IHRoaXMudigpOwogICAgICAgICAgcmV0dXJuIGUKICAgICAgfSwgZS5wcm90b3R5cGUuTSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgIGZvciAodmFyIGUgPSB7fSwgbiA9IDA7IG4gPCB0OyBuKyspIGVbdGhpcy52KCldID0gdGhpcy52KCk7CiAgICAgICAgICByZXR1cm4gZQogICAgICB9LCBlLnByb3RvdHlwZS5oID0gZnVuY3Rpb24odCkgewogICAgICAgICAgdmFyIGUgPSBmdW5jdGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9ICIiLCBzID0gMCwgbyA9IGUsIHIgPSBlICsgbjsgbyA8IHI7IG8rKykgewogICAgICAgICAgICAgICAgICB2YXIgYSA9IHQuZ2V0VWludDgobyk7CiAgICAgICAgICAgICAgICAgIGlmICgwICE9ICgxMjggJiBhKSkKICAgICAgICAgICAgICAgICAgICAgIGlmICgxOTIgIT0gKDIyNCAmIGEpKQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgyMjQgIT0gKDI0MCAmIGEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgyNDAgIT0gKDI0OCAmIGEpKSB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgYnl0ZSAiICsgYS50b1N0cmluZygxNikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA2NTUzNiA8PSAocyA9ICg3ICYgYSkgPDwgMTggfCAoNjMgJiB0LmdldFVpbnQ4KCsrbykpIDw8IDEyIHwgKDYzICYgdC5nZXRVaW50OCgrK28pKSA8PCA2IHwgKDYzICYgdC5nZXRVaW50OCgrK28pKSA8PCAwKSA/IChzIC09IDY1NTM2LCBpICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoNTUyOTYgKyAocyA+Pj4gMTApLCA1NjMyMCArICgxMDIzICYgcykpKSA6IGkgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgxNSAmIGEpIDw8IDEyIHwgKDYzICYgdC5nZXRVaW50OCgrK28pKSA8PCA2IHwgKDYzICYgdC5nZXRVaW50OCgrK28pKSA8PCAwKTsKICAgICAgICAgICAgICAgICAgZWxzZSBpICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKDMxICYgYSkgPDwgNiB8IDYzICYgdC5nZXRVaW50OCgrK28pKTsKICAgICAgICAgICAgICAgICAgZWxzZSBpICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBpCiAgICAgICAgICB9KHRoaXMucywgdGhpcy50LCB0KTsKICAgICAgICAgIHJldHVybiB0aGlzLnQgKz0gdCwgZQogICAgICB9LCBlLnByb3RvdHlwZS5sID0gZnVuY3Rpb24odCkgewogICAgICAgICAgdmFyIGUgPSB0aGlzLmkuc2xpY2UodGhpcy50LCB0aGlzLnQgKyB0KTsKICAgICAgICAgIHJldHVybiB0aGlzLnQgKz0gdCwgZQogICAgICB9LCBlLnByb3RvdHlwZS52ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICBpZighdGhpcy5zKSByZXR1cm4gbnVsbDsKICAgICAgICAgIHZhciB0LCBlID0gdGhpcy5zLmdldFVpbnQ4KHRoaXMudCsrKSwKICAgICAgICAgICAgICBuID0gMCwKICAgICAgICAgICAgICBpID0gMCwKICAgICAgICAgICAgICBzID0gMCwKICAgICAgICAgICAgICBvID0gMDsKICAgICAgICAgIGlmIChlIDwgMTkyKSByZXR1cm4gZSA8IDEyOCA/IGUgOiBlIDwgMTQ0ID8gdGhpcy5NKDE1ICYgZSkgOiBlIDwgMTYwID8gdGhpcy5nKDE1ICYgZSkgOiB0aGlzLmgoMzEgJiBlKTsKICAgICAgICAgIGlmICgyMjMgPCBlKSByZXR1cm4gLTEgKiAoMjU1IC0gZSArIDEpOwogICAgICAgICAgc3dpdGNoIChlKSB7CiAgICAgICAgICAgICAgY2FzZSAxOTI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgIGNhc2UgMTk0OgogICAgICAgICAgICAgICAgICByZXR1cm4gITE7CiAgICAgICAgICAgICAgY2FzZSAxOTU6CiAgICAgICAgICAgICAgICAgIHJldHVybiAhMDsKICAgICAgICAgICAgICBjYXNlIDE5NjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gPSB0aGlzLnMuZ2V0VWludDgodGhpcy50KSwgdGhpcy50ICs9IDEsIHRoaXMubChuKTsKICAgICAgICAgICAgICBjYXNlIDE5NzoKICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gPSB0aGlzLnMuZ2V0VWludDE2KHRoaXMudCksIHRoaXMudCArPSAyLCB0aGlzLmwobik7CiAgICAgICAgICAgICAgY2FzZSAxOTg6CiAgICAgICAgICAgICAgICAgIHJldHVybiBuID0gdGhpcy5zLmdldFVpbnQzMih0aGlzLnQpLCB0aGlzLnQgKz0gNCwgdGhpcy5sKG4pOwogICAgICAgICAgICAgIGNhc2UgMTk5OgogICAgICAgICAgICAgICAgICByZXR1cm4gbiA9IHRoaXMucy5nZXRVaW50OCh0aGlzLnQpLCBpID0gdGhpcy5zLmdldEludDgodGhpcy50ICsgMSksIHRoaXMudCArPSAyLCBbaSwgdGhpcy5sKG4pXTsKICAgICAgICAgICAgICBjYXNlIDIwMDoKICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gPSB0aGlzLnMuZ2V0VWludDE2KHRoaXMudCksIGkgPSB0aGlzLnMuZ2V0SW50OCh0aGlzLnQgKyAyKSwgdGhpcy50ICs9IDMsIFtpLCB0aGlzLmwobildOwogICAgICAgICAgICAgIGNhc2UgMjAxOgogICAgICAgICAgICAgICAgICByZXR1cm4gbiA9IHRoaXMucy5nZXRVaW50MzIodGhpcy50KSwgaSA9IHRoaXMucy5nZXRJbnQ4KHRoaXMudCArIDQpLCB0aGlzLnQgKz0gNSwgW2ksIHRoaXMubChuKV07CiAgICAgICAgICAgICAgY2FzZSAyMDI6CiAgICAgICAgICAgICAgICAgIHJldHVybiB0ID0gdGhpcy5zLmdldEZsb2F0MzIodGhpcy50KSwgdGhpcy50ICs9IDQsIHQ7CiAgICAgICAgICAgICAgY2FzZSAyMDM6CiAgICAgICAgICAgICAgICAgIHJldHVybiB0ID0gdGhpcy5zLmdldEZsb2F0NjQodGhpcy50KSwgdGhpcy50ICs9IDgsIHQ7CiAgICAgICAgICAgICAgY2FzZSAyMDQ6CiAgICAgICAgICAgICAgICAgIHJldHVybiB0ID0gdGhpcy5zLmdldFVpbnQ4KHRoaXMudCksIHRoaXMudCArPSAxLCB0OwogICAgICAgICAgICAgIGNhc2UgMjA1OgogICAgICAgICAgICAgICAgICByZXR1cm4gdCA9IHRoaXMucy5nZXRVaW50MTYodGhpcy50KSwgdGhpcy50ICs9IDIsIHQ7CiAgICAgICAgICAgICAgY2FzZSAyMDY6CiAgICAgICAgICAgICAgICAgIHJldHVybiB0ID0gdGhpcy5zLmdldFVpbnQzMih0aGlzLnQpLCB0aGlzLnQgKz0gNCwgdDsKICAgICAgICAgICAgICBjYXNlIDIwNzoKICAgICAgICAgICAgICAgICAgcmV0dXJuIHMgPSB0aGlzLnMuZ2V0VWludDMyKHRoaXMudCkgKiBNYXRoLnBvdygyLCAzMiksIG8gPSB0aGlzLnMuZ2V0VWludDMyKHRoaXMudCArIDQpLCB0aGlzLnQgKz0gOCwgcyArIG87CiAgICAgICAgICAgICAgY2FzZSAyMDg6CiAgICAgICAgICAgICAgICAgIHJldHVybiB0ID0gdGhpcy5zLmdldEludDgodGhpcy50KSwgdGhpcy50ICs9IDEsIHQ7CiAgICAgICAgICAgICAgY2FzZSAyMDk6CiAgICAgICAgICAgICAgICAgIHJldHVybiB0ID0gdGhpcy5zLmdldEludDE2KHRoaXMudCksIHRoaXMudCArPSAyLCB0OwogICAgICAgICAgICAgIGNhc2UgMjEwOgogICAgICAgICAgICAgICAgICByZXR1cm4gdCA9IHRoaXMucy5nZXRJbnQzMih0aGlzLnQpLCB0aGlzLnQgKz0gNCwgdDsKICAgICAgICAgICAgICBjYXNlIDIxMToKICAgICAgICAgICAgICAgICAgcmV0dXJuIHMgPSB0aGlzLnMuZ2V0SW50MzIodGhpcy50KSAqIE1hdGgucG93KDIsIDMyKSwgbyA9IHRoaXMucy5nZXRVaW50MzIodGhpcy50ICsgNCksIHRoaXMudCArPSA4LCBzICsgbzsKICAgICAgICAgICAgICBjYXNlIDIxMjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPSB0aGlzLnMuZ2V0SW50OCh0aGlzLnQpLCB0aGlzLnQgKz0gMSwgMCA9PT0gaSA/IHZvaWQodGhpcy50ICs9IDEpIDogW2ksIHRoaXMubCgxKV07CiAgICAgICAgICAgICAgY2FzZSAyMTM6CiAgICAgICAgICAgICAgICAgIHJldHVybiBpID0gdGhpcy5zLmdldEludDgodGhpcy50KSwgdGhpcy50ICs9IDEsIFtpLCB0aGlzLmwoMildOwogICAgICAgICAgICAgIGNhc2UgMjE0OgogICAgICAgICAgICAgICAgICByZXR1cm4gaSA9IHRoaXMucy5nZXRJbnQ4KHRoaXMudCksIHRoaXMudCArPSAxLCBbaSwgdGhpcy5sKDQpXTsKICAgICAgICAgICAgICBjYXNlIDIxNToKICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPSB0aGlzLnMuZ2V0SW50OCh0aGlzLnQpLCB0aGlzLnQgKz0gMSwgMCA9PT0gaSA/IChzID0gdGhpcy5zLmdldEludDMyKHRoaXMudCkgKiBNYXRoLnBvdygyLCAzMiksIG8gPSB0aGlzLnMuZ2V0VWludDMyKHRoaXMudCArIDQpLCB0aGlzLnQgKz0gOCwgbmV3IERhdGUocyArIG8pKSA6IFtpLCB0aGlzLmwoOCldOwogICAgICAgICAgICAgIGNhc2UgMjE2OgogICAgICAgICAgICAgICAgICByZXR1cm4gaSA9IHRoaXMucy5nZXRJbnQ4KHRoaXMudCksIHRoaXMudCArPSAxLCBbaSwgdGhpcy5sKDE2KV07CiAgICAgICAgICAgICAgY2FzZSAyMTc6CiAgICAgICAgICAgICAgICAgIHJldHVybiBuID0gdGhpcy5zLmdldFVpbnQ4KHRoaXMudCksIHRoaXMudCArPSAxLCB0aGlzLmgobik7CiAgICAgICAgICAgICAgY2FzZSAyMTg6CiAgICAgICAgICAgICAgICAgIHJldHVybiBuID0gdGhpcy5zLmdldFVpbnQxNih0aGlzLnQpLCB0aGlzLnQgKz0gMiwgdGhpcy5oKG4pOwogICAgICAgICAgICAgIGNhc2UgMjE5OgogICAgICAgICAgICAgICAgICByZXR1cm4gbiA9IHRoaXMucy5nZXRVaW50MzIodGhpcy50KSwgdGhpcy50ICs9IDQsIHRoaXMuaChuKTsKICAgICAgICAgICAgICBjYXNlIDIyMDoKICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gPSB0aGlzLnMuZ2V0VWludDE2KHRoaXMudCksIHRoaXMudCArPSAyLCB0aGlzLmcobik7CiAgICAgICAgICAgICAgY2FzZSAyMjE6CiAgICAgICAgICAgICAgICAgIHJldHVybiBuID0gdGhpcy5zLmdldFVpbnQzMih0aGlzLnQpLCB0aGlzLnQgKz0gNCwgdGhpcy5nKG4pOwogICAgICAgICAgICAgIGNhc2UgMjIyOgogICAgICAgICAgICAgICAgICByZXR1cm4gbiA9IHRoaXMucy5nZXRVaW50MTYodGhpcy50KSwgdGhpcy50ICs9IDIsIHRoaXMuTShuKTsKICAgICAgICAgICAgICBjYXNlIDIyMzoKICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gPSB0aGlzLnMuZ2V0VWludDMyKHRoaXMudCksIHRoaXMudCArPSA0LCB0aGlzLk0obikKICAgICAgICAgIH0KICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQ291bGQgbm90IHBhcnNlIikKICAgICAgfTsKCiAgICAgIGNvbnN0IHEgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICB2YXIgbiA9IG5ldyBlKHQgPSB0LnNsaWNlKDEpKSwKICAgICAgICAgICAgICBpID0gbi52KCk7CiAgICAgICAgICBpZiAobi50ID09PSB0LmJ5dGVMZW5ndGgpIHJldHVybiBpOwogICAgICAgICAgcmV0dXJuIG51bGwKICAgICAgfShwYWNrZXQpOwoKICAgICAgcmV0dXJuIHE/LmRhdGE/LlsxXTsKICB9CgogIHZhciBibHVlYm9hdCA9IHsKICAgICAgZW5jb2RlLAogICAgICBkZWNvZGUKICB9OwoKICBmdW5jdGlvbiBIZXhBbHBoYVRvUkdCQShoZXgsIGFscGhhKSB7CiAgICAgIGxldCByID0gcGFyc2VJbnQoaGV4LnNsaWNlKDEsIDMpLCAxNik7CiAgICAgIGxldCBnID0gcGFyc2VJbnQoaGV4LnNsaWNlKDMsIDUpLCAxNik7CiAgICAgIGxldCBiID0gcGFyc2VJbnQoaGV4LnNsaWNlKDUsIDcpLCAxNik7CiAgICAgIHJldHVybiBgcmdiYSgke3J9LCAke2d9LCAke2J9LCAke2FscGhhfSlgOwogIH0KICBmdW5jdGlvbiBSR0JBdG9IZXhBbHBoYShyZ2JhKSB7CiAgICAgIGxldCBbciwgZywgYiwgYV0gPSByZ2JhLnNsaWNlKDUsIC0xKS5zcGxpdCgiLCIpLm1hcCh4ID0+IHBhcnNlRmxvYXQoeC50cmltKCkpKTsKICAgICAgbGV0IGhleCA9IGAjJHtyLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAiMCIpfSR7Zy50b1N0cmluZygxNikucGFkU3RhcnQoMiwgIjAiKX0ke2IudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICIwIil9YDsKICAgICAgcmV0dXJuIFtoZXgsIGFdOwogIH0KICBmdW5jdGlvbiBwYXJzZUNoYW5nZVBhY2tldChwYWNrZXQpIHsKICAgICAgbGV0IHJldHVyblZhciA9IFtdOwogICAgICBmb3IgKGxldCBjaGFuZ2Ugb2YgcGFja2V0LmNoYW5nZXMpIHsKICAgICAgICAgIGxldCBkYXRhID0ge307CiAgICAgICAgICBsZXQga2V5cyA9IGNoYW5nZVsxXS5tYXAoKGluZGV4KSA9PiBwYWNrZXQudmFsdWVzW2luZGV4XSk7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBkYXRhW2tleXNbaV1dID0gY2hhbmdlWzJdW2ldOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuVmFyLnB1c2goewogICAgICAgICAgICAgIGlkOiBjaGFuZ2VbMF0sCiAgICAgICAgICAgICAgZGF0YQogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJldHVyblZhcjsKICB9CgogIC8vIEB0cy1pZ25vcmUgKGNhbid0IGJlIGJvdGhlcmVkIHRvIGZpZ3VyZSBvdXQgaG93IHRvIGltcG9ydCB0aGlzKQogIGNsYXNzIFNvY2tldEhhbmRsZXIgZXh0ZW5kcyBFdmVudFRhcmdldCB7CiAgICAgIGNvbnN0cnVjdG9yKGNoZWF0KSB7CiAgICAgICAgICBzdXBlcigpOwogICAgICAgICAgdGhpcy5zb2NrZXQgPSBudWxsOwogICAgICAgICAgdGhpcy5oYXNGaXJlZCA9IGZhbHNlOwogICAgICAgICAgdGhpcy50cmFuc3BvcnRUeXBlID0gInVua25vd24iOwogICAgICAgICAgdGhpcy5ibHVlYm9hdFJvb21JZCA9IG51bGw7CiAgICAgICAgICB0aGlzLmNoZWF0ID0gY2hlYXQ7CiAgICAgIH0KICAgICAgZ2V0U29ja2V0KCkgewogICAgICAgICAgbGV0IGhhbmRsZXJUaGlzID0gdGhpczsKICAgICAgICAgIGlmICghT2JqZWN0LmlzRnJvemVuKFdlYlNvY2tldCkpIHsKICAgICAgICAgICAgICAvLyBpbnRlcmNlcHQgYW55IG91dGdvaW5nIHNvY2tldCBjb25uZWN0aW9ucwogICAgICAgICAgICAgIFdlYlNvY2tldC5wcm90b3R5cGUuX3NlbmQgPSBXZWJTb2NrZXQucHJvdG90eXBlLnNlbmQ7CiAgICAgICAgICAgICAgV2ViU29ja2V0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIHVybCBpcyBhIGxvY2FsIHVybCwgZG9uJ3QgaW50ZXJjZXB0IGl0CiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnVybC5zdGFydHNXaXRoKCJ3czovL2xvY2FsaG9zdCIpKQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbmQoZGF0YSk7CiAgICAgICAgICAgICAgICAgIGhhbmRsZXJUaGlzLnJlZ2lzdGVyU29ja2V0KHRoaXMpOwogICAgICAgICAgICAgICAgICBpZiAoIWhhbmRsZXJUaGlzLnNvY2tldCkKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgaGFuZGxlclRoaXMuc29ja2V0Ll9zZW5kKGRhdGEpOwogICAgICAgICAgICAgICAgICAvLyBhdHRlbXB0IHRvIGdldCB0aGUgcm9vbSBpZAogICAgICAgICAgICAgICAgICBpZiAoaGFuZGxlclRoaXMudHJhbnNwb3J0VHlwZSA9PSAiYmx1ZWJvYXQiKSB7CiAgICAgICAgICAgICAgICAgICAgICBsZXQgZGVjb2RlZCA9IGJsdWVib2F0LmRlY29kZShkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWNvZGVkLnJvb21JZCkKICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyVGhpcy5ibHVlYm9hdFJvb21JZCA9IGRlY29kZWQucm9vbUlkOwogICAgICAgICAgICAgICAgICAgICAgaWYgKGRlY29kZWQucm9vbSkKICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyVGhpcy5ibHVlYm9hdFJvb21JZCA9IGRlY29kZWQucm9vbTsKICAgICAgICAgICAgICAgICAgICAgIGlmICghaGFuZGxlclRoaXMuYmx1ZWJvYXRSb29tSWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlclRoaXMuY2hlYXQubG9nKCJSb29tIElEOiAiLCBoYW5kbGVyVGhpcy5ibHVlYm9hdFJvb21JZCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgLy8gcGVyaW9kaWNhbGx5IGF0dGVtcHQgdG8gZXh0cmFjdCB0aGUgc29ja2V0LCBpbiBjYXNlIHNvbWV0aGluZyBmYWlsZWQKICAgICAgICAgICAgICBsZXQgdHJ5R2V0U29ja2V0ID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lOwogICAgICAgICAgICAgICAgICBsZXQgZ290U29ja2V0ID0gKF9lID0gKF9kID0gKF9jID0gKF9iID0gKF9hID0gd2luZG93ID09PSBudWxsIHx8IHdpbmRvdyA9PT0gdm9pZCAwID8gdm9pZCAwIDogd2luZG93LnN0b3JlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm5ldHdvcmspID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5yb29tKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuY29ubmVjdGlvbikgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLnRyYW5zcG9ydCkgPT09IG51bGwgfHwgX2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lLndzOwogICAgICAgICAgICAgICAgICBpZiAoZ290U29ja2V0KSB7CiAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyVGhpcy5yZWdpc3RlclNvY2tldChnb3RTb2NrZXQpOwogICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0cnlHZXRTb2NrZXQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgMTAwKTsKICAgICAgICAgIH0KICAgICAgfQogICAgICByZWdpc3RlclNvY2tldChzb2NrZXQpIHsKICAgICAgICAgIGlmICh0aGlzLmhhc0ZpcmVkKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIHRoaXMuc29ja2V0ID0gc29ja2V0OwogICAgICAgICAgdGhpcy5oYXNGaXJlZCA9IHRydWU7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJzb2NrZXQiLCB7IGRldGFpbDogc29ja2V0IH0pKTsKICAgICAgICAgIC8vIGRldGVjdCB0aGUgdHJhbnNwb3J0IHR5cGUKICAgICAgICAgIGlmICgic3RvcmVzIiBpbiB1bnNhZmVXaW5kb3cpCiAgICAgICAgICAgICAgdGhpcy50cmFuc3BvcnRUeXBlID0gImNvbHlzZXVzIjsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICB0aGlzLnRyYW5zcG9ydFR5cGUgPSAiYmx1ZWJvYXQiOwogICAgICAgICAgbGV0IGhhbmRsZXJUaGlzID0gdGhpczsKICAgICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgKGUpID0+IHsKICAgICAgICAgICAgICAvLyBkZWNvZGUgdGhlIG1lc3NhZ2UKICAgICAgICAgICAgICBsZXQgZGVjb2RlZDsKICAgICAgICAgICAgICBpZiAodGhpcy50cmFuc3BvcnRUeXBlID09ICJjb2x5c2V1cyIpCiAgICAgICAgICAgICAgICAgIGRlY29kZWQgPSBjb2x5c2V1cy5kZWNvZGUoZS5kYXRhKTsKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgIGRlY29kZWQgPSBibHVlYm9hdC5kZWNvZGUoZS5kYXRhKTsKICAgICAgICAgICAgICBpZiAoIWRlY29kZWQpCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBoYW5kbGVyVGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgicmVjaWV2ZU1lc3NhZ2UiLCB7IGRldGFpbDogZGVjb2RlZCB9KSk7CiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkZWNvZGVkICE9ICJvYmplY3QiKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgaWYgKCdjaGFuZ2VzJyBpbiBkZWNvZGVkKSB7CiAgICAgICAgICAgICAgICAgIGxldCBwYXJzZWQgPSBwYXJzZUNoYW5nZVBhY2tldChkZWNvZGVkKTsKICAgICAgICAgICAgICAgICAgaGFuZGxlclRoaXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoInJlY2lldmVDaGFuZ2VzIiwgeyBkZXRhaWw6IHBhcnNlZCB9KSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgc2VuZERhdGEoY2hhbm5lbCwgZGF0YSkgewogICAgICAgICAgaWYgKCF0aGlzLnNvY2tldCkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICBpZiAoIXRoaXMuYmx1ZWJvYXRSb29tSWQgJiYgdGhpcy50cmFuc3BvcnRUeXBlID09ICJibHVlYm9hdCIpCiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hlYXQubG9nKCJSb29tIElEIG5vdCBmb3VuZCwgY2FuJ3Qgc2VuZCBkYXRhIik7CiAgICAgICAgICBsZXQgZW5jb2RlZDsKICAgICAgICAgIGlmICh0aGlzLnRyYW5zcG9ydFR5cGUgPT0gImNvbHlzZXVzIikKICAgICAgICAgICAgICBlbmNvZGVkID0gY29seXNldXMuZW5jb2RlKGNoYW5uZWwsIGRhdGEpOwogICAgICAgICAgZWxzZQogICAgICAgICAgICAgIGVuY29kZWQgPSBibHVlYm9hdC5lbmNvZGUoY2hhbm5lbCwgZGF0YSwgdGhpcy5ibHVlYm9hdFJvb21JZCk7CiAgICAgICAgICB0aGlzLnNvY2tldC5zZW5kKGVuY29kZWQpOwogICAgICB9CiAgfQoKICBjbGFzcyBLZXliaW5kTWFuYWdlciB7CiAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgdGhpcy5rZXlzID0gbmV3IFNldCgpOwogICAgICAgICAgdGhpcy5iaW5kcyA9IFtdOwogICAgICAgICAgdGhpcy5hZGRMaXN0ZW5lcnMoKTsKICAgICAgfQogICAgICBhZGRMaXN0ZW5lcnMoKSB7CiAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIChlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5rZXlzLmFkZChlLmtleS50b0xvd2VyQ2FzZSgpKTsKICAgICAgICAgICAgICB0aGlzLmNoZWNrQmluZHMoZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJrZXl1cCIsIChlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5rZXlzLmRlbGV0ZShlLmtleS50b0xvd2VyQ2FzZSgpKTsKICAgICAgICAgIH0pOwogICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImJsdXIiLCAoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5rZXlzLmNsZWFyKCk7CiAgICAgICAgICB9KTsKICAgICAgfQogICAgICBjaGVja0JpbmRzKGUpIHsKICAgICAgICAgIHZhciBfYTsKICAgICAgICAgIGlmIChlLnJlcGVhdCkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICBmb3IgKGxldCBiaW5kIG9mIHRoaXMuYmluZHMpIHsKICAgICAgICAgICAgICBpZiAoIWJpbmQua2V5cy5oYXMoZS5rZXkudG9Mb3dlckNhc2UoKSkpCiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIGlmIChiaW5kLmtleXMuc2l6ZSA9PSAwKQogICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAvLyBpZiB0aGUgYmluZCBpcyBleGNsdXNpdmUsIG1ha2Ugc3VyZSBubyBvdGhlciBrZXlzIGFyZSBwcmVzc2VkCiAgICAgICAgICAgICAgaWYgKGJpbmQuZXhjbHVzaXZlICYmIGJpbmQua2V5cy5zaXplICE9IHRoaXMua2V5cy5zaXplKQogICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAvLyBjaGVjayB3aGV0aGVyIHRoZSBrZXlzIGluIHRoZSBiaW5kIGFyZSBwcmVzc2VkCiAgICAgICAgICAgICAgaWYgKEFycmF5LmZyb20oYmluZC5rZXlzKS5ldmVyeShrZXkgPT4gdGhpcy5rZXlzLmhhcyhrZXkpKSkgewogICAgICAgICAgICAgICAgICAoX2EgPSBiaW5kLmNhbGxiYWNrKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsbChiaW5kKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgcmVnaXN0ZXJCaW5kKGJpbmQpIHsKICAgICAgICAgIGlmICh0aGlzLmJpbmRzLmluY2x1ZGVzKGJpbmQpKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIHRoaXMuYmluZHMucHVzaChiaW5kKTsKICAgICAgfQogICAgICByZW1vdmVCaW5kKGJpbmQpIHsKICAgICAgICAgIGlmICghdGhpcy5iaW5kcy5pbmNsdWRlcyhiaW5kKSkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB0aGlzLmJpbmRzLnNwbGljZSh0aGlzLmJpbmRzLmluZGV4T2YoYmluZCksIDEpOwogICAgICB9CiAgICAgIGNsZWFyQmluZHMoKSB7CiAgICAgICAgICB0aGlzLmJpbmRzID0gW107CiAgICAgIH0KICB9CgogIHZhciBjc3MgPSAiI2djX2h1ZCB7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB0b3A6IDA7XHJcbiAgICBsZWZ0OiAwO1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICB6LWluZGV4OiA5OTk5OTk5OTk5OTk7XHJcbiAgICBwb2ludGVyLWV2ZW50czogbm9uZTtcclxuICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTtcclxufVxyXG5cclxuI2djX2h1ZCAubWVudV9jb250cm9scyB7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGhlaWdodDogMjBweDtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLW1lbnUtY29udHJvbHMtYmctY29sb3IpO1xyXG4gICAgY29sb3I6IHZhcigtLW1lbnUtY29udHJvbHMtdGV4dC1jb2xvcik7XHJcbiAgICBib3JkZXItcmFkaXVzOiA1cHggNXB4IDBweCAwcHg7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbn1cclxuXHJcbiNnY19odWQgLm1lbnVfbWluaW1pemVyIHtcclxuICAgIG1hcmdpbi1sZWZ0OiAyMHB4O1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAyMHB4O1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgdG9wOiAwO1xyXG4gICAgcmlnaHQ6IDA7XHJcbiAgICB1c2VyLXNlbGVjdDogbm9uZTtcclxufVxyXG5cclxuI2djX2h1ZCAubWVudSB7XHJcbiAgICBwb2ludGVyLWV2ZW50czogYXV0bztcclxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLW1lbnUtYmctY29sb3IpO1xyXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgb3ZlcmZsb3cteDogaGlkZGVuO1xyXG4gICAgb3ZlcmZsb3cteTogaGlkZGVuO1xyXG4gICAgcmVzaXplOiBib3RoO1xyXG4gICAgd2lkdGg6IDMwMHB4O1xyXG4gICAgaGVpZ2h0OiAyMDBweDtcclxuICAgIG91dGxpbmU6IDNweCBzb2xpZCB2YXIoLS1tZW51LWJvcmRlci1jb2xvcik7XHJcbn1cclxuXHJcbiNnY19odWQgLm1lbnUubWluaW1pemVkIHtcclxuICAgIGhlaWdodDogMjBweCAhaW1wb3J0YW50O1xyXG4gICAgb3ZlcmZsb3cteTogaGlkZGVuO1xyXG4gICAgcmVzaXplOiBob3Jpem9udGFsO1xyXG59XHJcblxyXG4jZ2NfaHVkIC5ncm91cCB7XHJcbiAgICBtYXJnaW46IDBweDtcclxuICAgIHBhZGRpbmc6IDBweDtcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgLyogYWxsb2NhdGUgc29tZSBzcGFjZSBhdCB0aGUgdG9wIGFuZCBib3R0b20gKi9cclxuICAgIGhlaWdodDogY2FsYygxMDAlIC0gNDBweCk7IFxyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgdG9wOiAyMHB4O1xyXG4gICAgbGVmdDogMDtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIG92ZXJmbG93LXk6IGF1dG87XHJcbiAgICBvdmVyZmxvdy14OiBoaWRkZW47XHJcbn1cclxuXHJcbiNnY19odWQgLmJ1dHRvbiwgI2djX2h1ZCAuZ3JvdXBfb3BlbmVyIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJ1dHRvbi1iZy1jb2xvcik7XHJcbiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1idXR0b24tYm9yZGVyLWNvbG9yKTtcclxufVxyXG5cclxuI2djX2h1ZCAudG9nZ2xlIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXRvZ2dsZS1iZy1jb2xvcik7XHJcbiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS10b2dnbGUtYm9yZGVyLWNvbG9yKTtcclxufVxyXG5cclxuI2djX2h1ZCAuYnV0dG9uLCAjZ2NfaHVkIC50b2dnbGUsICNnY19odWQgLmdyb3VwX29wZW5lciB7XHJcbiAgICBib3JkZXItcmFkaXVzOiA1cHg7XHJcbiAgICBwYWRkaW5nOiA1cHg7XHJcbiAgICBtYXJnaW46IDVweDtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgIHdpZHRoOiA5MCU7XHJcbiAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4ycyBlYXNlLWluLW91dDtcclxufVxyXG5cclxuLyogbWFrZSBpdCBib3VuY2Ugc21hbGxlciB3aGVuIGNsaWNrZWQgKi9cclxuI2djX2h1ZCAuYnV0dG9uOmFjdGl2ZSwgI2djX2h1ZCAudG9nZ2xlOmFjdGl2ZSwgI2djX2h1ZCAuZ3JvdXBfb3BlbmVyOmFjdGl2ZSB7XHJcbiAgICB0cmFuc2Zvcm06IHNjYWxlKDAuOTMpO1xyXG59XHJcblxyXG4jZ2NfaHVkIC5jb2xvcnBpY2tlciB7XHJcbiAgICB3aWR0aDogMTAwJTtcclxufVxyXG5cclxuI2djX2h1ZCAuY29sb3JwaWNrZXJfd3JhcHBlciB7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgbWFyZ2luOiA1cHg7XHJcbn1cclxuXHJcbiNnY19odWQgLmNvbG9ycGlja2VyX29wYWNpdHlfd3JhcHBlciB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kO1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxufVxyXG5cclxuI2djX2h1ZCAuY29sb3JwaWNrZXJfcHJldmlldyB7XHJcbiAgICB3aWR0aDogNTBweDtcclxuICAgIGhlaWdodDogNTBweDtcclxuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcclxuICAgIG9wYWNpdHk6IDE7XHJcbn1cclxuXHJcbiNnY19odWQgLnRleHQge1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbn1cclxuXHJcbiNnY19odWQgLnRleHRpbnB1dF93cmFwcGVyLCAjZ2NfaHVkIC5kcm9wZG93bl93cmFwcGVyLCAjZ2NfaHVkIC5zbGlkZXJfd3JhcHBlciB7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG59XHJcblxyXG4jZ2NfaHVkIC50ZXh0aW5wdXQge1xyXG4gICAgd2lkdGg6IDkwJTtcclxuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcclxuICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXRleHRpbnB1dC1ib3JkZXItY29sb3IpO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tdGV4dGlucHV0LWJnLWNvbG9yKTtcclxuICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTtcclxuICAgIHBhZGRpbmc6IDVweDtcclxuICAgIG1hcmdpbjogNXB4O1xyXG59XHJcblxyXG4jZ2NfaHVkIC5kcm9wZG93biB7XHJcbiAgICB3aWR0aDogOTAlO1xyXG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tZHJvcGRvd24tYm9yZGVyLWNvbG9yKTtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWRyb3Bkb3duLWJnLWNvbG9yKTtcclxuICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTtcclxuICAgIHBhZGRpbmc6IDVweDtcclxuICAgIG1hcmdpbjogNXB4O1xyXG59XHJcblxyXG4jZ2NfaHVkIC50b2dnbGVfd3JhcHBlciwgI2djX2h1ZCAuYnV0dG9uX3dyYXBwZXIge1xyXG4gICAgd2lkdGg6IDkwJTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgcGFkZGluZzogMHB4O1xyXG59XHJcblxyXG4jZ2NfaHVkIC50b2dnbGUsICNnY19odWQgLmJ1dHRvbiB7XHJcbiAgICAvKiBtYWtlIGl0IHRha2UgdXAgYXMgbXVjaCBzcGFjZSBhcyBwb3NzaWJsZSAqL1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBtYXJnaW4tbGVmdDogMHB4O1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAwcHg7XHJcbn1cclxuXHJcbiNnY19odWQgLmtleWJpbmRfb3BlbmVyIHtcclxuICAgIHdpZHRoOiAzMHB4O1xyXG4gICAgaGVpZ2h0OiAzMHB4O1xyXG4gICAgZm9udC1zaXplOiAzMHB4O1xyXG4gICAgbWFyZ2luLWxlZnQ6IDEwcHg7XHJcbn1cclxuXHJcbiNnY19odWQgLmtleWJpbmRfZWRpdG9yX3dyYXBwZXIge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0ta2V5YmluZC1lZGl0b3ItYmctY29sb3IpO1xyXG4gICAgYm9yZGVyOiAzcHggc29saWQgdmFyKC0ta2V5YmluZC1lZGl0b3ItYm9yZGVyLWNvbG9yKTtcclxuICAgIGJvcmRlci1yYWRpdXM6IDhweDtcclxufVxyXG5cclxuI2djX2h1ZCAua2V5YmluZF9lZGl0b3Ige1xyXG4gICAgd2lkdGg6IDUwdnc7XHJcbiAgICBoZWlnaHQ6IDUwdmg7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kO1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTtcclxufVxyXG5cclxuI2djX2h1ZCAuY2xvc2Uge1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgdG9wOiAwO1xyXG4gICAgcmlnaHQ6IDA7XHJcbiAgICB3aWR0aDogMjBweDtcclxuICAgIGhlaWdodDogMjBweDtcclxuICAgIGZvbnQtc2l6ZTogMjBweDtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgIHVzZXItc2VsZWN0OiBub25lO1xyXG59XHJcblxyXG4jZ2NfaHVkIC5rZXliaW5kX3RpdGxlIHtcclxuICAgIGZvbnQtc2l6ZTogNDBweDtcclxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxufVxyXG5cclxuI2djX2h1ZCAua2V5YmluZF9jb250cm9scyB7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG59XHJcblxyXG4jZ2NfaHVkIC5rZXliaW5kX2Rpc3BsYXkge1xyXG4gICAgYm9yZGVyOiAzcHggc29saWQgd2hpdGU7XHJcbiAgICBtaW4td2lkdGg6IDMwMHB4O1xyXG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgaGVpZ2h0OiA1MHB4O1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxufVxyXG5cclxuI2djX2h1ZCAua2V5YmluZF9leGNsdXNpdmUge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxufVxyXG5cclxuI2djX2h1ZCAua2V5YmluZF9leGNsdXNpdmUgLnRleHQge1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xyXG59XHJcblxyXG4jZ2NfaHVkIC5rZXliaW5kX2VkaXRvciAuYWN0aW9uIHtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxufVxyXG5cclxuI2djX2h1ZCAuc2xpZGVyIHtcclxuICAgIHdpZHRoOiA5MCU7XHJcbiAgICBtYXJnaW46IDVweDtcclxufVxyXG5cclxuLmdjX292ZXJsYXlfY2FudmFzIHtcclxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgIHRvcDogMDtcclxuICAgIGxlZnQ6IDA7XHJcbiAgICB3aWR0aDogMTAwdnc7XHJcbiAgICBoZWlnaHQ6IDEwMHZoO1xyXG4gICAgei1pbmRleDogOTk5OTtcclxuICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xyXG59XHJcblxyXG5Aa2V5ZnJhbWVzIHNsaWRlX291dF9sZWZ0IHtcclxuICAgIDAlIHtcclxuICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7XHJcbiAgICAgICAgb3BhY2l0eTogMTtcclxuICAgICAgICBwb2ludGVyLWV2ZW50czogYWxsO1xyXG4gICAgfVxyXG5cclxuICAgIDEwMCUge1xyXG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtMTAwJSk7XHJcbiAgICAgICAgb3BhY2l0eTogMDtcclxuICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTtcclxuICAgIH1cclxufVxyXG5cclxuQGtleWZyYW1lcyBzbGlkZV9vdXRfcmlnaHQge1xyXG4gICAgMCUge1xyXG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgwKTtcclxuICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7XHJcbiAgICB9XHJcblxyXG4gICAgMTAwJSB7XHJcbiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDEwMCUpO1xyXG4gICAgICAgIG9wYWNpdHk6IDA7XHJcbiAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XHJcbiAgICB9XHJcbn1cclxuXHJcbkBrZXlmcmFtZXMgc2xpZGVfaW5fbGVmdCB7XHJcbiAgICAwJSB7XHJcbiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0xMDAlKTtcclxuICAgICAgICBvcGFjaXR5OiAwO1xyXG4gICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xyXG4gICAgfVxyXG5cclxuICAgIDEwMCUge1xyXG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgwKTtcclxuICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7XHJcbiAgICB9XHJcbn1cclxuXHJcbkBrZXlmcmFtZXMgc2xpZGVfaW5fcmlnaHQge1xyXG4gICAgMCUge1xyXG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgxMDAlKTtcclxuICAgICAgICBvcGFjaXR5OiAwO1xyXG4gICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xyXG4gICAgfVxyXG5cclxuICAgIDEwMCUge1xyXG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgwKTtcclxuICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7XHJcbiAgICB9XHJcbn1cclxuXHJcbkBrZXlmcmFtZXMgaWRsZSB7fSI7CgogIGNsYXNzIEh1ZEVsZW1lbnQgZXh0ZW5kcyBFdmVudFRhcmdldCB7CiAgICAgIC8vIGFueSBpcyB1c2VkIHRvIGF2b2lkIGNpcmN1bGFyIGRlcGVuZGVuY2llcwogICAgICBjb25zdHJ1Y3Rvcihncm91cCwgb3B0aW9ucykgewogICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgIHRoaXMuZ3JvdXAgPSBudWxsOwogICAgICAgICAgdGhpcy5vcHRpb25zID0gbnVsbDsKICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7CiAgICAgICAgICB0aGlzLmdyb3VwID0gZ3JvdXA7CiAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwogICAgICB9CiAgICAgIHJlbW92ZSgpIHsKICAgICAgICAgIHZhciBfYTsKICAgICAgICAgIChfYSA9IHRoaXMuZWxlbWVudCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJlbW92ZSgpOwogICAgICAgICAgdGhpcy5ncm91cC5lbGVtZW50cy5zcGxpY2UodGhpcy5ncm91cC5lbGVtZW50cy5pbmRleE9mKHRoaXMpLCAxKTsKICAgICAgfQogIH0KCiAgY2xhc3MgVGV4dCBleHRlbmRzIEh1ZEVsZW1lbnQgewogICAgICBjb25zdHJ1Y3Rvcihncm91cCwgb3B0aW9ucykgewogICAgICAgICAgc3VwZXIoZ3JvdXAsIG9wdGlvbnMpOwogICAgICAgICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgidGV4dCIpOwogICAgICAgICAgdGhpcy5lbGVtZW50LmlubmVyVGV4dCA9IHRoaXMub3B0aW9ucy50ZXh0OwogICAgICB9CiAgICAgIHNldCB0ZXh0KHRleHQpIHsKICAgICAgICAgIHRoaXMuZWxlbWVudC5pbm5lclRleHQgPSB0ZXh0OwogICAgICB9CiAgICAgIGdldCB0ZXh0KCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5pbm5lclRleHQ7CiAgICAgIH0KICB9CgogIGNsYXNzIEdyb3VwT3BlbmVyIGV4dGVuZHMgSHVkRWxlbWVudCB7CiAgICAgIGNvbnN0cnVjdG9yKGdyb3VwLCBvcHRpb25zKSB7CiAgICAgICAgICBzdXBlcihncm91cCwgb3B0aW9ucyk7CiAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCJncm91cF9vcGVuZXIiKTsKICAgICAgICAgIHRoaXMuZWxlbWVudC5pbm5lclRleHQgPSB0aGlzLm9wdGlvbnMudGV4dDsKICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgICAgICAgICAgICB2YXIgX2E7CiAgICAgICAgICAgICAgbGV0IGRpcmVjdGlvbiA9IChfYSA9IHRoaXMub3B0aW9ucy5kaXJlY3Rpb24pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6ICJyaWdodCI7CiAgICAgICAgICAgICAgbGV0IG9wcG9zaXRlRGlyZWN0aW9uID0gZGlyZWN0aW9uID09ICJyaWdodCIgPyAibGVmdCIgOiAicmlnaHQiOwogICAgICAgICAgICAgIC8vIG9wZW4gdGhlIGdyb3VwCiAgICAgICAgICAgICAgdGhpcy5ncm91cC5zbGlkZSgib3V0IiwgZGlyZWN0aW9uKTsKICAgICAgICAgICAgICBsZXQgZ3JvdXBUb09wZW4gPSB0aGlzLmdyb3VwLm1lbnUuZ2V0QW55R3JvdXAodGhpcy5vcHRpb25zLm9wZW5Hcm91cCk7CiAgICAgICAgICAgICAgaWYgKCFncm91cFRvT3BlbikKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGdyb3VwVG9PcGVuLnNsaWRlKCJpbiIsIG9wcG9zaXRlRGlyZWN0aW9uKTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICAgIHNldCB0ZXh0KHRleHQpIHsKICAgICAgICAgIHRoaXMuZWxlbWVudC5pbm5lclRleHQgPSB0ZXh0OwogICAgICB9CiAgICAgIGdldCB0ZXh0KCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5pbm5lclRleHQ7CiAgICAgIH0KICB9CgogIGNsYXNzIENvbG9yUGlja2VyIGV4dGVuZHMgSHVkRWxlbWVudCB7CiAgICAgIGNvbnN0cnVjdG9yKGdyb3VwLCBvcHRpb25zKSB7CiAgICAgICAgICB2YXIgX2EsIF9iOwogICAgICAgICAgc3VwZXIoZ3JvdXAsIG9wdGlvbnMpOwogICAgICAgICAgdGhpcy5vcGFjaXR5U2xpZGVyID0gbnVsbDsKICAgICAgICAgIHRoaXMuY29sb3JQaWNrZXIgPSBudWxsOwogICAgICAgICAgdGhpcy5wcmV2aWV3ID0gbnVsbDsKICAgICAgICAgIC8vIGNyZWF0ZSB0aGUgZWxlbWVudAogICAgICAgICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gYAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXh0Ij4ke3RoaXMub3B0aW9ucy50ZXh0fTwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2xvcnBpY2tlcl93cmFwcGVyIj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbG9ycGlja2VyX29wYWNpdHlfd3JhcHBlciI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGV4dCI+T3BhY2l0eTwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgbWluPSIwIiBtYXg9IjI1NSIgdmFsdWU9IjI1NSIgY2xhc3M9ImNvbG9ycGlja2VyX29wYWNpdHkiPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iY29sb3IiIHZhbHVlPSIjZmZmZmZmIiBjbGFzcz0iY29sb3JwaWNrZXJfY29sb3IiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sb3JwaWNrZXJfcHJldmlldyI+PC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIGA7CiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoImNvbG9ycGlja2VyIik7CiAgICAgICAgICB0aGlzLm9wYWNpdHlTbGlkZXIgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoIi5jb2xvcnBpY2tlcl9vcGFjaXR5Iik7CiAgICAgICAgICB0aGlzLmNvbG9yUGlja2VyID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCIuY29sb3JwaWNrZXJfY29sb3IiKTsKICAgICAgICAgIHRoaXMucHJldmlldyA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcigiLmNvbG9ycGlja2VyX3ByZXZpZXciKTsKICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuYmluZFZhcikKICAgICAgICAgICAgICB0aGlzLmNvbG9yID0gd2luZG93LmNoZWF0Lmh1ZC5zeW5jZWRWYXJzLmdldCgiY3NzVmFycyIpLmdldCh0aGlzLm9wdGlvbnMuYmluZFZhcik7CiAgICAgICAgICBlbHNlIGlmICh0aGlzLm9wdGlvbnMuY29sb3IpCiAgICAgICAgICAgICAgdGhpcy5jb2xvciA9IHRoaXMub3B0aW9ucy5jb2xvcjsKICAgICAgICAgIC8vIHByZXZlbnQgdGhlIG1lbnUgZnJvbSBiZWluZyBkcmFnZ2VkIHdoZW4gdGhlIHNsaWRlciBpcyBtb3ZlZAogICAgICAgICAgdGhpcy5vcGFjaXR5U2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIChlKSA9PiB7IGUuc3RvcFByb3BhZ2F0aW9uKCk7IH0pOwogICAgICAgICAgKF9hID0gdGhpcy5vcGFjaXR5U2xpZGVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCAoKSA9PiB7IHRoaXMudXBkYXRlUHJldmlldygpOyB9KTsKICAgICAgICAgIChfYiA9IHRoaXMuY29sb3JQaWNrZXIpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsICgpID0+IHsgdGhpcy51cGRhdGVQcmV2aWV3KCk7IH0pOwogICAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDsKICAgICAgICAgIHRoaXMudXBkYXRlUHJldmlldygpOwogICAgICB9CiAgICAgIHVwZGF0ZVByZXZpZXcoKSB7CiAgICAgICAgICBsZXQgY29sb3IgPSB0aGlzLmNvbG9yUGlja2VyLnZhbHVlOwogICAgICAgICAgbGV0IG9wYWNpdHkgPSBwYXJzZUludCh0aGlzLm9wYWNpdHlTbGlkZXIudmFsdWUpOwogICAgICAgICAgdGhpcy5wcmV2aWV3LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yOwogICAgICAgICAgdGhpcy5wcmV2aWV3LnN0eWxlLm9wYWNpdHkgPSBgJHtvcGFjaXR5IC8gMjU1fWA7CiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmJpbmRWYXIpIHsKICAgICAgICAgICAgICB3aW5kb3cuY2hlYXQuaHVkLnVwZGF0ZUNzc1Zhcih0aGlzLm9wdGlvbnMuYmluZFZhciwgdGhpcy5jb2xvcik7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJjaGFuZ2UiLCB7CiAgICAgICAgICAgICAgZGV0YWlsOiB0aGlzLmNvbG9yCiAgICAgICAgICB9KSk7CiAgICAgIH0KICAgICAgc2V0IGNvbG9yKGNvbG9yKSB7CiAgICAgICAgICBsZXQgW2hleCwgYWxwaGFdID0gUkdCQXRvSGV4QWxwaGEoY29sb3IpOwogICAgICAgICAgdGhpcy5jb2xvclBpY2tlci52YWx1ZSA9IGhleDsKICAgICAgICAgIHRoaXMub3BhY2l0eVNsaWRlci52YWx1ZSA9IGAkezI1NSAqIGFscGhhfWA7CiAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXcoKTsKICAgICAgfQogICAgICBnZXQgY29sb3IoKSB7CiAgICAgICAgICBsZXQgY29sb3IgPSB0aGlzLmNvbG9yUGlja2VyLnZhbHVlOwogICAgICAgICAgbGV0IG9wYWNpdHkgPSBwYXJzZUludCh0aGlzLm9wYWNpdHlTbGlkZXIudmFsdWUpOwogICAgICAgICAgbGV0IHJnYmEgPSBIZXhBbHBoYVRvUkdCQShjb2xvciwgb3BhY2l0eSAvIDI1NSk7CiAgICAgICAgICByZXR1cm4gcmdiYTsKICAgICAgfQogIH0KCiAgZnVuY3Rpb24ga2V5Ym9hcmQoKSB7CiAgCXJldHVybiAobmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZygiPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCA1MCA0MFwiPjxyZWN0IHdpZHRoPVwiNDBcIiBoZWlnaHQ9XCIyNlwiIHg9XCI0XCIgeT1cIjEwXCIgcng9XCIyLjAzOFwiIHJ5PVwiMi4yMzRcIiBzdHlsZT1cImZpbGw6IzAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6I2ZmZjtzdHJva2Utd2lkdGg6ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lXCIvPjxyZWN0IHdpZHRoPVwiNDBcIiBoZWlnaHQ9XCIyNlwiIHg9XCI0XCIgeT1cIjEwXCIgcng9XCIyLjAzOFwiIHJ5PVwiMi4yMzRcIiBzdHlsZT1cImZpbGw6IzAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MXB4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjFcIi8+PHBhdGggZD1cIk0xNCAzMGgxOU03IDMwaDVNMzUgMzBoNk03IDE2aDRNMTMgMTZoNE0xOSAxNmg0TTI1IDE2aDRNMzEgMTZoNE0zNCAyM2g0TTI4IDIzaDRNMjIgMjNoNE0xNiAyM2g0TTM3IDE2aDRNMTAgMjNoNFwiIHN0eWxlPVwiZmlsbDpub25lO2ZpbGwtb3BhY2l0eTouNzU7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOiNmZmY7c3Ryb2tlLXdpZHRoOjQ7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MVwiLz48L3N2Zz4iLCAnaW1hZ2Uvc3ZnK3htbCcpKS5maXJzdENoaWxkOwogIH0KCiAgLy8gQHRzLWlnbm9yZQogIGNsYXNzIEtleWJpbmRFZGl0b3IgewogICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgICAgICB2YXIgX2E7CiAgICAgICAgICB0aGlzLmNhcHR1cmluZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy5rZXlzID0gbmV3IFNldCgpOwogICAgICAgICAgdGhpcy5hY3Rpb25TdGF0ZSA9ICJzdGFydCI7CiAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwogICAgICAgICAgdGhpcy5rZXliaW5kT3BlbmVyID0ga2V5Ym9hcmQoKTsKICAgICAgICAgIHRoaXMua2V5YmluZE9wZW5lci5jbGFzc0xpc3QuYWRkKCJrZXliaW5kX29wZW5lciIpOwogICAgICAgICAgdGhpcy5rZXliaW5kRWRpdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGlhbG9nIik7CiAgICAgICAgICB0aGlzLmtleWJpbmRFZGl0b3IuY2xhc3NMaXN0LmFkZCgia2V5YmluZF9lZGl0b3Jfd3JhcHBlciIpOwogICAgICAgICAgdGhpcy5rZXliaW5kRWRpdG9yLmlubmVySFRNTCA9IGAKCQkJPGRpdiBjbGFzcz0ia2V5YmluZF9lZGl0b3IiPgoJCQkJPGRpdiBjbGFzcz0iY2xvc2UiPng8L2Rpdj4KCQkJCTxoMSBjbGFzcz0ia2V5YmluZF90aXRsZSI+JHtvcHRpb25zLnRpdGxlfTwvaDE+CgkJCQk8ZGl2IGNsYXNzPSJrZXliaW5kX2NvbnRyb2xzIj4KCQkJCQk8ZGl2IGNsYXNzPSJrZXliaW5kX2Rpc3BsYXkiPjwvZGl2PgoJCQkJCTxkaXYgY2xhc3M9ImtleWJpbmRfZXhjbHVzaXZlIj4KCQkJCQkJPGRpdiBjbGFzcz0idGV4dCI+RXhjbHVzaXZlPzwvZGl2PgoJCQkJCQk8aW5wdXQgdHlwZT0iY2hlY2tib3giIGNsYXNzPSJleGNsdXNpdmUiIC8+CgkJCQkJPC9kaXY+CgkJCQkJPGRpdiBjbGFzcz0iYWN0aW9uIj5TdGFydCBDYXB0dXJlPC9kaXY+CgkJCQk8L2Rpdj4KCQkJPC9kaXY+CgkJYDsKICAgICAgICAgIGxldCBiaW5kRXhjbHVzaXZlID0gKF9hID0gb3B0aW9ucy5leGNsdXNpdmUpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGZhbHNlOwogICAgICAgICAgbGV0IGV4aXN0aW5nS2V5YmluZCA9IHdpbmRvdy5jaGVhdC5odWQuc3luY2VkVmFycy5nZXQoImtleWJpbmRzIikuZ2V0KG9wdGlvbnMuaWQpOwogICAgICAgICAgaWYgKGV4aXN0aW5nS2V5YmluZCkgewogICAgICAgICAgICAgIHRoaXMua2V5cyA9IG5ldyBTZXQoZXhpc3RpbmdLZXliaW5kLmtleXMpOwogICAgICAgICAgICAgIGJpbmRFeGNsdXNpdmUgPSBleGlzdGluZ0tleWJpbmQuZXhjbHVzaXZlOwogICAgICAgICAgfQogICAgICAgICAgZWxzZSBpZiAob3B0aW9ucy5rZXlzKQogICAgICAgICAgICAgIHRoaXMua2V5cyA9IG9wdGlvbnMua2V5czsKICAgICAgICAgIGlmIChiaW5kRXhjbHVzaXZlKQogICAgICAgICAgICAgIHRoaXMua2V5YmluZEVkaXRvci5xdWVyeVNlbGVjdG9yKCIuZXhjbHVzaXZlIikuc2V0QXR0cmlidXRlKCJjaGVja2VkIiwgInRydWUiKTsKICAgICAgICAgIHRoaXMuYmluZCA9IHsKICAgICAgICAgICAgICBrZXlzOiB0aGlzLmtleXMsCiAgICAgICAgICAgICAgZXhjbHVzaXZlOiBiaW5kRXhjbHVzaXZlLAogICAgICAgICAgICAgIGNhbGxiYWNrOiBvcHRpb25zLmNhbGxiYWNrCiAgICAgICAgICB9OwogICAgICAgICAgd2luZG93LmNoZWF0LmtleWJpbmRNYW5hZ2VyLnJlZ2lzdGVyQmluZCh0aGlzLmJpbmQpOwogICAgICAgICAgdGhpcy51cGRhdGVBY3Rpb24oKTsKICAgICAgICAgIHRoaXMudXBkYXRlRGlzcGxheSgpOwogICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVycygpOwogICAgICB9CiAgICAgIGFkZEV2ZW50TGlzdGVuZXJzKCkgewogICAgICAgICAgbGV0IGFjdGlvbiA9IHRoaXMua2V5YmluZEVkaXRvci5xdWVyeVNlbGVjdG9yKCIuYWN0aW9uIik7CiAgICAgICAgICBsZXQgY2xvc2UgPSB0aGlzLmtleWJpbmRFZGl0b3IucXVlcnlTZWxlY3RvcigiLmNsb3NlIik7CiAgICAgICAgICBsZXQgZGlzcGxheSA9IHRoaXMua2V5YmluZEVkaXRvci5xdWVyeVNlbGVjdG9yKCIua2V5YmluZF9kaXNwbGF5Iik7CiAgICAgICAgICBsZXQgZXhjbHVzaXZlID0gdGhpcy5rZXliaW5kRWRpdG9yLnF1ZXJ5U2VsZWN0b3IoIi5leGNsdXNpdmUiKTsKICAgICAgICAgIHRoaXMua2V5YmluZE9wZW5lci5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgICAgICAgICAgICB0aGlzLmtleWJpbmRFZGl0b3Iuc2hvd01vZGFsKCk7CiAgICAgICAgICB9KTsKICAgICAgICAgIC8vIHByZXZlbnQgdGhlIG1lbnUgZnJvbSBiZWluZyBkcmFnZ2VkIGJ5IHRoZSBkaWFsb2cKICAgICAgICAgIHRoaXMua2V5YmluZEVkaXRvci5hZGRFdmVudExpc3RlbmVyKCJtb3VzZWRvd24iLCAoZSkgPT4gewogICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhcHR1cmluZykKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGlmIChlLnRhcmdldCA9PSBhY3Rpb24pCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB0aGlzLmVuZENhcHR1cmUoKTsKICAgICAgICAgIH0pOwogICAgICAgICAgZGlzcGxheS5hZGRFdmVudExpc3RlbmVyKCJtb3VzZWRvd24iLCAoZSkgPT4gewogICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgdGhpcy5iZWdpbkNhcHR1cmUoKTsKICAgICAgICAgIH0pOwogICAgICAgICAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5rZXliaW5kRWRpdG9yLmNsb3NlKCk7CiAgICAgICAgICB9KTsKICAgICAgICAgIGFjdGlvbi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgICAgICAgICAgICBpZiAodGhpcy5hY3Rpb25TdGF0ZSA9PSAiU3RhcnQgQ2FwdHVyZSIpCiAgICAgICAgICAgICAgICAgIHRoaXMuYmVnaW5DYXB0dXJlKCk7CiAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5hY3Rpb25TdGF0ZSA9PSAiRW5kIENhcHR1cmUiKQogICAgICAgICAgICAgICAgICB0aGlzLmVuZENhcHR1cmUoKTsKICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmFjdGlvblN0YXRlID09ICJSZXNldCIpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5rZXlzLmNsZWFyKCk7CiAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGlzcGxheSgpOwogICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUFjdGlvbigpOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgZXhjbHVzaXZlLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsICgpID0+IHsKICAgICAgICAgICAgICB0aGlzLmJpbmQuZXhjbHVzaXZlID0gZXhjbHVzaXZlLmNoZWNrZWQ7CiAgICAgICAgICAgICAgdGhpcy5zeW5jQmluZCgpOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgYmVnaW5DYXB0dXJlKCkgewogICAgICAgICAgdGhpcy5jYXB0dXJpbmcgPSB0cnVlOwogICAgICAgICAgdGhpcy5rZXlzLmNsZWFyKCk7CiAgICAgICAgICB0aGlzLmtleWJpbmRFZGl0b3IucXVlcnlTZWxlY3RvcigiLmtleWJpbmRfZGlzcGxheSIpLmlubmVySFRNTCA9ICJQcmVzcyBhbnkga2V5Li4uIjsKICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCB0aGlzLmtleWJpbmRDYXB0dXJlLmJpbmQodGhpcykpOwogICAgICAgICAgdGhpcy51cGRhdGVBY3Rpb24oKTsKICAgICAgfQogICAgICBrZXliaW5kQ2FwdHVyZShlKSB7CiAgICAgICAgICBpZiAoIXRoaXMuY2FwdHVyaW5nKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIGlmIChlLmtleSA9PT0gIkVzY2FwZSIgfHwgZS5rZXkgPT09ICJFbnRlciIpIHsKICAgICAgICAgICAgICB0aGlzLmVuZENhcHR1cmUoKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmtleXMuYWRkKGUua2V5LnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgdGhpcy51cGRhdGVEaXNwbGF5KCk7CiAgICAgIH0KICAgICAgZW5kQ2FwdHVyZSgpIHsKICAgICAgICAgIHRoaXMuY2FwdHVyaW5nID0gZmFsc2U7CiAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgdGhpcy5rZXliaW5kQ2FwdHVyZS5iaW5kKHRoaXMpKTsKICAgICAgICAgIHRoaXMudXBkYXRlQWN0aW9uKCk7CiAgICAgICAgICB0aGlzLnN5bmNCaW5kKCk7CiAgICAgIH0KICAgICAgdXBkYXRlRGlzcGxheSgpIHsKICAgICAgICAgIGxldCBrZXliaW5kRGlzcGxheSA9IHRoaXMua2V5YmluZEVkaXRvci5xdWVyeVNlbGVjdG9yKCIua2V5YmluZF9kaXNwbGF5Iik7CiAgICAgICAgICBsZXQga2V5cyA9IEFycmF5LmZyb20odGhpcy5rZXlzKTsKICAgICAgICAgIC8vIHJlcGxhY2Ugc3BhY2Ugd2l0aCAic3BhY2UiCiAgICAgICAgICBrZXlzID0ga2V5cy5tYXAoKGtleSkgPT4ga2V5ID09PSAiICIgPyAic3BhY2UiIDoga2V5KTsKICAgICAgICAgIGtleWJpbmREaXNwbGF5LmlubmVySFRNTCA9IGtleXMuam9pbigiICsgIik7CiAgICAgIH0KICAgICAgdXBkYXRlQWN0aW9uKCkgewogICAgICAgICAgbGV0IGFjdGlvbiA9IHRoaXMua2V5YmluZEVkaXRvci5xdWVyeVNlbGVjdG9yKCIuYWN0aW9uIik7CiAgICAgICAgICBpZiAodGhpcy5jYXB0dXJpbmcpCiAgICAgICAgICAgICAgdGhpcy5hY3Rpb25TdGF0ZSA9ICJFbmQgQ2FwdHVyZSI7CiAgICAgICAgICBlbHNlIGlmICh0aGlzLmtleXMuc2l6ZSA9PSAwKQogICAgICAgICAgICAgIHRoaXMuYWN0aW9uU3RhdGUgPSAiU3RhcnQgQ2FwdHVyZSI7CiAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgdGhpcy5hY3Rpb25TdGF0ZSA9ICJSZXNldCI7CiAgICAgICAgICBhY3Rpb24uaW5uZXJIVE1MID0gdGhpcy5hY3Rpb25TdGF0ZTsKICAgICAgfQogICAgICBhdHRhY2hUbyhlbGVtZW50KSB7CiAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKHRoaXMua2V5YmluZE9wZW5lcik7CiAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKHRoaXMua2V5YmluZEVkaXRvcik7CiAgICAgIH0KICAgICAgc3luY0JpbmQoKSB7CiAgICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5pZCkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB3aW5kb3cuY2hlYXQuaHVkLnVwZGF0ZUtleWJpbmQodGhpcy5vcHRpb25zLmlkLCB7CiAgICAgICAgICAgICAga2V5czogQXJyYXkuZnJvbSh0aGlzLmtleXMpLAogICAgICAgICAgICAgIGV4Y2x1c2l2ZTogdGhpcy5iaW5kLmV4Y2x1c2l2ZQogICAgICAgICAgfSk7CiAgICAgIH0KICB9CgogIGNsYXNzIEJ1dHRvbiBleHRlbmRzIEh1ZEVsZW1lbnQgewogICAgICBjb25zdHJ1Y3Rvcihncm91cCwgb3B0aW9ucykgewogICAgICAgICAgdmFyIF9hLCBfYjsKICAgICAgICAgIHN1cGVyKGdyb3VwLCBvcHRpb25zKTsKICAgICAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoImJ1dHRvbl93cmFwcGVyIik7CiAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnV0dG9uIj4ke3RoaXMub3B0aW9ucy50ZXh0fTwvYnV0dG9uPgogICAgICAgIGA7CiAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50OwogICAgICAgICAgdGhpcy5idXR0b24gPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoImJ1dHRvbiIpOwogICAgICAgICAgdGhpcy5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgICAgICAgdmFyIF9hOwogICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImNsaWNrIikpOwogICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucnVuRnVuY3Rpb24pCiAgICAgICAgICAgICAgICAgIChfYSA9IHdpbmRvdy5jaGVhdC5mdW5jcy5nZXQodGhpcy5vcHRpb25zLnJ1bkZ1bmN0aW9uKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNhbGwodGhpcyk7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMua2V5YmluZCkgewogICAgICAgICAgICAgIGxldCBrZXliaW5kRWRpdG9yID0gbmV3IEtleWJpbmRFZGl0b3IoewogICAgICAgICAgICAgICAgICB0aXRsZTogKF9hID0gb3B0aW9ucy50aXRsZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogYFNldCBrZXliaW5kIGZvciAke3RoaXMuYnV0dG9uLmlubmVyVGV4dH1gLAogICAgICAgICAgICAgICAgICBrZXlzOiAoX2IgPSBvcHRpb25zLmRlZmF1bHRLZXliaW5kKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBuZXcgU2V0KCksCiAgICAgICAgICAgICAgICAgIGV4Y2x1c2l2ZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJjbGljayIpKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGtleWJpbmRFZGl0b3IuYXR0YWNoVG8oZWxlbWVudCk7CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgc2V0IHRleHQodGV4dCkgewogICAgICAgICAgdGhpcy5idXR0b24uaW5uZXJUZXh0ID0gdGV4dDsKICAgICAgfQogICAgICBnZXQgdGV4dCgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmJ1dHRvbi5pbm5lclRleHQ7CiAgICAgIH0KICB9CgogIGNsYXNzIFRleHRJbnB1dCBleHRlbmRzIEh1ZEVsZW1lbnQgewogICAgICBjb25zdHJ1Y3Rvcihncm91cCwgb3B0aW9ucykgewogICAgICAgICAgdmFyIF9hOwogICAgICAgICAgc3VwZXIoZ3JvdXAsIG9wdGlvbnMpOwogICAgICAgICAgdGhpcy5pbnB1dCA9IG51bGw7CiAgICAgICAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDxkaXYgY2xhc3M9InRleHQiPiR7dGhpcy5vcHRpb25zLnRleHR9PC9kaXY+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0idGV4dGlucHV0IiBwbGFjZWhvbGRlcj0iJHsoX2EgPSB0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXIpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6ICIifSI+CiAgICAgICAgYDsKICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgidGV4dGlucHV0X3dyYXBwZXIiKTsKICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7CiAgICAgICAgICB0aGlzLmlucHV0ID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCJpbnB1dCIpOwogICAgICAgICAgdGhpcy5pbnB1dC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsICgpID0+IHsKICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHsKICAgICAgICAgICAgICAgICAgZGV0YWlsOiB0aGlzLnRleHQKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICB9KTsKICAgICAgfQogICAgICBzZXQgdGV4dCh0ZXh0KSB7CiAgICAgICAgICB0aGlzLmlucHV0LnZhbHVlID0gdGV4dDsKICAgICAgfQogICAgICBnZXQgdGV4dCgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmlucHV0LnZhbHVlOwogICAgICB9CiAgfQoKICBjbGFzcyBUb2dnbGUgZXh0ZW5kcyBIdWRFbGVtZW50IHsKICAgICAgY29uc3RydWN0b3IoZ3JvdXAsIG9wdGlvbnMpIHsKICAgICAgICAgIHZhciBfYSwgX2IsIF9jOwogICAgICAgICAgc3VwZXIoZ3JvdXAsIG9wdGlvbnMpOwogICAgICAgICAgLy8gY3JlYXRlIHRoZSBlbGVtZW50CiAgICAgICAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBgCgkJCTxidXR0b24gY2xhc3M9InRvZ2dsZSI+PC9idXR0b24+CgkJYDsKICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgidG9nZ2xlX3dyYXBwZXIiKTsKICAgICAgICAgIC8vIGFkZCBhIGtleWJpbmQgaWYgbmVlZGVkCiAgICAgICAgICBpZiAob3B0aW9ucy5rZXliaW5kKSB7CiAgICAgICAgICAgICAgbGV0IGVkaXRvck9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAoX2EgPSBvcHRpb25zLnRpdGxlKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAiU2V0IGtleWJpbmQgZm9yIHRvZ2dsZSIsCiAgICAgICAgICAgICAgICAgIGtleXM6IChfYiA9IG9wdGlvbnMuZGVmYXVsdEtleWJpbmQpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IG5ldyBTZXQoKSwKICAgICAgICAgICAgICAgICAgZXhjbHVzaXZlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGlmIChvcHRpb25zLmtleWJpbmRJZCkKICAgICAgICAgICAgICAgICAgZWRpdG9yT3B0aW9ucy5pZCA9IG9wdGlvbnMua2V5YmluZElkOwogICAgICAgICAgICAgIGxldCBrZXliaW5kRWRpdG9yID0gbmV3IEtleWJpbmRFZGl0b3IoZWRpdG9yT3B0aW9ucyk7CiAgICAgICAgICAgICAga2V5YmluZEVkaXRvci5hdHRhY2hUbyhlbGVtZW50KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuZW5hYmxlZCA9IChfYyA9IHRoaXMub3B0aW9ucy5kZWZhdWx0KSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiBmYWxzZTsKICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7CiAgICAgICAgICB0aGlzLmJ1dHRvbiA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcigiYnV0dG9uIik7CiAgICAgICAgICB0aGlzLl90ZXh0RW5hYmxlZCA9IHRoaXMub3B0aW9ucy50ZXh0RW5hYmxlZDsKICAgICAgICAgIHRoaXMuX3RleHREaXNhYmxlZCA9IHRoaXMub3B0aW9ucy50ZXh0RGlzYWJsZWQ7CiAgICAgICAgICB0aGlzLnVwZGF0ZUJ1dHRvbigpOwogICAgICAgICAgLy8gcHJldmVudCB0aGUgbWVudSBmcm9tIGJlaW5nIGFjdGl2YXRlZCB3aXRoIGVudGVyCiAgICAgICAgICB0aGlzLmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgKGUpID0+IGUucHJldmVudERlZmF1bHQoKSk7CiAgICAgICAgICB0aGlzLmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgICAgICAgICAgICB0aGlzLnRvZ2dsZSgpOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdXBkYXRlQnV0dG9uKCkgewogICAgICAgICAgdGhpcy5idXR0b24uaW5uZXJIVE1MID0gdGhpcy5lbmFibGVkID8gdGhpcy5fdGV4dEVuYWJsZWQgOiB0aGlzLl90ZXh0RGlzYWJsZWQ7CiAgICAgICAgICB0aGlzLmJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCJlbmFibGVkIiwgdGhpcy5lbmFibGVkKTsKICAgICAgfQogICAgICB0b2dnbGUoKSB7CiAgICAgICAgICB0aGlzLmVuYWJsZWQgPSAhdGhpcy5lbmFibGVkOwogICAgICAgICAgdGhpcy51cGRhdGVCdXR0b24oKTsKICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucnVuRnVuY3Rpb24pCiAgICAgICAgICAgICAgd2luZG93LmNoZWF0LmZ1bmNzLmdldCh0aGlzLm9wdGlvbnMucnVuRnVuY3Rpb24pKHRoaXMuZW5hYmxlZCk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJjaGFuZ2UiLCB7CiAgICAgICAgICAgICAgZGV0YWlsOiB0aGlzLmVuYWJsZWQKICAgICAgICAgIH0pKTsKICAgICAgfQogICAgICBnZXQgdmFsdWUoKSB7CiAgICAgICAgICB2YXIgX2E7CiAgICAgICAgICByZXR1cm4gKF9hID0gdGhpcy5lbmFibGVkKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBmYWxzZTsKICAgICAgfQogICAgICBzZXQgdmFsdWUodmFsdWUpIHsKICAgICAgICAgIHRoaXMuZW5hYmxlZCA9IHZhbHVlOwogICAgICAgICAgdGhpcy51cGRhdGVCdXR0b24oKTsKICAgICAgfQogICAgICBnZXQgdGV4dEVuYWJsZWQoKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5fdGV4dEVuYWJsZWQ7CiAgICAgIH0KICAgICAgc2V0IHRleHRFbmFibGVkKHRleHQpIHsKICAgICAgICAgIHRoaXMuX3RleHRFbmFibGVkID0gdGV4dDsKICAgICAgICAgIHRoaXMudXBkYXRlQnV0dG9uKCk7CiAgICAgIH0KICAgICAgZ2V0IHRleHREaXNhYmxlZCgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLl90ZXh0RGlzYWJsZWQ7CiAgICAgIH0KICAgICAgc2V0IHRleHREaXNhYmxlZCh0ZXh0KSB7CiAgICAgICAgICB0aGlzLl90ZXh0RGlzYWJsZWQgPSB0ZXh0OwogICAgICAgICAgdGhpcy51cGRhdGVCdXR0b24oKTsKICAgICAgfQogIH0KCiAgY2xhc3MgRHJvcGRvd24gZXh0ZW5kcyBIdWRFbGVtZW50IHsKICAgICAgY29uc3RydWN0b3IoZ3JvdXAsIG9wdGlvbnMpIHsKICAgICAgICAgIHN1cGVyKGdyb3VwLCBvcHRpb25zKTsKICAgICAgICAgIC8vIGNyZWF0ZSB0aGUgZWxlbWVudAogICAgICAgICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgiZHJvcGRvd25fd3JhcHBlciIpOwogICAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IGAKCQkJPGRpdiBjbGFzcz0idGV4dCI+JHtvcHRpb25zLnRleHR9PC9kaXY+CgkJCTxzZWxlY3QgY2xhc3M9ImRyb3Bkb3duIj4KCQkJCSR7b3B0aW9ucy5vcHRpb25zLm1hcCgob3B0aW9uKSA9PiB7CiAgICAgICAgICAgIHJldHVybiBgPG9wdGlvbiB2YWx1ZT0iJHtvcHRpb259IiAke29wdGlvbiA9PT0gb3B0aW9ucy5kZWZhdWx0ID8gInNlbGVjdGVkIiA6ICIifT4KCQkJCQkJJHtvcHRpb259CgkJCQkJPC9vcHRpb24+YDsKICAgICAgICB9KS5qb2luKCIiKX0KCQkJPC9zZWxlY3Q+CgkJYDsKICAgICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoIi5kcm9wZG93biIpOwogICAgICAgICAgLy8gcHJldmVudCBhY2NpZGVudGFsIG5hdmlnYXRpb24gd2l0aCBhcnJvd3MKICAgICAgICAgIHRoaXMuc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCAoZSkgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTsKICAgICAgICAgIC8vIGFkZCB0aGUgZXZlbnQgbGlzdGVuZXIKICAgICAgICAgIHRoaXMuc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsICgpID0+IHsKICAgICAgICAgICAgICBpZiAob3B0aW9ucy5ydW5GdW5jdGlvbikgewogICAgICAgICAgICAgICAgICB3aW5kb3cuY2hlYXQuZnVuY3MuZ2V0KHRoaXMub3B0aW9ucy5ydW5GdW5jdGlvbikodGhpcy5zZWxlY3QudmFsdWUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJjaGFuZ2UiLCB7CiAgICAgICAgICAgICAgICAgIGRldGFpbDogdGhpcy5zZWxlY3QudmFsdWUKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICB9KTsKICAgICAgfQogICAgICBhZGRPcHRpb24ob3B0aW9uKSB7CiAgICAgICAgICBsZXQgb3B0aW9uRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOwogICAgICAgICAgb3B0aW9uRWxlbWVudC52YWx1ZSA9IG9wdGlvbjsKICAgICAgICAgIG9wdGlvbkVsZW1lbnQuaW5uZXJUZXh0ID0gb3B0aW9uOwogICAgICAgICAgdGhpcy5zZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uRWxlbWVudCk7CiAgICAgIH0KICAgICAgcmVtb3ZlT3B0aW9uKG9wdGlvbikgewogICAgICAgICAgbGV0IG9wdGlvbkVsZW1lbnQgPSB0aGlzLnNlbGVjdC5xdWVyeVNlbGVjdG9yKGBvcHRpb25bdmFsdWU9IiR7b3B0aW9ufSJdYCk7CiAgICAgICAgICBpZiAob3B0aW9uRWxlbWVudCkgewogICAgICAgICAgICAgIHRoaXMuc2VsZWN0LnJlbW92ZUNoaWxkKG9wdGlvbkVsZW1lbnQpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHRoaXMuc2VsZWN0LnZhbHVlID09PSBvcHRpb24pIHsKICAgICAgICAgICAgICB0aGlzLnNlbGVjdC52YWx1ZSA9IHRoaXMuc2VsZWN0Lm9wdGlvbnNbMF0udmFsdWU7CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgc2V0T3B0aW9ucyhvcHRpb25zKSB7CiAgICAgICAgICB0aGlzLnNlbGVjdC5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgIG9wdGlvbnMuZm9yRWFjaCgob3B0aW9uKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5hZGRPcHRpb24ob3B0aW9uKTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICAgIGdldCB2YWx1ZSgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdC52YWx1ZTsKICAgICAgfQogICAgICBzZXQgdmFsdWUodmFsdWUpIHsKICAgICAgICAgIHRoaXMuc2VsZWN0LnZhbHVlID0gdmFsdWU7CiAgICAgIH0KICB9CgogIGNsYXNzIFNsaWRlciBleHRlbmRzIEh1ZEVsZW1lbnQgewogICAgICBjb25zdHJ1Y3Rvcihncm91cCwgb3B0aW9ucykgewogICAgICAgICAgdmFyIF9hOwogICAgICAgICAgc3VwZXIoZ3JvdXAsIG9wdGlvbnMpOwogICAgICAgICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgic2xpZGVyX3dyYXBwZXIiKTsKICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gYAoJCQk8ZGl2IGNsYXNzID0gInRleHQiPiR7b3B0aW9ucy50ZXh0fTwvZGl2PgoJCQk8aW5wdXQgdHlwZSA9ICJyYW5nZSIgbWluID0gIiR7b3B0aW9ucy5taW59IiBtYXggPSAiJHtvcHRpb25zLm1heH0iIHZhbHVlID0gIiR7KF9hID0gb3B0aW9ucy5kZWZhdWx0KSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAwfSIgY2xhc3MgPSAic2xpZGVyIj4KCQlgOwogICAgICAgICAgdGhpcy5zbGlkZXIgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoIi5zbGlkZXIiKTsKICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7CiAgICAgICAgICAvLyBwcmV2ZW50IHRoZSBzbGlkZXIgZnJvbSBkcmFnZ2luZyB0aGUgbWVudSB3aGVuIGNsaWNrZWQKICAgICAgICAgIHRoaXMuc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIChlKSA9PiB7CiAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgIH0pOwogICAgICAgICAgLy8gbGlzdGVuIGZvciBjaGFuZ2VzCiAgICAgICAgICB0aGlzLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsICgpID0+IHsKICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJ1bkZ1bmN0aW9uKQogICAgICAgICAgICAgICAgICB3aW5kb3cuY2hlYXQuZnVuY3MuZ2V0KHRoaXMub3B0aW9ucy5ydW5GdW5jdGlvbikodGhpcy5zbGlkZXIudmFsdWUpOwogICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImNoYW5nZSIsIHsKICAgICAgICAgICAgICAgICAgZGV0YWlsOiB0aGlzLnNsaWRlci52YWx1ZQogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICAgIHNldCB2YWx1ZSh2YWx1ZSkgewogICAgICAgICAgdGhpcy5zbGlkZXIudmFsdWUgPSB2YWx1ZS50b1N0cmluZygpOwogICAgICB9CiAgICAgIGdldCB2YWx1ZSgpIHsKICAgICAgICAgIHJldHVybiBOdW1iZXIodGhpcy5zbGlkZXIudmFsdWUpOwogICAgICB9CiAgfQoKICBjbGFzcyBHcm91cCB7CiAgICAgIGNvbnN0cnVjdG9yKG1lbnUsIHBhcmVudEdyb3VwLCBuYW1lLCBpc1Jvb3QgPSBmYWxzZSkgewogICAgICAgICAgdGhpcy5uYW1lID0gIiI7CiAgICAgICAgICB0aGlzLmhpZGVUaW1lb3V0ID0gbnVsbDsKICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7CiAgICAgICAgICB0aGlzLmlzUm9vdCA9IGZhbHNlOwogICAgICAgICAgdGhpcy5ncm91cHMgPSBbXTsKICAgICAgICAgIHRoaXMucGFyZW50R3JvdXAgPSBudWxsOwogICAgICAgICAgdGhpcy5lbGVtZW50cyA9IFtdOwogICAgICAgICAgdGhpcy5tZW51ID0gbnVsbDsKICAgICAgICAgIHRoaXMubWVudSA9IG1lbnU7CiAgICAgICAgICB0aGlzLnBhcmVudEdyb3VwID0gcGFyZW50R3JvdXA7CiAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICAgICAgdGhpcy5pc1Jvb3QgPSBpc1Jvb3Q7CiAgICAgICAgICB0aGlzLmluaXQoKTsKICAgICAgfQogICAgICBpbml0KCkgewogICAgICAgICAgdmFyIF9hLCBfYjsKICAgICAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoImdyb3VwIik7CiAgICAgICAgICBpZiAoIXRoaXMuaXNSb290KQogICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7CiAgICAgICAgICAoX2IgPSAoX2EgPSB0aGlzLm1lbnUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5lbGVtZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuYXBwZW5kQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAvLyBhZGQgYSBiYWNrIGJ1dHRvbiBpZiB0aGlzIGlzbid0IHRoZSByb290IGdyb3VwCiAgICAgICAgICBpZiAoIXRoaXMuaXNSb290KSB7CiAgICAgICAgICAgICAgdGhpcy5hZGRFbGVtZW50KCJncm91cG9wZW5lciIsIHsKICAgICAgICAgICAgICAgICAgdGV4dDogIkJhY2siLAogICAgICAgICAgICAgICAgICBvcGVuR3JvdXA6IHRoaXMucGFyZW50R3JvdXAubmFtZSwKICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiAicmlnaHQiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgYWRkRWxlbWVudCh0eXBlLCBvcHRpb25zKSB7CiAgICAgICAgICB2YXIgX2E7CiAgICAgICAgICBsZXQgZWxlbWVudDsKICAgICAgICAgIHN3aXRjaCAodHlwZS50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICAgICAgY2FzZSAidGV4dCI6CiAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBuZXcgVGV4dCh0aGlzLCBvcHRpb25zKTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAiZ3JvdXBvcGVuZXIiOgogICAgICAgICAgICAgICAgICBlbGVtZW50ID0gbmV3IEdyb3VwT3BlbmVyKHRoaXMsIG9wdGlvbnMpOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlICJjb2xvcnBpY2tlciI6CiAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBuZXcgQ29sb3JQaWNrZXIodGhpcywgb3B0aW9ucyk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgImJ1dHRvbiI6CiAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBuZXcgQnV0dG9uKHRoaXMsIG9wdGlvbnMpOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlICJ0ZXh0aW5wdXQiOgogICAgICAgICAgICAgICAgICBlbGVtZW50ID0gbmV3IFRleHRJbnB1dCh0aGlzLCBvcHRpb25zKTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAidG9nZ2xlIjoKICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IG5ldyBUb2dnbGUodGhpcywgb3B0aW9ucyk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgImRyb3Bkb3duIjoKICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IG5ldyBEcm9wZG93bih0aGlzLCBvcHRpb25zKTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAic2xpZGVyIjoKICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IG5ldyBTbGlkZXIodGhpcywgb3B0aW9ucyk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFVua25vd24gZWxlbWVudCB0eXBlOiAke3R5cGV9YCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIWVsZW1lbnQpCiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAoX2EgPSB0aGlzLmVsZW1lbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5hcHBlbmRDaGlsZChlbGVtZW50LmVsZW1lbnQpOwogICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7CiAgICAgIH0KICAgICAgc2xpZGUobW9kZSwgZGlyZWN0aW9uKSB7CiAgICAgICAgICBpZiAodGhpcy5oaWRlVGltZW91dCkKICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5oaWRlVGltZW91dCk7CiAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuYW5pbWF0aW9uID0gYHNsaWRlXyR7bW9kZX1fJHtkaXJlY3Rpb259IGJvdGggMC41c2A7CiAgICAgICAgICBpZiAobW9kZSA9PSAiaW4iKQogICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgICAgICAgZWxzZSBpZiAobW9kZSA9PSAib3V0IikgewogICAgICAgICAgICAgIHRoaXMuaGlkZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiLCA1MDApOwogICAgICAgICAgfQogICAgICB9CiAgICAgIGNyZWF0ZUdyb3VwKG5hbWUpIHsKICAgICAgICAgIGxldCBleGlzdGluZ0dyb3VwID0gdGhpcy5tZW51LmdldEFueUdyb3VwKG5hbWUpOwogICAgICAgICAgaWYgKGV4aXN0aW5nR3JvdXApCiAgICAgICAgICAgICAgcmV0dXJuIGV4aXN0aW5nR3JvdXA7CiAgICAgICAgICBsZXQgZ3JvdXAgPSBuZXcgR3JvdXAodGhpcy5tZW51LCB0aGlzLCBuYW1lKTsKICAgICAgICAgIHRoaXMuZ3JvdXBzLnB1c2goZ3JvdXApOwogICAgICAgICAgdGhpcy5tZW51Lmdyb3Vwcy5wdXNoKGdyb3VwKTsKICAgICAgICAgIC8vIGFkZCBhIGJ1dHRvbiB0byBvcGVuIHRoZSBncm91cAogICAgICAgICAgdGhpcy5hZGRFbGVtZW50KCJncm91cG9wZW5lciIsIHsKICAgICAgICAgICAgICB0ZXh0OiBuYW1lLAogICAgICAgICAgICAgIG9wZW5Hcm91cDogbmFtZSwKICAgICAgICAgICAgICBkaXJlY3Rpb246ICJsZWZ0IgogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gZ3JvdXA7CiAgICAgIH0KICAgICAgZ3JvdXAobmFtZSkgewogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmdyb3Vwcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIGlmICh0aGlzLmdyb3Vwc1tpXS5uYW1lID09IG5hbWUpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ3JvdXBzW2ldOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHJlbW92ZSgpIHsKICAgICAgICAgIHZhciBfYSwgX2I7CiAgICAgICAgICAoX2EgPSB0aGlzLmVsZW1lbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5yZW1vdmUoKTsKICAgICAgICAgIChfYiA9IHRoaXMucGFyZW50R3JvdXApID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5ncm91cHMuc3BsaWNlKHRoaXMucGFyZW50R3JvdXAuZ3JvdXBzLmluZGV4T2YodGhpcyksIDEpOwogICAgICAgICAgdGhpcy5tZW51Lmdyb3Vwcy5zcGxpY2UodGhpcy5tZW51Lmdyb3Vwcy5pbmRleE9mKHRoaXMpLCAxKTsKICAgICAgfQogICAgICBjbGVhckVsZW1lbnRzKCkgewogICAgICAgICAgdGhpcy5lbGVtZW50cyA9IFtdOwogICAgICAgICAgaWYgKCF0aGlzLmVsZW1lbnQpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9ICIiOwogICAgICB9CiAgICAgIGxvYWRGcm9tT2JqZWN0KG9iamVjdCkgewogICAgICAgICAgY29uc3QgbG9hZEdyb3VwcyA9ICgpID0+IHsKICAgICAgICAgICAgICBpZiAob2JqZWN0Lmdyb3VwcykgewogICAgICAgICAgICAgICAgICBmb3IgKGxldCBncm91cCBvZiBvYmplY3QuZ3JvdXBzKSB7CiAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3R3JvdXAgPSB0aGlzLmNyZWF0ZUdyb3VwKGdyb3VwLm5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgbmV3R3JvdXAubG9hZEZyb21PYmplY3QoZ3JvdXApOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICAgIGNvbnN0IGxvYWRFbGVtZW50cyA9ICgpID0+IHsKICAgICAgICAgICAgICBpZiAob2JqZWN0LmVsZW1lbnRzKSB7CiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGVsZW1lbnQgb2Ygb2JqZWN0LmVsZW1lbnRzKSB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZEVsZW1lbnQoZWxlbWVudC50eXBlLCBlbGVtZW50Lm9wdGlvbnMpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICAgIGlmIChvYmplY3Qub3JkZXIgPT0gImVsZW1lbnRzRmlyc3QiKSB7CiAgICAgICAgICAgICAgbG9hZEVsZW1lbnRzKCk7CiAgICAgICAgICAgICAgbG9hZEdyb3VwcygpOwogICAgICAgICAgfQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgbG9hZEdyb3VwcygpOwogICAgICAgICAgICAgIGxvYWRFbGVtZW50cygpOwogICAgICAgICAgfQogICAgICB9CiAgfQoKICBjbGFzcyBNZW51Q29udHJvbHMgewogICAgICBjb25zdHJ1Y3RvcihtZW51KSB7CiAgICAgICAgICB0aGlzLm1lbnUgPSBudWxsOwogICAgICAgICAgdGhpcy5lbGVtZW50ID0gbnVsbDsKICAgICAgICAgIHRoaXMubWVudSA9IG1lbnU7CiAgICAgICAgICB0aGlzLmluaXQoKTsKICAgICAgfQogICAgICBpbml0KCkgewogICAgICAgICAgdmFyIF9hLCBfYjsKICAgICAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoIm1lbnVfY29udHJvbHMiKTsKICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gdGhpcy5tZW51Lm5hbWU7CiAgICAgICAgICAvLyBjcmVhdGUgdGhlIG1pbmltaXplcgogICAgICAgICAgbGV0IG1pbmltaXplciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgbWluaW1pemVyLmNsYXNzTGlzdC5hZGQoIm1lbnVfbWluaW1pemVyIik7CiAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50OwogICAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKG1pbmltaXplcik7CiAgICAgICAgICAoX2IgPSAoX2EgPSB0aGlzLm1lbnUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5lbGVtZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuYXBwZW5kQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICB0aGlzLnVwZGF0ZU1pbmltaXplcigpOwogICAgICAgICAgbWluaW1pemVyLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICAgICAgICAgIHZhciBfYTsKICAgICAgICAgICAgICAoX2EgPSB0aGlzLm1lbnUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5taW5pbWl6ZSgpOwogICAgICAgICAgICAgIHRoaXMudXBkYXRlTWluaW1pemVyKCk7CiAgICAgICAgICB9KTsKICAgICAgfQogICAgICB1cGRhdGVNaW5pbWl6ZXIoKSB7CiAgICAgICAgICB2YXIgX2E7CiAgICAgICAgICBpZiAoIXRoaXMuZWxlbWVudCkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICBsZXQgbWluaW1pemVyID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoIi5tZW51X21pbmltaXplciIpOwogICAgICAgICAgaWYgKCFtaW5pbWl6ZXIpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgbWluaW1pemVyLmlubmVySFRNTCA9ICgoX2EgPSB0aGlzLm1lbnUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5taW5pbWl6ZWQpID8gIisiIDogIi0iOwogICAgICB9CiAgfQoKICBjbGFzcyBNZW51IHsKICAgICAgLy8gYW55IGlzIHVzZWQgdG8gYXZvaWQgY2lyY3VsYXIgZGVwZW5kZW5jaWVzCiAgICAgIGNvbnN0cnVjdG9yKGh1ZCwgbmFtZSwgdHJhbnNmb3JtKSB7CiAgICAgICAgICB0aGlzLmh1ZCA9IG51bGw7CiAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBudWxsOwogICAgICAgICAgdGhpcy5yb290R3JvdXAgPSBudWxsOwogICAgICAgICAgdGhpcy5uYW1lID0gIiI7CiAgICAgICAgICB0aGlzLmdyb3VwcyA9IFtdOwogICAgICAgICAgdGhpcy5taW5pbWl6ZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMudHJhbnNmb3JtID0gewogICAgICAgICAgICAgIHRvcDogMCwKICAgICAgICAgICAgICBsZWZ0OiAwLAogICAgICAgICAgICAgIHdpZHRoOiAzMDAsCiAgICAgICAgICAgICAgaGVpZ2h0OiAyMDAsCiAgICAgICAgICAgICAgbWluaW1pemVkOiBmYWxzZQogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuaHVkID0gaHVkOwogICAgICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgICAgIGlmICh0cmFuc2Zvcm0pCiAgICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07CiAgICAgICAgICB0aGlzLmluaXQoKTsKICAgICAgfQogICAgICBhcHBseVRyYW5zZm9ybSh0cmFuc2Zvcm0pIHsKICAgICAgICAgIHZhciBfYTsKICAgICAgICAgIGlmICghdGhpcy5lbGVtZW50KQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIGlmICh0cmFuc2Zvcm0uaGVpZ2h0IDwgNTApCiAgICAgICAgICAgICAgdHJhbnNmb3JtLmhlaWdodCA9IDUwOwogICAgICAgICAgaWYgKHRyYW5zZm9ybS53aWR0aCA8IDUwKQogICAgICAgICAgICAgIHRyYW5zZm9ybS53aWR0aCA9IDUwOwogICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IGAke3RyYW5zZm9ybS50b3B9cHhgOwogICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBgJHt0cmFuc2Zvcm0ubGVmdH1weGA7CiAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUud2lkdGggPSBgJHt0cmFuc2Zvcm0ud2lkdGh9cHhgOwogICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IGAke3RyYW5zZm9ybS5oZWlnaHR9cHhgOwogICAgICAgICAgdGhpcy5taW5pbWl6ZSgoX2EgPSB0cmFuc2Zvcm0ubWluaW1pemVkKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBmYWxzZSk7CiAgICAgIH0KICAgICAgaW5pdCgpIHsKICAgICAgICAgIHZhciBfYTsKICAgICAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoIm1lbnUiKTsKICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7CiAgICAgICAgICAoX2EgPSB0aGlzLmh1ZCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmVsZW1lbnQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICB0aGlzLmFwcGx5VHJhbnNmb3JtKHRoaXMudHJhbnNmb3JtKTsKICAgICAgICAgIC8vIGNyZWF0ZSB0aGUgbWVudSBjb250cm9scwogICAgICAgICAgbmV3IE1lbnVDb250cm9scyh0aGlzKTsKICAgICAgICAgIC8vIGNyZWF0ZSB0aGUgcm9vdCBncm91cAogICAgICAgICAgbGV0IHJvb3RHcm91cCA9IG5ldyBHcm91cCh0aGlzLCBudWxsLCAicm9vdCIsIHRydWUpOwogICAgICAgICAgdGhpcy5yb290R3JvdXAgPSByb290R3JvdXA7CiAgICAgICAgICB0aGlzLmdyb3Vwcy5wdXNoKHJvb3RHcm91cCk7CiAgICAgICAgICAvLyBhZGQgdGhlIHJvb3QgZ3JvdXAgdG8gdGhlIG1lbnUKICAgICAgICAgIGlmIChyb290R3JvdXAuZWxlbWVudCkgewogICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChyb290R3JvdXAuZWxlbWVudCk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmFkZExpc3RlbmVycygpOwogICAgICB9CiAgICAgIGFkZExpc3RlbmVycygpIHsKICAgICAgICAgIGlmICghdGhpcy5lbGVtZW50KQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIGxldCBkcmFnZ2luZyA9IGZhbHNlOwogICAgICAgICAgbGV0IGRyYWdTdGFydCA9IHsgeDogMCwgeTogMCB9OwogICAgICAgICAgbGV0IGRyYWdEaXN0YW5jZSA9IDA7CiAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vkb3duIiwgKGUpID0+IHsKICAgICAgICAgICAgICBkcmFnZ2luZyA9IHRydWU7CiAgICAgICAgICAgICAgZHJhZ1N0YXJ0LnggPSBlLmNsaWVudFg7CiAgICAgICAgICAgICAgZHJhZ1N0YXJ0LnkgPSBlLmNsaWVudFk7CiAgICAgICAgICAgICAgZHJhZ0Rpc3RhbmNlID0gMDsKICAgICAgICAgIH0pOwogICAgICAgICAgLy8gY2FuY2VsIGRyYWdnaW5nIGlmIGl0J3MgYmVpbmcgcmVzaXplZAogICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNldXAiLCAoKSA9PiB7IGRyYWdnaW5nID0gZmFsc2U7IH0pOwogICAgICAgICAgbGV0IG9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKChlKSA9PiB7CiAgICAgICAgICAgICAgLy8gaWYgdGhlIGVsZW1lbnQgaXMgaW52aXNpYmxlIGlnbm9yZSBpdAogICAgICAgICAgICAgIGlmIChlWzBdLmNvbnRlbnRSZWN0LndpZHRoID09IDAgfHwgZVswXS5jb250ZW50UmVjdC5oZWlnaHQgPT0gMCkKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGRyYWdnaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm0ud2lkdGggPSBlWzBdLmNvbnRlbnRSZWN0LndpZHRoOwogICAgICAgICAgICAgIGlmICghdGhpcy5taW5pbWl6ZWQpCiAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtLmhlaWdodCA9IGVbMF0uY29udGVudFJlY3QuaGVpZ2h0OwogICAgICAgICAgICAgIHRoaXMuc3luY1RyYW5zZm9ybSgpOwogICAgICAgICAgfSk7CiAgICAgICAgICBvYnNlcnZlci5vYnNlcnZlKHRoaXMuZWxlbWVudCk7CiAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIiwgKGUpID0+IHsKICAgICAgICAgICAgICBpZiAoIWRyYWdnaW5nKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgZHJhZ0Rpc3RhbmNlICs9IE1hdGguYWJzKGUuY2xpZW50WCAtIGRyYWdTdGFydC54KSArIE1hdGguYWJzKGUuY2xpZW50WSAtIGRyYWdTdGFydC55KTsKICAgICAgICAgICAgICBpZiAoZHJhZ0Rpc3RhbmNlIDwgMTApCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBsZXQgeCA9IGUuY2xpZW50WCAtIGRyYWdTdGFydC54OwogICAgICAgICAgICAgIGxldCB5ID0gZS5jbGllbnRZIC0gZHJhZ1N0YXJ0Lnk7CiAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBgJHt0aGlzLmVsZW1lbnQub2Zmc2V0TGVmdCArIHh9cHhgOwogICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSBgJHt0aGlzLmVsZW1lbnQub2Zmc2V0VG9wICsgeX1weGA7CiAgICAgICAgICAgICAgLy8gc3luYyB0aGUgdHJhbnNmb3JtCiAgICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm0udG9wID0gdGhpcy5lbGVtZW50Lm9mZnNldFRvcDsKICAgICAgICAgICAgICB0aGlzLnRyYW5zZm9ybS5sZWZ0ID0gdGhpcy5lbGVtZW50Lm9mZnNldExlZnQ7CiAgICAgICAgICAgICAgdGhpcy5zeW5jVHJhbnNmb3JtKCk7CiAgICAgICAgICAgICAgLy8gcHJldmVudCB0aGUgbWVudSBmcm9tIGdvaW5nIG9mZiBzY3JlZW4KICAgICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50Lm9mZnNldExlZnQgPCAwKQogICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdCA9ICIwcHgiOwogICAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQub2Zmc2V0VG9wIDwgMCkKICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9ICIwcHgiOwogICAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQub2Zmc2V0TGVmdCArIHRoaXMuZWxlbWVudC5vZmZzZXRXaWR0aCA+IHdpbmRvdy5pbm5lcldpZHRoKQogICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdCA9IGAke3dpbmRvdy5pbm5lcldpZHRoIC0gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRofXB4YDsKICAgICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50Lm9mZnNldFRvcCArIHRoaXMuZWxlbWVudC5vZmZzZXRIZWlnaHQgPiB3aW5kb3cuaW5uZXJIZWlnaHQpCiAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSBgJHt3aW5kb3cuaW5uZXJIZWlnaHQgLSB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0fXB4YDsKICAgICAgICAgICAgICBkcmFnU3RhcnQueCA9IGUuY2xpZW50WDsKICAgICAgICAgICAgICBkcmFnU3RhcnQueSA9IGUuY2xpZW50WTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICAgIHN5bmNUcmFuc2Zvcm0oKSB7CiAgICAgICAgICB0aGlzLmh1ZC51cGRhdGVNZW51VHJhbnNmb3JtKHRoaXMubmFtZSwgdGhpcy50cmFuc2Zvcm0pOwogICAgICB9CiAgICAgIC8vIGFkZGluZyBhIGdyb3VwIHRvIHRoZSBtZW51IGluc3RlYWQgcGxhY2VzIGl0IGluIHRoZSByb290IGdyb3VwCiAgICAgIGNyZWF0ZUdyb3VwKG5hbWUpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnJvb3RHcm91cC5jcmVhdGVHcm91cChuYW1lKTsKICAgICAgfQogICAgICBncm91cChuYW1lKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5yb290R3JvdXAuZ3JvdXAobmFtZSk7CiAgICAgIH0KICAgICAgYWRkRWxlbWVudCh0eXBlLCBvcHRpb25zKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5yb290R3JvdXAuYWRkRWxlbWVudCh0eXBlLCBvcHRpb25zKTsKICAgICAgfQogICAgICBnZXRBbnlHcm91cChuYW1lKSB7CiAgICAgICAgICBmb3IgKGxldCBncm91cCBvZiB0aGlzLmdyb3VwcykgewogICAgICAgICAgICAgIGlmIChncm91cC5uYW1lID09IG5hbWUpCiAgICAgICAgICAgICAgICAgIHJldHVybiBncm91cDsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHJlbW92ZSgpIHsKICAgICAgICAgIHZhciBfYTsKICAgICAgICAgIChfYSA9IHRoaXMuZWxlbWVudCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJlbW92ZSgpOwogICAgICAgICAgdGhpcy5odWQubWVudXMuc3BsaWNlKHRoaXMuaHVkLm1lbnVzLmluZGV4T2YodGhpcyksIDEpOwogICAgICB9CiAgICAgIG1pbmltaXplKGZvcmNlID0gbnVsbCkgewogICAgICAgICAgaWYgKGZvcmNlID09IG51bGwpCiAgICAgICAgICAgICAgdGhpcy5taW5pbWl6ZWQgPSAhdGhpcy5taW5pbWl6ZWQ7CiAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgdGhpcy5taW5pbWl6ZWQgPSBmb3JjZTsKICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCJtaW5pbWl6ZWQiLCB0aGlzLm1pbmltaXplZCk7CiAgICAgICAgICB0aGlzLnRyYW5zZm9ybS5taW5pbWl6ZWQgPSB0aGlzLm1pbmltaXplZDsKICAgICAgICAgIHRoaXMuc3luY1RyYW5zZm9ybSgpOwogICAgICB9CiAgICAgIGxvYWRGcm9tT2JqZWN0KG9iamVjdCkgewogICAgICAgICAgdGhpcy5yb290R3JvdXAubG9hZEZyb21PYmplY3Qob2JqZWN0KTsKICAgICAgfQogIH0KCiAgY29uc3QgRGVmYXVsdENzcyA9IG5ldyBNYXAoWwogICAgICBbIm1lbnUtYmctY29sb3IiLCAicmdiYSgwLCAwLCAwLCAwLjUpIl0sCiAgICAgIFsibWVudS1ib3JkZXItY29sb3IiLCAicmdiYSgwLCAwLCAwLCAwKSJdLAogICAgICBbInRleHQtY29sb3IiLCAicmdiYSgyNTUsIDI1NSwgMjU1LCAxKSJdLAogICAgICBbImJ1dHRvbi1iZy1jb2xvciIsICJyZ2JhKDAsIDAsIDAsIDAuNSkiXSwKICAgICAgWyJidXR0b24tYm9yZGVyLWNvbG9yIiwgInJnYmEoMjU1LCAyNTUsIDI1NSwgMSkiXSwKICAgICAgWyJtZW51LWNvbnRyb2xzLWJnLWNvbG9yIiwgInJnYmEoMCwgMCwgMjU1LCAwLjUpIl0sCiAgICAgIFsibWVudS1jb250cm9scy10ZXh0LWNvbG9yIiwgInJnYmEoMjU1LCAyNTUsIDI1NSwgMSkiXSwKICAgICAgWyJ0ZXh0aW5wdXQtYm9yZGVyLWNvbG9yIiwgInJnYmEoMjU1LCAyNTUsIDI1NSwgMSkiXSwKICAgICAgWyJ0ZXh0aW5wdXQtYmctY29sb3IiLCAicmdiYSgwLCAwLCAwLCAwLjUpIl0sCiAgICAgIFsidG9nZ2xlLWJnLWNvbG9yIiwgInJnYmEoMCwgMCwgMCwgMC41KSJdLAogICAgICBbInRvZ2dsZS1ib3JkZXItY29sb3IiLCAicmdiYSgyNTUsIDI1NSwgMjU1LCAxKSJdLAogICAgICBbImRyb3Bkb3duLWJnLWNvbG9yIiwgInJnYmEoMCwgMCwgMCwgMC41KSJdLAogICAgICBbImRyb3Bkb3duLWJvcmRlci1jb2xvciIsICJyZ2JhKDI1NSwgMjU1LCAyNTUsIDEpIl0sCiAgICAgIFsia2V5YmluZC1lZGl0b3ItYmctY29sb3IiLCAicmdiYSgwLCAwLCAwLCAwLjc1KSJdLAogICAgICBbImtleWJpbmQtZWRpdG9yLWJvcmRlci1jb2xvciIsICJyZ2JhKDI1NSwgMjU1LCAyNTUsIDEpIl0KICBdKTsKICBjb25zdCBEZWZhdWx0TWVudVRyYW5zZm9ybXMgPSBuZXcgTWFwKFsKICAgICAgWyJIVUQgQ3VzdG9taXphdGlvbiIsIHsKICAgICAgICAgICAgICB0b3A6IDEwLAogICAgICAgICAgICAgIGxlZnQ6IDEwLAogICAgICAgICAgICAgIHdpZHRoOiBNYXRoLm1pbih3aW5kb3cuaW5uZXJXaWR0aCAvIDQsIDM1MCksCiAgICAgICAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyLAogICAgICAgICAgICAgIG1pbmltaXplZDogZmFsc2UKICAgICAgICAgIH1dLAogICAgICBbIkRldnRvb2xzIiwgewogICAgICAgICAgICAgIHRvcDogd2luZG93LmlubmVySGVpZ2h0IC8gMiArIDEwLAogICAgICAgICAgICAgIGxlZnQ6IDEwLAogICAgICAgICAgICAgIHdpZHRoOiBNYXRoLm1pbih3aW5kb3cuaW5uZXJXaWR0aCAvIDQsIDM1MCksCiAgICAgICAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyLAogICAgICAgICAgICAgIG1pbmltaXplZDogdHJ1ZQogICAgICAgICAgfV0sCiAgICAgIFsiR2VuZXJhbCBDaGVhdHMiLCB7CiAgICAgICAgICAgICAgdG9wOiAxMCwKICAgICAgICAgICAgICBsZWZ0OiB3aW5kb3cuaW5uZXJXaWR0aCAvIDMgKyAyMCwKICAgICAgICAgICAgICB3aWR0aDogTWF0aC5taW4od2luZG93LmlubmVyV2lkdGggLyA0LCAzNTApLAogICAgICAgICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0IC8gMiwKICAgICAgICAgICAgICBtaW5pbWl6ZWQ6IGZhbHNlCiAgICAgICAgICB9XSwKICAgICAgWyJDaGVhdHMgZm9yIGdhbWVtb2RlcyIsIHsKICAgICAgICAgICAgICB0b3A6IDEwLAogICAgICAgICAgICAgIGxlZnQ6IHdpbmRvdy5pbm5lcldpZHRoIC8gMyAqIDIgKyAzMCwKICAgICAgICAgICAgICB3aWR0aDogTWF0aC5taW4od2luZG93LmlubmVyV2lkdGggLyA0LCAzNTApLAogICAgICAgICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0IC8gMiwKICAgICAgICAgICAgICBtaW5pbWl6ZWQ6IGZhbHNlCiAgICAgICAgICB9XQogIF0pOwogIGNvbnN0IERlZmF1bHRLZXliaW5kcyA9IG5ldyBNYXAoW10pOwogIGNvbnN0IEh1ZEN1c3RvbWl6ZXJNZW51ID0gewogICAgICBtZW51czogWwogICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJIVUQgQ3VzdG9taXphdGlvbiIsCiAgICAgICAgICAgICAgZ3JvdXBzOiBbCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJHZW5lcmFsIiwKICAgICAgICAgICAgICAgICAgICAgIG9yZGVyOiAiZWxlbWVudHNGaXJzdCIsCiAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50czogWwogICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImNvbG9ycGlja2VyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogIlRleHQgQ29sb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZFZhcjogInRleHQtY29sb3IiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgICAgZ3JvdXBzOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAiTWVudSBBcHBlYXJhbmNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiY29sb3JwaWNrZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogIk1lbnUgQmFja2dyb3VuZCBDb2xvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmRWYXI6ICJtZW51LWJnLWNvbG9yIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImNvbG9ycGlja2VyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICJNZW51IEJvcmRlciBDb2xvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmRWYXI6ICJtZW51LWJvcmRlci1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogIk1lbnUgQ29udHJvbHMgQXBwZWFyYW5jZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImNvbG9ycGlja2VyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICJNZW51IENvbnRyb2xzIEJhY2tncm91bmQgQ29sb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaW5kVmFyOiAibWVudS1jb250cm9scy1iZy1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb2xvcnBpY2tlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiTWVudSBDb250cm9scyBUZXh0IENvbG9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZFZhcjogIm1lbnUtY29udHJvbHMtdGV4dC1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogIktleWJpbmQgRWRpdG9yIEFwcGVhcmFuY2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50czogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb2xvcnBpY2tlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiS2V5YmluZCBFZGl0b3IgQmFja2dyb3VuZCBDb2xvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmRWYXI6ICJrZXliaW5kLWVkaXRvci1iZy1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb2xvcnBpY2tlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiS2V5YmluZCBFZGl0b3IgQm9yZGVyIENvbG9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZFZhcjogImtleWJpbmQtZWRpdG9yLWJvcmRlci1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJFbGVtZW50cyIsCiAgICAgICAgICAgICAgICAgICAgICBncm91cHM6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJCdXR0b25zIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiY29sb3JwaWNrZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogIkJ1dHRvbiBCYWNrZ3JvdW5kIENvbG9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZFZhcjogImJ1dHRvbi1iZy1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb2xvcnBpY2tlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiQnV0dG9uIEJvcmRlciBDb2xvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmRWYXI6ICJidXR0b24tYm9yZGVyLWNvbG9yIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAiVGV4dCBJbnB1dHMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50czogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb2xvcnBpY2tlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiVGV4dCBJbnB1dCBCYWNrZ3JvdW5kIENvbG9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZFZhcjogInRleHRpbnB1dC1iZy1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb2xvcnBpY2tlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiVGV4dCBJbnB1dCBCb3JkZXIgQ29sb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaW5kVmFyOiAidGV4dGlucHV0LWJvcmRlci1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogIlRvZ2dsZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50czogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb2xvcnBpY2tlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiVG9nZ2xlIEJhY2tncm91bmQgQ29sb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaW5kVmFyOiAidG9nZ2xlLWJnLWNvbG9yIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImNvbG9ycGlja2VyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICJUb2dnbGUgQm9yZGVyIENvbG9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZFZhcjogInRvZ2dsZS1ib3JkZXItY29sb3IiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJEcm9wZG93bnMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50czogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb2xvcnBpY2tlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiRHJvcGRvd24gQmFja2dyb3VuZCBDb2xvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmRWYXI6ICJkcm9wZG93bi1iZy1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb2xvcnBpY2tlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAiRHJvcGRvd24gQm9yZGVyIENvbG9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZFZhcjogImRyb3Bkb3duLWJvcmRlci1jb2xvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIGVsZW1lbnRzOiBbCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJidXR0b24iLAogICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICJSZXNldCBzZXR0aW5ncyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuRnVuY3Rpb246ICJyZXNldFNldHRpbmdzIgogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgXQogICAgICAgICAgfQogICAgICBdCiAgfTsKCiAgY2xhc3MgT3ZlcmxheUNhbnZhcyB7CiAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgICAgIHRoaXMuY2FudmFzLmNsYXNzTGlzdC5hZGQoImdjX292ZXJsYXlfY2FudmFzIik7CiAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOwogICAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0OwogICAgICAgICAgLy8ga2VlcCB0aGUgY2FudmFzIHNjYWxlZCB0byB0aGUgd2luZG93IHNpemUKICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCAoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDsKICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7CiAgICAgICAgICB9KTsKICAgICAgfQogICAgICBnZXQgY29udGV4dCgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICB9CiAgfQoKICAvLyBAdHMtaWdub3JlCiAgY2xhc3MgSHVkIHsKICAgICAgY29uc3RydWN0b3IoY2hlYXQpIHsKICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7CiAgICAgICAgICB0aGlzLm1lbnVzID0gW107CiAgICAgICAgICB0aGlzLmNzc1ZhcnNTaGVldCA9IG51bGw7CiAgICAgICAgICAvLyBzbyB3ZSBjYW4gYWNjZXNzIHRoaXMgZ2xvYmFsbHkgd2hpbGUgaXQncyBiZWluZyBjb25zdHJ1Y3RlZAogICAgICAgICAgd2luZG93LmNoZWF0Lmh1ZCA9IHRoaXM7CiAgICAgICAgICB0aGlzLnN5bmNlZFZhcnMgPSBuZXcgTWFwKCk7CiAgICAgICAgICB0aGlzLmNoZWF0ID0gY2hlYXQ7CiAgICAgICAgICB0aGlzLmNoZWF0LmZ1bmNzLnNldCgicmVzZXRTZXR0aW5ncyIsIHRoaXMucmVzZXRTZXR0aW5ncy5iaW5kKHRoaXMpKTsKICAgICAgICAgIHRoaXMubG9hZFN5bmNlZFZhcigiY3NzVmFycyIsIERlZmF1bHRDc3MpOwogICAgICAgICAgdGhpcy5sb2FkU3luY2VkVmFyKCJtZW51VHJhbnNmb3JtcyIsIERlZmF1bHRNZW51VHJhbnNmb3Jtcyk7CiAgICAgICAgICB0aGlzLmxvYWRTeW5jZWRWYXIoImtleWJpbmRzIiwgRGVmYXVsdEtleWJpbmRzKTsKICAgICAgICAgIHRoaXMudXBkYXRlQ3NzVmFycygpOwogICAgICAgICAgdGhpcy5pbml0KCk7CiAgICAgICAgICAvLyBsb2FkIHRoZSBjdXN0b21pemVyIG1lbnUgYnkgZGVmYXVsdAogICAgICAgICAgdGhpcy5sb2FkRnJvbU9iamVjdChIdWRDdXN0b21pemVyTWVudSk7CiAgICAgICAgICB0aGlzLmFkZFRvZ2dsZSgpOwogICAgICB9CiAgICAgIHJlc2V0U2V0dGluZ3MoKSB7CiAgICAgICAgICBpZiAoIWNvbmZpcm0oIlNldHRpbmcgdXBkYXRlcyB3aWxsIG9ubHkgdGFrZSBwbGFjZSBhZnRlciB5b3UgcmVsb2FkIHRoZSBwYWdlLCBhcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gcmVzZXQgc2V0dGluZ3M/IikpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgR01fZGVsZXRlVmFsdWUoImNzc1ZhcnMiKTsKICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlKCJtZW51VHJhbnNmb3JtcyIpOwogICAgICAgICAgR01fZGVsZXRlVmFsdWUoImtleWJpbmRzIik7CiAgICAgIH0KICAgICAgYWRkVG9nZ2xlKCkgewogICAgICAgICAgdGhpcy5jaGVhdC5rZXliaW5kTWFuYWdlci5yZWdpc3RlckJpbmQoewogICAgICAgICAgICAgIGtleXM6IG5ldyBTZXQoWyJcXCJdKSwKICAgICAgICAgICAgICBleGNsdXNpdmU6IGZhbHNlLAogICAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gdGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPT0gIm5vbmUiID8gIiIgOiAibm9uZSI7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgfQogICAgICBjcmVhdGVNZW51KG5hbWUpIHsKICAgICAgICAgIHZhciBfYTsKICAgICAgICAgIGxldCBleGlzdGluZ01lbnUgPSB0aGlzLm1lbnUobmFtZSk7CiAgICAgICAgICBpZiAoZXhpc3RpbmdNZW51KQogICAgICAgICAgICAgIHJldHVybiBleGlzdGluZ01lbnU7CiAgICAgICAgICBsZXQgbWVudVRyYW5zZm9ybSA9IChfYSA9IHRoaXMuc3luY2VkVmFycy5nZXQoIm1lbnVUcmFuc2Zvcm1zIikpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXQobmFtZSk7CiAgICAgICAgICBsZXQgbWVudSA9IG5ldyBNZW51KHRoaXMsIG5hbWUsIG1lbnVUcmFuc2Zvcm0pOwogICAgICAgICAgdGhpcy5tZW51cy5wdXNoKG1lbnUpOwogICAgICAgICAgcmV0dXJuIG1lbnU7CiAgICAgIH0KICAgICAgbWVudShuYW1lKSB7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubWVudXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBpZiAodGhpcy5tZW51c1tpXS5uYW1lID09IG5hbWUpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVudXNbaV07CiAgICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgbG9hZFN5bmNlZFZhcihuYW1lLCBkZWZhdWx0VmFsdWUpIHsKICAgICAgICAgIGxldCBsb2FkZWRWYWx1ZSA9IEdNX2dldFZhbHVlKG5hbWUsICJ7fSIpOwogICAgICAgICAgbGV0IHN0b3JlZFZhbHVlID0gSlNPTi5wYXJzZShsb2FkZWRWYWx1ZSk7CiAgICAgICAgICBmb3IgKGxldCBba2V5LCB2YWx1ZV0gb2YgZGVmYXVsdFZhbHVlKSB7CiAgICAgICAgICAgICAgaWYgKCFzdG9yZWRWYWx1ZVtrZXldKQogICAgICAgICAgICAgICAgICBzdG9yZWRWYWx1ZVtrZXldID0gdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnN5bmNlZFZhcnMuc2V0KG5hbWUsIG5ldyBNYXAoT2JqZWN0LmVudHJpZXMoc3RvcmVkVmFsdWUpKSk7CiAgICAgIH0KICAgICAgdXBkYXRlQ3NzVmFyKGtleSwgdmFsdWUpIHsKICAgICAgICAgIHZhciBfYSwgX2I7CiAgICAgICAgICAoX2EgPSB0aGlzLnN5bmNlZFZhcnMuZ2V0KCJjc3NWYXJzIikpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXQoa2V5LCB2YWx1ZSk7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNzc1ZhcnMoKTsKICAgICAgICAgIC8vIHNhdmUgdGhlIGNzcyB2YXJzCiAgICAgICAgICBsZXQgY3NzVmFycyA9IEpTT04uc3RyaW5naWZ5KE9iamVjdC5mcm9tRW50cmllcygoX2IgPSB0aGlzLnN5bmNlZFZhcnMuZ2V0KCJjc3NWYXJzIikpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IFtdKSk7CiAgICAgICAgICBHTV9zZXRWYWx1ZSgiY3NzVmFycyIsIGNzc1ZhcnMpOwogICAgICB9CiAgICAgIHVwZGF0ZU1lbnVUcmFuc2Zvcm0obmFtZSwgdHJhbnNmb3JtKSB7CiAgICAgICAgICB2YXIgX2EsIF9iOwogICAgICAgICAgKF9hID0gdGhpcy5zeW5jZWRWYXJzLmdldCgibWVudVRyYW5zZm9ybXMiKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNldChuYW1lLCB0cmFuc2Zvcm0pOwogICAgICAgICAgLy8gc2F2ZSB0aGUgbWVudSB0cmFuc2Zvcm1zCiAgICAgICAgICBsZXQgbWVudVRyYW5zZm9ybXMgPSBKU09OLnN0cmluZ2lmeShPYmplY3QuZnJvbUVudHJpZXMoKF9iID0gdGhpcy5zeW5jZWRWYXJzLmdldCgibWVudVRyYW5zZm9ybXMiKSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogW10pKTsKICAgICAgICAgIEdNX3NldFZhbHVlKCJtZW51VHJhbnNmb3JtcyIsIG1lbnVUcmFuc2Zvcm1zKTsKICAgICAgfQogICAgICB1cGRhdGVLZXliaW5kKGlkLCB2YWx1ZSkgewogICAgICAgICAgdmFyIF9hLCBfYjsKICAgICAgICAgIGNvbnNvbGUubG9nKGlkLCB2YWx1ZSk7CiAgICAgICAgICAoX2EgPSB0aGlzLnN5bmNlZFZhcnMuZ2V0KCJrZXliaW5kcyIpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0KGlkLCB2YWx1ZSk7CiAgICAgICAgICAvLyBzYXZlIHRoZSBrZXliaW5kcwogICAgICAgICAgbGV0IGtleWJpbmRzID0gSlNPTi5zdHJpbmdpZnkoT2JqZWN0LmZyb21FbnRyaWVzKChfYiA9IHRoaXMuc3luY2VkVmFycy5nZXQoImtleWJpbmRzIikpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IFtdKSk7CiAgICAgICAgICBHTV9zZXRWYWx1ZSgia2V5YmluZHMiLCBrZXliaW5kcyk7CiAgICAgIH0KICAgICAgdXBkYXRlQ3NzVmFycygpIHsKICAgICAgICAgIHZhciBfYTsKICAgICAgICAgIGlmICghdGhpcy5jc3NWYXJzU2hlZXQpIHsKICAgICAgICAgICAgICB0aGlzLmNzc1ZhcnNTaGVldCA9IG5ldyBDU1NTdHlsZVNoZWV0KCk7CiAgICAgICAgICAgICAgZG9jdW1lbnQuYWRvcHRlZFN0eWxlU2hlZXRzID0gWy4uLmRvY3VtZW50LmFkb3B0ZWRTdHlsZVNoZWV0cywgdGhpcy5jc3NWYXJzU2hlZXRdOwogICAgICAgICAgfQogICAgICAgICAgbGV0IGNzc1ZhcnMgPSAiOnJvb3Qge1xuIjsKICAgICAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiAoX2EgPSB0aGlzLnN5bmNlZFZhcnMuZ2V0KCJjc3NWYXJzIikpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFtdKSB7CiAgICAgICAgICAgICAgY3NzVmFycyArPSBgXHQtLSR7a2V5fTogJHt2YWx1ZX07XG5gOwogICAgICAgICAgfQogICAgICAgICAgY3NzVmFycyArPSAifSI7CiAgICAgICAgICB0aGlzLmNzc1ZhcnNTaGVldC5yZXBsYWNlU3luYyhjc3NWYXJzKTsKICAgICAgfQogICAgICBpbml0KCkgewogICAgICAgICAgbGV0IHN0eWxlID0gbmV3IENTU1N0eWxlU2hlZXQoKTsKICAgICAgICAgIHN0eWxlLnJlcGxhY2VTeW5jKGNzcyk7CiAgICAgICAgICBkb2N1bWVudC5hZG9wdGVkU3R5bGVTaGVldHMgPSBbLi4uZG9jdW1lbnQuYWRvcHRlZFN0eWxlU2hlZXRzLCBzdHlsZV07CiAgICAgICAgICBsZXQgaHVkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICBodWQuaWQgPSAiZ2NfaHVkIjsKICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGh1ZDsKICAgICAgICAgIC8vIHRoZSBib2R5IGlzIG5vdCBsb2FkZWQgeWV0LCBzbyB3ZSBoYXZlIHRvIHdhaXQKICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCAoKSA9PiB7CiAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChodWQpOwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNzc1ZhcnMoKTsKICAgICAgfQogICAgICBsb2FkRnJvbU9iamVjdChvYmopIHsKICAgICAgICAgIGZvciAobGV0IG1lbnUgb2Ygb2JqLm1lbnVzKSB7CiAgICAgICAgICAgICAgbGV0IG5ld01lbnUgPSB0aGlzLmNyZWF0ZU1lbnUobWVudS5uYW1lKTsKICAgICAgICAgICAgICBuZXdNZW51LmxvYWRGcm9tT2JqZWN0KG1lbnUpOwogICAgICAgICAgfQogICAgICB9CiAgICAgIGNyZWF0ZU92ZXJsYXlDYW52YXMoKSB7CiAgICAgICAgICB2YXIgX2E7CiAgICAgICAgICBsZXQgY2FudmFzID0gbmV3IE92ZXJsYXlDYW52YXMoKTsKICAgICAgICAgIChfYSA9IGRvY3VtZW50LmJvZHkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5hcHBlbmRDaGlsZChjYW52YXMuY2FudmFzKTsKICAgICAgICAgIHJldHVybiBjYW52YXM7CiAgICAgIH0KICB9CgogIGNvbnN0IGh1ZEFkZGl0aW9uJDcgPSB7CiAgICAgIG1lbnVzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIkRldnRvb2xzIiwKICAgICAgICAgICAgICBlbGVtZW50czogWwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAidG9nZ2xlIiwKICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RW5hYmxlZDogIlN0b3AgbG9nZ2luZyBpbmNvbWluZyBtZXNzYWdlcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dERpc2FibGVkOiAiTG9nIGluY29taW5nIG1lc3NhZ2VzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBydW5GdW5jdGlvbjogImxvZ0luY29taW5nTWVzc2FnZXMiCiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJidXR0b24iLAogICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICJMb2cgY2xvc2VzdCBkZXZpY2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bkZ1bmN0aW9uOiAibG9nQ2xvc2VzdERldmljZSIKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0KICAgICAgICAgIH0KICAgICAgXQogIH07CiAgY2xhc3MgRGV2dG9vbHNDbGFzcyB7CiAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgdGhpcy5uYW1lID0gIkdpbWtpdCBDaGVhdCBEZXZ0b29scyI7CiAgICAgICAgICB0aGlzLmh1ZEFkZGl0aW9uID0gaHVkQWRkaXRpb24kNzsKICAgICAgICAgIHRoaXMubG9nZ2luZ0luY29taW5nTWVzc2FnZXMgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZnVuY3MgPSBuZXcgTWFwKFsKICAgICAgICAgICAgICBbImxvZ0luY29taW5nTWVzc2FnZXMiLCAoZW5hYmxlZCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnaW5nSW5jb21pbmdNZXNzYWdlcyA9IGVuYWJsZWQ7CiAgICAgICAgICAgICAgICAgIH1dLAogICAgICAgICAgICAgIFsibG9nQ2xvc2VzdERldmljZSIsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nQ2xvc2VzdERldmljZSgpOwogICAgICAgICAgICAgICAgICB9XQogICAgICAgICAgXSk7CiAgICAgIH0KICAgICAgaW5pdChjaGVhdCkgewogICAgICAgICAgY2hlYXQuc29ja2V0SGFuZGxlci5hZGRFdmVudExpc3RlbmVyKCJyZWNpZXZlTWVzc2FnZSIsIChlKSA9PiB7CiAgICAgICAgICAgICAgaWYgKCF0aGlzLmxvZ2dpbmdJbmNvbWluZ01lc3NhZ2VzKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgY2hlYXQubG9nKCJJbmNvbWluZyBtZXNzYWdlIiwgZS5kZXRhaWwpOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgbG9nQ2xvc2VzdERldmljZSgpIHsKICAgICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mLCBfZywgX2g7CiAgICAgICAgICBsZXQgZGV2aWNlcyA9IChfZSA9IChfZCA9IChfYyA9IChfYiA9IChfYSA9IHVuc2FmZVdpbmRvdyA9PT0gbnVsbCB8fCB1bnNhZmVXaW5kb3cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVuc2FmZVdpbmRvdy5zdG9yZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5waGFzZXIpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5zY2VuZSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLndvcmxkTWFuYWdlcikgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmRldmljZXMpID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5kZXZpY2VzSW5WaWV3OwogICAgICAgICAgbGV0IGJvZHkgPSAoX2ggPSAoX2cgPSAoX2YgPSB1bnNhZmVXaW5kb3cgPT09IG51bGwgfHwgdW5zYWZlV2luZG93ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1bnNhZmVXaW5kb3cuc3RvcmVzKSA9PT0gbnVsbCB8fCBfZiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2YucGhhc2VyKSA9PT0gbnVsbCB8fCBfZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2cubWFpbkNoYXJhY3RlcikgPT09IG51bGwgfHwgX2ggPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9oLmJvZHk7CiAgICAgICAgICBsZXQgY2xvc2VzdCA9IG51bGw7CiAgICAgICAgICBsZXQgY2xvc2VzdERpc3RhbmNlID0gSW5maW5pdHk7CiAgICAgICAgICBmb3IgKGxldCBkZXZpY2Ugb2YgZGV2aWNlcykgewogICAgICAgICAgICAgIGlmIChkZXZpY2UuaW50ZXJhY3RpdmVab25lcy56b25lcy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgbGV0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KE1hdGgucG93KGRldmljZS54IC0gYm9keS54LCAyKSArIE1hdGgucG93KGRldmljZS55IC0gYm9keS55LCAyKSk7CiAgICAgICAgICAgICAgaWYgKGRpc3RhbmNlIDwgY2xvc2VzdERpc3RhbmNlKSB7CiAgICAgICAgICAgICAgICAgIGNsb3Nlc3QgPSBkZXZpY2U7CiAgICAgICAgICAgICAgICAgIGNsb3Nlc3REaXN0YW5jZSA9IGRpc3RhbmNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKGNsb3Nlc3QpOwogICAgICB9CiAgfQogIGZ1bmN0aW9uIERldnRvb2xzKCkgewogICAgICByZXR1cm4gbmV3IERldnRvb2xzQ2xhc3MoKTsKICB9CgogIGNvbnN0IGh1ZEFkZGl0aW9uJDYgPSB7CiAgICAgIG1lbnVzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIkdlbmVyYWwgQ2hlYXRzIiwKICAgICAgICAgICAgICBlbGVtZW50czogWwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAidG9nZ2xlIiwKICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RW5hYmxlZDogIlN0b3AgYXV0byBhbnN3ZXJpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgIHRleHREaXNhYmxlZDogIkF1dG8gYW5zd2VyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBydW5GdW5jdGlvbjogInNldEF1dG9BbnN3ZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgIGtleWJpbmQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAga2V5YmluZElkOiAiYXV0b0Fuc3dlciIKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0KICAgICAgICAgIH0KICAgICAgXQogIH07CiAgY2xhc3MgQXV0b2Fuc3dlckNsYXNzIHsKICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICB0aGlzLm5hbWUgPSAiQXV0b2Fuc3dlciI7CiAgICAgICAgICB0aGlzLmh1ZEFkZGl0aW9uID0gaHVkQWRkaXRpb24kNjsKICAgICAgICAgIHRoaXMuYXV0b0Fuc3dlcmluZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy5mdW5jcyA9IG5ldyBNYXAoWwogICAgICAgICAgICAgIFsic2V0QXV0b0Fuc3dlciIsIChlbmFibGVkKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dG9BbnN3ZXJpbmcgPSBlbmFibGVkOwogICAgICAgICAgICAgICAgICB9XQogICAgICAgICAgXSk7CiAgICAgICAgICB0aGlzLmN1cnJlbnRRdWVzdGlvbklkID0gIiI7CiAgICAgICAgICB0aGlzLmFuc3dlckRldmljZUlkID0gIiI7CiAgICAgICAgICB0aGlzLnF1ZXN0aW9ucyA9IFtdOwogICAgICAgICAgLy8gYmx1ZWJvYXQgc3BlY2lmaWMKICAgICAgICAgIHRoaXMucXVlc3Rpb25JZExpc3QgPSBbXTsKICAgICAgICAgIHRoaXMuY3VycmVudFF1ZXN0aW9uSW5kZXggPSAwOwogICAgICB9CiAgICAgIGluaXQoY2hlYXQpIHsKICAgICAgICAgIGNoZWF0LnNvY2tldEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigicmVjaWV2ZU1lc3NhZ2UiLCAoZSkgPT4gewogICAgICAgICAgICAgIHZhciBfYTsKICAgICAgICAgICAgICBpZiAoY2hlYXQuc29ja2V0SGFuZGxlci50cmFuc3BvcnRUeXBlID09ICJjb2x5c2V1cyIpCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAvLyBnZXQgdGhlIHF1ZXN0aW9ucyBhbmQgcXVlc3Rpb24gbGlzdAogICAgICAgICAgICAgIGlmICgoKF9hID0gZS5kZXRhaWwpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5rZXkpICE9ICJTVEFURV9VUERBVEUiKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgc3dpdGNoIChlLmRldGFpbC5kYXRhLnR5cGUpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAiR0FNRV9RVUVTVElPTlMiOgogICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvbnMgPSBlLmRldGFpbC5kYXRhLnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIGNhc2UgIlBMQVlFUl9RVUVTVElPTl9MSVNUIjoKICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb25JZExpc3QgPSBlLmRldGFpbC5kYXRhLnZhbHVlLnF1ZXN0aW9uTGlzdDsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFF1ZXN0aW9uSW5kZXggPSBlLmRldGFpbC5kYXRhLnZhbHVlLnF1ZXN0aW9uSW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgY2FzZSAiUExBWUVSX1FVRVNUSU9OX0xJU1RfSU5ERVgiOgogICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UXVlc3Rpb25JbmRleCA9IGUuZGV0YWlsLmRhdGEudmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIGNoZWF0LnNvY2tldEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigicmVjaWV2ZUNoYW5nZXMiLCAoZSkgPT4gewogICAgICAgICAgICAgIHZhciBfYSwgX2IsIF9jOwogICAgICAgICAgICAgIGxldCBjaGFuZ2VzID0gZS5kZXRhaWw7CiAgICAgICAgICAgICAgZm9yIChsZXQgY2hhbmdlIG9mIGNoYW5nZXMpIHsKICAgICAgICAgICAgICAgICAgLy8gdHJ5IHRvIGdldCB0aGUgZGV2aWNlIElEIG9mIHRoZSBhbnN3ZXIgZGV2aWNlCiAgICAgICAgICAgICAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhjaGFuZ2UuZGF0YSkpIHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkgIT0gIkdMT0JBTF9xdWVzdGlvbnMiKQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvbnMgPSBKU09OLnBhcnNlKHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYW5zd2VyRGV2aWNlSWQgPSBjaGFuZ2UuaWQ7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgd2hldGhlciBpdCBpbmNsdWRlcyB0aGUgbmV3IHF1ZXN0aW9uIElECiAgICAgICAgICAgICAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhjaGFuZ2UuZGF0YSkpIHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkuaW5jbHVkZXMoImN1cnJlbnRRdWVzdGlvbklkIikgJiYga2V5LmluY2x1ZGVzKChfYyA9IChfYiA9IChfYSA9IHVuc2FmZVdpbmRvdy5zdG9yZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5waGFzZXIpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5tYWluQ2hhcmFjdGVyKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuaWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UXVlc3Rpb25JZCA9IHZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgICAgdmFyIF9hOwogICAgICAgICAgICAgIGlmICghdGhpcy5hdXRvQW5zd2VyaW5nKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgaWYgKGNoZWF0LnNvY2tldEhhbmRsZXIudHJhbnNwb3J0VHlwZSA9PSAiY29seXNldXMiKSB7CiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRRdWVzdGlvbklkID09ICIiKQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICBsZXQgY29ycmVjdFF1ZXN0aW9uID0gKF9hID0gdGhpcy5xdWVzdGlvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5maW5kKHEgPT4gcS5faWQgPT0gdGhpcy5jdXJyZW50UXVlc3Rpb25JZCk7CiAgICAgICAgICAgICAgICAgIGlmICghY29ycmVjdFF1ZXN0aW9uKQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICBsZXQgY29ycmVjdEFuc3dlcklkID0gY29ycmVjdFF1ZXN0aW9uLmFuc3dlcnMuZmluZCgoYSkgPT4gYS5jb3JyZWN0KS5faWQ7CiAgICAgICAgICAgICAgICAgIGxldCBwYWNrZXQgPSB7CiAgICAgICAgICAgICAgICAgICAgICBrZXk6ICdhbnN3ZXJlZCcsCiAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogdGhpcy5hbnN3ZXJEZXZpY2VJZCwKICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICBhbnN3ZXI6IGNvcnJlY3RBbnN3ZXJJZAogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICBjaGVhdC5zb2NrZXRIYW5kbGVyLnNlbmREYXRhKCJNRVNTQUdFX0ZPUl9ERVZJQ0UiLCBwYWNrZXQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgbGV0IHF1ZXN0aW9uSWQgPSB0aGlzLnF1ZXN0aW9uSWRMaXN0W3RoaXMuY3VycmVudFF1ZXN0aW9uSW5kZXhdOwogICAgICAgICAgICAgICAgICBsZXQgYW5zd2VySWQgPSB0aGlzLnF1ZXN0aW9ucy5maW5kKHEgPT4gcS5faWQgPT0gcXVlc3Rpb25JZCkuYW5zd2Vycy5maW5kKChhKSA9PiBhLmNvcnJlY3QpLl9pZDsKICAgICAgICAgICAgICAgICAgY2hlYXQuc29ja2V0SGFuZGxlci5zZW5kRGF0YSgiUVVFU1RJT05fQU5TV0VSRUQiLCB7CiAgICAgICAgICAgICAgICAgICAgICBhbnN3ZXI6IGFuc3dlcklkLAogICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25JZDogcXVlc3Rpb25JZAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9LCAxMDAwKTsKICAgICAgfQogIH0KICBmdW5jdGlvbiBBdXRvYW5zd2VyKCkgewogICAgICByZXR1cm4gbmV3IEF1dG9hbnN3ZXJDbGFzcygpOwogIH0KCiAgbGV0IHNraW5zID0gWyJVbmNoYW5nZWQiLCAiZGVmYXVsdF9icm93bmdyZWVuIiwgImRlZmF1bHRfY3lhbiIsICJkZWZhdWx0X2RhcmtibHVlIiwgImRlZmF1bHRfZGFya2dyZWVuIiwgImRlZmF1bHRfZGFya3B1cnBsZSIsICJkZWZhdWx0X2dyYXkiLCAiZGVmYXVsdF9ncmF5Ymx1ZSIsICJkZWZhdWx0X2dyYXlicm93biIsICJkZWZhdWx0X2hvdHBpbmsiLCAiZGVmYXVsdF9saWdodGJyb3duIiwgImRlZmF1bHRfbGlnaHRncmVlbiIsICJkZWZhdWx0X2xpZ2h0cGluayIsICJkZWZhdWx0X2xpZ2h0cHVycGxlIiwgImRlZmF1bHRfbGlnaHR5ZWxsb3ciLCAiZGVmYXVsdF9saW1lIiwgImRlZmF1bHRfbWFyb29uIiwgImRlZmF1bHRfb3JhbmdlIiwgImRlZmF1bHRfcGluayIsICJkZWZhdWx0X3JlZCIsICJkZWZhdWx0X3llbGxvdyIsICJzdW5ueSIsICJnbGFzc0hhbGZGdWxsIiwgInN0cmlwZURvdWJsZUdyZWVuIiwgInNwcmlua2xlc1JlZCIsICJkYXlPbmUiLCAidm9ydGV4QWdlbnQiLCAiZWNob0FnZW50IiwgImdyYXlHcmFkaWVudCIsICJtdXN0YWNoZSIsICJjbG93biIsICJyZWROaW5qYSIsICJyZWREZWxpY2lvdXNBcHBsZSIsICJwb2xrYURvdEJsdWVBbmRZZWxsb3ciLCAiZmFkZWRCbHVlR3JhZGllbnQiLCAid2hpdGVBbmRCbHVlVmVydGljYWxTdHJpcGVzIiwgInZvbGNhbm9DcmFja3MiLCAicGlua1Bhc3RlIiwgInllbGxvd0NyYWNrc1B1cnBsZSIsICJnbHlwaHNZZWxsb3dCcm93biIsICJjYW1vQmx1ZSIsICJnbHlwaHNPcmFuZ2VCbHVlIiwgInB1cnBsZVBhc3RlIiwgIm11c3RhY2hlQnJvd24iLCAibXVzdGFjaGVQaW5rIiwgInBvbGthRG90V2hpdGVBbmRSZWQiLCAiY2Ftb1RhbiIsICJjYW1vR3JlZW4iLCAic3RyaXBlRG91YmxlUHVycGxlIiwgInN0cmlwZURvdWJsZVJlZCIsICJzdHJpcGVEb3VibGVZZWxsb3ciLCAic3ByaW5rbGVzQ2hvY29sYXRlIiwgImNvb2xSZWRCbHVlR3JhZGllbnQiLCAibW91bnRhaW5BbmRTdW4iLCAicmVkRGlub0Nvc3R1bWUiLCAicGVuY2lsUGFjayIsICJjb3JuIiwgImx1Y2hhZG9yIiwgImZveCIsICJidXJnZXIiLCAiZ2FsYXh5IiwgImNlbGxCbHVlIiwgImNlbGxHb2xkIiwgInJvY2t5V2VzdCIsICJwdXp6bGVSZWRHcmVlbiIsICJwdXp6bGVPcmFuZ2VCbHVlIiwgInB1enpsZUdyYXlXaGl0ZSIsICJwdXp6bGVHcmVlbkJsdWUiLCAicHV6emxlWWVsbG93UHVycGxlIiwgInB1bXBraW4iLCAiZ2hvc3RDb3N0dW1lIiwgIm11bW15IiwgImZpZnRoQmlydGhkYXkiLCAicHVtcGtpblBpZSIsICJmZWFzdCIsICJmcm9zdEJ1ZGR5IiwgImZlc3RpdmVPbmVzaWVUYW4iLCAiZmVzdGl2ZU9uZXNpZVJlZCIsICJmZXN0aXZlT25lc2llR3JlZW4iLCAiZmVzdGl2ZU9uZXNpZUJsdWUiLCAiaG90Q2hvY29sYXRlIiwgInNub3dnbG9iZSIsICJwb2xrYURvdEZlc3RpdmUiLCAicG9sa2FEb3RGZXN0aXZlUmV2ZXJzZSIsICJtdXN0YWNoZVNhbnRhIiwgImZpcmV3b3JrIiwgImdpZnQiLCAic25vd21hbiIsICJkZXRlY3RpdmUiLCAieWluWWFuZyIsICJhc3Ryb0hlbG1ldCIsICJoYW1zdGVyIiwgInBpcmF0ZSIsICJyb2Nrc3RhciIsICJjaXJjdWl0R3JheSIsICJjaXJjdWl0Qmx1ZSIsICJjaXJjdWl0R3JlZW4iLCAicm9zZXMiLCAiaGVhcnQiLCAiemVicmEiLCAiY29uc3RlbGxhdGlvbkJsYWNrV2hpdGUiLCAiY29uc3RlbGxhdGlvbkJsYWNrR3JlZW4iLCAiY29uc3RlbGxhdGlvblB1cnBsZVllbGxvdyIsICJjb25zdGVsbGF0aW9uUGlua0dyZWVuIiwgImNvbnN0ZWxsYXRpb25ZZWxsb3dQaW5rIiwgInNxdWlnZ2xlcyIsICJmcm96ZW5NdW1teSIsICJsZXByZWNoYXVuIiwgImV2aWxQbGFudEdyZWVuIiwgImV2aWxQbGFudFBpbmsiLCAiZmlzaGVyIiwgInJhaW5ib3dXYXZlIiwgInNrZXRjaCIsICJza2V0Y2hCbHVlIiwgImJhbmFuYVNwbGl0IiwgImVpZ2h0Qml0IiwgImdhbWVyR3JlZW4iLCAiZ2FtZXJQaW5rIiwgImdhbWVyUHVycGxlIiwgImdhbWVyWWVsbG93IiwgImdyYWR1YXRlIiwgImdyYWR1YXRlQmx1ZSIsICJhcmN0aWNGb3giLCAiY29mZmVlIiwgInBhcnR5UGluZWFwcGxlIiwgInNlbnRyeVJvYm90IiwgImNvbnN0cnVjdGlvbiIsICJjbG9jayIsICJjcmFzaFRlc3REdW1teSJdOwogIGxldCB0cmFpbHMgPSBbIk5vbmUiLCAib3JpZ2luX3Rva2VuIl07CiAgc2tpbnMgPSBza2lucy5zb3J0KCk7CiAgdHJhaWxzID0gdHJhaWxzLnNvcnQoKTsKICBjb25zdCBodWRBZGRpdGlvbiQ1ID0gewogICAgICBtZW51czogWwogICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJHZW5lcmFsIENoZWF0cyIsCiAgICAgICAgICAgICAgZ3JvdXBzOiBbCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJDb3NtZXRpYyBQaWNrZXIiLAogICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogIlNlbGVjdCBjb3NtZXRpY3MgdG8gYXBwbHkgdG8geW91ciBjaGFyYWN0ZXIuIFRoZXNlIGNoYW5nZXMgYXJlIG9ubHkgdmlzaWJsZSB0byB5b3UuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJkcm9wZG93biIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICJTZWxlY3RlZCBTa2luIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHNraW5zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuRnVuY3Rpb246ICJzZXRTa2luIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICJVbmNoYW5nZWQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImRyb3Bkb3duIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogIlNlbGVjdGVkIFRyYWlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRyYWlscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bkZ1bmN0aW9uOiAic2V0VHJhaWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogIk5vbmUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdCiAgICAgICAgICB9CiAgICAgIF0KICB9OwogIGNsYXNzIENvc21ldGljcGlja2VyQ2xhc3MgewogICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgIHRoaXMubmFtZSA9ICJDb3NtZXRpYyBQaWNrZXIiOwogICAgICAgICAgdGhpcy5odWRBZGRpdGlvbiA9IGh1ZEFkZGl0aW9uJDU7CiAgICAgICAgICB0aGlzLmZ1bmNzID0gbmV3IE1hcChbCiAgICAgICAgICAgICAgWyJzZXRTa2luIiwgKHNraW4pID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2tpbihza2luKTsKICAgICAgICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICAgWyJzZXRUcmFpbCIsICh0cmFpbCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRUcmFpbCh0cmFpbCk7CiAgICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICBdKTsKICAgICAgICAgIHRoaXMuc2tpbldhaXRpbmcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMudHJhaWxXYWl0aW5nID0gZmFsc2U7CiAgICAgIH0KICAgICAgc2V0U2tpbihza2luKSB7CiAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZjsKICAgICAgICAgIGlmIChza2luID09ICJVbmNoYW5nZWQiKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIGlmICghKCJzdG9yZXMiIGluIHVuc2FmZVdpbmRvdykpIHsKICAgICAgICAgICAgICBpZiAodGhpcy5za2luV2FpdGluZykKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGxldCBjaGVja0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgICAgICBpZiAoInN0b3JlcyIgaW4gdW5zYWZlV2luZG93KSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNTa2luQXBwbGllZChza2luKSkKICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGNoZWNrSW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTa2luKHNraW4pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgMTAwKTsKICAgICAgICAgICAgICB0aGlzLnNraW5XYWl0aW5nID0gdHJ1ZTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBsZXQgcGhhc2VyID0gdW5zYWZlV2luZG93LnN0b3Jlcy5waGFzZXI7CiAgICAgICAgICBsZXQgdXNlcklkID0gKF9hID0gcGhhc2VyLm1haW5DaGFyYWN0ZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pZDsKICAgICAgICAgIGlmICghdXNlcklkKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIGxldCBza2luSWQgPSBgY2hhcmFjdGVyXyR7c2tpbn1gOwogICAgICAgICAgKF9mID0gKF9lID0gKF9kID0gKF9jID0gKF9iID0gcGhhc2VyLnNjZW5lKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2hhcmFjdGVyTWFuYWdlcikgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmNoYXJhY3RlcnMpID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC5nZXQodXNlcklkKSkgPT09IG51bGwgfHwgX2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lLnNraW4pID09PSBudWxsIHx8IF9mID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZi51cGRhdGVTa2luKHNraW5JZCk7CiAgICAgIH0KICAgICAgaGFzU2tpbkFwcGxpZWQoc2tpbikgewogICAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZTsKICAgICAgICAgIGxldCBwaGFzZXIgPSB1bnNhZmVXaW5kb3cuc3RvcmVzLnBoYXNlcjsKICAgICAgICAgIGxldCB1c2VySWQgPSAoX2EgPSBwaGFzZXIubWFpbkNoYXJhY3RlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlkOwogICAgICAgICAgaWYgKCF1c2VySWQpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgbGV0IHNraW5JZCA9IGBjaGFyYWN0ZXJfJHtza2lufWA7CiAgICAgICAgICByZXR1cm4gKChfZSA9IChfZCA9IChfYyA9IChfYiA9IHBoYXNlci5zY2VuZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNoYXJhY3Rlck1hbmFnZXIpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5jaGFyYWN0ZXJzKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QuZ2V0KHVzZXJJZCkpID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5za2luLnNraW5JZCkgPT0gc2tpbklkOwogICAgICB9CiAgICAgIHNldFRyYWlsKHRyYWlsKSB7CiAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZjsKICAgICAgICAgIGlmICghKCJzdG9yZXMiIGluIHVuc2FmZVdpbmRvdykpIHsKICAgICAgICAgICAgICBpZiAodGhpcy50cmFpbFdhaXRpbmcpCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBsZXQgY2hlY2tJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgICAgICAgaWYgKCJzdG9yZXMiIGluIHVuc2FmZVdpbmRvdykgewogICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzU2tpbkFwcGxpZWQodHJhaWwpKQogICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoY2hlY2tJbnRlcnZhbCk7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFRyYWlsKHRyYWlsKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICAgICAgdGhpcy50cmFpbFdhaXRpbmcgPSB0cnVlOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGxldCBwaGFzZXIgPSB1bnNhZmVXaW5kb3cuc3RvcmVzLnBoYXNlcjsKICAgICAgICAgIGxldCB1c2VySWQgPSAoX2EgPSBwaGFzZXIubWFpbkNoYXJhY3RlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlkOwogICAgICAgICAgaWYgKCF1c2VySWQpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgLy8gYmxhbmsgdHJhaWwgaXMgIk5vbmUiCiAgICAgICAgICBpZiAodHJhaWwgPT0gIk5vbmUiKQogICAgICAgICAgICAgIHRyYWlsID0gIiI7CiAgICAgICAgICBsZXQgdHJhaWxJZCA9IGB0cmFpbF8ke3RyYWlsfWA7CiAgICAgICAgICAoX2YgPSAoX2UgPSAoX2QgPSAoX2MgPSAoX2IgPSBwaGFzZXIuc2NlbmUpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jaGFyYWN0ZXJNYW5hZ2VyKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuY2hhcmFjdGVycykgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmdldCh1c2VySWQpKSA9PT0gbnVsbCB8fCBfZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2UuY2hhcmFjdGVyVHJhaWwpID09PSBudWxsIHx8IF9mID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZi51cGRhdGVBcHBlYXJhbmNlKHRyYWlsSWQpOwogICAgICB9CiAgfQogIGZ1bmN0aW9uIENvc21ldGljcGlja2VyKCkgewogICAgICByZXR1cm4gbmV3IENvc21ldGljcGlja2VyQ2xhc3MoKTsKICB9CgogIGNvbnN0IGh1ZEFkZGl0aW9uJDQgPSB7CiAgICAgIG1lbnVzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIkdlbmVyYWwgQ2hlYXRzIiwKICAgICAgICAgICAgICBncm91cHM6IFsKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgbmFtZTogIlBsYXllciBIaWdobGlnaHRlciIsCiAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50czogWwogICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogInRvZ2dsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRFbmFibGVkOiAiU3RvcCBIaWdobGlnaHRpbmcgVGVhbW1hdGVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHREaXNhYmxlZDogIkhpZ2hsaWdodCBUZWFtbWF0ZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuRnVuY3Rpb246ICJoaWdobGlnaHRUZWFtbWF0ZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5YmluZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleWJpbmRJZDogImhpZ2hsaWdodFRlYW1tYXRlcyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAidG9nZ2xlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEVuYWJsZWQ6ICJTdG9wIEhpZ2hsaWdodGluZyBFbmVtaWVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHREaXNhYmxlZDogIkhpZ2hsaWdodCBFbmVtaWVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bkZ1bmN0aW9uOiAiaGlnaGxpZ2h0RW5lbWllcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXliaW5kOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5YmluZElkOiAiaGlnaGxpZ2h0RW5lbWllcyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic2xpZGVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogIkFycm93IERpc3RhbmNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbjogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXg6IDc1MCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDIwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bkZ1bmN0aW9uOiAic2V0QXJyb3dEaXN0YW5jZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0KICAgICAgICAgIH0KICAgICAgXQogIH07CiAgY2xhc3MgUGxheWVyaGlnaGxpZ2h0ZXJDbGFzcyB7CiAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgdGhpcy5uYW1lID0gIlBsYXllciBIaWdobGlnaHRlciI7CiAgICAgICAgICB0aGlzLmh1ZEFkZGl0aW9uID0gaHVkQWRkaXRpb24kNDsKICAgICAgICAgIHRoaXMuZnVuY3MgPSBuZXcgTWFwKFsKICAgICAgICAgICAgICBbImhpZ2hsaWdodFRlYW1tYXRlcyIsICh2YWx1ZSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWdobGlnaHRpbmdUZWFtbWF0ZXMgPSB2YWx1ZTsKICAgICAgICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICAgWyJoaWdobGlnaHRFbmVtaWVzIiwgKHZhbHVlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZ2hsaWdodGluZ0VuZW1pZXMgPSB2YWx1ZTsKICAgICAgICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICAgWyJzZXRBcnJvd0Rpc3RhbmNlIiwgKHZhbHVlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFycm93RGlzdGFuY2UgPSB2YWx1ZTsKICAgICAgICAgICAgICAgICAgfV0KICAgICAgICAgIF0pOwogICAgICAgICAgdGhpcy5oaWdobGlnaHRpbmdUZWFtbWF0ZXMgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuaGlnaGxpZ2h0aW5nRW5lbWllcyA9IGZhbHNlOwogICAgICAgICAgdGhpcy5jdHggPSBudWxsOwogICAgICAgICAgdGhpcy5jYW52YXMgPSBudWxsOwogICAgICAgICAgdGhpcy5hcnJvd0Rpc3RhbmNlID0gMjAwOwogICAgICB9CiAgICAgIGluaXQoY2hlYXQpIHsKICAgICAgICAgIHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgICB2YXIgX2EsIF9iOwogICAgICAgICAgICAgIGlmICghKChfYiA9IChfYSA9IHVuc2FmZVdpbmRvdyA9PT0gbnVsbCB8fCB1bnNhZmVXaW5kb3cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVuc2FmZVdpbmRvdy5zdG9yZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5waGFzZXIpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5zY2VuZSkpCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBpZiAodGhpcy5jYW52YXMgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcyA9IGNoZWF0Lmh1ZC5jcmVhdGVPdmVybGF5Q2FudmFzKCk7CiAgICAgICAgICAgICAgICAgIHRoaXMuY3R4ID0gdGhpcy5jYW52YXMuY29udGV4dDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTsKICAgICAgICAgIH0sIDEwMCk7CiAgICAgIH0KICAgICAgcmVuZGVyKCkgewogICAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nLCBfaCwgX2osIF9rLCBfbDsKICAgICAgICAgIChfYSA9IHRoaXMuY3R4KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2xlYXJSZWN0KDAsIDAsIChfYyA9IChfYiA9IHRoaXMuY2FudmFzKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FudmFzLndpZHRoKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiAxOTIwLCAoX2UgPSAoX2QgPSB0aGlzLmNhbnZhcykgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmNhbnZhcy5oZWlnaHQpICE9PSBudWxsICYmIF9lICE9PSB2b2lkIDAgPyBfZSA6IDEwODApOwogICAgICAgICAgbGV0IHBoYXNlciA9IHVuc2FmZVdpbmRvdy5zdG9yZXMucGhhc2VyOwogICAgICAgICAgbGV0IGNoYXJhY3RlcnMgPSBwaGFzZXIuc2NlbmUuY2hhcmFjdGVyTWFuYWdlci5jaGFyYWN0ZXJzOwogICAgICAgICAgbGV0IHVzZXIgPSBwaGFzZXIubWFpbkNoYXJhY3RlcjsKICAgICAgICAgIGZvciAobGV0IFtpZCwgZGF0YV0gb2YgY2hhcmFjdGVycykgewogICAgICAgICAgICAgIGlmIChpZCA9PSB1c2VyLmlkKQogICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICBsZXQgaXNFbmVteSA9IGRhdGEudGVhbUlkICE9IHVzZXIudGVhbUlkOwogICAgICAgICAgICAgIGlmIChpc0VuZW15ICYmICF0aGlzLmhpZ2hsaWdodGluZ0VuZW1pZXMpCiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIGlmICghaXNFbmVteSAmJiAhdGhpcy5oaWdobGlnaHRpbmdUZWFtbWF0ZXMpCiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gaXNFbmVteSA/ICJyZWQiIDogImdyZWVuIjsKICAgICAgICAgICAgICB0aGlzLmN0eC5saW5lV2lkdGggPSA1OwogICAgICAgICAgICAgIC8vIHJlbmRlciBhbiBhcnJvdyBwb2ludGluZyB0byB0aGUgcGxheWVyCiAgICAgICAgICAgICAgbGV0IGFuZ2xlID0gTWF0aC5hdGFuMihkYXRhLmJvZHkueSAtIHVzZXIuYm9keS55LCBkYXRhLmJvZHkueCAtIHVzZXIuYm9keS54KTsKICAgICAgICAgICAgICBsZXQgZGlzdGFuY2UgPSBNYXRoLnNxcnQoTWF0aC5wb3coZGF0YS5ib2R5LnggLSB1c2VyLmJvZHkueCwgMikgKyBNYXRoLnBvdyhkYXRhLmJvZHkueSAtIHVzZXIuYm9keS55LCAyKSk7CiAgICAgICAgICAgICAgbGV0IGFycm93RGlzdGFuY2UgPSBNYXRoLm1pbihkaXN0YW5jZSwgdGhpcy5hcnJvd0Rpc3RhbmNlKTsKICAgICAgICAgICAgICBsZXQgYXJyb3dUaXAgPSB7CiAgICAgICAgICAgICAgICAgIHg6IE1hdGguY29zKGFuZ2xlKSAqIGFycm93RGlzdGFuY2UgKyB0aGlzLmNhbnZhcy5jYW52YXMud2lkdGggLyAyLAogICAgICAgICAgICAgICAgICB5OiBNYXRoLnNpbihhbmdsZSkgKiBhcnJvd0Rpc3RhbmNlICsgdGhpcy5jYW52YXMuY2FudmFzLmhlaWdodCAvIDIKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGxldCBsZWZ0VGlwQW5nbGUgPSBhbmdsZSAtIE1hdGguUEkgLyA0ICogMzsKICAgICAgICAgICAgICBsZXQgcmlnaHRUaXBBbmdsZSA9IGFuZ2xlICsgTWF0aC5QSSAvIDQgKiAzOwogICAgICAgICAgICAgIC8vIGRyYXcgYSBsaW5lIGZyb20gdGhlIGNlbnRlciB0byBib3RoIHRpcHMKICAgICAgICAgICAgICAoX2YgPSB0aGlzLmN0eCkgPT09IG51bGwgfHwgX2YgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9mLmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgIChfZyA9IHRoaXMuY3R4KSA9PT0gbnVsbCB8fCBfZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2cubW92ZVRvKGFycm93VGlwLngsIGFycm93VGlwLnkpOwogICAgICAgICAgICAgIChfaCA9IHRoaXMuY3R4KSA9PT0gbnVsbCB8fCBfaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2gubGluZVRvKE1hdGguY29zKGxlZnRUaXBBbmdsZSkgKiA1MCArIGFycm93VGlwLngsIE1hdGguc2luKGxlZnRUaXBBbmdsZSkgKiA1MCArIGFycm93VGlwLnkpOwogICAgICAgICAgICAgIChfaiA9IHRoaXMuY3R4KSA9PT0gbnVsbCB8fCBfaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2oubW92ZVRvKGFycm93VGlwLngsIGFycm93VGlwLnkpOwogICAgICAgICAgICAgIChfayA9IHRoaXMuY3R4KSA9PT0gbnVsbCB8fCBfayA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2subGluZVRvKE1hdGguY29zKHJpZ2h0VGlwQW5nbGUpICogNTAgKyBhcnJvd1RpcC54LCBNYXRoLnNpbihyaWdodFRpcEFuZ2xlKSAqIDUwICsgYXJyb3dUaXAueSk7CiAgICAgICAgICAgICAgKF9sID0gdGhpcy5jdHgpID09PSBudWxsIHx8IF9sID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbC5zdHJva2UoKTsKICAgICAgICAgICAgICAvLyB3cml0ZSB0aGUgdXNlcidzIG5hbWUgYW5kIGRpc3RhbmNlCiAgICAgICAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gImJsYWNrIjsKICAgICAgICAgICAgICB0aGlzLmN0eC5mb250ID0gIjIwcHggVmVyZGFuYSI7CiAgICAgICAgICAgICAgdGhpcy5jdHgudGV4dEFsaWduID0gImNlbnRlciI7CiAgICAgICAgICAgICAgdGhpcy5jdHgudGV4dEJhc2VsaW5lID0gIm1pZGRsZSI7CiAgICAgICAgICAgICAgdGhpcy5jdHguZmlsbFRleHQoYCR7ZGF0YS5uYW1ldGFnLm5hbWV9ICgke01hdGgucm91bmQoZGlzdGFuY2UpfSlgLCBhcnJvd1RpcC54LCBhcnJvd1RpcC55KTsKICAgICAgICAgIH0KICAgICAgfQogIH0KICBmdW5jdGlvbiBQbGF5ZXJoaWdobGlnaHRlcigpIHsKICAgICAgcmV0dXJuIG5ldyBQbGF5ZXJoaWdobGlnaHRlckNsYXNzKCk7CiAgfQoKICBjbGFzcyBGcmVlY2FtQ2xhc3MgewogICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgIHRoaXMubmFtZSA9ICJDb3NtZXRpYyBQaWNrZXIiOwogICAgICAgICAgdGhpcy5mcmVlY2FtbWluZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy5mcmVlQ2FtUG9zID0geyB4OiAwLCB5OiAwIH07CiAgICAgICAgICB0aGlzLnRvZ2dsZUZyZWVjYW0gPSBudWxsOwogICAgICAgICAgdGhpcy5zcGVjdGF0ZU1lbnUgPSBudWxsOwogICAgICAgICAgdGhpcy5rZXlzID0gbmV3IFNldCgpOwogICAgICB9CiAgICAgIGluaXQoY2hlYXQpIHsKICAgICAgICAgIGxldCBjYW1Hcm91cCA9IGNoZWF0Lmh1ZC5jcmVhdGVNZW51KCJHZW5lcmFsIENoZWF0cyIpLmNyZWF0ZUdyb3VwKCJGcmVlY2FtIik7CiAgICAgICAgICAvLyBpbml0aWFsaXplIGFsbCB0aGUgZWxlbWVudHMKICAgICAgICAgIGxldCB0b2dnbGVGcmVlY2FtID0gY2FtR3JvdXAuYWRkRWxlbWVudCgidG9nZ2xlIiwgewogICAgICAgICAgICAgIHRleHRFbmFibGVkOiAiU3RvcCBGcmVlY2FtbWluZyIsCiAgICAgICAgICAgICAgdGV4dERpc2FibGVkOiAiVW5iaW5kIENhbWVyYSIsCiAgICAgICAgICAgICAga2V5YmluZDogdHJ1ZSwKICAgICAgICAgICAgICBrZXliaW5kSWQ6ICJ0b2dnbGVGcmVlY2FtIgogICAgICAgICAgfSk7CiAgICAgICAgICB0b2dnbGVGcmVlY2FtLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIChlKSA9PiB7CiAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhbUhlbHBlcikgewogICAgICAgICAgICAgICAgICB0b2dnbGVGcmVlY2FtLnZhbHVlID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy5lbmFibGVGcmVlY2FtKGUuZGV0YWlsKTsKICAgICAgICAgIH0pOwogICAgICAgICAgbGV0IGRyb3Bkb3duID0gY2FtR3JvdXAuYWRkRWxlbWVudCgiZHJvcGRvd24iLCB7CiAgICAgICAgICAgICAgdGV4dDogIlNwZWN0YXRlIFBsYXllciIsCiAgICAgICAgICAgICAgb3B0aW9uczogWyJOb25lIl0KICAgICAgICAgIH0pOwogICAgICAgICAgZHJvcGRvd24uYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwgKGUpID0+IHsKICAgICAgICAgICAgICB0aGlzLnNwZWN0YXRlUGxheWVyKGUuZGV0YWlsKTsKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy50b2dnbGVGcmVlY2FtID0gdG9nZ2xlRnJlZWNhbTsKICAgICAgICAgIHRoaXMuc3BlY3RhdGVNZW51ID0gZHJvcGRvd247CiAgICAgICAgICBjaGVhdC5hZGRFdmVudExpc3RlbmVyKCdnYW1lTG9hZGVkJywgKCkgPT4gewogICAgICAgICAgICAgIHRoaXMuY2FtSGVscGVyID0gdW5zYWZlV2luZG93LnN0b3Jlcy5waGFzZXIuc2NlbmUuY2FtZXJhSGVscGVyOwogICAgICAgICAgICAgIC8vIGFkZCBpbiB0aGUgdXBkYXRlIGxvb3AKICAgICAgICAgICAgICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7CiAgICAgICAgICAgICAgfSwgMTAwMCAvIDYwKTsKICAgICAgICAgIH0pOwogICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCAoZSkgPT4gewogICAgICAgICAgICAgIGlmICghdGhpcy5mcmVlY2FtbWluZykKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGlmICghZS5rZXkuaW5jbHVkZXMoIkFycm93IikpCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgIHRoaXMua2V5cy5hZGQoZS5rZXkpOwogICAgICAgICAgfSk7CiAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigia2V5dXAiLCAoZSkgPT4gewogICAgICAgICAgICAgIHRoaXMua2V5cy5kZWxldGUoZS5rZXkpOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgZW5hYmxlRnJlZWNhbSh2YWx1ZSkgewogICAgICAgICAgbGV0IHBoYXNlciA9IHVuc2FmZVdpbmRvdy5zdG9yZXMucGhhc2VyOwogICAgICAgICAgbGV0IGNhbWVyYSA9IHBoYXNlci5zY2VuZS5jYW1lcmFzLmNhbWVyYXNbMF07CiAgICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgICAgICB0aGlzLmNhbUhlbHBlci5zdG9wRm9sbG93KCk7CiAgICAgICAgICAgICAgdGhpcy5mcmVlQ2FtUG9zLnggPSBjYW1lcmEubWlkUG9pbnQueDsKICAgICAgICAgICAgICB0aGlzLmZyZWVDYW1Qb3MueSA9IGNhbWVyYS5taWRQb2ludC55OwogICAgICAgICAgfQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgbGV0IGNoYXJPYmogPSBwaGFzZXIuc2NlbmUuY2hhcmFjdGVyTWFuYWdlci5jaGFyYWN0ZXJzLmdldChwaGFzZXIubWFpbkNoYXJhY3Rlci5pZCkuYm9keTsKICAgICAgICAgICAgICB0aGlzLmNhbUhlbHBlci5zdGFydEZvbGxvd2luZ09iamVjdCh7IG9iamVjdDogY2hhck9iaiB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuZnJlZWNhbW1pbmcgPSB2YWx1ZTsKICAgICAgfQogICAgICBzcGVjdGF0ZVBsYXllcihuYW1lKSB7CiAgICAgICAgICBpZiAobmFtZSA9PSAiTm9uZSIpIHsKICAgICAgICAgICAgICB0aGlzLmVuYWJsZUZyZWVjYW0oZmFsc2UpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMudG9nZ2xlRnJlZWNhbS52YWx1ZSA9IHRydWU7CiAgICAgICAgICBsZXQgcGhhc2VyID0gdW5zYWZlV2luZG93LnN0b3Jlcy5waGFzZXI7CiAgICAgICAgICBsZXQgcGxheWVycyA9IHBoYXNlci5zY2VuZS5jaGFyYWN0ZXJNYW5hZ2VyLmNoYXJhY3RlcnM7CiAgICAgICAgICBmb3IgKGxldCBbaWQsIHBsYXllcl0gb2YgcGxheWVycykgewogICAgICAgICAgICAgIGlmIChwbGF5ZXIubmFtZXRhZy5uYW1lID09IG5hbWUpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5jYW1IZWxwZXIuc3RhcnRGb2xsb3dpbmdPYmplY3QoeyBvYmplY3Q6IHBsYXllci5ib2R5IH0pOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgdXBkYXRlKCkgewogICAgICAgICAgdGhpcy51cGRhdGVTcGVjdGF0YWJsZVBsYXllcnMoKTsKICAgICAgICAgIGlmICghdGhpcy5mcmVlY2FtbWluZykKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAvLyBtb3ZlIHRoZSBjYW1lcmEKICAgICAgICAgIGlmICh0aGlzLmtleXMuaGFzKCJBcnJvd1VwIikpCiAgICAgICAgICAgICAgdGhpcy5mcmVlQ2FtUG9zLnkgLT0gMjA7CiAgICAgICAgICBpZiAodGhpcy5rZXlzLmhhcygiQXJyb3dEb3duIikpCiAgICAgICAgICAgICAgdGhpcy5mcmVlQ2FtUG9zLnkgKz0gMjA7CiAgICAgICAgICBpZiAodGhpcy5rZXlzLmhhcygiQXJyb3dMZWZ0IikpCiAgICAgICAgICAgICAgdGhpcy5mcmVlQ2FtUG9zLnggLT0gMjA7CiAgICAgICAgICBpZiAodGhpcy5rZXlzLmhhcygiQXJyb3dSaWdodCIpKQogICAgICAgICAgICAgIHRoaXMuZnJlZUNhbVBvcy54ICs9IDIwOwogICAgICAgICAgdGhpcy5jYW1IZWxwZXIuZ29Ubyh0aGlzLmZyZWVDYW1Qb3MpOwogICAgICB9CiAgICAgIHVwZGF0ZVNwZWN0YXRhYmxlUGxheWVycygpIHsKICAgICAgICAgIHZhciBfYTsKICAgICAgICAgIGxldCBwaGFzZXIgPSB1bnNhZmVXaW5kb3cuc3RvcmVzLnBoYXNlcjsKICAgICAgICAgIGxldCBwbGF5ZXJzID0gcGhhc2VyLnNjZW5lLmNoYXJhY3Rlck1hbmFnZXIuY2hhcmFjdGVyczsKICAgICAgICAgIGxldCBvcHRpb25zID0gWyJOb25lIl07CiAgICAgICAgICBmb3IgKGxldCBbaWQsIHBsYXllcl0gb2YgcGxheWVycykgewogICAgICAgICAgICAgIGlmIChpZCA9PSBwaGFzZXIubWFpbkNoYXJhY3Rlci5pZCkKICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgb3B0aW9ucy5wdXNoKHBsYXllci5uYW1ldGFnLm5hbWUpOwogICAgICAgICAgfQogICAgICAgICAgKF9hID0gdGhpcy5zcGVjdGF0ZU1lbnUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXRPcHRpb25zKG9wdGlvbnMpOwogICAgICB9CiAgfQogIGZ1bmN0aW9uIEZyZWVjYW0oKSB7CiAgICAgIHJldHVybiBuZXcgRnJlZWNhbUNsYXNzKCk7CiAgfQoKICB2YXIgVXBncmFkZVR5cGU7CiAgKGZ1bmN0aW9uIChVcGdyYWRlVHlwZSkgewogICAgICBVcGdyYWRlVHlwZVsiSW5zdXJhbmNlIl0gPSAiaW5zdXJhbmNlIjsKICAgICAgVXBncmFkZVR5cGVbIk1vbmV5IFBlciBRdWVzdGlvbiJdID0gIm1vbmV5UGVyUXVlc3Rpb24iOwogICAgICBVcGdyYWRlVHlwZVsiTXVsdGlwbGllciJdID0gIm11bHRpcGxpZXIiOwogICAgICBVcGdyYWRlVHlwZVsiU3RyZWFrIEJvbnVzIl0gPSAic3RyZWFrQm9udXMiOwogIH0pKFVwZ3JhZGVUeXBlIHx8IChVcGdyYWRlVHlwZSA9IHt9KSk7CiAgY29uc3QgaHVkQWRkaXRpb24kMyA9IHsKICAgICAgbWVudXM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiQ2hlYXRzIGZvciBnYW1lbW9kZXMiLAogICAgICAgICAgICAgIGdyb3VwczogWwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAiQ2xhc3NpYyIsCiAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50czogWwogICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogInRvZ2dsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRFbmFibGVkOiAiU3RvcCBBdXRvIFB1cmNoYXNpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dERpc2FibGVkOiAiU3RhcnQgQXV0byBQdXJjaGFzaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuRnVuY3Rpb246ICJzZXRBdXRvUHVyY2hhc2luZ0NsYXNzaWMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5YmluZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleWJpbmRJZDogImF1dG9QdXJjaGFzaW5nQ2xhc3NpYyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0KICAgICAgICAgIH0KICAgICAgXQogIH07CiAgY2xhc3MgQ2xhc3NpY0NsYXNzIHsKICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICB0aGlzLm5hbWUgPSAiQ2xhc3NpYyBTY3JpcHQiOwogICAgICAgICAgdGhpcy5tb25leSA9IDA7CiAgICAgICAgICB0aGlzLnVwZ3JhZGVMZXZlbHMgPSB7CiAgICAgICAgICAgICAgaW5zdXJhbmNlOiAxLAogICAgICAgICAgICAgIG1vbmV5UGVyUXVlc3Rpb246IDEsCiAgICAgICAgICAgICAgbXVsdGlwbGllcjogMSwKICAgICAgICAgICAgICBzdHJlYWtCb251czogMQogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuaHVkQWRkaXRpb24gPSBodWRBZGRpdGlvbiQzOwogICAgICAgICAgdGhpcy5hdXRvUHVyY2hhc2luZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy5mdW5jcyA9IG5ldyBNYXAoWwogICAgICAgICAgICAgIFsic2V0QXV0b1B1cmNoYXNpbmdDbGFzc2ljIiwgKGVuYWJsZWQpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXV0b1B1cmNoYXNpbmcgPSBlbmFibGVkOwogICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYXV0b1B1cmNoYXNpbmcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja0F1dG9CdXkoKTsKICAgICAgICAgICAgICAgICAgfV0KICAgICAgICAgIF0pOwogICAgICAgICAgdGhpcy51cGdyYWRlc1RvR2V0ID0gWwogICAgICAgICAgICAgIFsiU3RyZWFrIEJvbnVzIiwgMiwgMjBdLAogICAgICAgICAgICAgIFsiTW9uZXkgUGVyIFF1ZXN0aW9uIiwgMywgMTAwXSwKICAgICAgICAgICAgICBbIlN0cmVhayBCb251cyIsIDMsIDIwMF0sCiAgICAgICAgICAgICAgWyJNdWx0aXBsaWVyIiwgMywgMzAwXSwKICAgICAgICAgICAgICBbIlN0cmVhayBCb251cyIsIDQsIDIwMDBdLAogICAgICAgICAgICAgIFsiTXVsdGlwbGllciIsIDQsIDIwMDBdLAogICAgICAgICAgICAgIFsiTW9uZXkgUGVyIFF1ZXN0aW9uIiwgNSwgMTAwMDBdLAogICAgICAgICAgICAgIFsiU3RyZWFrIEJvbnVzIiwgNSwgMjAwMDBdLAogICAgICAgICAgICAgIFsiTXVsdGlwbGllciIsIDUsIDEyMDAwXSwKICAgICAgICAgICAgICBbIk1vbmV5IFBlciBRdWVzdGlvbiIsIDYsIDc1MDAwXSwKICAgICAgICAgICAgICBbIk11bHRpcGxpZXIiLCA2LCA4NTAwMF0sCiAgICAgICAgICAgICAgWyJTdHJlYWsgQm9udXMiLCA2LCAyMDAwMDBdLAogICAgICAgICAgICAgIFsiU3RyZWFrIEJvbnVzIiwgNywgMjAwMDAwMF0sCiAgICAgICAgICAgICAgWyJTdHJlYWsgQm9udXMiLCA4LCAyMDAwMDAwMF0sCiAgICAgICAgICAgICAgWyJNdWx0aXBsaWVyIiwgNywgNzAwMDAwXSwKICAgICAgICAgICAgICBbIk1vbmV5IFBlciBRdWVzdGlvbiIsIDksIDEwMDAwMDAwXSwKICAgICAgICAgICAgICBbIk11bHRpcGxpZXIiLCA4LCA2NTAwMDAwXSwKICAgICAgICAgICAgICBbIlN0cmVhayBCb251cyIsIDksIDIwMDAwMDAwMF0sCiAgICAgICAgICAgICAgWyJNdWx0aXBsaWVyIiwgOSwgNjUwMDAwMDBdLAogICAgICAgICAgICAgIFsiU3RyZWFrIEJvbnVzIiwgMTAsIDIwMDAwMDAwMDBdLAogICAgICAgICAgICAgIFsiTW9uZXkgUGVyIFF1ZXN0aW9uIiwgMTAsIDEwMDAwMDAwMF0sCiAgICAgICAgICAgICAgWyJNdWx0aXBsaWVyIiwgMTAsIDEwMDAwMDAwMDBdCiAgICAgICAgICBdOwogICAgICB9CiAgICAgIGluaXQoY2hlYXQpIHsKICAgICAgICAgIHRoaXMuY2hlYXQgPSBjaGVhdDsKICAgICAgICAgIC8vIGdldCB0aGUgYW1vdW50IG9mIG1vbmV5CiAgICAgICAgICB0aGlzLmNoZWF0LnNvY2tldEhhbmRsZXIuYWRkRXZlbnRMaXN0ZW5lcigicmVjaWV2ZU1lc3NhZ2UiLCAoZSkgPT4gewogICAgICAgICAgICAgIHZhciBfYSwgX2I7CiAgICAgICAgICAgICAgaWYgKHRoaXMuY2hlYXQuc29ja2V0SGFuZGxlci50cmFuc3BvcnRUeXBlICE9ICJibHVlYm9hdCIpCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBpZiAoKChfYSA9IGUuZGV0YWlsLmRhdGEpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50eXBlKSA9PSAiVVBHUkFERV9MRVZFTFMiKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMudXBncmFkZUxldmVscyA9IGUuZGV0YWlsLmRhdGEudmFsdWU7CiAgICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSBhbnkgdXBncmFkZXMgdGhhdCB3ZSBhbHJlYWR5IGhhdmUKICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnVwZ3JhZGVzVG9HZXQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgIGxldCB1cGdyYWRlID0gdGhpcy51cGdyYWRlc1RvR2V0W2ldOwogICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSB0aGUgdXBncmFkZQogICAgICAgICAgICAgICAgICAgICAgbGV0IHVwZ3JhZGVBbW91bnQgPSB0aGlzLnVwZ3JhZGVMZXZlbHNbVXBncmFkZVR5cGVbdXBncmFkZVswXV1dOwogICAgICAgICAgICAgICAgICAgICAgaWYgKHVwZ3JhZGVBbW91bnQgPj0gdXBncmFkZVsxXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBncmFkZXNUb0dldC5zcGxpY2UoaSwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaS0tOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICgoKF9iID0gZS5kZXRhaWwuZGF0YSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnR5cGUpID09ICJCQUxBTkNFIikgewogICAgICAgICAgICAgICAgICB0aGlzLm1vbmV5ID0gZS5kZXRhaWwuZGF0YS52YWx1ZTsKICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja0F1dG9CdXkoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgfQogICAgICBjaGVja0F1dG9CdXkoKSB7CiAgICAgICAgICBpZiAoIXRoaXMuYXV0b1B1cmNoYXNpbmcpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgbGV0IHVwZ3JhZGUgPSB0aGlzLnVwZ3JhZGVzVG9HZXRbMF07CiAgICAgICAgICBpZiAoIXVwZ3JhZGUpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgaWYgKHRoaXMubW9uZXkgPj0gdXBncmFkZVsyXSkgewogICAgICAgICAgICAgIHRoaXMucHVyY2hhc2VVcGdyYWRlKHVwZ3JhZGVbMF0sIHVwZ3JhZGVbMV0pOwogICAgICAgICAgfQogICAgICB9CiAgICAgIHB1cmNoYXNlVXBncmFkZShuYW1lLCBsZXZlbCkgewogICAgICAgICAgdGhpcy5jaGVhdC5sb2coIlB1cmNoYXNpbmcgdXBncmFkZSIsIG5hbWUsIGxldmVsKTsKICAgICAgICAgIHRoaXMuY2hlYXQuc29ja2V0SGFuZGxlci5zZW5kRGF0YSgiVVBHUkFERV9QVVJDSEFTRUQiLCB7CiAgICAgICAgICAgICAgdXBncmFkZU5hbWU6IG5hbWUsCiAgICAgICAgICAgICAgbGV2ZWwKICAgICAgICAgIH0pOwogICAgICB9CiAgfQogIGZ1bmN0aW9uIENsYXNzaWMoKSB7CiAgICAgIHJldHVybiBuZXcgQ2xhc3NpY0NsYXNzKCk7CiAgfQoKICBjb25zdCBodWRBZGRpdGlvbiQyID0gewogICAgICBtZW51czogWwogICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJDaGVhdHMgZm9yIGdhbWVtb2RlcyIsCiAgICAgICAgICAgICAgZ3JvdXBzOiBbCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJTdXBlciBSaWNoIE1vZGUiLAogICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ0b2dnbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RW5hYmxlZDogIlN0b3AgQXV0byBQdXJjaGFzaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHREaXNhYmxlZDogIlN0YXJ0IEF1dG8gUHVyY2hhc2luZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bkZ1bmN0aW9uOiAic2V0QXV0b1B1cmNoYXNpbmdSaWNoTW9kZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXliaW5kOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5YmluZElkOiAiYXV0b1B1cmNoYXNpbmdSaWNoTW9kZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0KICAgICAgICAgIH0KICAgICAgXQogIH07CiAgY2xhc3MgUmljaE1vZGVDbGFzcyBleHRlbmRzIENsYXNzaWNDbGFzcyB7CiAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTsKICAgICAgICAgIHRoaXMubmFtZSA9ICJSaWNoIE1vZGUgU2NyaXB0IjsKICAgICAgICAgIHRoaXMuaHVkQWRkaXRpb24gPSBodWRBZGRpdGlvbiQyOwogICAgICAgICAgdGhpcy5mdW5jcyA9IG5ldyBNYXAoWwogICAgICAgICAgICAgIFsic2V0QXV0b1B1cmNoYXNpbmdSaWNoTW9kZSIsIChlbmFibGVkKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dG9QdXJjaGFzaW5nID0gZW5hYmxlZDsKICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmF1dG9QdXJjaGFzaW5nKQogICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tBdXRvQnV5KCk7CiAgICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICBdKTsKICAgICAgICAgIHRoaXMudXBncmFkZXNUb0dldCA9IFsKICAgICAgICAgICAgICBbIlN0cmVhayBCb251cyIsIDIsIDEwMDAwXSwKICAgICAgICAgICAgICBbIk1vbmV5IFBlciBRdWVzdGlvbiIsIDMsIDUwMDBdLAogICAgICAgICAgICAgIFsiU3RyZWFrIEJvbnVzIiwgMywgMTAwMDAwXSwKICAgICAgICAgICAgICBbIk11bHRpcGxpZXIiLCAzLCAxNTAwMDBdLAogICAgICAgICAgICAgIFsiU3RyZWFrIEJvbnVzIiwgNCwgMTAwMDAwMF0sCiAgICAgICAgICAgICAgWyJNdWx0aXBsaWVyIiwgNCwgMTAwMDAwMF0sCiAgICAgICAgICAgICAgWyJNb25leSBQZXIgUXVlc3Rpb24iLCA1LCA1MDAwMDAwXSwKICAgICAgICAgICAgICBbIlN0cmVhayBCb251cyIsIDUsIDEwMDAwMDAwXSwKICAgICAgICAgICAgICBbIk11bHRpcGxpZXIiLCA1LCA2MDAwMDAwXSwKICAgICAgICAgICAgICBbIk1vbmV5IFBlciBRdWVzdGlvbiIsIDYsIDM3NTAwMDAwXSwKICAgICAgICAgICAgICBbIk11bHRpcGxpZXIiLCA2LCA0MjUwMDAwMF0sCiAgICAgICAgICAgICAgWyJTdHJlYWsgQm9udXMiLCA2LCAxMDAwMDAwMDBdLAogICAgICAgICAgICAgIFsiU3RyZWFrIEJvbnVzIiwgNywgMTAwMDAwMDAwMF0sCiAgICAgICAgICAgICAgWyJTdHJlYWsgQm9udXMiLCA4LCAxMDAwMDAwMDAwMF0sCiAgICAgICAgICAgICAgWyJNdWx0aXBsaWVyIiwgNywgMzUwMDAwMDAwXSwKICAgICAgICAgICAgICBbIk1vbmV5IFBlciBRdWVzdGlvbiIsIDksIDUwMDAwMDAwMDBdLAogICAgICAgICAgICAgIFsiTXVsdGlwbGllciIsIDgsIDMyNTAwMDAwMDBdLAogICAgICAgICAgICAgIFsiU3RyZWFrIEJvbnVzIiwgOSwgMTAwMDAwMDAwMDAwXSwKICAgICAgICAgICAgICBbIk11bHRpcGxpZXIiLCA5LCAzMjUwMDAwMDAwMF0sCiAgICAgICAgICAgICAgWyJTdHJlYWsgQm9udXMiLCAxMCwgMTAwMDAwMDAwMDAwMF0sCiAgICAgICAgICAgICAgWyJNb25leSBQZXIgUXVlc3Rpb24iLCAxMCwgNTAwMDAwMDAwMDBdLAogICAgICAgICAgICAgIFsiTXVsdGlwbGllciIsIDEwLCA1MDAwMDAwMDAwMDBdCiAgICAgICAgICBdOwogICAgICB9CiAgfQogIGZ1bmN0aW9uIFJpY2hNb2RlKCkgewogICAgICByZXR1cm4gbmV3IFJpY2hNb2RlQ2xhc3MoKTsKICB9CgogIGNsYXNzIFRydXN0Tm9PbmVDbGFzcyB7CiAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgdGhpcy5uYW1lID0gIlRydXN0IE5vIE9uZSBTY3JpcHQiOwogICAgICAgICAgdGhpcy5wZW9wbGUgPSBbXTsKICAgICAgfQogICAgICBpbml0KGNoZWF0KSB7CiAgICAgICAgICB0aGlzLmNoZWF0ID0gY2hlYXQ7CiAgICAgICAgICAvLyBhZGQgdGhlIGltcG9zdGVyIGRpc3BsYXkKICAgICAgICAgIGxldCBncm91cCA9IGNoZWF0Lmh1ZC5jcmVhdGVNZW51KCJDaGVhdHMgZm9yIGdhbWVtb2RlcyIpLmNyZWF0ZUdyb3VwKCJUcnVzdCBObyBPbmUiKTsKICAgICAgICAgIGxldCB0ZXh0ID0gZ3JvdXAuYWRkRWxlbWVudCgidGV4dCIsIHsKICAgICAgICAgICAgICB0ZXh0OiAiSW1wb3N0ZXJzOiBXYWl0aW5nLi4uIChvbmx5IHdvcmtzIGlmIHlvdSBkb24ndCBqb2luIG1pZC1nYW1lKSIKICAgICAgICAgIH0pOwogICAgICAgICAgY2hlYXQuc29ja2V0SGFuZGxlci5hZGRFdmVudExpc3RlbmVyKCJyZWNpZXZlTWVzc2FnZSIsIChlKSA9PiB7CiAgICAgICAgICAgICAgaWYgKHRoaXMuY2hlYXQuc29ja2V0SGFuZGxlci50cmFuc3BvcnRUeXBlICE9ICJibHVlYm9hdCIpCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBpZiAoZS5kZXRhaWwua2V5ID09ICJJTVBPU1RFUl9NT0RFX1BFT1BMRSIpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5wZW9wbGUgPSBlLmRldGFpbC5kYXRhOwogICAgICAgICAgICAgICAgICBsZXQgaW1wb3N0ZXJzID0gdGhpcy5wZW9wbGUuZmlsdGVyKChwZXJzb24pID0+IHBlcnNvbi5yb2xlID09ICJpbXBvc3RlciIpOwogICAgICAgICAgICAgICAgICB0ZXh0LnRleHQgPSBgSW1wb3N0ZXIocyk6ICR7aW1wb3N0ZXJzLm1hcCgocGVyc29uKSA9PiBwZXJzb24ubmFtZSkuam9pbigiLCAiKX1gOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICB9CiAgfQogIGZ1bmN0aW9uIFRydXN0Tm9PbmUoKSB7CiAgICAgIHJldHVybiBuZXcgVHJ1c3ROb09uZUNsYXNzKCk7CiAgfQoKICBjb25zdCBodWRBZGRpdGlvbiQxID0gewogICAgICBtZW51czogWwogICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJHZW5lcmFsIENoZWF0cyIsCiAgICAgICAgICAgICAgZWxlbWVudHM6IFsKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgdHlwZTogInRvZ2dsZSIsCiAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEVuYWJsZWQ6ICJTdG9wIGluc3RhbnQgdXNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RGlzYWJsZWQ6ICJJbnN0YW50IHVzZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBydW5GdW5jdGlvbjogInNldEluc3RhbnRVc2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgIGtleWJpbmQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAga2V5YmluZElkOiAiaW5zdGFudFVzZSIKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0KICAgICAgICAgIH0KICAgICAgXQogIH07CiAgY2xhc3MgSW5zdGFudHVzZUNsYXNzIHsKICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICB0aGlzLm5hbWUgPSAiSW5zdGFudHVzZSI7CiAgICAgICAgICB0aGlzLmh1ZEFkZGl0aW9uID0gaHVkQWRkaXRpb24kMTsKICAgICAgICAgIHRoaXMuaW5zdGFudFVzZUVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgdGhpcy5mdW5jcyA9IG5ldyBNYXAoWwogICAgICAgICAgICAgIFsic2V0SW5zdGFudFVzZSIsIChlbmFibGVkKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluc3RhbnRVc2VFbmFibGVkID0gZW5hYmxlZDsKICAgICAgICAgICAgICAgICAgfV0KICAgICAgICAgIF0pOwogICAgICB9CiAgICAgIGluaXQoY2hlYXQpIHsKICAgICAgICAgIGxldCBzZWxmID0gdGhpczsKICAgICAgICAgIGNoZWF0LmtleWJpbmRNYW5hZ2VyLnJlZ2lzdGVyQmluZCh7CiAgICAgICAgICAgICAga2V5czogbmV3IFNldChbImVudGVyIl0pLAogICAgICAgICAgICAgIGV4Y2x1c2l2ZTogZmFsc2UsCiAgICAgICAgICAgICAgY2FsbGJhY2soKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYudXNlTmVhcmVzdCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICB9CiAgICAgIHVzZU5lYXJlc3QoKSB7CiAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZiwgX2csIF9oLCBfaiwgX2s7CiAgICAgICAgICBsZXQgZGV2aWNlcyA9IChfZSA9IChfZCA9IChfYyA9IChfYiA9IChfYSA9IHVuc2FmZVdpbmRvdyA9PT0gbnVsbCB8fCB1bnNhZmVXaW5kb3cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVuc2FmZVdpbmRvdy5zdG9yZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5waGFzZXIpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5zY2VuZSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLndvcmxkTWFuYWdlcikgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmRldmljZXMpID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5kZXZpY2VzSW5WaWV3OwogICAgICAgICAgbGV0IGJvZHkgPSAoX2ggPSAoX2cgPSAoX2YgPSB1bnNhZmVXaW5kb3cgPT09IG51bGwgfHwgdW5zYWZlV2luZG93ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1bnNhZmVXaW5kb3cuc3RvcmVzKSA9PT0gbnVsbCB8fCBfZiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2YucGhhc2VyKSA9PT0gbnVsbCB8fCBfZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2cubWFpbkNoYXJhY3RlcikgPT09IG51bGwgfHwgX2ggPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9oLmJvZHk7CiAgICAgICAgICBpZiAoIWRldmljZXMgfHwgIWJvZHkpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgbGV0IGNsb3Nlc3QgPSBudWxsOwogICAgICAgICAgbGV0IGNsb3Nlc3REaXN0YW5jZSA9IEluZmluaXR5OwogICAgICAgICAgZm9yIChsZXQgZGV2aWNlIG9mIGRldmljZXMpIHsKICAgICAgICAgICAgICBpZiAoZGV2aWNlLmludGVyYWN0aXZlWm9uZXMuem9uZXMubGVuZ3RoID09IDApCiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIGxldCBkaXN0YW5jZSA9IE1hdGguc3FydChNYXRoLnBvdyhkZXZpY2UueCAtIGJvZHkueCwgMikgKyBNYXRoLnBvdyhkZXZpY2UueSAtIGJvZHkueSwgMikpOwogICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IGNsb3Nlc3REaXN0YW5jZSkgewogICAgICAgICAgICAgICAgICBjbG9zZXN0ID0gZGV2aWNlOwogICAgICAgICAgICAgICAgICBjbG9zZXN0RGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIWNsb3Nlc3QpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgKF9rID0gKF9qID0gY2xvc2VzdCA9PT0gbnVsbCB8fCBjbG9zZXN0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjbG9zZXN0LmludGVyYWN0aXZlWm9uZXMpID09PSBudWxsIHx8IF9qID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfai5vbkludGVyYWN0aW9uKSA9PT0gbnVsbCB8fCBfayA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2suY2FsbChfaik7CiAgICAgIH0KICB9CiAgZnVuY3Rpb24gSW5zdGFudHVzZSgpIHsKICAgICAgcmV0dXJuIG5ldyBJbnN0YW50dXNlQ2xhc3MoKTsKICB9CgogIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4KCiAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55CiAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLgoKICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSAogIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQogIEFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCwKICBJTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST00KICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUgogIE9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1IKICBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLgogICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovCgogIGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHsKICAgICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9CiAgICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQogICAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQogICAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH0KICAgICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTsKICAgICAgfSk7CiAgfQoKICBjb25zdCBwdXJjaGFzZXMgPSB7CiAgICAgICJDYXB0dXJlIFRoZSBGbGFnIjogWwogICAgICAgICAgewogICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiU3BlZWQgVXBncmFkZSIsCiAgICAgICAgICAgICAgc2VsZWN0b3I6IHsKICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1OYW1lOiAiU3BlZWQgVXBncmFkZSIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICByZXVzYWJsZTogZmFsc2UKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJFZmZpY2llbmN5IFVwZ3JhZGUiLAogICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgIGdyYW50ZWRJdGVtTmFtZTogIkVmZmljaWVuY3kgVXBncmFkZSIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICByZXVzYWJsZTogZmFsc2UKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJFbmVyZ3kgUGVyIFF1ZXN0aW9uIFVwZ3JhZGUiLAogICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgIGdyYW50ZWRJdGVtTmFtZTogIkVuZXJneSBQZXIgUXVlc3Rpb24gVXBncmFkZSIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICByZXVzYWJsZTogZmFsc2UKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJJbnZpc2FCaXRzIiwKICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICBncmFudGVkSXRlbUlkOiAic2lsdmVyLW9yZSIKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHJldXNhYmxlOiB0cnVlCiAgICAgICAgICB9CiAgICAgIF0sCiAgICAgICJUYWciOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJTcGVlZCBVcGdyYWRlIiwKICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICBncmFudGVkSXRlbU5hbWU6ICJTcGVlZCBVcGdyYWRlIgogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgcmV1c2FibGU6IGZhbHNlCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiRWZmaWNpZW5jeSBVcGdyYWRlIiwKICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICBncmFudGVkSXRlbU5hbWU6ICJFZmZpY2llbmN5IFVwZ3JhZGUiCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICByZXVzYWJsZTogZmFsc2UKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJFbmVyZ3kgUGVyIFF1ZXN0aW9uIFVwZ3JhZGUiLAogICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgIGdyYW50ZWRJdGVtTmFtZTogIkVuZXJneSBQZXIgUXVlc3Rpb24gVXBncmFkZSIKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHJldXNhYmxlOiBmYWxzZQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIkVuZHVyYW5jZSBVcGdyYWRlIiwKICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICBncmFudGVkSXRlbU5hbWU6ICJFbmR1cmFuY2UgVXBncmFkZSIKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHJldXNhYmxlOiBmYWxzZQogICAgICAgICAgfQogICAgICBdLAogICAgICAiU25vd2JyYXdsIjogWwogICAgICAgICAgewogICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiTWVkIFBhY2siLAogICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgIGdyYW50ZWRJdGVtSWQ6ICJtZWRwYWNrIgogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgcmV1c2FibGU6IHRydWUKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJTaGllbGQgQ2FuIiwKICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICBncmFudGVkSXRlbUlkOiAic2hpZWxkLWNhbiIKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHJldXNhYmxlOiB0cnVlCiAgICAgICAgICB9CiAgICAgIF0sCiAgICAgICJPbmUgV2F5IE91dCI6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIk1lZCBQYWNrIiwKICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICBncmFudGVkSXRlbUlkOiAibWVkcGFjayIKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHJldXNhYmxlOiB0cnVlCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiU2hpZWxkIENhbiIsCiAgICAgICAgICAgICAgc2VsZWN0b3I6IHsKICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1JZDogInNoaWVsZC1jYW4iCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICByZXVzYWJsZTogdHJ1ZQogICAgICAgICAgfQogICAgICBdLAogICAgICAiRmFybWNoYWluIjogewogICAgICAgICAgIlNlZWRzIjogWwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJDb3JuIFNlZWQiLAogICAgICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1JZDogInllbGxvdy1zZWVkIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICByZXVzYWJsZTogdHJ1ZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIldoZWF0IFNlZWQiLAogICAgICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1JZDogInRhbi1zZWVkIiwKICAgICAgICAgICAgICAgICAgICAgIGdyYW50QWN0aW9uOiAiR3JhbnQgSXRlbSIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcmV1c2FibGU6IHRydWUKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJQb3RhdG8gU2VlZCIsCiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgICAgICBncmFudGVkSXRlbUlkOiAiYnJvd24tc2VlZCIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcmV1c2FibGU6IHRydWUKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJHcmFwZSBTZWVkIiwKICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IHsKICAgICAgICAgICAgICAgICAgICAgIGdyYW50ZWRJdGVtSWQ6ICJwdXJwbGUtc2VlZCIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcmV1c2FibGU6IHRydWUKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJSYXNwYmVycnkgU2VlZCIsCiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgICAgICBncmFudGVkSXRlbUlkOiAibWFnZW50YS1zZWVkIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICByZXVzYWJsZTogdHJ1ZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIldhdGVybWVsb24gU2VlZCIsCiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgICAgICBncmFudGVkSXRlbUlkOiAiZ3JlZW4tc2VlZCIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcmV1c2FibGU6IHRydWUKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJDb2ZmZWUgQmVhbiIsCiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgICAgICBncmFudGVkSXRlbUlkOiAiYnJvbnplLXNlZWQiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHJldXNhYmxlOiB0cnVlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiT3JhbmdlIFNlZWQiLAogICAgICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1JZDogIm9yYW5nZS1zZWVkIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICByZXVzYWJsZTogdHJ1ZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIkdpbWJlcnJ5IFNlZWQiLAogICAgICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1JZDogImdvbGQtc2VlZCIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcmV1c2FibGU6IHRydWUKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJDYXNoIEJlcnJ5IFNlZWQiLAogICAgICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1JZDogImRhcmstZ3JlZW4tc2VlZCIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcmV1c2FibGU6IHRydWUKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJQZXBwZXIgU2VlZCIsCiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgICAgICBncmFudGVkSXRlbUlkOiAicmVkLXNlZWQiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHJldXNhYmxlOiB0cnVlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiRW5lcmd5IEJhciBTZWVkIiwKICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IHsKICAgICAgICAgICAgICAgICAgICAgIGdyYW50ZWRJdGVtSWQ6ICJibHVlLXNlZWQiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHJldXNhYmxlOiB0cnVlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiTG90dGVyeSBUaWNrZXQgU2VlZCIsCiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgICAgICBncmFudGVkSXRlbUlkOiAidGVhbC1zZWVkIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICByZXVzYWJsZTogdHJ1ZQogICAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICAiU2VlZCBVbmxvY2tzIjogWwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICJXaGVhdCBTZWVkIFVubG9jayIsCiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgICAgICBncmFudGVkSXRlbU5hbWU6ICJXaGVhdCBTZWVkIFVubG9jayIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcmV1c2FibGU6IGZhbHNlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiUG90YXRvIFNlZWQgVW5sb2NrIiwKICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IHsKICAgICAgICAgICAgICAgICAgICAgIGdyYW50ZWRJdGVtTmFtZTogIlBvdGF0byBTZWVkIFVubG9jayIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcmV1c2FibGU6IGZhbHNlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiR3JhcGUgU2VlZCBVbmxvY2siLAogICAgICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1OYW1lOiAiR3JhcGUgU2VlZCBVbmxvY2siCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHJldXNhYmxlOiBmYWxzZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIlJhc3BiZXJyeSBTZWVkIFVubG9jayIsCiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgICAgICBncmFudGVkSXRlbU5hbWU6ICJSYXNwYmVycnkgU2VlZCBVbmxvY2siCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHJldXNhYmxlOiBmYWxzZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIldhdGVybWVsb24gU2VlZCBVbmxvY2siLAogICAgICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1OYW1lOiAiV2F0ZXJtZWxvbiBTZWVkIFVubG9jayIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcmV1c2FibGU6IGZhbHNlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAiQ29mZmVlIEJlYW4gU2VlZCBVbmxvY2siLAogICAgICAgICAgICAgICAgICBzZWxlY3RvcjogewogICAgICAgICAgICAgICAgICAgICAgZ3JhbnRlZEl0ZW1OYW1lOiAiQ29mZmVlIEJlYW4gU2VlZCBVbmxvY2siCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHJldXNhYmxlOiBmYWxzZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIk9yYW5nZSBTZWVkIFVubG9jayIsCiAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB7CiAgICAgICAgICAgICAgICAgICAgICBncmFudGVkSXRlbU5hbWU6ICJPcmFuZ2UgU2VlZCBVbmxvY2siCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHJldXNhYmxlOiBmYWxzZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIkdpbWJlcnJ5IFNlZWQgVW5sb2NrIiwKICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IHsKICAgICAgICAgICAgICAgICAgICAgIGdyYW50ZWRJdGVtTmFtZTogIkdpbWJlcnJ5IFNlZWQgVW5sb2NrIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICByZXVzYWJsZTogZmFsc2UKICAgICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgIH0KICB9OwoKICBjbGFzcyBJbnN0YXB1cmNoYXNlcnNDbGFzcyB7CiAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgdGhpcy5uYW1lID0gIlB1cmNoYXNlcnMiOwogICAgICB9CiAgICAgIGluaXQoY2hlYXQpIHsKICAgICAgICAgIGNoZWF0LmFkZEV2ZW50TGlzdGVuZXIoImdhbWVMb2FkZWQiLCAoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVCdXR0b25zKGNoZWF0KTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICAgIGNyZWF0ZUJ1dHRvbnMoY2hlYXQpIHsKICAgICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2U7CiAgICAgICAgICBsZXQgZGV2aWNlcyA9IChfZSA9IChfZCA9IChfYyA9IChfYiA9IChfYSA9IHVuc2FmZVdpbmRvdyA9PT0gbnVsbCB8fCB1bnNhZmVXaW5kb3cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVuc2FmZVdpbmRvdy5zdG9yZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5waGFzZXIpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5zY2VuZSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLndvcmxkTWFuYWdlcikgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmRldmljZXMpID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5hbGxEZXZpY2VzOwogICAgICAgICAgaWYgKCFkZXZpY2VzKSB7CiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmNyZWF0ZUJ1dHRvbnMoY2hlYXQpLCAxMDAwKTsgLy8gdHJ5IGFnYWluIGluIGNhc2Ugc29tZXRoaW5nIHdlbnQgd3JvbmcKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBmb3IgKGxldCBnYW1lbW9kZSBpbiBwdXJjaGFzZXMpIHsKICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUdhbWVtb2RlQnV0dG9ucyhnYW1lbW9kZSwgcHVyY2hhc2VzW2dhbWVtb2RlXSwgY2hlYXQuaHVkLmNyZWF0ZU1lbnUoIkNoZWF0cyBmb3IgZ2FtZW1vZGVzIikpOwogICAgICAgICAgfQogICAgICB9CiAgICAgIGNyZWF0ZUdhbWVtb2RlQnV0dG9ucyhnYW1lbW9kZSwgY29udGVudCwgcm9vdEdyb3VwKSB7CiAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZiwgX2c7CiAgICAgICAgICBsZXQgZGV2aWNlcyA9IChfZSA9IChfZCA9IChfYyA9IChfYiA9IChfYSA9IHVuc2FmZVdpbmRvdyA9PT0gbnVsbCB8fCB1bnNhZmVXaW5kb3cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVuc2FmZVdpbmRvdy5zdG9yZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5waGFzZXIpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5zY2VuZSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLndvcmxkTWFuYWdlcikgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmRldmljZXMpID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5hbGxEZXZpY2VzOwogICAgICAgICAgbGV0IGdyb3VwID0gcm9vdEdyb3VwLmNyZWF0ZUdyb3VwKGdhbWVtb2RlKTsKICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShjb250ZW50KSkgewogICAgICAgICAgICAgIGZvciAobGV0IFtuYW1lLCBtZW51XSBvZiBPYmplY3QuZW50cmllcyhjb250ZW50KSkgewogICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUdhbWVtb2RlQnV0dG9ucyhuYW1lLCBtZW51LCBncm91cCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGZvciAobGV0IHB1cmNoYXNlIG9mIGNvbnRlbnQpIHsKICAgICAgICAgICAgICBsZXQgeyBzZWxlY3RvciwgZGlzcGxheU5hbWUsIHJldXNhYmxlIH0gPSBwdXJjaGFzZTsKICAgICAgICAgICAgICAvLyBmaWx0ZXIgZGV2aWNlcyBieSBzZWxlY3RvcgogICAgICAgICAgICAgIGxldCBwdXJjaGFzZURldmljZXMgPSBkZXZpY2VzLmZpbHRlcigoZGV2aWNlKSA9PiB7CiAgICAgICAgICAgICAgICAgIHZhciBfYTsKICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoZXMgPSB0cnVlOwogICAgICAgICAgICAgICAgICBmb3IgKGxldCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoc2VsZWN0b3IpKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoKChfYSA9IGRldmljZS5vcHRpb25zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Fba2V5XSkgIT0gdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXM7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgaWYgKHB1cmNoYXNlRGV2aWNlcy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgLy8gc29ydCB0aGVtIGJ5IHByaWNlCiAgICAgICAgICAgICAgcHVyY2hhc2VEZXZpY2VzLnNvcnQoKGEsIGIpID0+IHsgdmFyIF9hLCBfYjsgcmV0dXJuICgoX2EgPSBhID09PSBudWxsIHx8IGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGEub3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmFtb3VudE9mUmVxdWlyZWRJdGVtKSAtICgoX2IgPSBiID09PSBudWxsIHx8IGIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGIub3B0aW9ucykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmFtb3VudE9mUmVxdWlyZWRJdGVtKTsgfSk7CiAgICAgICAgICAgICAgbGV0IGJ1dHRvblRleHQgPSBgUHVyY2hhc2UgJHtkaXNwbGF5TmFtZX0gKCR7KF9nID0gKF9mID0gcHVyY2hhc2VEZXZpY2VzWzBdKSA9PT0gbnVsbCB8fCBfZiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Yub3B0aW9ucykgPT09IG51bGwgfHwgX2cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9nLmFtb3VudE9mUmVxdWlyZWRJdGVtfSlgOwogICAgICAgICAgICAgIGxldCBidXR0b24gPSBncm91cC5hZGRFbGVtZW50KCdidXR0b24nLCB7CiAgICAgICAgICAgICAgICAgIHRleHQ6IGJ1dHRvblRleHQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBfaCwgX2osIF9rLCBfbCwgX20sIF9vLCBfcDsKICAgICAgICAgICAgICAgICAgaWYgKCEoKF9qID0gKF9oID0gcHVyY2hhc2VEZXZpY2VzWzBdKSA9PT0gbnVsbCB8fCBfaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2guaW50ZXJhY3RpdmVab25lcykgPT09IG51bGwgfHwgX2ogPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9qLm9uSW50ZXJhY3Rpb24pKSB7CiAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGhhcHBlbmVkIHRvIG1lIGEgZmV3IHRpbWVzIGFuZCBJIGRvbid0IGtub3cgd2h5LCBqdXN0IHJlLWdldCB0aGUgZGV2aWNlcwogICAgICAgICAgICAgICAgICAgICAgcHVyY2hhc2VEZXZpY2VzID0gcHVyY2hhc2VEZXZpY2VzLm1hcCgoZGV2aWNlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRldmljZXMuZmluZCgoZCkgPT4gZC5pZCA9PSBkZXZpY2UuaWQpOwogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgKF9tID0gKF9sID0gKF9rID0gcHVyY2hhc2VEZXZpY2VzWzBdKSA9PT0gbnVsbCB8fCBfayA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2suaW50ZXJhY3RpdmVab25lcykgPT09IG51bGwgfHwgX2wgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9sLm9uSW50ZXJhY3Rpb24pID09PSBudWxsIHx8IF9tID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbS5jYWxsKF9sKTsKICAgICAgICAgICAgICAgICAgaWYgKHJldXNhYmxlKQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAvLyBjaGVjayB3aGV0aGVyIGl0IHdhcyBzdWNjZXNzZnVsbHkgcHVyY2hhc2VkCiAgICAgICAgICAgICAgICAgIC8vIHdhaXQgNTAwbXMgZm9yIHRoZSBwdXJjaGFzZSB0byBnbyB0aHJvdWdoCiAgICAgICAgICAgICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwMCkpOwogICAgICAgICAgICAgICAgICBpZiAocHVyY2hhc2VEZXZpY2VzWzBdLnN0YXRlLmFjdGl2ZSkKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gaXQgd2Fzbid0IHB1cmNoYXNlZAogICAgICAgICAgICAgICAgICBwdXJjaGFzZURldmljZXMuc2hpZnQoKTsKICAgICAgICAgICAgICAgICAgaWYgKHB1cmNoYXNlRGV2aWNlcy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgYnV0dG9uIHRleHQKICAgICAgICAgICAgICAgICAgYnV0dG9uVGV4dCA9IGBQdXJjaGFzZSAke2Rpc3BsYXlOYW1lfSAoJHsoX3AgPSAoX28gPSBwdXJjaGFzZURldmljZXNbMF0pID09PSBudWxsIHx8IF9vID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfby5vcHRpb25zKSA9PT0gbnVsbCB8fCBfcCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3AuYW1vdW50T2ZSZXF1aXJlZEl0ZW19KWA7CiAgICAgICAgICAgICAgICAgIGJ1dHRvbi50ZXh0ID0gYnV0dG9uVGV4dDsKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICB9CiAgICAgIH0KICB9CiAgZnVuY3Rpb24gSW5zdGFwdXJjaGFzZXJzKCkgewogICAgICByZXR1cm4gbmV3IEluc3RhcHVyY2hhc2Vyc0NsYXNzKCk7CiAgfQoKICBjb25zdCBodWRBZGRpdGlvbiA9IHsKICAgICAgbWVudXM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiQ2hlYXRzIGZvciBnYW1lbW9kZXMiLAogICAgICAgICAgICAgIGdyb3VwczogWwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAiRmFybWNoYWluIiwKICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAidG9nZ2xlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEVuYWJsZWQ6ICJTdG9wIGF1dG8gaGFydmVzdGluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RGlzYWJsZWQ6ICJTdGFydCBhdXRvIGhhcnZlc3RpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5YmluZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleWJpbmRJZDogImF1dG9IYXJ2ZXN0aW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5GdW5jdGlvbjogInNldEF1dG9IYXJ2ZXN0IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ0b2dnbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RW5hYmxlZDogIlN0b3AgYXV0byBwbGFudGluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RGlzYWJsZWQ6ICJTdGFydCBhdXRvIHBsYW50aW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleWJpbmQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXliaW5kSWQ6ICJhdXRvUGxhbnRpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5GdW5jdGlvbjogInNldEF1dG9QbGFudCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0KICAgICAgICAgIH0KICAgICAgXQogIH07CiAgY29uc3Qgc2VlZFJhbmtpbmcgPSBbCiAgICAgICd5ZWxsb3ctc2VlZCcsCiAgICAgICd0YW4tc2VlZCcsCiAgICAgICdicm93bi1zZWVkJywKICAgICAgJ3B1cnBsZS1zZWVkJywKICAgICAgJ21hZ2VudGEtc2VlZCcsCiAgICAgICdncmVlbi1zZWVkJywKICAgICAgJ2Jyb256ZS1zZWVkJywKICAgICAgJ29yYW5nZS1zZWVkJywKICAgICAgJ2dvbGQtc2VlZCcsCiAgICAgICdkYXJrLWdyZWVuLXNlZWQnLAogICAgICAncmVkLXNlZWQnLAogICAgICAnYmx1ZS1zZWVkJywKICAgICAgJ3RlYWwtc2VlZCcKICBdOwogIGNsYXNzIEZhcm1jaGFpbkNsYXNzIHsKICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICB0aGlzLm5hbWUgPSAiRmFybWNoYWluIjsKICAgICAgICAgIHRoaXMuaHVkQWRkaXRpb24gPSBodWRBZGRpdGlvbjsKICAgICAgICAgIHRoaXMuYXV0b0hhcnZlc3RpbmcgPSB0cnVlOwogICAgICAgICAgdGhpcy5hdXRvUGxhbnRpbmcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZnVuY3MgPSBuZXcgTWFwKFsKICAgICAgICAgICAgICBbInNldEF1dG9IYXJ2ZXN0IiwgKGVuYWJsZWQpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXV0b0hhcnZlc3RpbmcgPSBlbmFibGVkOwogICAgICAgICAgICAgICAgICB9XSwKICAgICAgICAgICAgICBbInNldEF1dG9QbGFudCIsIChlbmFibGVkKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dG9QbGFudGluZyA9IGVuYWJsZWQ7CiAgICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICBdKTsKICAgICAgfQogICAgICBpbml0KGNoZWF0KSB7CiAgICAgICAgICAvLyBzZXQgdXAgYXV0byBoYXJ2ZXN0CiAgICAgICAgICBjaGVhdC5zb2NrZXRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoInJlY2lldmVDaGFuZ2VzIiwgKGUpID0+IHsKICAgICAgICAgICAgICBsZXQgY2hhbmdlcyA9IGUuZGV0YWlsOwogICAgICAgICAgICAgIGZvciAobGV0IGNoYW5nZSBvZiBjaGFuZ2VzKSB7CiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiBjaGFuZ2UuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKCFrZXkuZW5kc1dpdGgoInN0YXR1cyIpIHx8IGNoYW5nZS5kYXRhW2tleV0gIT0gImF2YWlsYWJsZUZvckNvbGxlY3Rpb24iKQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgLy8gaGFydmVzdCBpdAogICAgICAgICAgICAgICAgICAgICAgbGV0IHBhY2tldCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6ICJjb2xsZWN0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogY2hhbmdlLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHVuZGVmaW5lZAogICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgIGNoZWF0LnNvY2tldEhhbmRsZXIuc2VuZERhdGEoIk1FU1NBR0VfRk9SX0RFVklDRSIsIHBhY2tldCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIGNoZWF0LmFkZEV2ZW50TGlzdGVuZXIoImdhbWVMb2FkZWQiLCAoKSA9PiB7CiAgICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nOwogICAgICAgICAgICAgIGxldCBkZXZpY2VzID0gKF9lID0gKF9kID0gKF9jID0gKF9iID0gKF9hID0gdW5zYWZlV2luZG93ID09PSBudWxsIHx8IHVuc2FmZVdpbmRvdyA9PT0gdm9pZCAwID8gdm9pZCAwIDogdW5zYWZlV2luZG93LnN0b3JlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBoYXNlcikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnNjZW5lKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Mud29ybGRNYW5hZ2VyKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QuZGV2aWNlcykgPT09IG51bGwgfHwgX2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lLmFsbERldmljZXM7CiAgICAgICAgICAgICAgbGV0IHBsb3RzID0gZGV2aWNlcy5maWx0ZXIoKGRldmljZSkgPT4gZGV2aWNlLm9wdGlvbnMuc3R5bGUgPT0gInBsYW50Iik7CiAgICAgICAgICAgICAgbGV0IHJlY2lwaWVEZXZpY2VzID0ge307CiAgICAgICAgICAgICAgZm9yIChsZXQgZGV2aWNlIG9mIGRldmljZXMpIHsKICAgICAgICAgICAgICAgICAgaWYgKCFzZWVkUmFua2luZy5pbmNsdWRlcygoX2YgPSBkZXZpY2Uub3B0aW9ucykgPT09IG51bGwgfHwgX2YgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9mLmluZ3JlZGllbnQxSXRlbSkpCiAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgcmVjaXBpZURldmljZXNbKF9nID0gZGV2aWNlLm9wdGlvbnMpID09PSBudWxsIHx8IF9nID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZy5pbmdyZWRpZW50MUl0ZW1dID0gZGV2aWNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBzZXQgdXAgYXV0byBwbGFudAogICAgICAgICAgICAgIHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2M7CiAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5hdXRvUGxhbnRpbmcpCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIGxldCBpbnZlbnRvcnkgPSAoX2MgPSAoX2IgPSAoX2EgPSB1bnNhZmVXaW5kb3cgPT09IG51bGwgfHwgdW5zYWZlV2luZG93ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1bnNhZmVXaW5kb3cuc3RvcmVzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubWUpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5pbnZlbnRvcnkpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5zbG90czsKICAgICAgICAgICAgICAgICAgaWYgKCFpbnZlbnRvcnkpCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIC8vIGZpbmQgdGhlIG1vc3QgdmFsdWFibGUgc2VlZCBpbiB0aGUgaW52ZW50b3J5CiAgICAgICAgICAgICAgICAgIGxldCBtb3N0VmFsdWFibGVTZWVkID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgICBmb3IgKGxldCBzZWVkIG9mIHNlZWRSYW5raW5nKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoaW52ZW50b3J5LmhhcyhzZWVkKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIG1vc3RWYWx1YWJsZVNlZWQgPSBzZWVkOwogICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmICghbW9zdFZhbHVhYmxlU2VlZCkKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgLy8gcGxhbnQgdGhlIHNlZWQgaW4gdGhlIGxhc3QgaWRsZSBwbG90CiAgICAgICAgICAgICAgICAgIGxldCBwbGFudFBsb3QgPSBwbG90cy5maW5kTGFzdCgocGxvdCkgPT4gcGxvdC5zdGF0ZS5zdGF0dXMgPT0gImlkbGUiKTsKICAgICAgICAgICAgICAgICAgY2hlYXQuc29ja2V0SGFuZGxlci5zZW5kRGF0YSgiTUVTU0FHRV9GT1JfREVWSUNFIiwgewogICAgICAgICAgICAgICAgICAgICAga2V5OiAiY3JhZnQiLAogICAgICAgICAgICAgICAgICAgICAgZGV2aWNlSWQ6IHBsYW50UGxvdC5pZCwKICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGU6IHJlY2lwaWVEZXZpY2VzW21vc3RWYWx1YWJsZVNlZWRdLmlkCiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0sIDUwKTsKICAgICAgICAgIH0pOwogICAgICB9CiAgfQogIGZ1bmN0aW9uIEZhcm1jaGFpbigpIHsKICAgICAgcmV0dXJuIG5ldyBGYXJtY2hhaW5DbGFzcygpOwogIH0KCiAgLy8gaW1wb3J0IHsgQm90Q3JlYXRvciB9IGZyb20gJy4vc2NyaXB0cy9nZW5lcmFsL2JvdGNyZWF0b3InOwogIGNsYXNzIENoZWF0IGV4dGVuZHMgRXZlbnRUYXJnZXQgewogICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgIHN1cGVyKCk7CiAgICAgICAgICB0aGlzLmtleWJpbmRNYW5hZ2VyID0gbmV3IEtleWJpbmRNYW5hZ2VyKCk7CiAgICAgICAgICB0aGlzLmZ1bmNzID0gbmV3IE1hcCgpOwogICAgICAgICAgdGhpcy5zY3JpcHRzID0gW107CiAgICAgICAgICAvLyBhZGQgY2hlYXQgdG8gdGhlIGdsb2JhbCBzY29wZQogICAgICAgICAgd2luZG93LmNoZWF0ID0gdGhpczsKICAgICAgICAgIHRoaXMuc29ja2V0SGFuZGxlciA9IG5ldyBTb2NrZXRIYW5kbGVyKHRoaXMpOwogICAgICAgICAgdGhpcy5zb2NrZXRIYW5kbGVyLmFkZEV2ZW50TGlzdGVuZXIoInNvY2tldCIsIChlKSA9PiB7CiAgICAgICAgICAgICAgY2hlYXQubG9nKCJTb2NrZXQgY29ubmVjdGVkIiwgZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuc29ja2V0SGFuZGxlci5nZXRTb2NrZXQoKTsKICAgICAgICAgIHRoaXMuaHVkID0gbmV3IEh1ZCh0aGlzKTsKICAgICAgICAgIC8vIGluaXRpYWxpemUgYW55IHNjcmlwdHMKICAgICAgICAgIHRoaXMuc2NyaXB0cyA9IFsKICAgICAgICAgICAgICBEZXZ0b29scygpLAogICAgICAgICAgICAgIEluc3RhbnR1c2UoKSwKICAgICAgICAgICAgICBBdXRvYW5zd2VyKCksCiAgICAgICAgICAgICAgQ29zbWV0aWNwaWNrZXIoKSwKICAgICAgICAgICAgICBQbGF5ZXJoaWdobGlnaHRlcigpLAogICAgICAgICAgICAgIEZyZWVjYW0oKSwKICAgICAgICAgICAgICBDbGFzc2ljKCksCiAgICAgICAgICAgICAgUmljaE1vZGUoKSwKICAgICAgICAgICAgICBUcnVzdE5vT25lKCksCiAgICAgICAgICAgICAgRmFybWNoYWluKCksCiAgICAgICAgICAgICAgSW5zdGFwdXJjaGFzZXJzKCkKICAgICAgICAgICAgICAvLyBCb3RDcmVhdG9yKCkKICAgICAgICAgIF07CiAgICAgICAgICB0aGlzLmluaXRTY3JpcHRzKCk7CiAgICAgICAgICB0aGlzLndhaXRGb3JMb2FkKCk7CiAgICAgIH0KICAgICAgd2FpdEZvckxvYWQoKSB7CiAgICAgICAgICAvLyBjb2x5c2V1cyBleGNsdXNpdmUKICAgICAgICAgIGxldCBsb2FkSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kOwogICAgICAgICAgICAgIGxldCBsb2FkZWREYXRhID0gKF9hID0gdW5zYWZlV2luZG93ID09PSBudWxsIHx8IHVuc2FmZVdpbmRvdyA9PT0gdm9pZCAwID8gdm9pZCAwIDogdW5zYWZlV2luZG93LnN0b3JlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxvYWRpbmc7CiAgICAgICAgICAgICAgbGV0IGxvYWRlZCA9IChsb2FkZWREYXRhID09PSBudWxsIHx8IGxvYWRlZERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxvYWRlZERhdGEucGVyY2VudGFnZUFzc2V0c0xvYWRlZCkgPj0gMTAwICYmIChsb2FkZWREYXRhID09PSBudWxsIHx8IGxvYWRlZERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxvYWRlZERhdGEuY29tcGxldGVkSW5pdGlhbExvYWQpCiAgICAgICAgICAgICAgICAgICYmIChsb2FkZWREYXRhID09PSBudWxsIHx8IGxvYWRlZERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxvYWRlZERhdGEubG9hZGVkSW5pdGlhbERldmljZXMpICYmIChsb2FkZWREYXRhID09PSBudWxsIHx8IGxvYWRlZERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxvYWRlZERhdGEubG9hZGVkSW5pdGlhbFRlcnJhaW4pOwogICAgICAgICAgICAgIGlmICghbG9hZGVkKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgLy8gY2hlY2sgd2hldGhlciB3ZSd2ZSBiZWVuIGFzc2lnbmVkIHRvIGEgdGVhbQogICAgICAgICAgICAgIGxldCB0ZWFtID0gKF9kID0gKF9jID0gKF9iID0gdW5zYWZlV2luZG93ID09PSBudWxsIHx8IHVuc2FmZVdpbmRvdyA9PT0gdm9pZCAwID8gdm9pZCAwIDogdW5zYWZlV2luZG93LnN0b3JlcykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnBoYXNlcikgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLm1haW5DaGFyYWN0ZXIpID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC50ZWFtSWQ7CiAgICAgICAgICAgICAgaWYgKHRlYW0gPT0gIl9fTk9fVEVBTV9JRCIpCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBjbGVhckludGVydmFsKGxvYWRJbnRlcnZhbCk7CiAgICAgICAgICAgICAgdGhpcy5sb2coIkdhbWUgTG9hZGVkIik7CiAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiZ2FtZUxvYWRlZCIpKTsKICAgICAgICAgIH0sIDEwMDAgLyA2MCk7CiAgICAgICAgICAvLyBUT0RPOiBBZGQgYmx1ZWJvYXQgbG9hZCBkZXRlY3Rpb24KICAgICAgfQogICAgICBpbml0U2NyaXB0cygpIHsKICAgICAgICAgIGZvciAobGV0IHNjcmlwdCBvZiB0aGlzLnNjcmlwdHMpIHsKICAgICAgICAgICAgICAvLyBhZGQgZnVuY3Rpb25zCiAgICAgICAgICAgICAgaWYgKHNjcmlwdC5mdW5jcykgewogICAgICAgICAgICAgICAgICBmb3IgKGxldCBbbmFtZSwgZnVuY10gb2Ygc2NyaXB0LmZ1bmNzKSB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZ1bmNzLnNldChuYW1lLCBmdW5jKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBhZGQgaHVkIGFkZGl0aW9ucwogICAgICAgICAgICAgIGlmIChzY3JpcHQuaHVkQWRkaXRpb24pIHsKICAgICAgICAgICAgICAgICAgdGhpcy5odWQubG9hZEZyb21PYmplY3Qoc2NyaXB0Lmh1ZEFkZGl0aW9uKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZSB0aGUgc2NyaXB0CiAgICAgICAgICAgICAgaWYgKHNjcmlwdC5pbml0KSB7CiAgICAgICAgICAgICAgICAgIHNjcmlwdC5pbml0KHRoaXMpOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgfQogICAgICBhbnRpZnJlZXplKCkgewogICAgICAgICAgbGV0IG5hdGl2ZUZyZWV6ZSA9IE9iamVjdC5mcmVlemU7CiAgICAgICAgICBPYmplY3QuZnJlZXplID0gKG9iaikgPT4gewogICAgICAgICAgICAgIHZhciBfYTsKICAgICAgICAgICAgICBpZiAoKChfYSA9IG9iai5jb25zdHJ1Y3RvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm5hbWUpID09ICJXZWJTb2NrZXQiIHx8IG9iai5uYW1lID09ICJXZWJTb2NrZXQiKQogICAgICAgICAgICAgICAgICByZXR1cm4gb2JqOwogICAgICAgICAgICAgIHJldHVybiBuYXRpdmVGcmVlemUob2JqKTsKICAgICAgICAgIH07CiAgICAgICAgICAvLyBpZ25vcmUgYW55IGF0dGVtcHRzIHRvIG1vZGlmeSBXZWJTb2NrZXQucHJvdG90eXBlLnNlbmQKICAgICAgICAgIHZhciBvcmlnaW5hbFNlbmQgPSBXZWJTb2NrZXQucHJvdG90eXBlLnNlbmQ7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViU29ja2V0LnByb3RvdHlwZSwgJ3NlbmQnLCB7CiAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsU2VuZDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gb3JpZ2luYWxTZW5kKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8vIGFsbG93IHNldHRpbmcgdG8gdGhlIG9yaWdpbmFsIHZhbHVlCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkF0dGVtcHRlZCB0byBtb2RpZnkgV2ViU29ja2V0LnByb3RvdHlwZS5zZW5kIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgbG9nKC4uLmFyZ3MpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbR0NdIiwgLi4uYXJncyk7CiAgICAgIH0KICAgICAgZ2V0U2NyaXB0KG5hbWUpIHsKICAgICAgICAgIGZvciAobGV0IHNjcmlwdCBvZiB0aGlzLnNjcmlwdHMpIHsKICAgICAgICAgICAgICBpZiAoc2NyaXB0Lm5hbWUgPT0gbmFtZSkKICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjcmlwdDsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgfQogIGNvbnN0IGNoZWF0ID0gbmV3IENoZWF0KCk7CgogIGNoZWF0LmxvZygiTG9hZGVkIEdpbWtpdCBDaGVhdCB2ZXJzaW9uOiAiICsgdmVyc2lvbik7CiAgY2hlYXQuYW50aWZyZWV6ZSgpOwogIC8vIG1ha2Ugc3VyZSB0aGUgY2hlYXQgaXMgcnVubmluZwogIGlmIChPYmplY3QuaXNGcm96ZW4oV2ViU29ja2V0KSkgewogICAgICBhbGVydCgiV2ViU29ja2V0IG9iamVjdCBpcyBzdGlsbCBmcm96ZW4uIFBsZWFzZSB0cnkgcmVmcmVzaGluZyB0aGUgcGFnZS4gSWYgdGhpcyBwZXJzaXN0cywgb3BlbiBhbiBpc3N1ZSBvbiBHaXRIdWIuIik7CiAgfQoKfSkoKTsK"},{"name":"YouTube Auto-Liker","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["http://*.youtube.com/*","https://*.youtube.com/*"],"orig_noframes":true,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685019476884,"data":{}},"enabled":true,"position":2,"file_url":"https://greasyfork.org/scripts/33865-youtube-auto-liker/code/YouTube%20Auto-Liker.user.js","uuid":"4bb01f84-d672-48bd-9994-257d95a1f18e","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgIFlvdVR1YmUgQXV0by1MaWtlcgovLyBAbmFtZTp6aCAgICAgICAgWW91VHViZeiHquWLlem7nuiumgovLyBAbmFtZTpqYSAgICAgICAgWW91VHViZeOBruOCiOOBhuOBquiHquWLlQovLyBAbmFtZXNwYWNlICAgICAgaHR0cHM6Ly9naXRodWIuY29tL0hhdFNjcmlwdHMveW91dHViZS1hdXRvLWxpa2VyCi8vIEB2ZXJzaW9uICAgICAgICAxLjMuMjIKLy8gQGRlc2NyaXB0aW9uICAgIEF1dG9tYXRpY2FsbHkgbGlrZXMgdmlkZW9zIG9mIGNoYW5uZWxzIHlvdSdyZSBzdWJzY3JpYmVkIHRvCi8vIEBkZXNjcmlwdGlvbjp6aCDlsI3mgqjoqILplrLnmoTpoLvpgZPoppbpoLvoh6rli5Xpu57orpoKLy8gQGRlc2NyaXB0aW9uOmphIOizvOiqreOBl+OBpuOBhOOCi+ODgeODo+ODs+ODjeODq+OBruWLleeUu+OBjOiHquWLleeahOOBq+WlveOBjeOBp+OBmQovLyBAZGVzY3JpcHRpb246cnUg0JDQstGC0L7QvNCw0YLQuNGH0LXRgdC60Lgg0L3RgNCw0LLQuNGC0YHRjyDQstC40LTQtdC+INC60LDQvdCw0LvQvtCyLCDQvdCwINC60L7RgtC+0YDRi9C1INCy0Ysg0L/QvtC00L/QuNGB0LDQvdGLCi8vIEBkZXNjcmlwdGlvbjplcyBMZSBndXN0YW4gYXV0b23DoXRpY2FtZW50ZSBsb3MgdmlkZW9zIGRlIGxvcyBjYW5hbGVzIGEgbG9zIHF1ZSBlc3TDoSBzdXNjcml0bwovLyBAZGVzY3JpcHRpb246cHQgR29zdGEgYXV0b21hdGljYW1lbnRlIGRlIHbDrWRlb3MgZGUgY2FuYWlzIG5vcyBxdWFpcyB2b2PDqiBlc3TDoSBpbnNjcml0bwovLyBAYXV0aG9yICAgICAgICAgSGF0U2NyaXB0cwovLyBAbGljZW5zZSAgICAgICAgTUlUCi8vIEBpY29uICAgICAgICAgICBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vSGF0U2NyaXB0cy95b3V0dWJlLWF1dG8tbGlrZXIvbWFzdGVyL2xvZ28uc3ZnCi8vIEBkb3dubG9hZHVybCAgICBodHRwczovL2dpdGh1Yi5jb20vSGF0U2NyaXB0cy95b3V0dWJlLWF1dG8tbGlrZXIvcmF3L21hc3Rlci95b3V0dWJlLWF1dG8tbGlrZXIudXNlci5qcwovLyBAdXBkYXRldXJsICAgICAgaHR0cHM6Ly9naXRodWIuY29tL0hhdFNjcmlwdHMveW91dHViZS1hdXRvLWxpa2VyL3Jhdy9tYXN0ZXIveW91dHViZS1hdXRvLWxpa2VyLnVzZXIuanMKLy8gQG1hdGNoICAgICAgICAgIGh0dHA6Ly8qLnlvdXR1YmUuY29tLyoKLy8gQG1hdGNoICAgICAgICAgIGh0dHBzOi8vKi55b3V0dWJlLmNvbS8qCi8vIEByZXF1aXJlICAgICAgICBodHRwczovL29wZW51c2VyanMub3JnL3NyYy9saWJzL3NpenpsZS9HTV9jb25maWcuanMKLy8gQGdyYW50ICAgICAgICAgIEdNX2dldFZhbHVlCi8vIEBncmFudCAgICAgICAgICBHTV9zZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgICAgR01fcmVnaXN0ZXJNZW51Q29tbWFuZAovLyBAcnVuLWF0ICAgICAgICAgZG9jdW1lbnQtaWRsZQovLyBAbm9mcmFtZXMKLy8gPT0vVXNlclNjcmlwdD09CgovKiBnbG9iYWwgR01fY29uZmlnLCBHTV9pbmZvLCBHTV9yZWdpc3Rlck1lbnVDb21tYW5kICovCgooKCkgPT4gewogICd1c2Ugc3RyaWN0JwoKICBHTV9jb25maWcuaW5pdCh7CiAgICBpZDogJ3l0YWxfY29uZmlnJywKICAgIHRpdGxlOiBHTV9pbmZvLnNjcmlwdC5uYW1lICsgJyBTZXR0aW5ncycsCiAgICBmaWVsZHM6IHsKICAgICAgREVCVUdfTU9ERTogewogICAgICAgIGxhYmVsOiAnRGVidWcgbW9kZScsCiAgICAgICAgdHlwZTogJ2NoZWNrYm94JywKICAgICAgICBkZWZhdWx0OiBmYWxzZSwKICAgICAgICB0aXRsZTogJ0xvZyBkZWJ1ZyBtZXNzYWdlcyB0byB0aGUgY29uc29sZScKICAgICAgfSwKICAgICAgQ0hFQ0tfRlJFUVVFTkNZOiB7CiAgICAgICAgbGFiZWw6ICdDaGVjayBmcmVxdWVuY3kgKG1zKScsCiAgICAgICAgdHlwZTogJ251bWJlcicsCiAgICAgICAgbWluOiAxLAogICAgICAgIGRlZmF1bHQ6IDUwMDAsCiAgICAgICAgdGl0bGU6ICdUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJldHdlZW4gY2hlY2tpbmcgaWYgdmlkZW8gc2hvdWxkIGJlIGxpa2VkJwogICAgICB9LAogICAgICBXQVRDSF9USFJFU0hPTEQ6IHsKICAgICAgICBsYWJlbDogJ1dhdGNoIHRocmVzaG9sZCAlJywKICAgICAgICB0eXBlOiAnbnVtYmVyJywKICAgICAgICBtaW46IDAsCiAgICAgICAgbWF4OiAxMDAsCiAgICAgICAgZGVmYXVsdDogNTAsCiAgICAgICAgdGl0bGU6ICdUaGUgcGVyY2VudGFnZSB3YXRjaGVkIHRvIGxpa2UgdGhlIHZpZGVvIGF0JwogICAgICB9LAogICAgICBMSUtFX0lGX05PVF9TVUJTQ1JJQkVEOiB7CiAgICAgICAgbGFiZWw6ICdMaWtlIGlmIG5vdCBzdWJzY3JpYmVkJywKICAgICAgICB0eXBlOiAnY2hlY2tib3gnLAogICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgIHRpdGxlOiAnTGlrZSB2aWRlb3MgZnJvbSBjaGFubmVscyB5b3UgYXJlIG5vdCBzdWJzY3JpYmVkIHRvJwogICAgICB9LAogICAgICBBVVRPX0xJS0VfTElWRV9TVFJFQU1TOiB7CiAgICAgICAgbGFiZWw6ICdBdXRvLWxpa2UgbGl2ZSBzdHJlYW1zJywKICAgICAgICB0eXBlOiAnY2hlY2tib3gnLAogICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgIHRpdGxlOiAnQXV0b21hdGljYWxseSBsaWtlIGxpdmUgc3RyZWFtcycKICAgICAgfQogICAgfQogIH0pCgogIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQoJ1NldHRpbmdzJywgKCkgPT4gewogICAgR01fY29uZmlnLm9wZW4oKQogIH0pCgogIGNsYXNzIERlYnVnZ2VyIHsKICAgIGNvbnN0cnVjdG9yIChuYW1lLCBlbmFibGVkKSB7CiAgICAgIHRoaXMuZGVidWcgPSB7fQogICAgICBpZiAoIXdpbmRvdy5jb25zb2xlKSB7CiAgICAgICAgcmV0dXJuICgpID0+IHsgfQogICAgICB9CiAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdy5jb25zb2xlKS5mb3JFYWNoKGtleSA9PiB7CiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuY29uc29sZVtrZXldID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICBpZiAoZW5hYmxlZCkgewogICAgICAgICAgICB0aGlzLmRlYnVnW2tleV0gPSB3aW5kb3cuY29uc29sZVtrZXldLmJpbmQod2luZG93LmNvbnNvbGUsIG5hbWUgKyAnOiAnKQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5kZWJ1Z1trZXldID0gKCkgPT4geyB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgICByZXR1cm4gdGhpcy5kZWJ1ZwogICAgfQogIH0KCiAgY29uc3QgREVCVUcgPSBuZXcgRGVidWdnZXIoR01faW5mby5zY3JpcHQubmFtZSwgR01fY29uZmlnLmdldCgnREVCVUdfTU9ERScpKQoKICBjb25zdCBTRUxFQ1RPUlMgPSB7CiAgICBQTEFZRVI6ICcjbW92aWVfcGxheWVyJywKICAgIFNVQlNDUklCRV9CVVRUT046ICcjc3Vic2NyaWJlLWJ1dHRvbiA+IHl0ZC1zdWJzY3JpYmUtYnV0dG9uLXJlbmRlcmVyJywKICAgIExJS0VfQlVUVE9OOiAnI21lbnUgI3RvcC1sZXZlbC1idXR0b25zLWNvbXB1dGVkID4geXRkLXRvZ2dsZS1idXR0b24tcmVuZGVyZXI6bnRoLWNoaWxkKDEpLCAjc2VnbWVudGVkLWxpa2UtYnV0dG9uIGJ1dHRvbicsCiAgICBESVNMSUtFX0JVVFRPTjogJyNtZW51ICN0b3AtbGV2ZWwtYnV0dG9ucy1jb21wdXRlZCA+IHl0ZC10b2dnbGUtYnV0dG9uLXJlbmRlcmVyOm50aC1jaGlsZCgyKSwgI3NlZ21lbnRlZC1kaXNsaWtlLWJ1dHRvbiBidXR0b24nCiAgfQoKICBjb25zdCBhdXRvTGlrZWRWaWRlb0lkcyA9IFtdCgogIHNldEludGVydmFsKHdhaXQsIEdNX2NvbmZpZy5nZXQoJ0NIRUNLX0ZSRVFVRU5DWScpKQoKICBmdW5jdGlvbiBnZXRWaWRlb0lkICgpIHsKICAgIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcGFnZS1tYW5hZ2VyID4geXRkLXdhdGNoLWZsZXh5JykKICAgIGlmIChlbGVtICYmIGVsZW0uaGFzQXR0cmlidXRlKCd2aWRlby1pZCcpKSB7CiAgICAgIHJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgndmlkZW8taWQnKQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCkuZ2V0KCd2JykKICAgIH0KICB9CgogIGZ1bmN0aW9uIHdhdGNoVGhyZXNob2xkUmVhY2hlZCAoKSB7CiAgICBjb25zdCBwbGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5QTEFZRVIpCiAgICBpZiAocGxheWVyKSB7CiAgICAgIGNvbnN0IHdhdGNoZWQgPSBwbGF5ZXIuZ2V0Q3VycmVudFRpbWUoKSAvIHBsYXllci5nZXREdXJhdGlvbigpCiAgICAgIGNvbnN0IHdhdGNoZWRUYXJnZXQgPSBHTV9jb25maWcuZ2V0KCdXQVRDSF9USFJFU0hPTEQnKSAvIDEwMAogICAgICBpZiAod2F0Y2hlZCA8IHdhdGNoZWRUYXJnZXQpIHsKICAgICAgICBERUJVRy5pbmZvKGBXYWl0aW5nIHVudGlsIHdhdGNoIHRocmVzaG9sZCByZWFjaGVkICgke3dhdGNoZWQudG9GaXhlZCgyKX0vJHt3YXRjaGVkVGFyZ2V0fSkuLi5gKQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9CiAgICByZXR1cm4gdHJ1ZQogIH0KCiAgZnVuY3Rpb24gaXNTdWJzY3JpYmVkICgpIHsKICAgIERFQlVHLmluZm8oJ0NoZWNraW5nIHdoZXRoZXIgc3Vic2NyaWJlZC4uLicpCiAgICBjb25zdCBzdWJzY3JpYmVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SUy5TVUJTQ1JJQkVfQlVUVE9OKQogICAgaWYgKCFzdWJzY3JpYmVCdXR0b24pIHsKICAgICAgdGhyb3cgRXJyb3IoJ0NvdWxkblwndCBmaW5kIHN1YiBidXR0b24nKQogICAgfQogICAgY29uc3Qgc3Vic2NyaWJlZCA9IHN1YnNjcmliZUJ1dHRvbi5oYXNBdHRyaWJ1dGUoJ3N1YnNjcmliZS1idXR0b24taGlkZGVuJykKICAgIERFQlVHLmluZm8oc3Vic2NyaWJlZCA/ICdXZSBhcmUgc3Vic2NyaWJlZCcgOiAnV2UgYXJlIG5vdCBzdWJzY3JpYmVkJykKICAgIHJldHVybiBzdWJzY3JpYmVkCiAgfQoKICBmdW5jdGlvbiB3YWl0ICgpIHsKICAgIGlmICh3YXRjaFRocmVzaG9sZFJlYWNoZWQoKSkgewogICAgICB0cnkgewogICAgICAgIGlmIChHTV9jb25maWcuZ2V0KCdMSUtFX0lGX05PVF9TVUJTQ1JJQkVEJykgfHwgaXNTdWJzY3JpYmVkKCkpIHsKICAgICAgICAgIGlmIChHTV9jb25maWcuZ2V0KCdBVVRPX0xJS0VfTElWRV9TVFJFQU1TJykgfHwKICAgICAgICAgICAgd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnl0cC1saXZlLWJhZGdlJykpLmRpc3BsYXkgPT09ICdub25lJykgewogICAgICAgICAgICBsaWtlKCkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBERUJVRy5pbmZvKGBGYWlsZWQgdG8gbGlrZSB2aWRlbzogJHtlfS4gV2lsbCB0cnkgYWdhaW4gaW4gJHtHTV9jb25maWcuZ2V0KCdDSEVDS19GUkVRVUVOQ1knKX0gbXMuLi5gKQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBpc0J1dHRvblByZXNzZWQgKGJ1dHRvbikgewogICAgcmV0dXJuIGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3N0eWxlLWRlZmF1bHQtYWN0aXZlJykgfHwKICAgICAgYnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS1wcmVzc2VkJykgPT09ICd0cnVlJwogIH0KCiAgZnVuY3Rpb24gbGlrZSAoKSB7CiAgICBERUJVRy5pbmZvKCdUcnlpbmcgdG8gbGlrZSB2aWRlby4uLicpCiAgICBjb25zdCBsaWtlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihTRUxFQ1RPUlMuTElLRV9CVVRUT04pCiAgICBjb25zdCBkaXNsaWtlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihTRUxFQ1RPUlMuRElTTElLRV9CVVRUT04pCiAgICBpZiAoIWxpa2VCdXR0b24pIHsKICAgICAgdGhyb3cgRXJyb3IoJ0NvdWxkblwndCBmaW5kIGxpa2UgYnV0dG9uJykKICAgIH0KICAgIGlmICghZGlzbGlrZUJ1dHRvbikgewogICAgICB0aHJvdyBFcnJvcignQ291bGRuXCd0IGZpbmQgZGlzbGlrZSBidXR0b24nKQogICAgfQogICAgY29uc3QgdmlkZW9JZCA9IGdldFZpZGVvSWQoKQogICAgaWYgKGlzQnV0dG9uUHJlc3NlZChsaWtlQnV0dG9uKSkgewogICAgICBERUJVRy5pbmZvKCdMaWtlIGJ1dHRvbiBoYXMgYWxyZWFkeSBiZWVuIGNsaWNrZWQnKQogICAgICBhdXRvTGlrZWRWaWRlb0lkcy5wdXNoKHZpZGVvSWQpCiAgICB9IGVsc2UgaWYgKGlzQnV0dG9uUHJlc3NlZChkaXNsaWtlQnV0dG9uKSkgewogICAgICBERUJVRy5pbmZvKCdEaXNsaWtlIGJ1dHRvbiBoYXMgYWxyZWFkeSBiZWVuIGNsaWNrZWQnKQogICAgfSBlbHNlIGlmIChhdXRvTGlrZWRWaWRlb0lkcy5pbmNsdWRlcyh2aWRlb0lkKSkgewogICAgICBERUJVRy5pbmZvKCdWaWRlbyBoYXMgYWxyZWFkeSBiZWVuIGF1dG8tbGlrZWQuIFVzZXIgbXVzdCAnICsKICAgICAgICAnaGF2ZSB1bi1saWtlZCBpdCwgc28gd2Ugd29uXCd0IGxpa2UgaXQgYWdhaW4nKQogICAgfSBlbHNlIHsKICAgICAgREVCVUcuaW5mbygnRm91bmQgbGlrZSBidXR0b24uIEl0XCdzIHVuY2xpY2tlZC4gQ2xpY2tpbmcgaXQuLi4nKQogICAgICBsaWtlQnV0dG9uLmNsaWNrKCkKICAgICAgaWYgKGlzQnV0dG9uUHJlc3NlZChsaWtlQnV0dG9uKSkgewogICAgICAgIGF1dG9MaWtlZFZpZGVvSWRzLnB1c2godmlkZW9JZCkKICAgICAgICBERUJVRy5pbmZvKCdTdWNjZXNzZnVsbHkgbGlrZWQgdmlkZW8nKQogICAgICB9IGVsc2UgewogICAgICAgIERFQlVHLmluZm8oJ0ZhaWxlZCB0byBsaWtlIHZpZGVvJykKICAgICAgfQogICAgfQogIH0KfSkoKQ==","requires":[{"meta":{"name":"GM_config.js","url":"https://openuserjs.org/src/libs/sizzle/GM_config.js","ts":1685019477510,"mimetype":"text/javascript"},"source":"LyoKQ29weXJpZ2h0IDIwMDkrLCBHTV9jb25maWcgQ29udHJpYnV0b3JzIChodHRwczovL2dpdGh1Yi5jb20vc2l6emxlbWN0d2l6emxlL0dNX2NvbmZpZykKCkdNX2NvbmZpZyBDb2xsYWJvcmF0b3JzL0NvbnRyaWJ1dG9yczoKICAgIE1pa2UgTWVkbGV5IDxtZWRsZXltaW5kQGdtYWlsLmNvbT4KICAgIEpvZSBTaW1tb25zCiAgICBJenp5IFNvZnQKICAgIE1hcnRpIE1hcnR6CiAgICBBZGFtIFRob21wc29uLVNoYXJwZQoKR01fY29uZmlnIGlzIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlLgoKICAgIEdNX2NvbmZpZyBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yCiAgICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKICAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAogICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKICAgIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogICAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgoqLwoKLy8gPT1Vc2VyU2NyaXB0PT0KLy8gQGV4Y2x1ZGUgICAgICAgKgovLyBAYXV0aG9yICAgICAgICBNaWtlIE1lZGxleSA8bWVkbGV5bWluZEBnbWFpbC5jb20+IChodHRwczovL2dpdGh1Yi5jb20vc2l6emxlbWN0d2l6emxlL0dNX2NvbmZpZykKLy8gQGljb24gICAgICAgICAgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3NpenpsZW1jdHdpenpsZS9HTV9jb25maWcvbWFzdGVyL2dtX2NvbmZpZ19pY29uX2xhcmdlLnBuZwoKLy8gPT1Vc2VyTGlicmFyeT09Ci8vIEBuYW1lICAgICAgICAgIEdNX2NvbmZpZwovLyBAZGVzY3JpcHRpb24gICBBIGxpZ2h0d2VpZ2h0LCByZXVzYWJsZSwgY3Jvc3MtYnJvd3NlciBncmFwaGljYWwgc2V0dGluZ3MgZnJhbWV3b3JrIGZvciBpbmNsdXNpb24gaW4gdXNlciBzY3JpcHRzLgovLyBAY29weXJpZ2h0ICAgICAyMDA5KywgTWlrZSBNZWRsZXkgKGh0dHBzOi8vZ2l0aHViLmNvbS9zaXp6bGVtY3R3aXp6bGUpCi8vIEBsaWNlbnNlICAgICAgIExHUEwtMy4wLW9yLWxhdGVyOyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vc2l6emxlbWN0d2l6emxlL0dNX2NvbmZpZy9tYXN0ZXIvTElDRU5TRQoKLy8gQGhvbWVwYWdlVVJMICAgaHR0cHM6Ly9vcGVudXNlcmpzLm9yZy9saWJzL3NpenpsZS9HTV9jb25maWcKLy8gQGhvbWVwYWdlVVJMICAgaHR0cHM6Ly9naXRodWIuY29tL3NpenpsZW1jdHdpenpsZS9HTV9jb25maWcKLy8gQHN1cHBvcnRVUkwgICAgaHR0cHM6Ly9naXRodWIuY29tL3NpenpsZW1jdHdpenpsZS9HTV9jb25maWcvaXNzdWVzCgovLyA9PS9Vc2VyU2NyaXB0PT0KCi8vID09L1VzZXJMaWJyYXJ5PT0KCi8qIGpzaGludCBlc3ZlcnNpb246IDggKi8KCmxldCBHTV9jb25maWcgPSAoZnVuY3Rpb24gKEdNKSB7CiAgLy8gVGhpcyBpcyB0aGUgaW5pdGlhbGl6ZXIgZnVuY3Rpb24KICBmdW5jdGlvbiBHTV9jb25maWdJbml0KGNvbmZpZywgYXJncykgewogICAgLy8gSW5pdGlhbGl6ZSBpbnN0YW5jZSB2YXJpYWJsZXMKICAgIGlmICh0eXBlb2YgY29uZmlnLmZpZWxkcyA9PSAidW5kZWZpbmVkIikgewogICAgICBjb25maWcuZmllbGRzID0ge307CiAgICAgIGNvbmZpZy5vbkluaXQgPSBjb25maWcub25Jbml0IHx8IGZ1bmN0aW9uKCkge307CiAgICAgIGNvbmZpZy5vbk9wZW4gPSBjb25maWcub25PcGVuIHx8IGZ1bmN0aW9uKCkge307CiAgICAgIGNvbmZpZy5vblNhdmUgPSBjb25maWcub25TYXZlIHx8IGZ1bmN0aW9uKCkge307CiAgICAgIGNvbmZpZy5vbkNsb3NlID0gY29uZmlnLm9uQ2xvc2UgfHwgZnVuY3Rpb24oKSB7fTsKICAgICAgY29uZmlnLm9uUmVzZXQgPSBjb25maWcub25SZXNldCB8fCBmdW5jdGlvbigpIHt9OwogICAgICBjb25maWcuaXNPcGVuID0gZmFsc2U7CiAgICAgIGNvbmZpZy50aXRsZSA9ICdVc2VyIFNjcmlwdCBTZXR0aW5ncyc7CiAgICAgIGNvbmZpZy5jc3MgPSB7CiAgICAgICAgYmFzaWM6IFsKICAgICAgICAgICIjR01fY29uZmlnICogeyBmb250LWZhbWlseTogYXJpYWwsdGFob21hLG15cmlhZCBwcm8sc2Fucy1zZXJpZjsgfSIsCiAgICAgICAgICAiI0dNX2NvbmZpZyB7IGJhY2tncm91bmQ6ICNGRkY7IH0iLAogICAgICAgICAgIiNHTV9jb25maWcgaW5wdXRbdHlwZT0ncmFkaW8nXSB7IG1hcmdpbi1yaWdodDogOHB4OyB9IiwKICAgICAgICAgICIjR01fY29uZmlnIC5pbmRlbnQ0MCB7IG1hcmdpbi1sZWZ0OiA0MCU7IH0iLAogICAgICAgICAgIiNHTV9jb25maWcgLmZpZWxkX2xhYmVsIHsgZm9udC1zaXplOiAxMnB4OyBmb250LXdlaWdodDogYm9sZDsgbWFyZ2luLXJpZ2h0OiA2cHg7IH0iLAogICAgICAgICAgIiNHTV9jb25maWcgLnJhZGlvX2xhYmVsIHsgZm9udC1zaXplOiAxMnB4OyB9IiwKICAgICAgICAgICIjR01fY29uZmlnIC5ibG9jayB7IGRpc3BsYXk6IGJsb2NrOyB9IiwKICAgICAgICAgICIjR01fY29uZmlnIC5zYXZlY2xvc2VfYnV0dG9ucyB7IG1hcmdpbjogMTZweCAxMHB4IDEwcHg7IHBhZGRpbmc6IDJweCAxMnB4OyB9IiwKICAgICAgICAgICIjR01fY29uZmlnIC5yZXNldCwgI0dNX2NvbmZpZyAucmVzZXQgYSwiICsKICAgICAgICAgICAgIiAjR01fY29uZmlnX2J1dHRvbnNfaG9sZGVyIHsgY29sb3I6ICMwMDA7IHRleHQtYWxpZ246IHJpZ2h0OyB9IiwKICAgICAgICAgICIjR01fY29uZmlnIC5jb25maWdfaGVhZGVyIHsgZm9udC1zaXplOiAyMHB0OyBtYXJnaW46IDA7IH0iLAogICAgICAgICAgIiNHTV9jb25maWcgLmNvbmZpZ19kZXNjLCAjR01fY29uZmlnIC5zZWN0aW9uX2Rlc2MsICNHTV9jb25maWcgLnJlc2V0IHsgZm9udC1zaXplOiA5cHQ7IH0iLAogICAgICAgICAgIiNHTV9jb25maWcgLmNlbnRlciB7IHRleHQtYWxpZ246IGNlbnRlcjsgfSIsCiAgICAgICAgICAiI0dNX2NvbmZpZyAuc2VjdGlvbl9oZWFkZXJfaG9sZGVyIHsgbWFyZ2luLXRvcDogOHB4OyB9IiwKICAgICAgICAgICIjR01fY29uZmlnIC5jb25maWdfdmFyIHsgbWFyZ2luOiAwIDAgNHB4OyB9IiwKICAgICAgICAgICIjR01fY29uZmlnIC5zZWN0aW9uX2hlYWRlciB7IGJhY2tncm91bmQ6ICM0MTQxNDE7IGJvcmRlcjogMXB4IHNvbGlkICMwMDA7IGNvbG9yOiAjRkZGOyIsCiAgICAgICAgICAiIGZvbnQtc2l6ZTogMTNwdDsgbWFyZ2luOiAwOyB9IiwKICAgICAgICAgICIjR01fY29uZmlnIC5zZWN0aW9uX2Rlc2MgeyBiYWNrZ3JvdW5kOiAjRUZFRkVGOyBib3JkZXI6IDFweCBzb2xpZCAjQ0NDOyBjb2xvcjogIzU3NTc1NzsiICsKICAgICAgICAgICAgIiBmb250LXNpemU6IDlwdDsgbWFyZ2luOiAwIDAgNnB4OyB9IgogICAgICAgICAgXS5qb2luKCdcbicpICsgJ1xuJywKICAgICAgICBiYXNpY1ByZWZpeDogIkdNX2NvbmZpZyIsCiAgICAgICAgc3R5bGlzaDogIiIKICAgICAgfTsKICAgIH0KCiAgICB2YXIgc2V0dGluZ3MgPSBudWxsOwogICAgaWYgKGFyZ3MubGVuZ3RoID09IDEgJiYKICAgICAgdHlwZW9mIGFyZ3NbMF0uaWQgPT0gInN0cmluZyIgJiYKICAgICAgdHlwZW9mIGFyZ3NbMF0uYXBwZW5kQ2hpbGQgIT0gImZ1bmN0aW9uIikgc2V0dGluZ3MgPSBhcmdzWzBdOwogICAgZWxzZSB7CiAgICAgIC8vIFByb3ZpZGUgYmFja3dhcmRzLWNvbXBhdGliaWxpdHkgd2l0aCBhcmd1bWVudCBzdHlsZSBpbnRpYWxpemF0aW9uCiAgICAgIHNldHRpbmdzID0ge307CgogICAgICAvLyBsb29wIHRocm91Z2ggR01fY29uZmlnLmluaXQoKSBhcmd1bWVudHMKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhcmdzLmxlbmd0aCwgYXJnOyBpIDwgbDsgKytpKSB7CiAgICAgICAgYXJnID0gYXJnc1tpXTsKCiAgICAgICAgLy8gQW4gZWxlbWVudCB0byB1c2UgYXMgdGhlIGNvbmZpZyB3aW5kb3cKICAgICAgICBpZiAodHlwZW9mIGFyZy5hcHBlbmRDaGlsZCA9PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICBzZXR0aW5ncy5mcmFtZSA9IGFyZzsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgc3dpdGNoICh0eXBlb2YgYXJnKSB7CiAgICAgICAgICBjYXNlICdvYmplY3QnOgogICAgICAgICAgICBmb3IgKGxldCBqIGluIGFyZykgeyAvLyBjb3VsZCBiZSBhIGNhbGxiYWNrIGZ1bmN0aW9ucyBvciBzZXR0aW5ncyBvYmplY3QKICAgICAgICAgICAgICBpZiAodHlwZW9mIGFyZ1tqXSAhPSAiZnVuY3Rpb24iKSB7IC8vIHdlIGFyZSBpbiB0aGUgc2V0dGluZ3Mgb2JqZWN0CiAgICAgICAgICAgICAgICBzZXR0aW5ncy5maWVsZHMgPSBhcmc7IC8vIHN0b3JlIHNldHRpbmdzIG9iamVjdAogICAgICAgICAgICAgICAgYnJlYWs7IC8vIGxlYXZlIHRoZSBsb29wCiAgICAgICAgICAgICAgfSAvLyBvdGhlcndpc2UgaXQgbXVzdCBiZSBhIGNhbGxiYWNrIGZ1bmN0aW9uCiAgICAgICAgICAgICAgaWYgKCFzZXR0aW5ncy5ldmVudHMpIHNldHRpbmdzLmV2ZW50cyA9IHt9OwogICAgICAgICAgICAgIHNldHRpbmdzLmV2ZW50c1tqXSA9IGFyZ1tqXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ2Z1bmN0aW9uJzogLy8gcGFzc2luZyBhIGJhcmUgZnVuY3Rpb24gaXMgc2V0IHRvIG9wZW4gY2FsbGJhY2sKICAgICAgICAgICAgc2V0dGluZ3MuZXZlbnRzID0ge29uT3BlbjogYXJnfTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdzdHJpbmcnOiAvLyBjb3VsZCBiZSBjdXN0b20gQ1NTIG9yIHRoZSB0aXRsZSBzdHJpbmcKICAgICAgICAgICAgaWYgKC9cdytccypce1xzKlx3K1xzKjpccypcdytbXHN8XFNdKlx9Ly50ZXN0KGFyZykpCiAgICAgICAgICAgICAgc2V0dGluZ3MuY3NzID0gYXJnOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgc2V0dGluZ3MudGl0bGUgPSBhcmc7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIC8qIEluaXRpYWxpemUgZXZlcnl0aGluZyB1c2luZyB0aGUgbmV3IHNldHRpbmdzIG9iamVjdCAqLwogICAgLy8gU2V0IHRoZSBpZAogICAgaWYgKHNldHRpbmdzLmlkKSBjb25maWcuaWQgPSBzZXR0aW5ncy5pZDsKICAgIGVsc2UgaWYgKHR5cGVvZiBjb25maWcuaWQgPT0gInVuZGVmaW5lZCIpIGNvbmZpZy5pZCA9ICdHTV9jb25maWcnOwoKICAgIC8vIFNldCB0aGUgdGl0bGUKICAgIGlmIChzZXR0aW5ncy50aXRsZSkgY29uZmlnLnRpdGxlID0gc2V0dGluZ3MudGl0bGU7CgogICAgLy8gU2V0IHRoZSBjdXN0b20gY3NzCiAgICBpZiAoc2V0dGluZ3MuY3NzKSBjb25maWcuY3NzLnN0eWxpc2ggPSBzZXR0aW5ncy5jc3M7CgogICAgLy8gU2V0IHRoZSBmcmFtZQogICAgaWYgKHNldHRpbmdzLmZyYW1lKSBjb25maWcuZnJhbWUgPSBzZXR0aW5ncy5mcmFtZTsKCiAgICAvLyBTZXQgdGhlIGV2ZW50IGNhbGxiYWNrcwogICAgaWYgKHNldHRpbmdzLmV2ZW50cykgewogICAgICBsZXQgZXZlbnRzID0gc2V0dGluZ3MuZXZlbnRzOwogICAgICBmb3IgKGxldCBlIGluIGV2ZW50cykgewogICAgICAgIGNvbmZpZ1sib24iICsgZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGUuc2xpY2UoMSldID0gZXZlbnRzW2VdOwogICAgICB9CiAgICB9CgogICAgLy8gSWYgdGhlIGlkIGhhcyBjaGFuZ2VkIHdlIG11c3QgbW9kaWZ5IHRoZSBkZWZhdWx0IHN0eWxlCiAgICBpZiAoY29uZmlnLmlkICE9IGNvbmZpZy5jc3MuYmFzaWNQcmVmaXgpIHsKICAgICAgY29uZmlnLmNzcy5iYXNpYyA9IGNvbmZpZy5jc3MuYmFzaWMucmVwbGFjZSgKICAgICAgICBuZXcgUmVnRXhwKCcjJyArIGNvbmZpZy5jc3MuYmFzaWNQcmVmaXgsICdnbScpLCAnIycgKyBjb25maWcuaWQpOwogICAgICBjb25maWcuY3NzLmJhc2ljUHJlZml4ID0gY29uZmlnLmlkOwogICAgfQoKICAgIC8vIENyZWF0ZSB0aGUgZmllbGRzCiAgICBjb25maWcuaXNJbml0ID0gZmFsc2U7CiAgICBpZiAoc2V0dGluZ3MuZmllbGRzKSB7CiAgICAgIGNvbmZpZy5yZWFkKG51bGwsIChzdG9yZWQpID0+IHsgLy8gcmVhZCB0aGUgc3RvcmVkIHNldHRpbmdzCiAgICAgICAgbGV0IGZpZWxkcyA9IHNldHRpbmdzLmZpZWxkcywKICAgICAgICAgICAgY3VzdG9tVHlwZXMgPSBzZXR0aW5ncy50eXBlcyB8fCB7fSwKICAgICAgICAgICAgY29uZmlnSWQgPSBjb25maWcuaWQ7CgogICAgICAgIGZvciAobGV0IGlkIGluIGZpZWxkcykgewogICAgICAgICAgbGV0IGZpZWxkID0gZmllbGRzW2lkXSwKICAgICAgICAgICAgICBmaWVsZEV4aXN0cyA9IGZhbHNlOwoKICAgICAgICAgIGlmIChjb25maWcuZmllbGRzW2lkXSkgewogICAgICAgICAgICBmaWVsZEV4aXN0cyA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gZm9yIGVhY2ggZmllbGQgZGVmaW5pdGlvbiBjcmVhdGUgYSBmaWVsZCBvYmplY3QKICAgICAgICAgIGlmIChmaWVsZCkgewogICAgICAgICAgICBpZiAoY29uZmlnLmlzT3BlbiAmJiBmaWVsZEV4aXN0cykgewogICAgICAgICAgICAgICAgY29uZmlnLmZpZWxkc1tpZF0ucmVtb3ZlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbmZpZy5maWVsZHNbaWRdID0gbmV3IEdNX2NvbmZpZ0ZpZWxkKGZpZWxkLCBzdG9yZWRbaWRdLCBpZCwKICAgICAgICAgICAgICBjdXN0b21UeXBlc1tmaWVsZC50eXBlXSwgY29uZmlnSWQpOwoKICAgICAgICAgICAgLy8gQWRkIGZpZWxkIHRvIG9wZW4gZnJhbWUKICAgICAgICAgICAgaWYgKGNvbmZpZy5pc09wZW4pIHsKICAgICAgICAgICAgICBjb25maWcuZmllbGRzW2lkXS53cmFwcGVyID0gY29uZmlnLmZpZWxkc1tpZF0udG9Ob2RlKCk7CiAgICAgICAgICAgICAgY29uZmlnLmZyYW1lU2VjdGlvbi5hcHBlbmRDaGlsZChjb25maWcuZmllbGRzW2lkXS53cmFwcGVyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmICghZmllbGQgJiYgZmllbGRFeGlzdHMpIHsKICAgICAgICAgICAgLy8gUmVtb3ZlIGZpZWxkIGZyb20gb3BlbiBmcmFtZQogICAgICAgICAgICBpZiAoY29uZmlnLmlzT3BlbikgewogICAgICAgICAgICAgIGNvbmZpZy5maWVsZHNbaWRdLnJlbW92ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkZWxldGUgY29uZmlnLmZpZWxkc1tpZF07CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25maWcuaXNJbml0ID0gdHJ1ZTsKICAgICAgICBjb25maWcub25Jbml0LmNhbGwoY29uZmlnKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBjb25maWcuaXNJbml0ID0gdHJ1ZTsKICAgICAgY29uZmlnLm9uSW5pdC5jYWxsKGNvbmZpZyk7CiAgICB9CiAgfQoKICBsZXQgY29uc3RydWN0ID0gZnVuY3Rpb24gKCkgewogICAgLy8gUGFyc2luZyBvZiBpbnB1dCBwcm92aWRlZCB2aWEgZnJvbnRlbmRzCiAgICBHTV9jb25maWdJbml0KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKICBjb25zdHJ1Y3QucHJvdG90eXBlID0gewogICAgLy8gU3VwcG9ydCByZS1pbml0YWxpemF0aW9uCiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgR01fY29uZmlnSW5pdCh0aGlzLCBhcmd1bWVudHMpOwogICAgfSwKCiAgICAvLyBjYWxsIEdNX2NvbmZpZy5vcGVuKCkgZnJvbSB5b3VyIHNjcmlwdCB0byBvcGVuIHRoZSBtZW51CiAgICBvcGVuOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIGRvbid0IG9wZW4gYmVmb3JlIGluaXQgaXMgZmluaXNoZWQKICAgICAgaWYgKCF0aGlzLmlzSW5pdCkgewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5vcGVuKCksIDApOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAvLyBEaWUgaWYgdGhlIG1lbnUgaXMgYWxyZWFkeSBvcGVuIG9uIHRoaXMgcGFnZQogICAgICAvLyBZb3UgY2FuIGhhdmUgbXVsdGlwbGUgaW5zdGFuY2VzIGJ1dCB5b3UgY2FuJ3Qgb3BlbiB0aGUgc2FtZSBpbnN0YW5jZSB0d2ljZQogICAgICBsZXQgbWF0Y2ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmlkKTsKICAgICAgaWYgKG1hdGNoICYmIChtYXRjaC50YWdOYW1lID09ICJJRlJBTUUiIHx8IG1hdGNoLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkpIHJldHVybjsKCiAgICAgIC8vIFNvbWV0aW1lcyAidGhpcyIgZ2V0cyBvdmVyd3JpdHRlbiBzbyBjcmVhdGUgYW4gYWxpYXMKICAgICAgbGV0IGNvbmZpZyA9IHRoaXM7CgogICAgICAvLyBGdW5jdGlvbiB0byBidWlsZCB0aGUgbWlnaHR5IGNvbmZpZyB3aW5kb3cgOikKICAgICAgZnVuY3Rpb24gYnVpbGRDb25maWdXaW4gKGJvZHksIGhlYWQpIHsKICAgICAgICBsZXQgY3JlYXRlID0gY29uZmlnLmNyZWF0ZSwKICAgICAgICAgICAgZmllbGRzID0gY29uZmlnLmZpZWxkcywKICAgICAgICAgICAgY29uZmlnSWQgPSBjb25maWcuaWQsCiAgICAgICAgICAgIGJvZHlXcmFwcGVyID0gY3JlYXRlKCdkaXYnLCB7aWQ6IGNvbmZpZ0lkICsgJ193cmFwcGVyJ30pOwoKICAgICAgICAvLyBBcHBlbmQgdGhlIHN0eWxlIHdoaWNoIGlzIG91ciBkZWZhdWx0IHN0eWxlIHBsdXMgdGhlIHVzZXIgc3R5bGUKICAgICAgICBoZWFkLmFwcGVuZENoaWxkKAogICAgICAgICAgY3JlYXRlKCdzdHlsZScsIHsKICAgICAgICAgIHR5cGU6ICd0ZXh0L2NzcycsCiAgICAgICAgICB0ZXh0Q29udGVudDogY29uZmlnLmNzcy5iYXNpYyArIGNvbmZpZy5jc3Muc3R5bGlzaAogICAgICAgIH0pKTsKCiAgICAgICAgLy8gQWRkIGhlYWRlciBhbmQgdGl0bGUKICAgICAgICBib2R5V3JhcHBlci5hcHBlbmRDaGlsZChjcmVhdGUoJ2RpdicsIHsKICAgICAgICAgIGlkOiBjb25maWdJZCArICdfaGVhZGVyJywKICAgICAgICAgIGNsYXNzTmFtZTogJ2NvbmZpZ19oZWFkZXIgYmxvY2sgY2VudGVyJwogICAgICAgIH0sIGNvbmZpZy50aXRsZSkpOwoKICAgICAgICAvLyBBcHBlbmQgZWxlbWVudHMKICAgICAgICBsZXQgc2VjdGlvbiA9IGJvZHlXcmFwcGVyLAogICAgICAgICAgICBzZWNOdW0gPSAwOyAvLyBTZWN0aW9uIGNvdW50CgogICAgICAgIC8vIGxvb3AgdGhyb3VnaCBmaWVsZHMKICAgICAgICBmb3IgKGxldCBpZCBpbiBmaWVsZHMpIHsKICAgICAgICAgIGxldCBmaWVsZCA9IGZpZWxkc1tpZF0sCiAgICAgICAgICAgICAgc2V0dGluZ3MgPSBmaWVsZC5zZXR0aW5nczsKCiAgICAgICAgICBpZiAoc2V0dGluZ3Muc2VjdGlvbikgeyAvLyB0aGUgc3RhcnQgb2YgYSBuZXcgc2VjdGlvbgogICAgICAgICAgICBzZWN0aW9uID0gYm9keVdyYXBwZXIuYXBwZW5kQ2hpbGQoY3JlYXRlKCdkaXYnLCB7CiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdzZWN0aW9uX2hlYWRlcl9ob2xkZXInLAogICAgICAgICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19zZWN0aW9uXycgKyBzZWNOdW0KICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc2V0dGluZ3Muc2VjdGlvbikpCiAgICAgICAgICAgICAgc2V0dGluZ3Muc2VjdGlvbiA9IFtzZXR0aW5ncy5zZWN0aW9uXTsKCiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5zZWN0aW9uWzBdKQogICAgICAgICAgICAgIHNlY3Rpb24uYXBwZW5kQ2hpbGQoY3JlYXRlKCdkaXYnLCB7CiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdzZWN0aW9uX2hlYWRlciBjZW50ZXInLAogICAgICAgICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19zZWN0aW9uX2hlYWRlcl8nICsgc2VjTnVtCiAgICAgICAgICAgICAgfSwgc2V0dGluZ3Muc2VjdGlvblswXSkpOwoKICAgICAgICAgICAgaWYgKHNldHRpbmdzLnNlY3Rpb25bMV0pCiAgICAgICAgICAgICAgc2VjdGlvbi5hcHBlbmRDaGlsZChjcmVhdGUoJ3AnLCB7CiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdzZWN0aW9uX2Rlc2MgY2VudGVyJywKICAgICAgICAgICAgICAgIGlkOiBjb25maWdJZCArICdfc2VjdGlvbl9kZXNjXycgKyBzZWNOdW0KICAgICAgICAgICAgICB9LCBzZXR0aW5ncy5zZWN0aW9uWzFdKSk7CiAgICAgICAgICAgICsrc2VjTnVtOwogICAgICAgICAgfQogICAgICAgICAgCiAgICAgICAgICBpZiAoc2VjTnVtID09PSAwKSB7CiAgICAgICAgICAgIHNlY3Rpb24gPSBib2R5V3JhcHBlci5hcHBlbmRDaGlsZChjcmVhdGUoJ2RpdicsIHsKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3NlY3Rpb25faGVhZGVyX2hvbGRlcicsCiAgICAgICAgICAgICAgICBpZDogY29uZmlnSWQgKyAnX3NlY3Rpb25fJyArIChzZWNOdW0rKykKICAgICAgICAgICAgfSkpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIENyZWF0ZSBmaWVsZCBlbGVtZW50cyBhbmQgYXBwZW5kIHRvIGN1cnJlbnQgc2VjdGlvbgogICAgICAgICAgc2VjdGlvbi5hcHBlbmRDaGlsZCgoZmllbGQud3JhcHBlciA9IGZpZWxkLnRvTm9kZSgpKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNvbmZpZy5mcmFtZVNlY3Rpb24gPSBzZWN0aW9uOwoKICAgICAgICAvLyBBZGQgc2F2ZSBhbmQgY2xvc2UgYnV0dG9ucwogICAgICAgIGJvZHlXcmFwcGVyLmFwcGVuZENoaWxkKGNyZWF0ZSgnZGl2JywKICAgICAgICAgIHtpZDogY29uZmlnSWQgKyAnX2J1dHRvbnNfaG9sZGVyJ30sCgogICAgICAgICAgY3JlYXRlKCdidXR0b24nLCB7CiAgICAgICAgICAgIGlkOiBjb25maWdJZCArICdfc2F2ZUJ0bicsCiAgICAgICAgICAgIHRleHRDb250ZW50OiAnU2F2ZScsCiAgICAgICAgICAgIHRpdGxlOiAnU2F2ZSBzZXR0aW5ncycsCiAgICAgICAgICAgIGNsYXNzTmFtZTogJ3NhdmVjbG9zZV9idXR0b25zJywKICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24gKCkgeyBjb25maWcuc2F2ZSgpOyB9CiAgICAgICAgICB9KSwKCiAgICAgICAgICBjcmVhdGUoJ2J1dHRvbicsIHsKICAgICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19jbG9zZUJ0bicsCiAgICAgICAgICAgIHRleHRDb250ZW50OiAnQ2xvc2UnLAogICAgICAgICAgICB0aXRsZTogJ0Nsb3NlIHdpbmRvdycsCiAgICAgICAgICAgIGNsYXNzTmFtZTogJ3NhdmVjbG9zZV9idXR0b25zJywKICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24gKCkgeyBjb25maWcuY2xvc2UoKTsgfQogICAgICAgICAgfSksCgogICAgICAgICAgY3JlYXRlKCdkaXYnLAogICAgICAgICAgICB7Y2xhc3NOYW1lOiAncmVzZXRfaG9sZGVyIGJsb2NrJ30sCgogICAgICAgICAgICAvLyBSZXNldCBsaW5rCiAgICAgICAgICAgIGNyZWF0ZSgnYScsIHsKICAgICAgICAgICAgICBpZDogY29uZmlnSWQgKyAnX3Jlc2V0TGluaycsCiAgICAgICAgICAgICAgdGV4dENvbnRlbnQ6ICdSZXNldCB0byBkZWZhdWx0cycsCiAgICAgICAgICAgICAgaHJlZjogJyMnLAogICAgICAgICAgICAgIHRpdGxlOiAnUmVzZXQgZmllbGRzIHRvIGRlZmF1bHQgdmFsdWVzJywKICAgICAgICAgICAgICBjbGFzc05hbWU6ICdyZXNldCcsCiAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oZSkgeyBlLnByZXZlbnREZWZhdWx0KCk7IGNvbmZpZy5yZXNldCgpOyB9CiAgICAgICAgICAgIH0pCiAgICAgICAgKSkpOwoKICAgICAgICBib2R5LmFwcGVuZENoaWxkKGJvZHlXcmFwcGVyKTsgLy8gUGFpbnQgZXZlcnl0aGluZyB0byB3aW5kb3cgYXQgb25jZQogICAgICAgIGNvbmZpZy5jZW50ZXIoKTsgLy8gU2hvdyBhbmQgY2VudGVyIGlmcmFtZQogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBjb25maWcuY2VudGVyLCBmYWxzZSk7IC8vIENlbnRlciBmcmFtZSBvbiByZXNpemUKCiAgICAgICAgLy8gQ2FsbCB0aGUgb3BlbigpIGNhbGxiYWNrIGZ1bmN0aW9uCiAgICAgICAgY29uZmlnLm9uT3Blbihjb25maWcuZnJhbWUuY29udGVudERvY3VtZW50IHx8IGNvbmZpZy5mcmFtZS5vd25lckRvY3VtZW50LAogICAgICAgICAgICAgICAgICAgICAgY29uZmlnLmZyYW1lLmNvbnRlbnRXaW5kb3cgfHwgd2luZG93LAogICAgICAgICAgICAgICAgICAgICAgY29uZmlnLmZyYW1lKTsKCiAgICAgICAgLy8gQ2xvc2UgZnJhbWUgb24gd2luZG93IGNsb3NlCiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29uZmlnLmNsb3NlKCk7CiAgICAgICAgfSwgZmFsc2UpOwoKICAgICAgICAvLyBOb3cgdGhhdCBldmVyeXRoaW5nIGlzIGxvYWRlZCwgbWFrZSBpdCB2aXNpYmxlCiAgICAgICAgY29uZmlnLmZyYW1lLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgIGNvbmZpZy5pc09wZW4gPSB0cnVlOwogICAgICB9CgogICAgICAvLyBDaGFuZ2UgdGhpcyBpbiB0aGUgb25PcGVuIGNhbGxiYWNrIHVzaW5nIHRoaXMuZnJhbWUuc2V0QXR0cmlidXRlKCdzdHlsZScsICcnKQogICAgICBsZXQgZGVmYXVsdFN0eWxlID0gJ2JvdHRvbTogYXV0bzsgYm9yZGVyOiAxcHggc29saWQgIzAwMDsgZGlzcGxheTogbm9uZTsgaGVpZ2h0OiA3NSU7JwogICAgICAgICsgJyBsZWZ0OiAwOyBtYXJnaW46IDA7IG1heC1oZWlnaHQ6IDk1JTsgbWF4LXdpZHRoOiA5NSU7IG9wYWNpdHk6IDA7JwogICAgICAgICsgJyBvdmVyZmxvdzogYXV0bzsgcGFkZGluZzogMDsgcG9zaXRpb246IGZpeGVkOyByaWdodDogYXV0bzsgdG9wOiAwOycKICAgICAgICArICcgd2lkdGg6IDc1JTsgei1pbmRleDogOTk5OTsnOwoKICAgICAgLy8gRWl0aGVyIHVzZSB0aGUgZWxlbWVudCBwYXNzZWQgdG8gaW5pdCgpIG9yIGNyZWF0ZSBhbiBpZnJhbWUKICAgICAgaWYgKHRoaXMuZnJhbWUpIHsKICAgICAgICB0aGlzLmZyYW1lLmlkID0gdGhpcy5pZDsgLy8gQWxsb3dzIGZvciBwcmVmaXhpbmcgc3R5bGVzIHdpdGggdGhlIGNvbmZpZyBpZAogICAgICAgIHRoaXMuZnJhbWUuc2V0QXR0cmlidXRlKCdzdHlsZScsIGRlZmF1bHRTdHlsZSk7CiAgICAgICAgYnVpbGRDb25maWdXaW4odGhpcy5mcmFtZSwgdGhpcy5mcmFtZS5vd25lckRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENyZWF0ZSBmcmFtZQogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoKHRoaXMuZnJhbWUgPSB0aGlzLmNyZWF0ZSgnaWZyYW1lJywgewogICAgICAgICAgaWQ6IHRoaXMuaWQsCiAgICAgICAgICBzdHlsZTogZGVmYXVsdFN0eWxlCiAgICAgICAgfSkpKTsKCiAgICAgICAgLy8gSW4gV2ViS2l0IHNyYyBjYW4ndCBiZSBzZXQgdW50aWwgaXQgaXMgYWRkZWQgdG8gdGhlIHBhZ2UKICAgICAgICB0aGlzLmZyYW1lLnNyYyA9ICcnOwogICAgICAgIC8vIHdlIHdhaXQgZm9yIHRoZSBpZnJhbWUgdG8gbG9hZCBiZWZvcmUgd2UgY2FuIG1vZGlmeSBpdAogICAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgICB0aGlzLmZyYW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIGxldCBmcmFtZSA9IGNvbmZpZy5mcmFtZTsKICAgICAgICAgICAgaWYgKCFmcmFtZS5jb250ZW50RG9jdW1lbnQpIHsKICAgICAgICAgICAgICB0aGF0LmxvZygiR01fY29uZmlnIGZhaWxlZCB0byBpbml0aWFsaXplIGRlZmF1bHQgc2V0dGluZ3MgZGlhbG9nIG5vZGUhIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbGV0IGJvZHkgPSBmcmFtZS5jb250ZW50RG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTsKICAgICAgICAgICAgICBib2R5LmlkID0gY29uZmlnLmlkOyAvLyBBbGxvd3MgZm9yIHByZWZpeGluZyBzdHlsZXMgd2l0aCB0aGUgY29uZmlnIGlkCiAgICAgICAgICAgICAgYnVpbGRDb25maWdXaW4oYm9keSwgZnJhbWUuY29udGVudERvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0pOwogICAgICAgICAgICB9CiAgICAgICAgfSwgZmFsc2UpOwogICAgICB9CiAgICB9LAoKICAgIHNhdmU6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy53cml0ZShudWxsLCBudWxsLCAodmFscykgPT4gdGhpcy5vblNhdmUodmFscykpOwogICAgfSwKCiAgICBjbG9zZTogZnVuY3Rpb24oKSB7CiAgICAgIC8vIElmIGZyYW1lIGlzIGFuIGlmcmFtZSB0aGVuIHJlbW92ZSBpdAogICAgICBpZiAodGhpcy5mcmFtZSAmJiB0aGlzLmZyYW1lLmNvbnRlbnREb2N1bWVudCkgewogICAgICAgIHRoaXMucmVtb3ZlKHRoaXMuZnJhbWUpOwogICAgICAgIHRoaXMuZnJhbWUgPSBudWxsOwogICAgICB9IGVsc2UgaWYgKHRoaXMuZnJhbWUpIHsgLy8gZWxzZSB3aXBlIGl0cyBjb250ZW50CiAgICAgICAgdGhpcy5mcmFtZS5pbm5lckhUTUwgPSAiIjsKICAgICAgICB0aGlzLmZyYW1lLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIH0KCiAgICAgIC8vIE51bGwgb3V0IGFsbCB0aGUgZmllbGRzIHNvIHdlIGRvbid0IGxlYWsgbWVtb3J5CiAgICAgIGxldCBmaWVsZHMgPSB0aGlzLmZpZWxkczsKICAgICAgZm9yIChsZXQgaWQgaW4gZmllbGRzKSB7CiAgICAgICAgbGV0IGZpZWxkID0gZmllbGRzW2lkXTsKICAgICAgICBmaWVsZC53cmFwcGVyID0gbnVsbDsKICAgICAgICBmaWVsZC5ub2RlID0gbnVsbDsKICAgICAgfQoKICAgICAgdGhpcy5vbkNsb3NlKCk7IC8vICBDYWxsIHRoZSBjbG9zZSgpIGNhbGxiYWNrIGZ1bmN0aW9uCiAgICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7CiAgICB9LAoKICAgIHNldDogZnVuY3Rpb24gKG5hbWUsIHZhbCkgewogICAgICB0aGlzLmZpZWxkc1tuYW1lXS52YWx1ZSA9IHZhbDsKCiAgICAgIGlmICh0aGlzLmZpZWxkc1tuYW1lXS5ub2RlKSB7CiAgICAgICAgdGhpcy5maWVsZHNbbmFtZV0ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0sCgogICAgZ2V0OiBmdW5jdGlvbiAobmFtZSwgZ2V0TGl2ZSkgewogICAgICAvKiBNaWdyYXRpb24gd2FybmluZyAqLwogICAgICBpZiAoIXRoaXMuaXNJbml0KSB7CiAgICAgICAgdGhpcy5sb2coJ0dNX2NvbmZpZzogZ2V0IGNhbGxlZCBiZWZvcmUgaW5pdCwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9zaXp6bGVtY3R3aXp6bGUvR01fY29uZmlnL2lzc3Vlcy8xMTMnKTsKICAgICAgfQoKICAgICAgbGV0IGZpZWxkID0gdGhpcy5maWVsZHNbbmFtZV0sCiAgICAgICAgICBmaWVsZFZhbCA9IG51bGw7CgogICAgICBpZiAoZ2V0TGl2ZSAmJiBmaWVsZC5ub2RlKSB7CiAgICAgICAgZmllbGRWYWwgPSBmaWVsZC50b1ZhbHVlKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmaWVsZFZhbCAhPSBudWxsID8gZmllbGRWYWwgOiBmaWVsZC52YWx1ZTsKICAgIH0sCgogICAgd3JpdGU6IGZ1bmN0aW9uIChzdG9yZSwgb2JqLCBjYikgewogICAgICBsZXQgZm9yZ290dGVuID0gbnVsbCwKICAgICAgICAgIHZhbHVlcyA9IG51bGw7CiAgICAgIGlmICghb2JqKSB7CiAgICAgICAgbGV0IGZpZWxkcyA9IHRoaXMuZmllbGRzOwoKICAgICAgICB2YWx1ZXMgPSB7fTsKICAgICAgICBmb3Jnb3R0ZW4gPSB7fTsKCiAgICAgICAgZm9yIChsZXQgaWQgaW4gZmllbGRzKSB7CiAgICAgICAgICBsZXQgZmllbGQgPSBmaWVsZHNbaWRdOwogICAgICAgICAgbGV0IHZhbHVlID0gZmllbGQudG9WYWx1ZSgpOwoKICAgICAgICAgIGlmIChmaWVsZC5zYXZlKSB7CiAgICAgICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgdmFsdWVzW2lkXSA9IHZhbHVlOwogICAgICAgICAgICAgIGZpZWxkLnZhbHVlID0gdmFsdWU7CiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgIHZhbHVlc1tpZF0gPSBmaWVsZC52YWx1ZTsKICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICBmb3Jnb3R0ZW5baWRdID0gdmFsdWUgIT0gbnVsbCA/IHZhbHVlIDogZmllbGQudmFsdWU7CiAgICAgICAgfQogICAgICB9CgogICAgICAoYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBsZXQgdmFsID0gdGhpcy5zdHJpbmdpZnkob2JqIHx8IHZhbHVlcyk7CiAgICAgICAgICBhd2FpdCB0aGlzLnNldFZhbHVlKHN0b3JlIHx8IHRoaXMuaWQsIHZhbCk7CiAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICB0aGlzLmxvZygiR01fY29uZmlnIGZhaWxlZCB0byBzYXZlIHNldHRpbmdzISIpOwogICAgICAgIH0KICAgICAgICBjYihmb3Jnb3R0ZW4pOwogICAgICB9KSgpOwogICAgfSwKCiAgICByZWFkOiBmdW5jdGlvbiAoc3RvcmUsIGNiKSB7CiAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgbGV0IHZhbCA9IGF3YWl0IHRoaXMuZ2V0VmFsdWUoc3RvcmUgfHwgdGhpcy5pZCwgJ3t9Jyk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGxldCBydmFsID0gdGhpcy5wYXJzZXIodmFsKTsKICAgICAgICAgIGNiKHJ2YWwpOwogICAgICAgIH0gY2F0Y2goZSkgewogICAgICAgICAgdGhpcy5sb2coIkdNX2NvbmZpZyBmYWlsZWQgdG8gcmVhZCBzYXZlZCBzZXR0aW5ncyEiKTsKICAgICAgICAgIGNiKHt9KTsKICAgICAgICB9CiAgICAgIH0pKCk7CiAgICB9LAoKICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgIGxldCBmaWVsZHMgPSB0aGlzLmZpZWxkczsKCiAgICAgIC8vIFJlc2V0IGFsbCB0aGUgZmllbGRzCiAgICAgIGZvciAobGV0IGlkIGluIGZpZWxkcykgeyBmaWVsZHNbaWRdLnJlc2V0KCk7IH0KCiAgICAgIHRoaXMub25SZXNldCgpOyAvLyBDYWxsIHRoZSByZXNldCgpIGNhbGxiYWNrIGZ1bmN0aW9uCiAgICB9LAoKICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkgewogICAgICBsZXQgQSA9IG51bGwsCiAgICAgICAgICBCID0gbnVsbDsKICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBBID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoYXJndW1lbnRzWzBdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBBID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChhcmd1bWVudHNbMF0pOwogICAgICAgICAgQiA9IGFyZ3VtZW50c1sxXTsKICAgICAgICAgIGZvciAobGV0IGIgaW4gQikgewogICAgICAgICAgICBpZiAoYi5pbmRleE9mKCJvbiIpID09IDApCiAgICAgICAgICAgICAgQS5hZGRFdmVudExpc3RlbmVyKGIuc3Vic3RyaW5nKDIpLCBCW2JdLCBmYWxzZSk7CiAgICAgICAgICAgIGVsc2UgaWYgKCIsc3R5bGUsYWNjZXNza2V5LGlkLG5hbWUsc3JjLGhyZWYsd2hpY2gsZm9yIi5pbmRleE9mKCIsIiArCiAgICAgICAgICAgICAgICAgICAgIGIudG9Mb3dlckNhc2UoKSkgIT0gLTEpCiAgICAgICAgICAgICAgQS5zZXRBdHRyaWJ1dGUoYiwgQltiXSk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICBBW2JdID0gQltiXTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh0eXBlb2YgYXJndW1lbnRzWzJdID09ICJzdHJpbmciKQogICAgICAgICAgICBBLmlubmVySFRNTCA9IGFyZ3VtZW50c1syXTsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW47ICsraSkKICAgICAgICAgICAgICBBLmFwcGVuZENoaWxkKGFyZ3VtZW50c1tpXSk7CiAgICAgIH0KICAgICAgcmV0dXJuIEE7CiAgICB9LAoKICAgIGNlbnRlcjogZnVuY3Rpb24gKCkgewogICAgICBsZXQgbm9kZSA9IHRoaXMuZnJhbWU7CiAgICAgIGlmICghbm9kZSkgcmV0dXJuOwogICAgICBsZXQgc3R5bGUgPSBub2RlLnN0eWxlLAogICAgICAgICAgYmVmb3JlT3BhY2l0eSA9IHN0eWxlLm9wYWNpdHk7CiAgICAgIGlmIChzdHlsZS5kaXNwbGF5ID09ICdub25lJykgc3R5bGUub3BhY2l0eSA9ICcwJzsKICAgICAgc3R5bGUuZGlzcGxheSA9ICcnOwogICAgICBzdHlsZS50b3AgPSBNYXRoLmZsb29yKCh3aW5kb3cuaW5uZXJIZWlnaHQgLyAyKSAtIChub2RlLm9mZnNldEhlaWdodCAvIDIpKSArICdweCc7CiAgICAgIHN0eWxlLmxlZnQgPSBNYXRoLmZsb29yKCh3aW5kb3cuaW5uZXJXaWR0aCAvIDIpIC0gKG5vZGUub2Zmc2V0V2lkdGggLyAyKSkgKyAncHgnOwogICAgICBzdHlsZS5vcGFjaXR5ID0gJzEnOwogICAgfSwKCiAgICByZW1vdmU6IGZ1bmN0aW9uIChlbCkgewogICAgICBpZiAoZWwgJiYgZWwucGFyZW50Tm9kZSkgZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbCk7CiAgICB9CiAgfTsKCiAgY29uc3RydWN0LnByb3RvdHlwZS5uYW1lID0gJ0dNX2NvbmZpZyc7CiAgY29uc3RydWN0LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGNvbnN0cnVjdDsKICBsZXQgaXNHTTQgPSB0eXBlb2YgR00uZ2V0VmFsdWUgIT09ICd1bmRlZmluZWQnICYmCiAgICB0eXBlb2YgR00uc2V0VmFsdWUgIT09ICd1bmRlZmluZWQnOwogIGxldCBpc0dNID0gaXNHTTQgfHwgKHR5cGVvZiBHTV9nZXRWYWx1ZSAhPT0gJ3VuZGVmaW5lZCcgJiYKICAgIHR5cGVvZiBHTV9nZXRWYWx1ZSgnYScsICdiJykgIT09ICd1bmRlZmluZWQnKTsKICBjb25zdHJ1Y3QucHJvdG90eXBlLmlzR00gPSBpc0dNOwoKICBpZiAoIWlzR000KSB7CiAgICBsZXQgcHJvbWlzaWZ5ID0gKG9sZCkgPT4gKC4uLmFyZ3MpID0+IHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgcmVzb2x2ZShvbGQuYXBwbHkodGhpcywgYXJncykpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICBsZXQgZ2V0VmFsdWUgPSBpc0dNID8gR01fZ2V0VmFsdWUKICAgICAgOiAobmFtZSwgZGVmKSA9PiB7CiAgICAgICAgbGV0IHMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShuYW1lKTsKICAgICAgICByZXR1cm4gcyAhPT0gbnVsbCA/IHMgOiBkZWY7CiAgICAgIH07CiAgICBsZXQgc2V0VmFsdWUgPSBpc0dNID8gR01fc2V0VmFsdWUKICAgICAgOiAobmFtZSwgdmFsdWUpID0+IGxvY2FsU3RvcmFnZS5zZXRJdGVtKG5hbWUsIHZhbHVlKTsKICAgIGxldCBsb2cgPSB0eXBlb2YgR01fbG9nICE9PSAndW5kZWZpbmVkJyA/IEdNX2xvZyA6IGNvbnNvbGUubG9nOwoKICAgIEdNLmdldFZhbHVlID0gcHJvbWlzaWZ5KGdldFZhbHVlKTsKICAgIEdNLnNldFZhbHVlID0gcHJvbWlzaWZ5KHNldFZhbHVlKTsKICAgIEdNLmxvZyA9IHByb21pc2lmeShsb2cpOwogIH0KCiAgY29uc3RydWN0LnByb3RvdHlwZS5zdHJpbmdpZnkgPSBKU09OLnN0cmluZ2lmeTsKICBjb25zdHJ1Y3QucHJvdG90eXBlLnBhcnNlciA9IEpTT04ucGFyc2U7CiAgY29uc3RydWN0LnByb3RvdHlwZS5nZXRWYWx1ZSA9IEdNLmdldFZhbHVlOwogIGNvbnN0cnVjdC5wcm90b3R5cGUuc2V0VmFsdWUgPSBHTS5zZXRWYWx1ZTsKICBjb25zdHJ1Y3QucHJvdG90eXBlLmxvZyA9IEdNLmxvZyB8fCBjb25zb2xlLmxvZzsKCiAgLy8gUGFzc3Rocm91Z2ggZnJvbnRlbmRzIGZvciBuZXcgYW5kIG9sZCB1c2FnZQogIGxldCBjb25maWcgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gbmV3IChjb25maWcuYmluZC5hcHBseShjb25zdHJ1Y3QsCiAgICAgIFtudWxsXS5jb25jYXQoQXJyYXkuZnJvbShhcmd1bWVudHMpKSkpOwogIH07CiAgY29uZmlnLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGNvbmZpZzsKCiAgLy8gU3VwcG9ydCBvbGQgbWV0aG9kIG9mIGluaXRhbGl6aW5nCiAgY29uZmlnLmluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICBHTV9jb25maWcgPSBjb25maWcuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIEdNX2NvbmZpZy5pbml0ID0gZnVuY3Rpb24oKSB7CiAgICAgIEdNX2NvbmZpZ0luaXQodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfTsKCiAgY29uZmlnLmNyZWF0ZSA9IGNvbnN0cnVjdC5wcm90b3R5cGUuY3JlYXRlOwogIGNvbmZpZy5pc0dNID0gY29uc3RydWN0LnByb3RvdHlwZS5pc0dNOwogIGNvbmZpZy5zZXRWYWx1ZSA9IGNvbnN0cnVjdC5wcm90b3R5cGUuc2V0VmFsdWU7CiAgY29uZmlnLmdldFZhbHVlID0gY29uc3RydWN0LnByb3RvdHlwZS5nZXRWYWx1ZTsKICBjb25maWcuc3RyaW5naWZ5ID0gY29uc3RydWN0LnByb3RvdHlwZS5zdHJpbmdpZnk7CiAgY29uZmlnLnBhcnNlciA9IGNvbnN0cnVjdC5wcm90b3R5cGUucGFyc2VyOwogIGNvbmZpZy5sb2cgPSBjb25zdHJ1Y3QucHJvdG90eXBlLmxvZzsKICBjb25maWcucmVtb3ZlID0gY29uc3RydWN0LnByb3RvdHlwZS5yZW1vdmU7CgogIHJldHVybiBjb25maWc7Cn0odHlwZW9mIEdNID09PSAnb2JqZWN0JyA/IEdNIDogT2JqZWN0LmNyZWF0ZShudWxsKSkpOwpsZXQgR01fY29uZmlnU3RydWN0ID0gR01fY29uZmlnOwoKZnVuY3Rpb24gR01fY29uZmlnRmllbGQoc2V0dGluZ3MsIHN0b3JlZCwgaWQsIGN1c3RvbVR5cGUsIGNvbmZpZ0lkKSB7CiAgLy8gU3RvcmUgdGhlIGZpZWxkJ3Mgc2V0dGluZ3MKICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7CiAgdGhpcy5pZCA9IGlkOwogIHRoaXMuY29uZmlnSWQgPSBjb25maWdJZDsKICB0aGlzLm5vZGUgPSBudWxsOwogIHRoaXMud3JhcHBlciA9IG51bGw7CiAgdGhpcy5zYXZlID0gdHlwZW9mIHNldHRpbmdzLnNhdmUgPT0gInVuZGVmaW5lZCIgPyB0cnVlIDogc2V0dGluZ3Muc2F2ZTsKCiAgLy8gQnV0dG9ucyBhcmUgc3RhdGljIGFuZCBkb24ndCBoYXZlIGEgc3RvcmVkIHZhbHVlCiAgaWYgKHNldHRpbmdzLnR5cGUgPT0gImJ1dHRvbiIpIHRoaXMuc2F2ZSA9IGZhbHNlOwoKICAvLyBpZiBhIGRlZmF1bHQgdmFsdWUgd2Fzbid0IHBhc3NlZCB0aHJvdWdoIGluaXQoKSB0aGVuCiAgLy8gICBpZiB0aGUgdHlwZSBpcyBjdXN0b20gdXNlIGl0cyBkZWZhdWx0IHZhbHVlCiAgLy8gICBlbHNlIHVzZSBkZWZhdWx0IHZhbHVlIGZvciB0eXBlCiAgLy8gZWxzZSB1c2UgdGhlIGRlZmF1bHQgdmFsdWUgcGFzc2VkIHRocm91Z2ggaW5pdCgpCiAgdGhpc1snZGVmYXVsdCddID0gdHlwZW9mIHNldHRpbmdzWydkZWZhdWx0J10gPT0gInVuZGVmaW5lZCIgPwogICAgY3VzdG9tVHlwZSA/CiAgICAgIGN1c3RvbVR5cGVbJ2RlZmF1bHQnXQogICAgICA6IHRoaXMuZGVmYXVsdFZhbHVlKHNldHRpbmdzLnR5cGUsIHNldHRpbmdzLm9wdGlvbnMpCiAgICA6IHNldHRpbmdzWydkZWZhdWx0J107CgogIC8vIFN0b3JlIHRoZSBmaWVsZCdzIHZhbHVlCiAgdGhpcy52YWx1ZSA9IHR5cGVvZiBzdG9yZWQgPT0gInVuZGVmaW5lZCIgPyB0aGlzWydkZWZhdWx0J10gOiBzdG9yZWQ7CgogIC8vIFNldHVwIG1ldGhvZHMgZm9yIGEgY3VzdG9tIHR5cGUKICBpZiAoY3VzdG9tVHlwZSkgewogICAgdGhpcy50b05vZGUgPSBjdXN0b21UeXBlLnRvTm9kZTsKICAgIHRoaXMudG9WYWx1ZSA9IGN1c3RvbVR5cGUudG9WYWx1ZTsKICAgIHRoaXMucmVzZXQgPSBjdXN0b21UeXBlLnJlc2V0OwogIH0KfQoKR01fY29uZmlnRmllbGQucHJvdG90eXBlID0gewogIGNyZWF0ZTogR01fY29uZmlnLmNyZWF0ZSwKCiAgZGVmYXVsdFZhbHVlOiBmdW5jdGlvbih0eXBlLCBvcHRpb25zKSB7CiAgICBsZXQgdmFsdWU7CgogICAgaWYgKHR5cGUuaW5kZXhPZigndW5zaWduZWQgJykgPT0gMCkKICAgICAgdHlwZSA9IHR5cGUuc3Vic3RyaW5nKDkpOwoKICAgIHN3aXRjaCAodHlwZSkgewogICAgICBjYXNlICdyYWRpbyc6IGNhc2UgJ3NlbGVjdCc6CiAgICAgICAgdmFsdWUgPSBvcHRpb25zWzBdOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdjaGVja2JveCc6CiAgICAgICAgdmFsdWUgPSBmYWxzZTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnaW50JzogY2FzZSAnaW50ZWdlcic6CiAgICAgIGNhc2UgJ2Zsb2F0JzogY2FzZSAnbnVtYmVyJzoKICAgICAgICB2YWx1ZSA9IDA7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdmFsdWUgPSAnJzsKICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgfSwKCiAgdG9Ob2RlOiBmdW5jdGlvbigpIHsKICAgIGxldCBmaWVsZCA9IHRoaXMuc2V0dGluZ3MsCiAgICAgICAgdmFsdWUgPSB0aGlzLnZhbHVlLAogICAgICAgIG9wdGlvbnMgPSBmaWVsZC5vcHRpb25zLAogICAgICAgIHR5cGUgPSBmaWVsZC50eXBlLAogICAgICAgIGlkID0gdGhpcy5pZCwKICAgICAgICBjb25maWdJZCA9IHRoaXMuY29uZmlnSWQsCiAgICAgICAgbGFiZWxQb3MgPSBmaWVsZC5sYWJlbFBvcywKICAgICAgICBjcmVhdGUgPSB0aGlzLmNyZWF0ZTsKCiAgICBmdW5jdGlvbiBhZGRMYWJlbChwb3MsIGxhYmVsRWwsIHBhcmVudE5vZGUsIGJlZm9yZUVsKSB7CiAgICAgIGlmICghYmVmb3JlRWwpIGJlZm9yZUVsID0gcGFyZW50Tm9kZS5maXJzdENoaWxkOwogICAgICBzd2l0Y2ggKHBvcykgewogICAgICAgIGNhc2UgJ3JpZ2h0JzogY2FzZSAnYmVsb3cnOgogICAgICAgICAgaWYgKHBvcyA9PSAnYmVsb3cnKQogICAgICAgICAgICBwYXJlbnROb2RlLmFwcGVuZENoaWxkKGNyZWF0ZSgnYnInLCB7fSkpOwogICAgICAgICAgcGFyZW50Tm9kZS5hcHBlbmRDaGlsZChsYWJlbEVsKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpZiAocG9zID09ICdhYm92ZScpCiAgICAgICAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNyZWF0ZSgnYnInLCB7fSksIGJlZm9yZUVsKTsKICAgICAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGxhYmVsRWwsIGJlZm9yZUVsKTsKICAgICAgfQogICAgfQoKICAgIGxldCByZXROb2RlID0gY3JlYXRlKCdkaXYnLCB7IGNsYXNzTmFtZTogJ2NvbmZpZ192YXInLAogICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ18nICsgaWQgKyAnX3ZhcicsCiAgICAgICAgICB0aXRsZTogZmllbGQudGl0bGUgfHwgJycgfSksCiAgICAgICAgZmlyc3RQcm9wOwoKICAgIC8vIFJldHJpZXZlIHRoZSBmaXJzdCBwcm9wCiAgICBmb3IgKGxldCBpIGluIGZpZWxkKSB7IGZpcnN0UHJvcCA9IGk7IGJyZWFrOyB9CgogICAgbGV0IGxhYmVsID0gZmllbGQubGFiZWwgJiYgdHlwZSAhPSAiYnV0dG9uIiA/CiAgICAgIGNyZWF0ZSgnbGFiZWwnLCB7CiAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ18nICsgaWQgKyAnX2ZpZWxkX2xhYmVsJywKICAgICAgICBmb3I6IGNvbmZpZ0lkICsgJ19maWVsZF8nICsgaWQsCiAgICAgICAgY2xhc3NOYW1lOiAnZmllbGRfbGFiZWwnCiAgICAgIH0sIGZpZWxkLmxhYmVsKSA6IG51bGw7CgogICAgbGV0IHdyYXAgPSBudWxsOwogICAgc3dpdGNoICh0eXBlKSB7CiAgICAgIGNhc2UgJ3RleHRhcmVhJzoKICAgICAgICByZXROb2RlLmFwcGVuZENoaWxkKCh0aGlzLm5vZGUgPSBjcmVhdGUoJ3RleHRhcmVhJywgewogICAgICAgICAgaW5uZXJIVE1MOiB2YWx1ZSwKICAgICAgICAgIGlkOiBjb25maWdJZCArICdfZmllbGRfJyArIGlkLAogICAgICAgICAgY2xhc3NOYW1lOiAnYmxvY2snLAogICAgICAgICAgY29sczogKGZpZWxkLmNvbHMgPyBmaWVsZC5jb2xzIDogMjApLAogICAgICAgICAgcm93czogKGZpZWxkLnJvd3MgPyBmaWVsZC5yb3dzIDogMikKICAgICAgICB9KSkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdyYWRpbyc6CiAgICAgICAgd3JhcCA9IGNyZWF0ZSgnZGl2JywgewogICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19maWVsZF8nICsgaWQKICAgICAgICB9KTsKICAgICAgICB0aGlzLm5vZGUgPSB3cmFwOwoKICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gb3B0aW9ucy5sZW5ndGg7IGkgPCBsZW47ICsraSkgewogICAgICAgICAgbGV0IHJhZExhYmVsID0gY3JlYXRlKCdsYWJlbCcsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAncmFkaW9fbGFiZWwnCiAgICAgICAgICB9LCBvcHRpb25zW2ldKTsKCiAgICAgICAgICBsZXQgcmFkID0gd3JhcC5hcHBlbmRDaGlsZChjcmVhdGUoJ2lucHV0JywgewogICAgICAgICAgICB2YWx1ZTogb3B0aW9uc1tpXSwKICAgICAgICAgICAgdHlwZTogJ3JhZGlvJywKICAgICAgICAgICAgbmFtZTogaWQsCiAgICAgICAgICAgIGNoZWNrZWQ6IG9wdGlvbnNbaV0gPT0gdmFsdWUKICAgICAgICAgIH0pKTsKCiAgICAgICAgICBsZXQgcmFkTGFiZWxQb3MgPSBsYWJlbFBvcyAmJgogICAgICAgICAgICAobGFiZWxQb3MgPT0gJ2xlZnQnIHx8IGxhYmVsUG9zID09ICdyaWdodCcpID8KICAgICAgICAgICAgbGFiZWxQb3MgOiBmaXJzdFByb3AgPT0gJ29wdGlvbnMnID8gJ2xlZnQnIDogJ3JpZ2h0JzsKCiAgICAgICAgICBhZGRMYWJlbChyYWRMYWJlbFBvcywgcmFkTGFiZWwsIHdyYXAsIHJhZCk7CiAgICAgICAgfQoKICAgICAgICByZXROb2RlLmFwcGVuZENoaWxkKHdyYXApOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZWxlY3QnOgogICAgICAgIHdyYXAgPSBjcmVhdGUoJ3NlbGVjdCcsIHsKICAgICAgICAgIGlkOiBjb25maWdJZCArICdfZmllbGRfJyArIGlkCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5ub2RlID0gd3JhcDsKCiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IG9wdGlvbnMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsKICAgICAgICAgIGxldCBvcHRpb24gPSBvcHRpb25zW2ldOwogICAgICAgICAgd3JhcC5hcHBlbmRDaGlsZChjcmVhdGUoJ29wdGlvbicsIHsKICAgICAgICAgICAgdmFsdWU6IG9wdGlvbiwKICAgICAgICAgICAgc2VsZWN0ZWQ6IG9wdGlvbiA9PSB2YWx1ZQogICAgICAgICAgfSwgb3B0aW9uKSk7CiAgICAgICAgfQoKICAgICAgICByZXROb2RlLmFwcGVuZENoaWxkKHdyYXApOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OiAvLyBmaWVsZHMgdXNpbmcgaW5wdXQgZWxlbWVudHMKICAgICAgICBsZXQgcHJvcHMgPSB7CiAgICAgICAgICBpZDogY29uZmlnSWQgKyAnX2ZpZWxkXycgKyBpZCwKICAgICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgICB2YWx1ZTogdHlwZSA9PSAnYnV0dG9uJyA/IGZpZWxkLmxhYmVsIDogdmFsdWUKICAgICAgICB9OwoKICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzoKICAgICAgICAgICAgcHJvcHMuY2hlY2tlZCA9IHZhbHVlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ2J1dHRvbic6CiAgICAgICAgICAgIHByb3BzLnNpemUgPSBmaWVsZC5zaXplID8gZmllbGQuc2l6ZSA6IDI1OwogICAgICAgICAgICBpZiAoZmllbGQuc2NyaXB0KSBmaWVsZC5jbGljayA9IGZpZWxkLnNjcmlwdDsKICAgICAgICAgICAgaWYgKGZpZWxkLmNsaWNrKSBwcm9wcy5vbmNsaWNrID0gZmllbGQuY2xpY2s7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnaGlkZGVuJzoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAvLyB0eXBlID0gdGV4dCwgaW50LCBvciBmbG9hdAogICAgICAgICAgICBwcm9wcy50eXBlID0gJ3RleHQnOwogICAgICAgICAgICBwcm9wcy5zaXplID0gZmllbGQuc2l6ZSA/IGZpZWxkLnNpemUgOiAyNTsKICAgICAgICB9CgogICAgICAgIHJldE5vZGUuYXBwZW5kQ2hpbGQoKHRoaXMubm9kZSA9IGNyZWF0ZSgnaW5wdXQnLCBwcm9wcykpKTsKICAgIH0KCiAgICBpZiAobGFiZWwpIHsKICAgICAgLy8gSWYgdGhlIGxhYmVsIGlzIHBhc3NlZCBmaXJzdCwgaW5zZXJ0IGl0IGJlZm9yZSB0aGUgZmllbGQKICAgICAgLy8gZWxzZSBpbnNlcnQgaXQgYWZ0ZXIKICAgICAgaWYgKCFsYWJlbFBvcykKICAgICAgICBsYWJlbFBvcyA9IGZpcnN0UHJvcCA9PSAibGFiZWwiIHx8IHR5cGUgPT0gInJhZGlvIiA/CiAgICAgICAgICAibGVmdCIgOiAicmlnaHQiOwoKICAgICAgYWRkTGFiZWwobGFiZWxQb3MsIGxhYmVsLCByZXROb2RlKTsKICAgIH0KCiAgICByZXR1cm4gcmV0Tm9kZTsKICB9LAoKICB0b1ZhbHVlOiBmdW5jdGlvbigpIHsKICAgIGxldCBub2RlID0gdGhpcy5ub2RlLAogICAgICAgIGZpZWxkID0gdGhpcy5zZXR0aW5ncywKICAgICAgICB0eXBlID0gZmllbGQudHlwZSwKICAgICAgICB1bnNpZ25lZCA9IGZhbHNlLAogICAgICAgIHJ2YWwgPSBudWxsOwoKICAgIGlmICghbm9kZSkgcmV0dXJuIHJ2YWw7CgogICAgaWYgKHR5cGUuaW5kZXhPZigndW5zaWduZWQgJykgPT0gMCkgewogICAgICB0eXBlID0gdHlwZS5zdWJzdHJpbmcoOSk7CiAgICAgIHVuc2lnbmVkID0gdHJ1ZTsKICAgIH0KCiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSAnY2hlY2tib3gnOgogICAgICAgIHJ2YWwgPSBub2RlLmNoZWNrZWQ7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NlbGVjdCc6CiAgICAgICAgcnZhbCA9IG5vZGVbbm9kZS5zZWxlY3RlZEluZGV4XS52YWx1ZTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAncmFkaW8nOgogICAgICAgIGxldCByYWRpb3MgPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpOwogICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSByYWRpb3MubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsKICAgICAgICAgIGlmIChyYWRpb3NbaV0uY2hlY2tlZCkKICAgICAgICAgICAgcnZhbCA9IHJhZGlvc1tpXS52YWx1ZTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2J1dHRvbic6CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2ludCc6IGNhc2UgJ2ludGVnZXInOgogICAgICBjYXNlICdmbG9hdCc6IGNhc2UgJ251bWJlcic6CiAgICAgICAgbGV0IG51bSA9IE51bWJlcihub2RlLnZhbHVlKTsKICAgICAgICBsZXQgd2FybiA9ICdGaWVsZCBsYWJlbGVkICInICsgZmllbGQubGFiZWwgKyAnIiBleHBlY3RzIGEnICsKICAgICAgICAgICh1bnNpZ25lZCA/ICcgcG9zaXRpdmUgJyA6ICduICcpICsgJ2ludGVnZXIgdmFsdWUnOwoKICAgICAgICBpZiAoaXNOYU4obnVtKSB8fCAodHlwZS5zdWJzdHIoMCwgMykgPT0gJ2ludCcgJiYKICAgICAgICAgICAgTWF0aC5jZWlsKG51bSkgIT0gTWF0aC5mbG9vcihudW0pKSB8fAogICAgICAgICAgICAodW5zaWduZWQgJiYgbnVtIDwgMCkpIHsKICAgICAgICAgIGFsZXJ0KHdhcm4gKyAnLicpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXRoaXMuX2NoZWNrTnVtYmVyUmFuZ2UobnVtLCB3YXJuKSkKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJ2YWwgPSBudW07CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcnZhbCA9IG5vZGUudmFsdWU7CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgcmV0dXJuIHJ2YWw7IC8vIHZhbHVlIHJlYWQgc3VjY2Vzc2Z1bGx5CiAgfSwKCiAgcmVzZXQ6IGZ1bmN0aW9uKCkgewogICAgbGV0IG5vZGUgPSB0aGlzLm5vZGUsCiAgICAgICAgZmllbGQgPSB0aGlzLnNldHRpbmdzLAogICAgICAgIHR5cGUgPSBmaWVsZC50eXBlOwoKICAgIGlmICghbm9kZSkgcmV0dXJuOwoKICAgIHN3aXRjaCAodHlwZSkgewogICAgICBjYXNlICdjaGVja2JveCc6CiAgICAgICAgbm9kZS5jaGVja2VkID0gdGhpc1snZGVmYXVsdCddOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZWxlY3QnOgogICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBub2RlLm9wdGlvbnMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsKICAgICAgICAgIGlmIChub2RlLm9wdGlvbnNbaV0udGV4dENvbnRlbnQgPT0gdGhpc1snZGVmYXVsdCddKQogICAgICAgICAgICBub2RlLnNlbGVjdGVkSW5kZXggPSBpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAncmFkaW8nOgogICAgICAgIGxldCByYWRpb3MgPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpOwogICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSByYWRpb3MubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsKICAgICAgICAgIGlmIChyYWRpb3NbaV0udmFsdWUgPT0gdGhpc1snZGVmYXVsdCddKQogICAgICAgICAgICByYWRpb3NbaV0uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdidXR0b24nIDoKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICBub2RlLnZhbHVlID0gdGhpc1snZGVmYXVsdCddOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgfSwKCiAgcmVtb3ZlOiBmdW5jdGlvbihlbCkgewogICAgR01fY29uZmlnLnJlbW92ZShlbCB8fCB0aGlzLndyYXBwZXIpOwogICAgdGhpcy53cmFwcGVyID0gbnVsbDsKICAgIHRoaXMubm9kZSA9IG51bGw7CiAgfSwKCiAgcmVsb2FkOiBmdW5jdGlvbigpIHsKICAgIGxldCB3cmFwcGVyID0gdGhpcy53cmFwcGVyOwogICAgaWYgKHdyYXBwZXIpIHsKICAgICAgbGV0IGZpZWxkUGFyZW50ID0gd3JhcHBlci5wYXJlbnROb2RlOwogICAgICBsZXQgbmV3V3JhcHBlciA9IHRoaXMudG9Ob2RlKCk7CiAgICAgIGZpZWxkUGFyZW50Lmluc2VydEJlZm9yZShuZXdXcmFwcGVyLCB3cmFwcGVyKTsKICAgICAgdGhpcy5yZW1vdmUoKTsKICAgICAgdGhpcy53cmFwcGVyID0gbmV3V3JhcHBlcjsKICAgIH0KICB9LAoKICBfY2hlY2tOdW1iZXJSYW5nZTogZnVuY3Rpb24obnVtLCB3YXJuKSB7CiAgICBsZXQgZmllbGQgPSB0aGlzLnNldHRpbmdzOwogICAgaWYgKHR5cGVvZiBmaWVsZC5taW4gPT0gIm51bWJlciIgJiYgbnVtIDwgZmllbGQubWluKSB7CiAgICAgIGFsZXJ0KHdhcm4gKyAnIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAnICsgZmllbGQubWluICsgJy4nKTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKHR5cGVvZiBmaWVsZC5tYXggPT0gIm51bWJlciIgJiYgbnVtID4gZmllbGQubWF4KSB7CiAgICAgIGFsZXJ0KHdhcm4gKyAnIGxlc3MgdGhhbiBvciBlcXVhbCB0byAnICsgZmllbGQubWF4ICsgJy4nKTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07Cg=="}]},{"name":"Sleek YouTube Downloader","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://www.youtube.com/","https://www.youtube.com/watch*","https://www.youtube.com/playlist*"],"orig_noframes":null,"orig_run_at":"document-end","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685019502075,"data":{}},"enabled":true,"position":3,"file_url":"https://greasyfork.org/scripts/438233-sleek-youtube-downloader/code/Sleek%20YouTube%20Downloader.user.js","uuid":"1f87d83e-305a-46a4-99c1-a15ce8e98df1","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBTbGVlayBZb3VUdWJlIERvd25sb2FkZXIKLy8gQG5hbWVzcGFjZSAgICBodHRwczovL2dpdGh1Yi5jb20vdGhpc2lzbXktZ2l0aHViCi8vIEBkZXNjcmlwdGlvbiAgQSBzaW1wbGUgdG9vbCB0aGF0IGFkZHMgWW91VHViZS1zdHlsZSBidXR0b25zIGZvciBtdWx0aS1mb3JtYXQgZG93bmxvYWRpbmcuIExpZ2h0ZXIgdGhhbiBtb3N0IGRvd25sb2FkIHNjcmlwdHMuCi8vIEBhdXRob3IgICAgICAgdGhpc2lzbXktZ2l0aHViCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly93d3cueW91dHViZS5jb20vCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2gqCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly93d3cueW91dHViZS5jb20vcGxheWxpc3QqCi8vIEBncmFudCAgICAgICAgbm9uZQovLyBAbGljZW5zZSAgICAgIE1JVAovLyBAcnVuLWF0ICAgICAgIGRvY3VtZW50LWVuZAovLyBAdmVyc2lvbiAgICAgIDMuMi4wCi8vID09L1VzZXJTY3JpcHQ9PQoKCi8vIFZhbGlkIGZvcm1hdHM6IE1QNCB8fCBNUDMsIFdBViwgTTRBLCBXRUJNLCBBQUMsIEZMQUMsIE9QVVMsIE9HRwpjb25zdCBidXR0b25zID0gWyJNUDMiLCAiTVA0Il07CgoKLy8gVGhlcmUgaXMgbm8gY29uc2lzdGVudCB2YXJpYWJsZSBmb3IgYm9yZGVyLXJhZGl1cyAoYnV0dG9uIHJvdW5kbmVzcykgeWV0LgovLyBPbGQgYm9yZGVyLXJhZGl1czogMnB4LiBOZXcgYm9yZGVyLXJhZGl1czogMjBweCBvciBoaWdoZXIuCmNvbnN0IGNzc1RleHQgPSBgCiAgICAuZG93bmxvYWQtYnV0dG9uIHsKICAgICAgICBib3JkZXItcmFkaXVzOiAyMHB4OwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IHJvdzsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teXQtc3BlYy0xMC1wZXJjZW50LWxheWVyKTsKICAgICAgICBjb2xvcjogdmFyKC0teXQtc3BlYy10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgcGFkZGluZzogdmFyKC0teXQtYnV0dG9uLXBhZGRpbmcpOwogICAgICAgIG1hcmdpbjogYXV0byB2YXIoLS15dGQtc3Vic2NyaWJlLWJ1dHRvbi1tYXJnaW4sIDRweCk7CiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgICBmb250LXNpemU6IHZhcigtLXl0ZC10YWItc3lzdGVtLWZvbnQtc2l6ZSwgMS40cmVtKTsKICAgICAgICBmb250LXdlaWdodDogdmFyKC0teXRkLXRhYi1zeXN0ZW0tZm9udC13ZWlnaHQsIDUwMCk7CiAgICAgICAgbGV0dGVyLXNwYWNpbmc6IHZhcigtLXl0ZC10YWItc3lzdGVtLWxldHRlci1zcGFjaW5nLCAuMDA3cHgpOwogICAgICAgIHRleHQtdHJhbnNmb3JtOiB2YXIoLS15dGQtdGFiLXN5c3RlbS10ZXh0LXRyYW5zZm9ybSwgdXBwZXJjYXNlKTsKICAgIH0KICAgIC5kb3dubG9hZC1idXR0b24tdGV4dCB7CiAgICAgICAgLS15dC1mb3JtYXR0ZWQtc3RyaW5nLWRlZW1waGFzaXplXy1fZGlzcGxheTogaW5pdGlhbDsKICAgICAgICAtLXl0LWZvcm1hdHRlZC1zdHJpbmctZGVlbXBoYXNpemUtY29sb3I6IHZhcigtLXl0LXNwZWMtdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIC0teXQtZm9ybWF0dGVkLXN0cmluZy1kZWVtcGhhc2l6ZV8tX21hcmdpbi1sZWZ0OiA0cHg7CiAgICB9CiAgICAuZG93bmxvYWQtYnV0dG9uLWNvbnRhaW5lciB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBmbGV4LWRpcmVjdGlvbjogcm93OwogICAgfQogICAgLmRvd25sb2FkLXBsYXlsaXN0LWJ1dHRvbiB7CiAgICAgICAgbWFyZ2luLXJpZ2h0OiA4cHg7CiAgICAgICAgbWFyZ2luLWxlZnQ6IDBweDsKICAgIH0KICAgIC5kb3dubG9hZC1wbGF5bGlzdC1idXR0b24tdGV4dCB7CiAgICAgICAgY29sb3I6ICNFNEU0RTQ7CiAgICB9CmA7CgoKKGZ1bmN0aW9uKCkgewogICAgJ3VzZSBzdHJpY3QnOwogICAgd2luZG93Lm9ubG9hZCA9ICgpID0+IHsKCiAgICAgICAgLy8gcGxheWxpc3QgcGFnZXMgd2lsbCB0cnkgdG8gYWRkIHRoZSBidXR0b25zIHJlcGVhdGVkbHkKICAgICAgICBsZXQgcGxheWxpc3RCdXR0b25zQWRkZWQgPSBmYWxzZTsKCiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInl0LW5hdmlnYXRlLWZpbmlzaCIsICgpID0+IHsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CgogICAgICAgICAgICAgICAgLy8gYXBwbHkgY3NzCiAgICAgICAgICAgICAgICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7CiAgICAgICAgICAgICAgICBzdHlsZS50eXBlID0gInRleHQvY3NzIjsKICAgICAgICAgICAgICAgIHN0eWxlLmlubmVySFRNTCA9IGNzc1RleHQ7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTsKCiAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgcGxheWxpc3QgYW5kIGNyZWF0ZSBhcHByb3ByaWF0ZSBxdWVyeQogICAgICAgICAgICAgICAgbGV0IHF1ZXJ5ID0gIiNhbmFseXRpY3MtYnV0dG9uOm5vdCguZG93bmxvYWQtcGFuZWwpIjsKICAgICAgICAgICAgICAgIGxldCBpblBsYXlsaXN0ID0gbG9jYXRpb24uaHJlZi5pbmNsdWRlcygiL3BsYXlsaXN0Iik7CiAgICAgICAgICAgICAgICBpZiAoaW5QbGF5bGlzdCAmJiAhcGxheWxpc3RCdXR0b25zQWRkZWQpIHsKICAgICAgICAgICAgICAgICAgICBxdWVyeSArPSAiLCBkaXYubWV0YWRhdGEtYnV0dG9ucy13cmFwcGVyOm5vdCguZG93bmxvYWQtcGFuZWwpIjsKICAgICAgICAgICAgICAgICAgICBwbGF5bGlzdEJ1dHRvbnNBZGRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChxdWVyeSkuZm9yRWFjaChwYW5lbCA9PiB7CgogICAgICAgICAgICAgICAgICAgIC8vIG91dGVyIGNvbnRhaW5lciAodG8gZmxleCBidXR0b25zIHNpZGUtYnktc2lkZSkKICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgiZG93bmxvYWQtYnV0dG9uLWNvbnRhaW5lciIpOwoKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1dHRvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7ICAgICAgICAvLyBidXR0b24KICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoImRvd25sb2FkLWJ1dHRvbiIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5QbGF5bGlzdCkgeyBidXR0b24uY2xhc3NMaXN0LmFkZCgiZG93bmxvYWQtcGxheWxpc3QtYnV0dG9uIik7IH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsgICAgICAgICAgICAgLy8gZG93bmxvYWQgZnVuY3Rpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsaW5rID0gZW5jb2RlVVJJQ29tcG9uZW50KGxvY2F0aW9uLmhyZWYpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZvcm1hdCA9IGJ1dHRvbnNbaV0udG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXQgPT09ICJtcDQiKSB7IGZvcm1hdCA9ICI3IjsgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oYGh0dHBzOi8vbG9hZGVyLnRvLz9saW5rPSR7IGxpbmsgfSZmPSR7IGZvcm1hdCB9JnM9MSZlPTEmcj1sb2FkZXJgKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBidXR0b25UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpOyAgIC8vIGJ1dHRvbiB0ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvblRleHQuY2xhc3NMaXN0LmFkZCgiZG93bmxvYWQtYnV0dG9uLXRleHQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluUGxheWxpc3QpIHsgYnV0dG9uVGV4dC5jbGFzc0xpc3QuYWRkKCJkb3dubG9hZC1wbGF5bGlzdC1idXR0b24tdGV4dCIpOyB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvblRleHQuaW5uZXJIVE1MID0gYnV0dG9uc1tpXTsKICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGJ1dHRvblRleHQpOyAgICAgICAgICAgICAgICAgICAgICAvLyBhcHBlbmQgdGV4dCB0byBidXR0b24KICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGJ1dHRvbik7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBwYW5lbC5jbGFzc0xpc3QuYWRkKCJkb3dubG9hZC1wYW5lbCIpOwogICAgICAgICAgICAgICAgICAgIHBhbmVsLmluc2VydEJlZm9yZShjb250YWluZXIsIHBhbmVsLmZpcnN0RWxlbWVudENoaWxkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9LCAyMDApOwogICAgICAgIH0pOwogICAgfTsKfSkoKTs="},{"name":"[Pixlr] Remove Black Sidebar","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://pixlr.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685019751319,"data":{}},"enabled":true,"position":4,"file_url":"https://greasyfork.org/scripts/430910-pixlr-remove-black-sidebar/code/%5BPixlr%5D%20Remove%20Black%20Sidebar.user.js","uuid":"db0afe60-f90f-4e1f-b884-54fe57199d08","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIFtQaXhscl0gUmVtb3ZlIEJsYWNrIFNpZGViYXIKLy8gQG5hbWVzcGFjZSAgIEhLUgovLyBAbWF0Y2ggICAgICAgaHR0cHM6Ly9waXhsci5jb20vKgovLyBAZ3JhbnQgICAgICAgbm9uZQovLyBAdmVyc2lvbiAgICAgMS4xCi8vIEBhdXRob3IgICAgICBIS1IKLy8gQGRlc2NyaXB0aW9uIFJlbW92ZXMgdGhlIGFubm95aW5nIGJsYWNrIHNpZGViYXIgdGhhdCBBZGJsb2NrZXJzIGRpZG4ndCByZW1vdmUuCi8vIEByZXF1aXJlICAgICBodHRwczovL2dyZWFzeWZvcmsub3JnL3NjcmlwdHMvMjE5MjctYXJyaXZlLWpzL2NvZGUvYXJyaXZlanMuanMKLy8gQHN1cHBvcnRVUkwgIGh0dHBzOi8vZ2l0aHViLmNvbS9IYWtvcnIvVXNlcnNjcmlwdHMvaXNzdWVzCi8vIEBncmFudCAgICAgICBHTV9hZGRTdHlsZQovLyA9PS9Vc2VyU2NyaXB0PT0KCigoKSA9PiB7CkdNX2FkZFN0eWxlKCIjd29ya3NwYWNlIHsgcmlnaHQ6IDBweCAhaW1wb3J0YW50OyB9Iik7Cgpkb2N1bWVudC5hcnJpdmUoJyNzbG90JywgZnVuY3Rpb24gKCkgewogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Nsb3QnKS5yZW1vdmUoKTsKICAgIGNvbnNvbGUubG9nKCJbUmVtb3ZlIEJsYWNrIFNpZGVyYmFyXSBSZW1vdmVkIGFuIGVsZW1lbnQhIikKfSk7Cgpkb2N1bWVudC5hcnJpdmUoJyNyaWdodC1zcGFjZScsIGZ1bmN0aW9uICgpIHsKICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNyaWdodC1zcGFjZScpLnJlbW92ZSgpOwogICAgY29uc29sZS5sb2coIltSZW1vdmUgQmxhY2sgU2lkZXJiYXJdIFJlbW92ZWQgYW4gZWxlbWVudCEiKQp9KTsKfSkoKTsK","requires":[{"meta":{"name":"arrivejs.js","url":"https://greasyfork.org/scripts/21927-arrive-js/code/arrivejs.js","ts":1685019751658,"mimetype":"text/javascript"},"source":"LypnbG9iYWxzIGpRdWVyeSxXaW5kb3csSFRNTEVsZW1lbnQsSFRNTERvY3VtZW50LEhUTUxDb2xsZWN0aW9uLE5vZGVMaXN0LE11dGF0aW9uT2JzZXJ2ZXIgKi8KLypleHBvcnRlZCBBcnJpdmUqLwovKmpzaGludCBsYXRlZGVmOmZhbHNlICovCgovKgogKiBhcnJpdmUuanMKICogdjIuNC4xCiAqIGh0dHBzOi8vZ2l0aHViLmNvbS91emFpcmZhcm9vcS9hcnJpdmUKICogTUlUIGxpY2Vuc2VkCiAqCiAqIENvcHlyaWdodCAoYykgMjAxNC0yMDE3IFV6YWlyIEZhcm9vcQogKi8KdmFyIEFycml2ZSA9IChmdW5jdGlvbih3aW5kb3csICQsIHVuZGVmaW5lZCkgewoKICAidXNlIHN0cmljdCI7CgogIGlmKCF3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB0eXBlb2YgSFRNTEVsZW1lbnQgPT09ICd1bmRlZmluZWQnKXsKICAgIHJldHVybjsgLy9mb3IgdW5zdXBwb3J0ZWQgYnJvd3NlcnMKICB9CgogIHZhciBhcnJpdmVVbmlxdWVJZCA9IDA7CgogIHZhciB1dGlscyA9IChmdW5jdGlvbigpIHsKICAgIHZhciBtYXRjaGVzID0gSFRNTEVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXMgfHwgSFRNTEVsZW1lbnQucHJvdG90eXBlLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fCBIVE1MRWxlbWVudC5wcm90b3R5cGUubW96TWF0Y2hlc1NlbGVjdG9yCiAgICAgICAgICAgICAgICAgIHx8IEhUTUxFbGVtZW50LnByb3RvdHlwZS5tc01hdGNoZXNTZWxlY3RvcjsKCiAgICByZXR1cm4gewogICAgICBtYXRjaGVzU2VsZWN0b3I6IGZ1bmN0aW9uKGVsZW0sIHNlbGVjdG9yKSB7CiAgICAgICAgcmV0dXJuIGVsZW0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiBtYXRjaGVzLmNhbGwoZWxlbSwgc2VsZWN0b3IpOwogICAgICB9LAogICAgICAvLyB0byBlbmFibGUgZnVuY3Rpb24gb3ZlcmxvYWRpbmcgLSBCeSBKb2huIFJlc2lnIChNSVQgTGljZW5zZWQpCiAgICAgIGFkZE1ldGhvZDogZnVuY3Rpb24gKG9iamVjdCwgbmFtZSwgZm4pIHsKICAgICAgICB2YXIgb2xkID0gb2JqZWN0WyBuYW1lIF07CiAgICAgICAgb2JqZWN0WyBuYW1lIF0gPSBmdW5jdGlvbigpewogICAgICAgICAgaWYgKCBmbi5sZW5ndGggPT0gYXJndW1lbnRzLmxlbmd0aCApIHsKICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKICAgICAgICAgIH0KICAgICAgICAgIGVsc2UgaWYgKCB0eXBlb2Ygb2xkID09ICdmdW5jdGlvbicgKSB7CiAgICAgICAgICAgIHJldHVybiBvbGQuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0sCiAgICAgIGNhbGxDYWxsYmFja3M6IGZ1bmN0aW9uKGNhbGxiYWNrc1RvQmVDYWxsZWQsIHJlZ2lzdHJhdGlvbkRhdGEpIHsKICAgICAgICBpZiAocmVnaXN0cmF0aW9uRGF0YSAmJiByZWdpc3RyYXRpb25EYXRhLm9wdGlvbnMub25jZU9ubHkgJiYgcmVnaXN0cmF0aW9uRGF0YS5maXJlZEVsZW1zLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAvLyBhcyBvbmx5T25jZSBwYXJhbSBpcyB0cnVlLCBtYWtlIHN1cmUgd2UgZmlyZSB0aGUgZXZlbnQgZm9yIG9ubHkgb25lIGl0ZW0KICAgICAgICAgIGNhbGxiYWNrc1RvQmVDYWxsZWQgPSBbY2FsbGJhY2tzVG9CZUNhbGxlZFswXV07CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBpID0gMCwgY2I7IChjYiA9IGNhbGxiYWNrc1RvQmVDYWxsZWRbaV0pOyBpKyspIHsKICAgICAgICAgIGlmIChjYiAmJiBjYi5jYWxsYmFjaykgewogICAgICAgICAgICBjYi5jYWxsYmFjay5jYWxsKGNiLmVsZW0sIGNiLmVsZW0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHJlZ2lzdHJhdGlvbkRhdGEgJiYgcmVnaXN0cmF0aW9uRGF0YS5vcHRpb25zLm9uY2VPbmx5ICYmIHJlZ2lzdHJhdGlvbkRhdGEuZmlyZWRFbGVtcy5sZW5ndGggPT0gMSkgewogICAgICAgICAgLy8gdW5iaW5kIGV2ZW50IGFmdGVyIGZpcnN0IGNhbGxiYWNrIGFzIG9uY2VPbmx5IGlzIHRydWUuCiAgICAgICAgICByZWdpc3RyYXRpb25EYXRhLm1lLnVuYmluZEV2ZW50V2l0aFNlbGVjdG9yQW5kQ2FsbGJhY2suY2FsbCgKICAgICAgICAgICAgcmVnaXN0cmF0aW9uRGF0YS50YXJnZXQsIHJlZ2lzdHJhdGlvbkRhdGEuc2VsZWN0b3IsIHJlZ2lzdHJhdGlvbkRhdGEuY2FsbGJhY2spOwogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gdHJhdmVyc2UgdGhyb3VnaCBhbGwgZGVzY2VuZGFudHMgb2YgYSBub2RlIHRvIGNoZWNrIGlmIGV2ZW50IHNob3VsZCBiZSBmaXJlZCBmb3IgYW55IGRlc2NlbmRhbnQKICAgICAgY2hlY2tDaGlsZE5vZGVzUmVjdXJzaXZlbHk6IGZ1bmN0aW9uKG5vZGVzLCByZWdpc3RyYXRpb25EYXRhLCBtYXRjaEZ1bmMsIGNhbGxiYWNrc1RvQmVDYWxsZWQpIHsKICAgICAgICAvLyBjaGVjayBlYWNoIG5ldyBub2RlIGlmIGl0IG1hdGNoZXMgdGhlIHNlbGVjdG9yCiAgICAgICAgZm9yICh2YXIgaT0wLCBub2RlOyAobm9kZSA9IG5vZGVzW2ldKTsgaSsrKSB7CiAgICAgICAgICBpZiAobWF0Y2hGdW5jKG5vZGUsIHJlZ2lzdHJhdGlvbkRhdGEsIGNhbGxiYWNrc1RvQmVDYWxsZWQpKSB7CiAgICAgICAgICAgIGNhbGxiYWNrc1RvQmVDYWxsZWQucHVzaCh7IGNhbGxiYWNrOiByZWdpc3RyYXRpb25EYXRhLmNhbGxiYWNrLCBlbGVtOiBub2RlIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChub2RlLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICB1dGlscy5jaGVja0NoaWxkTm9kZXNSZWN1cnNpdmVseShub2RlLmNoaWxkTm9kZXMsIHJlZ2lzdHJhdGlvbkRhdGEsIG1hdGNoRnVuYywgY2FsbGJhY2tzVG9CZUNhbGxlZCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBtZXJnZUFycmF5czogZnVuY3Rpb24oZmlyc3RBcnIsIHNlY29uZEFycil7CiAgICAgICAgLy8gT3ZlcndyaXRlcyBkZWZhdWx0IG9wdGlvbnMgd2l0aCB1c2VyLWRlZmluZWQgb3B0aW9ucy4KICAgICAgICB2YXIgb3B0aW9ucyA9IHt9LAogICAgICAgICAgICBhdHRyTmFtZTsKICAgICAgICBmb3IgKGF0dHJOYW1lIGluIGZpcnN0QXJyKSB7CiAgICAgICAgICBpZiAoZmlyc3RBcnIuaGFzT3duUHJvcGVydHkoYXR0ck5hbWUpKSB7CiAgICAgICAgICAgIG9wdGlvbnNbYXR0ck5hbWVdID0gZmlyc3RBcnJbYXR0ck5hbWVdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBmb3IgKGF0dHJOYW1lIGluIHNlY29uZEFycikgewogICAgICAgICAgaWYgKHNlY29uZEFyci5oYXNPd25Qcm9wZXJ0eShhdHRyTmFtZSkpIHsKICAgICAgICAgICAgb3B0aW9uc1thdHRyTmFtZV0gPSBzZWNvbmRBcnJbYXR0ck5hbWVdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gb3B0aW9uczsKICAgICAgfSwKICAgICAgdG9FbGVtZW50c0FycmF5OiBmdW5jdGlvbiAoZWxlbWVudHMpIHsKICAgICAgICAvLyBjaGVjayBpZiBvYmplY3QgaXMgYW4gYXJyYXkgKG9yIGFycmF5IGxpa2Ugb2JqZWN0KQogICAgICAgIC8vIE5vdGU6IHdpbmRvdyBvYmplY3QgaGFzIC5sZW5ndGggcHJvcGVydHkgYnV0IGl0J3Mgbm90IGFycmF5IG9mIGVsZW1lbnRzIHNvIGRvbid0IGNvbnNpZGVyIGl0IGFuIGFycmF5CiAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50cyAhPT0gInVuZGVmaW5lZCIgJiYgKHR5cGVvZiBlbGVtZW50cy5sZW5ndGggIT09ICJudW1iZXIiIHx8IGVsZW1lbnRzID09PSB3aW5kb3cpKSB7CiAgICAgICAgICBlbGVtZW50cyA9IFtlbGVtZW50c107CiAgICAgICAgfQogICAgICAgIHJldHVybiBlbGVtZW50czsKICAgICAgfQogICAgfTsKICB9KSgpOwoKCiAgLy8gQ2xhc3MgdG8gbWFpbnRhaW4gc3RhdGUgb2YgYWxsIHJlZ2lzdGVyZWQgZXZlbnRzIG9mIGEgc2luZ2xlIHR5cGUKICB2YXIgRXZlbnRzQnVja2V0ID0gKGZ1bmN0aW9uKCkgewogICAgdmFyIEV2ZW50c0J1Y2tldCA9IGZ1bmN0aW9uKCkgewogICAgICAvLyBob2xkcyBhbGwgdGhlIGV2ZW50cwoKICAgICAgdGhpcy5fZXZlbnRzQnVja2V0ICAgID0gW107CiAgICAgIC8vIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGlsZSBhZGRpbmcgYW4gZXZlbnQsIHRoZSBmdW5jdGlvbiBzaG91bGQgZG8gdGhlIGV2ZW50IGluaXRpYWxpemF0aW9uL3JlZ2lzdHJhdGlvbgogICAgICB0aGlzLl9iZWZvcmVBZGRpbmcgICAgPSBudWxsOwogICAgICAvLyBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hpbGUgcmVtb3ZpbmcgYW4gZXZlbnQsIHRoZSBmdW5jdGlvbiBzaG91bGQgZG8gdGhlIGV2ZW50IGRlc3RydWN0aW9uCiAgICAgIHRoaXMuX2JlZm9yZVJlbW92aW5nICA9IG51bGw7CiAgICB9OwoKICAgIEV2ZW50c0J1Y2tldC5wcm90b3R5cGUuYWRkRXZlbnQgPSBmdW5jdGlvbih0YXJnZXQsIHNlbGVjdG9yLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICB2YXIgbmV3RXZlbnQgPSB7CiAgICAgICAgdGFyZ2V0OiAgICAgICAgICAgICB0YXJnZXQsCiAgICAgICAgc2VsZWN0b3I6ICAgICAgICAgICBzZWxlY3RvciwKICAgICAgICBvcHRpb25zOiAgICAgICAgICAgIG9wdGlvbnMsCiAgICAgICAgY2FsbGJhY2s6ICAgICAgICAgICBjYWxsYmFjaywKICAgICAgICBmaXJlZEVsZW1zOiAgICAgICAgIFtdCiAgICAgIH07CgogICAgICBpZiAodGhpcy5fYmVmb3JlQWRkaW5nKSB7CiAgICAgICAgdGhpcy5fYmVmb3JlQWRkaW5nKG5ld0V2ZW50KTsKICAgICAgfQoKICAgICAgdGhpcy5fZXZlbnRzQnVja2V0LnB1c2gobmV3RXZlbnQpOwogICAgICByZXR1cm4gbmV3RXZlbnQ7CiAgICB9OwoKICAgIEV2ZW50c0J1Y2tldC5wcm90b3R5cGUucmVtb3ZlRXZlbnQgPSBmdW5jdGlvbihjb21wYXJlRnVuY3Rpb24pIHsKICAgICAgZm9yICh2YXIgaT10aGlzLl9ldmVudHNCdWNrZXQubGVuZ3RoIC0gMSwgcmVnaXN0ZXJlZEV2ZW50OyAocmVnaXN0ZXJlZEV2ZW50ID0gdGhpcy5fZXZlbnRzQnVja2V0W2ldKTsgaS0tKSB7CiAgICAgICAgaWYgKGNvbXBhcmVGdW5jdGlvbihyZWdpc3RlcmVkRXZlbnQpKSB7CiAgICAgICAgICBpZiAodGhpcy5fYmVmb3JlUmVtb3ZpbmcpIHsKICAgICAgICAgICAgICB0aGlzLl9iZWZvcmVSZW1vdmluZyhyZWdpc3RlcmVkRXZlbnQpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIG1hcmsgY2FsbGJhY2sgYXMgbnVsbCBzbyB0aGF0IGV2ZW4gaWYgYW4gZXZlbnQgbXV0YXRpb24gd2FzIGFscmVhZHkgdHJpZ2dlcmVkIGl0IGRvZXMgbm90IGNhbGwgY2FsbGJhY2sKICAgICAgICAgIHZhciByZW1vdmVkRXZlbnRzID0gdGhpcy5fZXZlbnRzQnVja2V0LnNwbGljZShpLCAxKTsKICAgICAgICAgIGlmIChyZW1vdmVkRXZlbnRzICYmIHJlbW92ZWRFdmVudHMubGVuZ3RoKSB7CiAgICAgICAgICAgIHJlbW92ZWRFdmVudHNbMF0uY2FsbGJhY2sgPSBudWxsOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBFdmVudHNCdWNrZXQucHJvdG90eXBlLmJlZm9yZUFkZGluZyA9IGZ1bmN0aW9uKGJlZm9yZUFkZGluZykgewogICAgICB0aGlzLl9iZWZvcmVBZGRpbmcgPSBiZWZvcmVBZGRpbmc7CiAgICB9OwoKICAgIEV2ZW50c0J1Y2tldC5wcm90b3R5cGUuYmVmb3JlUmVtb3ZpbmcgPSBmdW5jdGlvbihiZWZvcmVSZW1vdmluZykgewogICAgICB0aGlzLl9iZWZvcmVSZW1vdmluZyA9IGJlZm9yZVJlbW92aW5nOwogICAgfTsKCiAgICByZXR1cm4gRXZlbnRzQnVja2V0OwogIH0pKCk7CgoKICAvKioKICAgKiBAY29uc3RydWN0b3IKICAgKiBHZW5lcmFsIGNsYXNzIGZvciBiaW5kaW5nL3VuYmluZGluZyBhcnJpdmUgYW5kIGxlYXZlIGV2ZW50cwogICAqLwogIHZhciBNdXRhdGlvbkV2ZW50cyA9IGZ1bmN0aW9uKGdldE9ic2VydmVyQ29uZmlnLCBvbk11dGF0aW9uKSB7CiAgICB2YXIgZXZlbnRzQnVja2V0ICAgID0gbmV3IEV2ZW50c0J1Y2tldCgpLAogICAgICAgIG1lICAgICAgICAgICAgICA9IHRoaXM7CgogICAgdmFyIGRlZmF1bHRPcHRpb25zID0gewogICAgICBmaXJlT25BdHRyaWJ1dGVzTW9kaWZpY2F0aW9uOiBmYWxzZQogICAgfTsKCiAgICAvLyBhY3R1YWwgZXZlbnQgcmVnaXN0cmF0aW9uIGJlZm9yZSBhZGRpbmcgaXQgdG8gYnVja2V0CiAgICBldmVudHNCdWNrZXQuYmVmb3JlQWRkaW5nKGZ1bmN0aW9uKHJlZ2lzdHJhdGlvbkRhdGEpIHsKICAgICAgdmFyCiAgICAgICAgdGFyZ2V0ICAgID0gcmVnaXN0cmF0aW9uRGF0YS50YXJnZXQsCiAgICAgICAgb2JzZXJ2ZXI7CgogICAgICAvLyBtdXRhdGlvbiBvYnNlcnZlciBkb2VzIG5vdCB3b3JrIG9uIHdpbmRvdyBvciBkb2N1bWVudAogICAgICBpZiAodGFyZ2V0ID09PSB3aW5kb3cuZG9jdW1lbnQgfHwgdGFyZ2V0ID09PSB3aW5kb3cpIHsKICAgICAgICB0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaHRtbCIpWzBdOwogICAgICB9CgogICAgICAvLyBDcmVhdGUgYW4gb2JzZXJ2ZXIgaW5zdGFuY2UKICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihlKSB7CiAgICAgICAgb25NdXRhdGlvbi5jYWxsKHRoaXMsIGUsIHJlZ2lzdHJhdGlvbkRhdGEpOwogICAgICB9KTsKCiAgICAgIHZhciBjb25maWcgPSBnZXRPYnNlcnZlckNvbmZpZyhyZWdpc3RyYXRpb25EYXRhLm9wdGlvbnMpOwoKICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0YXJnZXQsIGNvbmZpZyk7CgogICAgICByZWdpc3RyYXRpb25EYXRhLm9ic2VydmVyID0gb2JzZXJ2ZXI7CiAgICAgIHJlZ2lzdHJhdGlvbkRhdGEubWUgPSBtZTsKICAgIH0pOwoKICAgIC8vIGNsZWFudXAvdW5yZWdpc3RlciBiZWZvcmUgcmVtb3ZpbmcgYW4gZXZlbnQKICAgIGV2ZW50c0J1Y2tldC5iZWZvcmVSZW1vdmluZyhmdW5jdGlvbiAoZXZlbnREYXRhKSB7CiAgICAgIGV2ZW50RGF0YS5vYnNlcnZlci5kaXNjb25uZWN0KCk7CiAgICB9KTsKCiAgICB0aGlzLmJpbmRFdmVudCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICBvcHRpb25zID0gdXRpbHMubWVyZ2VBcnJheXMoZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpOwoKICAgICAgdmFyIGVsZW1lbnRzID0gdXRpbHMudG9FbGVtZW50c0FycmF5KHRoaXMpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIGV2ZW50c0J1Y2tldC5hZGRFdmVudChlbGVtZW50c1tpXSwgc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKTsKICAgICAgfQogICAgfTsKCiAgICB0aGlzLnVuYmluZEV2ZW50ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBlbGVtZW50cyA9IHV0aWxzLnRvRWxlbWVudHNBcnJheSh0aGlzKTsKICAgICAgZXZlbnRzQnVja2V0LnJlbW92ZUV2ZW50KGZ1bmN0aW9uKGV2ZW50T2JqKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHRoaXMgPT09IHVuZGVmaW5lZCB8fCBldmVudE9iai50YXJnZXQgPT09IGVsZW1lbnRzW2ldKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0pOwogICAgfTsKCiAgICB0aGlzLnVuYmluZEV2ZW50V2l0aFNlbGVjdG9yT3JDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGVjdG9yKSB7CiAgICAgIHZhciBlbGVtZW50cyA9IHV0aWxzLnRvRWxlbWVudHNBcnJheSh0aGlzKSwKICAgICAgICAgIGNhbGxiYWNrID0gc2VsZWN0b3IsCiAgICAgICAgICBjb21wYXJlRnVuY3Rpb247CgogICAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgY29tcGFyZUZ1bmN0aW9uID0gZnVuY3Rpb24oZXZlbnRPYmopIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKCh0aGlzID09PSB1bmRlZmluZWQgfHwgZXZlbnRPYmoudGFyZ2V0ID09PSBlbGVtZW50c1tpXSkgJiYgZXZlbnRPYmouY2FsbGJhY2sgPT09IGNhbGxiYWNrKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9OwogICAgICB9CiAgICAgIGVsc2UgewogICAgICAgIGNvbXBhcmVGdW5jdGlvbiA9IGZ1bmN0aW9uKGV2ZW50T2JqKSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICgodGhpcyA9PT0gdW5kZWZpbmVkIHx8IGV2ZW50T2JqLnRhcmdldCA9PT0gZWxlbWVudHNbaV0pICYmIGV2ZW50T2JqLnNlbGVjdG9yID09PSBzZWxlY3RvcikgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfTsKICAgICAgfQogICAgICBldmVudHNCdWNrZXQucmVtb3ZlRXZlbnQoY29tcGFyZUZ1bmN0aW9uKTsKICAgIH07CgogICAgdGhpcy51bmJpbmRFdmVudFdpdGhTZWxlY3RvckFuZENhbGxiYWNrID0gZnVuY3Rpb24oc2VsZWN0b3IsIGNhbGxiYWNrKSB7CiAgICAgIHZhciBlbGVtZW50cyA9IHV0aWxzLnRvRWxlbWVudHNBcnJheSh0aGlzKTsKICAgICAgZXZlbnRzQnVja2V0LnJlbW92ZUV2ZW50KGZ1bmN0aW9uKGV2ZW50T2JqKSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICgodGhpcyA9PT0gdW5kZWZpbmVkIHx8IGV2ZW50T2JqLnRhcmdldCA9PT0gZWxlbWVudHNbaV0pICYmIGV2ZW50T2JqLnNlbGVjdG9yID09PSBzZWxlY3RvciAmJiBldmVudE9iai5jYWxsYmFjayA9PT0gY2FsbGJhY2spIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9KTsKICAgIH07CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCgogIC8qKgogICAqIEBjb25zdHJ1Y3RvcgogICAqIFByb2Nlc3NlcyAnYXJyaXZlJyBldmVudHMKICAgKi8KICB2YXIgQXJyaXZlRXZlbnRzID0gZnVuY3Rpb24oKSB7CiAgICAvLyBEZWZhdWx0IG9wdGlvbnMgZm9yICdhcnJpdmUnIGV2ZW50CiAgICB2YXIgYXJyaXZlRGVmYXVsdE9wdGlvbnMgPSB7CiAgICAgIGZpcmVPbkF0dHJpYnV0ZXNNb2RpZmljYXRpb246IGZhbHNlLAogICAgICBvbmNlT25seTogZmFsc2UsCiAgICAgIGV4aXN0aW5nOiBmYWxzZQogICAgfTsKCiAgICBmdW5jdGlvbiBnZXRBcnJpdmVPYnNlcnZlckNvbmZpZyhvcHRpb25zKSB7CiAgICAgIHZhciBjb25maWcgPSB7CiAgICAgICAgYXR0cmlidXRlczogZmFsc2UsCiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLAogICAgICAgIHN1YnRyZWU6IHRydWUKICAgICAgfTsKCiAgICAgIGlmIChvcHRpb25zLmZpcmVPbkF0dHJpYnV0ZXNNb2RpZmljYXRpb24pIHsKICAgICAgICBjb25maWcuYXR0cmlidXRlcyA9IHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb25maWc7CiAgICB9CgogICAgZnVuY3Rpb24gb25BcnJpdmVNdXRhdGlvbihtdXRhdGlvbnMsIHJlZ2lzdHJhdGlvbkRhdGEpIHsKICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24oIG11dGF0aW9uICkgewogICAgICAgIHZhciBuZXdOb2RlcyAgICA9IG11dGF0aW9uLmFkZGVkTm9kZXMsCiAgICAgICAgICAgIHRhcmdldE5vZGUgPSBtdXRhdGlvbi50YXJnZXQsCiAgICAgICAgICAgIGNhbGxiYWNrc1RvQmVDYWxsZWQgPSBbXSwKICAgICAgICAgICAgbm9kZTsKCiAgICAgICAgLy8gSWYgbmV3IG5vZGVzIGFyZSBhZGRlZAogICAgICAgIGlmKCBuZXdOb2RlcyAhPT0gbnVsbCAmJiBuZXdOb2Rlcy5sZW5ndGggPiAwICkgewogICAgICAgICAgdXRpbHMuY2hlY2tDaGlsZE5vZGVzUmVjdXJzaXZlbHkobmV3Tm9kZXMsIHJlZ2lzdHJhdGlvbkRhdGEsIG5vZGVNYXRjaEZ1bmMsIGNhbGxiYWNrc1RvQmVDYWxsZWQpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChtdXRhdGlvbi50eXBlID09PSAiYXR0cmlidXRlcyIpIHsKICAgICAgICAgIGlmIChub2RlTWF0Y2hGdW5jKHRhcmdldE5vZGUsIHJlZ2lzdHJhdGlvbkRhdGEsIGNhbGxiYWNrc1RvQmVDYWxsZWQpKSB7CiAgICAgICAgICAgIGNhbGxiYWNrc1RvQmVDYWxsZWQucHVzaCh7IGNhbGxiYWNrOiByZWdpc3RyYXRpb25EYXRhLmNhbGxiYWNrLCBlbGVtOiB0YXJnZXROb2RlIH0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdXRpbHMuY2FsbENhbGxiYWNrcyhjYWxsYmFja3NUb0JlQ2FsbGVkLCByZWdpc3RyYXRpb25EYXRhKTsKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gbm9kZU1hdGNoRnVuYyhub2RlLCByZWdpc3RyYXRpb25EYXRhLCBjYWxsYmFja3NUb0JlQ2FsbGVkKSB7CiAgICAgIC8vIGNoZWNrIGEgc2luZ2xlIG5vZGUgdG8gc2VlIGlmIGl0IG1hdGNoZXMgdGhlIHNlbGVjdG9yCiAgICAgIGlmICh1dGlscy5tYXRjaGVzU2VsZWN0b3Iobm9kZSwgcmVnaXN0cmF0aW9uRGF0YS5zZWxlY3RvcikpIHsKICAgICAgICBpZihub2RlLl9pZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBub2RlLl9pZCA9IGFycml2ZVVuaXF1ZUlkKys7CiAgICAgICAgfQogICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgYXJyaXZlIGV2ZW50IGlzIG5vdCBhbHJlYWR5IGZpcmVkIGZvciB0aGUgZWxlbWVudAogICAgICAgIGlmIChyZWdpc3RyYXRpb25EYXRhLmZpcmVkRWxlbXMuaW5kZXhPZihub2RlLl9pZCkgPT0gLTEpIHsKICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGEuZmlyZWRFbGVtcy5wdXNoKG5vZGUuX2lkKTsKCiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBhcnJpdmVFdmVudHMgPSBuZXcgTXV0YXRpb25FdmVudHMoZ2V0QXJyaXZlT2JzZXJ2ZXJDb25maWcsIG9uQXJyaXZlTXV0YXRpb24pOwoKICAgIHZhciBtdXRhdGlvbkJpbmRFdmVudCA9IGFycml2ZUV2ZW50cy5iaW5kRXZlbnQ7CgogICAgLy8gb3ZlcnJpZGUgYmluZEV2ZW50IGZ1bmN0aW9uCiAgICBhcnJpdmVFdmVudHMuYmluZEV2ZW50ID0gZnVuY3Rpb24oc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKSB7CgogICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAidW5kZWZpbmVkIikgewogICAgICAgIGNhbGxiYWNrID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0gYXJyaXZlRGVmYXVsdE9wdGlvbnM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3B0aW9ucyA9IHV0aWxzLm1lcmdlQXJyYXlzKGFycml2ZURlZmF1bHRPcHRpb25zLCBvcHRpb25zKTsKICAgICAgfQoKICAgICAgdmFyIGVsZW1lbnRzID0gdXRpbHMudG9FbGVtZW50c0FycmF5KHRoaXMpOwoKICAgICAgaWYgKG9wdGlvbnMuZXhpc3RpbmcpIHsKICAgICAgICB2YXIgZXhpc3RpbmcgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIG5vZGVzID0gZWxlbWVudHNbaV0ucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7CiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG5vZGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGV4aXN0aW5nLnB1c2goeyBjYWxsYmFjazogY2FsbGJhY2ssIGVsZW06IG5vZGVzW2pdIH0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gbm8gbmVlZCB0byBiaW5kIGV2ZW50IGlmIHRoZSBjYWxsYmFjayBoYXMgdG8gYmUgZmlyZWQgb25seSBvbmNlIGFuZCB3ZSBoYXZlIGFscmVhZHkgZm91bmQgdGhlIGVsZW1lbnQKICAgICAgICBpZiAob3B0aW9ucy5vbmNlT25seSAmJiBleGlzdGluZy5sZW5ndGgpIHsKICAgICAgICAgIHJldHVybiBjYWxsYmFjay5jYWxsKGV4aXN0aW5nWzBdLmVsZW0sIGV4aXN0aW5nWzBdLmVsZW0pOwogICAgICAgIH0KCiAgICAgICAgc2V0VGltZW91dCh1dGlscy5jYWxsQ2FsbGJhY2tzLCAxLCBleGlzdGluZyk7CiAgICAgIH0KCiAgICAgIG11dGF0aW9uQmluZEV2ZW50LmNhbGwodGhpcywgc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKTsKICAgIH07CgogICAgcmV0dXJuIGFycml2ZUV2ZW50czsKICB9OwoKCiAgLyoqCiAgICogQGNvbnN0cnVjdG9yCiAgICogUHJvY2Vzc2VzICdsZWF2ZScgZXZlbnRzCiAgICovCiAgdmFyIExlYXZlRXZlbnRzID0gZnVuY3Rpb24oKSB7CiAgICAvLyBEZWZhdWx0IG9wdGlvbnMgZm9yICdsZWF2ZScgZXZlbnQKICAgIHZhciBsZWF2ZURlZmF1bHRPcHRpb25zID0ge307CgogICAgZnVuY3Rpb24gZ2V0TGVhdmVPYnNlcnZlckNvbmZpZygpIHsKICAgICAgdmFyIGNvbmZpZyA9IHsKICAgICAgICBjaGlsZExpc3Q6IHRydWUsCiAgICAgICAgc3VidHJlZTogdHJ1ZQogICAgICB9OwoKICAgICAgcmV0dXJuIGNvbmZpZzsKICAgIH0KCiAgICBmdW5jdGlvbiBvbkxlYXZlTXV0YXRpb24obXV0YXRpb25zLCByZWdpc3RyYXRpb25EYXRhKSB7CiAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKCBtdXRhdGlvbiApIHsKICAgICAgICB2YXIgcmVtb3ZlZE5vZGVzICA9IG11dGF0aW9uLnJlbW92ZWROb2RlcywKICAgICAgICAgICAgY2FsbGJhY2tzVG9CZUNhbGxlZCA9IFtdOwoKICAgICAgICBpZiggcmVtb3ZlZE5vZGVzICE9PSBudWxsICYmIHJlbW92ZWROb2Rlcy5sZW5ndGggPiAwICkgewogICAgICAgICAgdXRpbHMuY2hlY2tDaGlsZE5vZGVzUmVjdXJzaXZlbHkocmVtb3ZlZE5vZGVzLCByZWdpc3RyYXRpb25EYXRhLCBub2RlTWF0Y2hGdW5jLCBjYWxsYmFja3NUb0JlQ2FsbGVkKTsKICAgICAgICB9CgogICAgICAgIHV0aWxzLmNhbGxDYWxsYmFja3MoY2FsbGJhY2tzVG9CZUNhbGxlZCwgcmVnaXN0cmF0aW9uRGF0YSk7CiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIG5vZGVNYXRjaEZ1bmMobm9kZSwgcmVnaXN0cmF0aW9uRGF0YSkgewogICAgICByZXR1cm4gdXRpbHMubWF0Y2hlc1NlbGVjdG9yKG5vZGUsIHJlZ2lzdHJhdGlvbkRhdGEuc2VsZWN0b3IpOwogICAgfQoKICAgIGxlYXZlRXZlbnRzID0gbmV3IE11dGF0aW9uRXZlbnRzKGdldExlYXZlT2JzZXJ2ZXJDb25maWcsIG9uTGVhdmVNdXRhdGlvbik7CgogICAgdmFyIG11dGF0aW9uQmluZEV2ZW50ID0gbGVhdmVFdmVudHMuYmluZEV2ZW50OwoKICAgIC8vIG92ZXJyaWRlIGJpbmRFdmVudCBmdW5jdGlvbgogICAgbGVhdmVFdmVudHMuYmluZEV2ZW50ID0gZnVuY3Rpb24oc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKSB7CgogICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAidW5kZWZpbmVkIikgewogICAgICAgIGNhbGxiYWNrID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0gbGVhdmVEZWZhdWx0T3B0aW9uczsKICAgICAgfSBlbHNlIHsKICAgICAgICBvcHRpb25zID0gdXRpbHMubWVyZ2VBcnJheXMobGVhdmVEZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7CiAgICAgIH0KCiAgICAgIG11dGF0aW9uQmluZEV2ZW50LmNhbGwodGhpcywgc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKTsKICAgIH07CgogICAgcmV0dXJuIGxlYXZlRXZlbnRzOwogIH07CgoKICB2YXIgYXJyaXZlRXZlbnRzID0gbmV3IEFycml2ZUV2ZW50cygpLAogICAgICBsZWF2ZUV2ZW50cyAgPSBuZXcgTGVhdmVFdmVudHMoKTsKCiAgZnVuY3Rpb24gZXhwb3NlVW5iaW5kQXBpKGV2ZW50T2JqLCBleHBvc2VUbywgZnVuY05hbWUpIHsKICAgIC8vIGV4cG9zZSB1bmJpbmQgZnVuY3Rpb24gd2l0aCBmdW5jdGlvbiBvdmVycmlkaW5nCiAgICB1dGlscy5hZGRNZXRob2QoZXhwb3NlVG8sIGZ1bmNOYW1lLCBldmVudE9iai51bmJpbmRFdmVudCk7CiAgICB1dGlscy5hZGRNZXRob2QoZXhwb3NlVG8sIGZ1bmNOYW1lLCBldmVudE9iai51bmJpbmRFdmVudFdpdGhTZWxlY3Rvck9yQ2FsbGJhY2spOwogICAgdXRpbHMuYWRkTWV0aG9kKGV4cG9zZVRvLCBmdW5jTmFtZSwgZXZlbnRPYmoudW5iaW5kRXZlbnRXaXRoU2VsZWN0b3JBbmRDYWxsYmFjayk7CiAgfQoKICAvKioqIGV4cG9zZSBBUElzICoqKi8KICBmdW5jdGlvbiBleHBvc2VBcGkoZXhwb3NlVG8pIHsKICAgIGV4cG9zZVRvLmFycml2ZSA9IGFycml2ZUV2ZW50cy5iaW5kRXZlbnQ7CiAgICBleHBvc2VVbmJpbmRBcGkoYXJyaXZlRXZlbnRzLCBleHBvc2VUbywgInVuYmluZEFycml2ZSIpOwoKICAgIGV4cG9zZVRvLmxlYXZlID0gbGVhdmVFdmVudHMuYmluZEV2ZW50OwogICAgZXhwb3NlVW5iaW5kQXBpKGxlYXZlRXZlbnRzLCBleHBvc2VUbywgInVuYmluZExlYXZlIik7CiAgfQoKICBpZiAoJCkgewogICAgZXhwb3NlQXBpKCQuZm4pOwogIH0KICBleHBvc2VBcGkoSFRNTEVsZW1lbnQucHJvdG90eXBlKTsKICBleHBvc2VBcGkoTm9kZUxpc3QucHJvdG90eXBlKTsKICBleHBvc2VBcGkoSFRNTENvbGxlY3Rpb24ucHJvdG90eXBlKTsKICBleHBvc2VBcGkoSFRNTERvY3VtZW50LnByb3RvdHlwZSk7CiAgZXhwb3NlQXBpKFdpbmRvdy5wcm90b3R5cGUpOwoKICB2YXIgQXJyaXZlID0ge307CiAgLy8gZXhwb3NlIGZ1bmN0aW9ucyB0byB1bmJpbmQgYWxsIGFycml2ZS9sZWF2ZSBldmVudHMKICBleHBvc2VVbmJpbmRBcGkoYXJyaXZlRXZlbnRzLCBBcnJpdmUsICJ1bmJpbmRBbGxBcnJpdmUiKTsKICBleHBvc2VVbmJpbmRBcGkobGVhdmVFdmVudHMsIEFycml2ZSwgInVuYmluZEFsbExlYXZlIik7CgogIHJldHVybiBBcnJpdmU7Cgp9KSh3aW5kb3csIHR5cGVvZiBqUXVlcnkgPT09ICd1bmRlZmluZWQnID8gbnVsbCA6IGpRdWVyeSwgdW5kZWZpbmVkKTs="}]},{"name":"[Pixlr] Unlimited Saves","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://pixlr.com/*/*"],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685019766812,"data":{}},"enabled":true,"position":5,"file_url":"https://greasyfork.org/scripts/460881-pixlr-unlimited-saves/code/%5BPixlr%5D%20Unlimited%20Saves.user.js","uuid":"364ae7c9-ecbf-4582-b64f-5d0227ba4f00","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIFtQaXhscl0gVW5saW1pdGVkIFNhdmVzCi8vIEBuYW1lc3BhY2UgICBIS1IKLy8gQG1hdGNoICAgICAgIGh0dHBzOi8vcGl4bHIuY29tLyovKgovLyBAZ3JhbnQgICAgICAgbm9uZQovLyBAdmVyc2lvbiAgICAgMS4wCi8vIEBhdXRob3IgICAgICBIS1IKLy8gQGRlc2NyaXB0aW9uIEJ5cGFzc2VzIHRoZSBkYWlseSBzYXZlIGxpbWl0Ci8vIEBydW4tYXQgICAgICBkb2N1bWVudC1zdGFydAovLyA9PS9Vc2VyU2NyaXB0PT0KCigoKSA9PiB7CiAgICBjb25zdCByZXBsYWNlbWVudFJlZ2V4ID0gL1woXClccyo+PVxzKjMvZzsKICAgIGNvbnN0IGJ5cGFzc1N0ciA9IGAoKT09J0QnYDsKCiAgICBmdW5jdGlvbiBwYXRjaE5vZGUobm9kZSkgewogICAgICAgIG5vZGU/LnJlbW92ZSgpOwoKICAgICAgICBmZXRjaChub2RlLnNyYykKICAgICAgICAgICAgLnRoZW4ocmVzID0+IHJlcy50ZXh0KCkpCiAgICAgICAgICAgIC50aGVuKHRleHQgPT4gewogICAgICAgICAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZShyZXBsYWNlbWVudFJlZ2V4LCBieXBhc3NTdHIpOwoKICAgICAgICAgICAgICAgIGlmKCF0ZXh0LmluY2x1ZGVzKGJ5cGFzc1N0cikpIHsKICAgICAgICAgICAgICAgICAgICBhbGVydChgRGFpbHkgbGltaXQgYnlwYXNzIGZhaWxlZCwgdGhlIHVzZXJzY3JpcHQgbWF5IGJlIG91dGRhdGVkIWApOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IG5ld05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKICAgICAgICAgICAgICAgICAgICAgIG5ld05vZGUuaW5uZXJIVE1MID0gdGV4dDsKCiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG5ld05vZGUpOwogICAgICAgICAgICB9KTsKICAgIH0KCiAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihtdXRhdGlvbnNMaXN0ID0+IHsKICAgICAgICBtdXRhdGlvbnNMaXN0LmZvckVhY2gobXV0YXRpb25SZWNvcmQgPT4gewogICAgICAgICAgWy4uLm11dGF0aW9uUmVjb3JkLmFkZGVkTm9kZXNdCiAgICAgICAgICAgIC5maWx0ZXIobm9kZSA9PiBub2RlLnRhZ05hbWUgPT09ICdTQ1JJUFQnICYmIG5vZGUuc3JjPy5pbmNsdWRlcygnL2Rpc3QvJykpCiAgICAgICAgICAgIC5mb3JFYWNoKG5vZGUgPT4gcGF0Y2hOb2RlKG5vZGUpKTsKICAgICAgICB9KTsKICAgIH0pLm9ic2VydmUoZG9jdW1lbnQsIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pOwp9KSgpOw=="},{"name":"[Pixlr X] Premium Content Remover","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://pixlr.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685019777343,"data":{}},"enabled":true,"position":6,"file_url":"https://greasyfork.org/scripts/425737-pixlr-x-premium-content-remover/code/%5BPixlr%20X%5D%20Premium%20Content%20Remover.user.js","uuid":"2ef51720-c5b0-4260-b971-55165d67f196","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBbUGl4bHIgWF0gUHJlbWl1bSBDb250ZW50IFJlbW92ZXIKLy8gQHZlcnNpb24gICAgICAyLjEKLy8gQGRlc2NyaXB0aW9uICBSZW1vdmVzIHByZW1pdW0gZmVhdHVyZXMgb24gUGl4bHIuY29tLCBiZWNhdXNlIHRoZXkgYXJlIGp1c3Qgb24geW91ciB3YXkuCi8vIEBhdXRob3IgICAgICAgSEtSCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly9waXhsci5jb20vKgovLyBAZ3JhbnQgICAgICAgIG5vbmUKLy8gQG5hbWVzcGFjZSAgICBIS1IKLy8gQHN1cHBvcnRVUkwgICBodHRwczovL2dpdGh1Yi5jb20vSGFrb3JyL1VzZXJzY3JpcHRzL2lzc3VlcwovLyBAcmVxdWlyZSAgICAgIGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy8yMTkyNy1hcnJpdmUtanMvY29kZS9hcnJpdmVqcy5qcwovLyBAZ3JhbnQgICAgICAgIEdNX2FkZFN0eWxlCi8vID09L1VzZXJTY3JpcHQ9PQoKKCgpID0+IHsKY29uc3QgdXNlclNjcmlwdE5hbWUgPSAiW1ByZW1pdW0gQ29udGVudCBSZW1vdmVyXSI7CmxldCBjb3VudCA9IDE7CmNvbnNvbGUubG9nKGAke3VzZXJTY3JpcHROYW1lfSBTdGFydGVkIWApOwoKR01fYWRkU3R5bGUoJyNzbmVha3kgeyB2aXNpYmlsaXR5OiBoaWRkZW4gIWltcG9ydGFudDsgfScpOwoKY29uc3QgcmVtb3ZlTGlzdCA9IFsKICAgICIucHJlbWl1bSIsCiAgICAiLmdldC1wcmVtaXVtIiwKICAgICIjdHJ5LXByZW1pdW0iLAogICAgIiN0b29sLWdsaXRjaCIsCiAgICAiI3Rvb2wtZm9jdXMiLAogICAgIiN0b29sLWRpc3BlcnNpb24iLAogICAgIiNjdXRvdXQtYXV0byIsCiAgICAiI21vZGFsLXBvcCIKXTsKCmZ1bmN0aW9uIGhhbmRsZVByZW1pdW1FbGVtZW50KGVsZW0pIHsKICAgIGNvbnNvbGUubG9nKGAke3VzZXJTY3JpcHROYW1lfSBSZW1vdmVkIGEgcHJlbWl1bSBlbGVtZW50ISAoJHtjb3VudCsrfSlgKTsKICAKICAgIC8vQ2hlY2sgYnkgZWxlbWVudCBjbGFzcwogICAgc3dpdGNoKGVsZW0uZ2V0QXR0cmlidXRlKCJjbGFzcyIpKSB7CiAgICAgIGNhc2UgImJ1dHRvbiBzbWFsbCBvdXRsaW5lIHBhZC0yMCBwcmVtaXVtIjoKICAgICAgICBlbGVtLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgY29uc29sZS5sb2coZWxlbSk7CiAgICAgICAgcmV0dXJuOwogICAgfQogIAogICAgLy9DaGVjayBieSBlbGVtZW50J3MgcGFyZW50J3MgY2xhc3MKICAgIHN3aXRjaChlbGVtLnBhcmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpKSB7CiAgICAgIGNhc2UgInRlbXBsYXRlLWJveCBsYXJnZSI6ICJ0ZW1wbGF0ZS1ib3giOwogICAgICAgICAgZWxlbS5wYXJlbnRFbGVtZW50Lm91dGVySFRNTCA9ICIiOwogICAgICAgICAgY29uc29sZS5sb2coZWxlbSk7CiAgICAgICAgICByZXR1cm47CgogICAgICBjYXNlICJlbGVtZW50LWdyb3VwIjoKICAgICAgICAgIGVsZW0ucmVtb3ZlKCk7CiAgICAgICAgICBjb25zb2xlLmxvZyhlbGVtKTsKICAgICAgICAgIHJldHVybjsKICAgIH0KICAgIAogICAgLy9EZWZhdWx0CiAgICBlbGVtLm91dGVySFRNTCA9ICIiOwogICAgY29uc29sZS5sb2coZWxlbSk7Cn0KCmZ1bmN0aW9uIGdldFByZW1pdW1FbGVtZW50cyhlbGVtKSB7CiAgICBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZWxlbSkpLmZvckVhY2goZWxlbSA9PiB7CiAgICAgICAgaGFuZGxlUHJlbWl1bUVsZW1lbnQoZWxlbSk7CiAgICB9KTsKfQoKZnVuY3Rpb24gcmVtb3ZlKGVsZW0pIHsKICAgIGdldFByZW1pdW1FbGVtZW50cyhlbGVtKTsKICAgIGRvY3VtZW50LmFycml2ZShlbGVtLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgZ2V0UHJlbWl1bUVsZW1lbnRzKGVsZW0pOwogICAgfSk7Cn0KCnJlbW92ZUxpc3QuZm9yRWFjaChlbGVtID0+IHsKICAgIHJlbW92ZShlbGVtKTsKfSk7Cn0pKCk7Cg==","requires":[{"meta":{"name":"arrivejs.js","url":"https://greasyfork.org/scripts/21927-arrive-js/code/arrivejs.js","ts":1685019777609,"mimetype":"text/javascript"},"source":"LypnbG9iYWxzIGpRdWVyeSxXaW5kb3csSFRNTEVsZW1lbnQsSFRNTERvY3VtZW50LEhUTUxDb2xsZWN0aW9uLE5vZGVMaXN0LE11dGF0aW9uT2JzZXJ2ZXIgKi8KLypleHBvcnRlZCBBcnJpdmUqLwovKmpzaGludCBsYXRlZGVmOmZhbHNlICovCgovKgogKiBhcnJpdmUuanMKICogdjIuNC4xCiAqIGh0dHBzOi8vZ2l0aHViLmNvbS91emFpcmZhcm9vcS9hcnJpdmUKICogTUlUIGxpY2Vuc2VkCiAqCiAqIENvcHlyaWdodCAoYykgMjAxNC0yMDE3IFV6YWlyIEZhcm9vcQogKi8KdmFyIEFycml2ZSA9IChmdW5jdGlvbih3aW5kb3csICQsIHVuZGVmaW5lZCkgewoKICAidXNlIHN0cmljdCI7CgogIGlmKCF3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB0eXBlb2YgSFRNTEVsZW1lbnQgPT09ICd1bmRlZmluZWQnKXsKICAgIHJldHVybjsgLy9mb3IgdW5zdXBwb3J0ZWQgYnJvd3NlcnMKICB9CgogIHZhciBhcnJpdmVVbmlxdWVJZCA9IDA7CgogIHZhciB1dGlscyA9IChmdW5jdGlvbigpIHsKICAgIHZhciBtYXRjaGVzID0gSFRNTEVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXMgfHwgSFRNTEVsZW1lbnQucHJvdG90eXBlLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fCBIVE1MRWxlbWVudC5wcm90b3R5cGUubW96TWF0Y2hlc1NlbGVjdG9yCiAgICAgICAgICAgICAgICAgIHx8IEhUTUxFbGVtZW50LnByb3RvdHlwZS5tc01hdGNoZXNTZWxlY3RvcjsKCiAgICByZXR1cm4gewogICAgICBtYXRjaGVzU2VsZWN0b3I6IGZ1bmN0aW9uKGVsZW0sIHNlbGVjdG9yKSB7CiAgICAgICAgcmV0dXJuIGVsZW0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiBtYXRjaGVzLmNhbGwoZWxlbSwgc2VsZWN0b3IpOwogICAgICB9LAogICAgICAvLyB0byBlbmFibGUgZnVuY3Rpb24gb3ZlcmxvYWRpbmcgLSBCeSBKb2huIFJlc2lnIChNSVQgTGljZW5zZWQpCiAgICAgIGFkZE1ldGhvZDogZnVuY3Rpb24gKG9iamVjdCwgbmFtZSwgZm4pIHsKICAgICAgICB2YXIgb2xkID0gb2JqZWN0WyBuYW1lIF07CiAgICAgICAgb2JqZWN0WyBuYW1lIF0gPSBmdW5jdGlvbigpewogICAgICAgICAgaWYgKCBmbi5sZW5ndGggPT0gYXJndW1lbnRzLmxlbmd0aCApIHsKICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKICAgICAgICAgIH0KICAgICAgICAgIGVsc2UgaWYgKCB0eXBlb2Ygb2xkID09ICdmdW5jdGlvbicgKSB7CiAgICAgICAgICAgIHJldHVybiBvbGQuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0sCiAgICAgIGNhbGxDYWxsYmFja3M6IGZ1bmN0aW9uKGNhbGxiYWNrc1RvQmVDYWxsZWQsIHJlZ2lzdHJhdGlvbkRhdGEpIHsKICAgICAgICBpZiAocmVnaXN0cmF0aW9uRGF0YSAmJiByZWdpc3RyYXRpb25EYXRhLm9wdGlvbnMub25jZU9ubHkgJiYgcmVnaXN0cmF0aW9uRGF0YS5maXJlZEVsZW1zLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAvLyBhcyBvbmx5T25jZSBwYXJhbSBpcyB0cnVlLCBtYWtlIHN1cmUgd2UgZmlyZSB0aGUgZXZlbnQgZm9yIG9ubHkgb25lIGl0ZW0KICAgICAgICAgIGNhbGxiYWNrc1RvQmVDYWxsZWQgPSBbY2FsbGJhY2tzVG9CZUNhbGxlZFswXV07CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBpID0gMCwgY2I7IChjYiA9IGNhbGxiYWNrc1RvQmVDYWxsZWRbaV0pOyBpKyspIHsKICAgICAgICAgIGlmIChjYiAmJiBjYi5jYWxsYmFjaykgewogICAgICAgICAgICBjYi5jYWxsYmFjay5jYWxsKGNiLmVsZW0sIGNiLmVsZW0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHJlZ2lzdHJhdGlvbkRhdGEgJiYgcmVnaXN0cmF0aW9uRGF0YS5vcHRpb25zLm9uY2VPbmx5ICYmIHJlZ2lzdHJhdGlvbkRhdGEuZmlyZWRFbGVtcy5sZW5ndGggPT0gMSkgewogICAgICAgICAgLy8gdW5iaW5kIGV2ZW50IGFmdGVyIGZpcnN0IGNhbGxiYWNrIGFzIG9uY2VPbmx5IGlzIHRydWUuCiAgICAgICAgICByZWdpc3RyYXRpb25EYXRhLm1lLnVuYmluZEV2ZW50V2l0aFNlbGVjdG9yQW5kQ2FsbGJhY2suY2FsbCgKICAgICAgICAgICAgcmVnaXN0cmF0aW9uRGF0YS50YXJnZXQsIHJlZ2lzdHJhdGlvbkRhdGEuc2VsZWN0b3IsIHJlZ2lzdHJhdGlvbkRhdGEuY2FsbGJhY2spOwogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gdHJhdmVyc2UgdGhyb3VnaCBhbGwgZGVzY2VuZGFudHMgb2YgYSBub2RlIHRvIGNoZWNrIGlmIGV2ZW50IHNob3VsZCBiZSBmaXJlZCBmb3IgYW55IGRlc2NlbmRhbnQKICAgICAgY2hlY2tDaGlsZE5vZGVzUmVjdXJzaXZlbHk6IGZ1bmN0aW9uKG5vZGVzLCByZWdpc3RyYXRpb25EYXRhLCBtYXRjaEZ1bmMsIGNhbGxiYWNrc1RvQmVDYWxsZWQpIHsKICAgICAgICAvLyBjaGVjayBlYWNoIG5ldyBub2RlIGlmIGl0IG1hdGNoZXMgdGhlIHNlbGVjdG9yCiAgICAgICAgZm9yICh2YXIgaT0wLCBub2RlOyAobm9kZSA9IG5vZGVzW2ldKTsgaSsrKSB7CiAgICAgICAgICBpZiAobWF0Y2hGdW5jKG5vZGUsIHJlZ2lzdHJhdGlvbkRhdGEsIGNhbGxiYWNrc1RvQmVDYWxsZWQpKSB7CiAgICAgICAgICAgIGNhbGxiYWNrc1RvQmVDYWxsZWQucHVzaCh7IGNhbGxiYWNrOiByZWdpc3RyYXRpb25EYXRhLmNhbGxiYWNrLCBlbGVtOiBub2RlIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChub2RlLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICB1dGlscy5jaGVja0NoaWxkTm9kZXNSZWN1cnNpdmVseShub2RlLmNoaWxkTm9kZXMsIHJlZ2lzdHJhdGlvbkRhdGEsIG1hdGNoRnVuYywgY2FsbGJhY2tzVG9CZUNhbGxlZCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBtZXJnZUFycmF5czogZnVuY3Rpb24oZmlyc3RBcnIsIHNlY29uZEFycil7CiAgICAgICAgLy8gT3ZlcndyaXRlcyBkZWZhdWx0IG9wdGlvbnMgd2l0aCB1c2VyLWRlZmluZWQgb3B0aW9ucy4KICAgICAgICB2YXIgb3B0aW9ucyA9IHt9LAogICAgICAgICAgICBhdHRyTmFtZTsKICAgICAgICBmb3IgKGF0dHJOYW1lIGluIGZpcnN0QXJyKSB7CiAgICAgICAgICBpZiAoZmlyc3RBcnIuaGFzT3duUHJvcGVydHkoYXR0ck5hbWUpKSB7CiAgICAgICAgICAgIG9wdGlvbnNbYXR0ck5hbWVdID0gZmlyc3RBcnJbYXR0ck5hbWVdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBmb3IgKGF0dHJOYW1lIGluIHNlY29uZEFycikgewogICAgICAgICAgaWYgKHNlY29uZEFyci5oYXNPd25Qcm9wZXJ0eShhdHRyTmFtZSkpIHsKICAgICAgICAgICAgb3B0aW9uc1thdHRyTmFtZV0gPSBzZWNvbmRBcnJbYXR0ck5hbWVdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gb3B0aW9uczsKICAgICAgfSwKICAgICAgdG9FbGVtZW50c0FycmF5OiBmdW5jdGlvbiAoZWxlbWVudHMpIHsKICAgICAgICAvLyBjaGVjayBpZiBvYmplY3QgaXMgYW4gYXJyYXkgKG9yIGFycmF5IGxpa2Ugb2JqZWN0KQogICAgICAgIC8vIE5vdGU6IHdpbmRvdyBvYmplY3QgaGFzIC5sZW5ndGggcHJvcGVydHkgYnV0IGl0J3Mgbm90IGFycmF5IG9mIGVsZW1lbnRzIHNvIGRvbid0IGNvbnNpZGVyIGl0IGFuIGFycmF5CiAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50cyAhPT0gInVuZGVmaW5lZCIgJiYgKHR5cGVvZiBlbGVtZW50cy5sZW5ndGggIT09ICJudW1iZXIiIHx8IGVsZW1lbnRzID09PSB3aW5kb3cpKSB7CiAgICAgICAgICBlbGVtZW50cyA9IFtlbGVtZW50c107CiAgICAgICAgfQogICAgICAgIHJldHVybiBlbGVtZW50czsKICAgICAgfQogICAgfTsKICB9KSgpOwoKCiAgLy8gQ2xhc3MgdG8gbWFpbnRhaW4gc3RhdGUgb2YgYWxsIHJlZ2lzdGVyZWQgZXZlbnRzIG9mIGEgc2luZ2xlIHR5cGUKICB2YXIgRXZlbnRzQnVja2V0ID0gKGZ1bmN0aW9uKCkgewogICAgdmFyIEV2ZW50c0J1Y2tldCA9IGZ1bmN0aW9uKCkgewogICAgICAvLyBob2xkcyBhbGwgdGhlIGV2ZW50cwoKICAgICAgdGhpcy5fZXZlbnRzQnVja2V0ICAgID0gW107CiAgICAgIC8vIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGlsZSBhZGRpbmcgYW4gZXZlbnQsIHRoZSBmdW5jdGlvbiBzaG91bGQgZG8gdGhlIGV2ZW50IGluaXRpYWxpemF0aW9uL3JlZ2lzdHJhdGlvbgogICAgICB0aGlzLl9iZWZvcmVBZGRpbmcgICAgPSBudWxsOwogICAgICAvLyBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hpbGUgcmVtb3ZpbmcgYW4gZXZlbnQsIHRoZSBmdW5jdGlvbiBzaG91bGQgZG8gdGhlIGV2ZW50IGRlc3RydWN0aW9uCiAgICAgIHRoaXMuX2JlZm9yZVJlbW92aW5nICA9IG51bGw7CiAgICB9OwoKICAgIEV2ZW50c0J1Y2tldC5wcm90b3R5cGUuYWRkRXZlbnQgPSBmdW5jdGlvbih0YXJnZXQsIHNlbGVjdG9yLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICB2YXIgbmV3RXZlbnQgPSB7CiAgICAgICAgdGFyZ2V0OiAgICAgICAgICAgICB0YXJnZXQsCiAgICAgICAgc2VsZWN0b3I6ICAgICAgICAgICBzZWxlY3RvciwKICAgICAgICBvcHRpb25zOiAgICAgICAgICAgIG9wdGlvbnMsCiAgICAgICAgY2FsbGJhY2s6ICAgICAgICAgICBjYWxsYmFjaywKICAgICAgICBmaXJlZEVsZW1zOiAgICAgICAgIFtdCiAgICAgIH07CgogICAgICBpZiAodGhpcy5fYmVmb3JlQWRkaW5nKSB7CiAgICAgICAgdGhpcy5fYmVmb3JlQWRkaW5nKG5ld0V2ZW50KTsKICAgICAgfQoKICAgICAgdGhpcy5fZXZlbnRzQnVja2V0LnB1c2gobmV3RXZlbnQpOwogICAgICByZXR1cm4gbmV3RXZlbnQ7CiAgICB9OwoKICAgIEV2ZW50c0J1Y2tldC5wcm90b3R5cGUucmVtb3ZlRXZlbnQgPSBmdW5jdGlvbihjb21wYXJlRnVuY3Rpb24pIHsKICAgICAgZm9yICh2YXIgaT10aGlzLl9ldmVudHNCdWNrZXQubGVuZ3RoIC0gMSwgcmVnaXN0ZXJlZEV2ZW50OyAocmVnaXN0ZXJlZEV2ZW50ID0gdGhpcy5fZXZlbnRzQnVja2V0W2ldKTsgaS0tKSB7CiAgICAgICAgaWYgKGNvbXBhcmVGdW5jdGlvbihyZWdpc3RlcmVkRXZlbnQpKSB7CiAgICAgICAgICBpZiAodGhpcy5fYmVmb3JlUmVtb3ZpbmcpIHsKICAgICAgICAgICAgICB0aGlzLl9iZWZvcmVSZW1vdmluZyhyZWdpc3RlcmVkRXZlbnQpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIG1hcmsgY2FsbGJhY2sgYXMgbnVsbCBzbyB0aGF0IGV2ZW4gaWYgYW4gZXZlbnQgbXV0YXRpb24gd2FzIGFscmVhZHkgdHJpZ2dlcmVkIGl0IGRvZXMgbm90IGNhbGwgY2FsbGJhY2sKICAgICAgICAgIHZhciByZW1vdmVkRXZlbnRzID0gdGhpcy5fZXZlbnRzQnVja2V0LnNwbGljZShpLCAxKTsKICAgICAgICAgIGlmIChyZW1vdmVkRXZlbnRzICYmIHJlbW92ZWRFdmVudHMubGVuZ3RoKSB7CiAgICAgICAgICAgIHJlbW92ZWRFdmVudHNbMF0uY2FsbGJhY2sgPSBudWxsOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBFdmVudHNCdWNrZXQucHJvdG90eXBlLmJlZm9yZUFkZGluZyA9IGZ1bmN0aW9uKGJlZm9yZUFkZGluZykgewogICAgICB0aGlzLl9iZWZvcmVBZGRpbmcgPSBiZWZvcmVBZGRpbmc7CiAgICB9OwoKICAgIEV2ZW50c0J1Y2tldC5wcm90b3R5cGUuYmVmb3JlUmVtb3ZpbmcgPSBmdW5jdGlvbihiZWZvcmVSZW1vdmluZykgewogICAgICB0aGlzLl9iZWZvcmVSZW1vdmluZyA9IGJlZm9yZVJlbW92aW5nOwogICAgfTsKCiAgICByZXR1cm4gRXZlbnRzQnVja2V0OwogIH0pKCk7CgoKICAvKioKICAgKiBAY29uc3RydWN0b3IKICAgKiBHZW5lcmFsIGNsYXNzIGZvciBiaW5kaW5nL3VuYmluZGluZyBhcnJpdmUgYW5kIGxlYXZlIGV2ZW50cwogICAqLwogIHZhciBNdXRhdGlvbkV2ZW50cyA9IGZ1bmN0aW9uKGdldE9ic2VydmVyQ29uZmlnLCBvbk11dGF0aW9uKSB7CiAgICB2YXIgZXZlbnRzQnVja2V0ICAgID0gbmV3IEV2ZW50c0J1Y2tldCgpLAogICAgICAgIG1lICAgICAgICAgICAgICA9IHRoaXM7CgogICAgdmFyIGRlZmF1bHRPcHRpb25zID0gewogICAgICBmaXJlT25BdHRyaWJ1dGVzTW9kaWZpY2F0aW9uOiBmYWxzZQogICAgfTsKCiAgICAvLyBhY3R1YWwgZXZlbnQgcmVnaXN0cmF0aW9uIGJlZm9yZSBhZGRpbmcgaXQgdG8gYnVja2V0CiAgICBldmVudHNCdWNrZXQuYmVmb3JlQWRkaW5nKGZ1bmN0aW9uKHJlZ2lzdHJhdGlvbkRhdGEpIHsKICAgICAgdmFyCiAgICAgICAgdGFyZ2V0ICAgID0gcmVnaXN0cmF0aW9uRGF0YS50YXJnZXQsCiAgICAgICAgb2JzZXJ2ZXI7CgogICAgICAvLyBtdXRhdGlvbiBvYnNlcnZlciBkb2VzIG5vdCB3b3JrIG9uIHdpbmRvdyBvciBkb2N1bWVudAogICAgICBpZiAodGFyZ2V0ID09PSB3aW5kb3cuZG9jdW1lbnQgfHwgdGFyZ2V0ID09PSB3aW5kb3cpIHsKICAgICAgICB0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaHRtbCIpWzBdOwogICAgICB9CgogICAgICAvLyBDcmVhdGUgYW4gb2JzZXJ2ZXIgaW5zdGFuY2UKICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihlKSB7CiAgICAgICAgb25NdXRhdGlvbi5jYWxsKHRoaXMsIGUsIHJlZ2lzdHJhdGlvbkRhdGEpOwogICAgICB9KTsKCiAgICAgIHZhciBjb25maWcgPSBnZXRPYnNlcnZlckNvbmZpZyhyZWdpc3RyYXRpb25EYXRhLm9wdGlvbnMpOwoKICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0YXJnZXQsIGNvbmZpZyk7CgogICAgICByZWdpc3RyYXRpb25EYXRhLm9ic2VydmVyID0gb2JzZXJ2ZXI7CiAgICAgIHJlZ2lzdHJhdGlvbkRhdGEubWUgPSBtZTsKICAgIH0pOwoKICAgIC8vIGNsZWFudXAvdW5yZWdpc3RlciBiZWZvcmUgcmVtb3ZpbmcgYW4gZXZlbnQKICAgIGV2ZW50c0J1Y2tldC5iZWZvcmVSZW1vdmluZyhmdW5jdGlvbiAoZXZlbnREYXRhKSB7CiAgICAgIGV2ZW50RGF0YS5vYnNlcnZlci5kaXNjb25uZWN0KCk7CiAgICB9KTsKCiAgICB0aGlzLmJpbmRFdmVudCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICBvcHRpb25zID0gdXRpbHMubWVyZ2VBcnJheXMoZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpOwoKICAgICAgdmFyIGVsZW1lbnRzID0gdXRpbHMudG9FbGVtZW50c0FycmF5KHRoaXMpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIGV2ZW50c0J1Y2tldC5hZGRFdmVudChlbGVtZW50c1tpXSwgc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKTsKICAgICAgfQogICAgfTsKCiAgICB0aGlzLnVuYmluZEV2ZW50ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBlbGVtZW50cyA9IHV0aWxzLnRvRWxlbWVudHNBcnJheSh0aGlzKTsKICAgICAgZXZlbnRzQnVja2V0LnJlbW92ZUV2ZW50KGZ1bmN0aW9uKGV2ZW50T2JqKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHRoaXMgPT09IHVuZGVmaW5lZCB8fCBldmVudE9iai50YXJnZXQgPT09IGVsZW1lbnRzW2ldKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0pOwogICAgfTsKCiAgICB0aGlzLnVuYmluZEV2ZW50V2l0aFNlbGVjdG9yT3JDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGVjdG9yKSB7CiAgICAgIHZhciBlbGVtZW50cyA9IHV0aWxzLnRvRWxlbWVudHNBcnJheSh0aGlzKSwKICAgICAgICAgIGNhbGxiYWNrID0gc2VsZWN0b3IsCiAgICAgICAgICBjb21wYXJlRnVuY3Rpb247CgogICAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgY29tcGFyZUZ1bmN0aW9uID0gZnVuY3Rpb24oZXZlbnRPYmopIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKCh0aGlzID09PSB1bmRlZmluZWQgfHwgZXZlbnRPYmoudGFyZ2V0ID09PSBlbGVtZW50c1tpXSkgJiYgZXZlbnRPYmouY2FsbGJhY2sgPT09IGNhbGxiYWNrKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9OwogICAgICB9CiAgICAgIGVsc2UgewogICAgICAgIGNvbXBhcmVGdW5jdGlvbiA9IGZ1bmN0aW9uKGV2ZW50T2JqKSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICgodGhpcyA9PT0gdW5kZWZpbmVkIHx8IGV2ZW50T2JqLnRhcmdldCA9PT0gZWxlbWVudHNbaV0pICYmIGV2ZW50T2JqLnNlbGVjdG9yID09PSBzZWxlY3RvcikgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfTsKICAgICAgfQogICAgICBldmVudHNCdWNrZXQucmVtb3ZlRXZlbnQoY29tcGFyZUZ1bmN0aW9uKTsKICAgIH07CgogICAgdGhpcy51bmJpbmRFdmVudFdpdGhTZWxlY3RvckFuZENhbGxiYWNrID0gZnVuY3Rpb24oc2VsZWN0b3IsIGNhbGxiYWNrKSB7CiAgICAgIHZhciBlbGVtZW50cyA9IHV0aWxzLnRvRWxlbWVudHNBcnJheSh0aGlzKTsKICAgICAgZXZlbnRzQnVja2V0LnJlbW92ZUV2ZW50KGZ1bmN0aW9uKGV2ZW50T2JqKSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICgodGhpcyA9PT0gdW5kZWZpbmVkIHx8IGV2ZW50T2JqLnRhcmdldCA9PT0gZWxlbWVudHNbaV0pICYmIGV2ZW50T2JqLnNlbGVjdG9yID09PSBzZWxlY3RvciAmJiBldmVudE9iai5jYWxsYmFjayA9PT0gY2FsbGJhY2spIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9KTsKICAgIH07CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCgogIC8qKgogICAqIEBjb25zdHJ1Y3RvcgogICAqIFByb2Nlc3NlcyAnYXJyaXZlJyBldmVudHMKICAgKi8KICB2YXIgQXJyaXZlRXZlbnRzID0gZnVuY3Rpb24oKSB7CiAgICAvLyBEZWZhdWx0IG9wdGlvbnMgZm9yICdhcnJpdmUnIGV2ZW50CiAgICB2YXIgYXJyaXZlRGVmYXVsdE9wdGlvbnMgPSB7CiAgICAgIGZpcmVPbkF0dHJpYnV0ZXNNb2RpZmljYXRpb246IGZhbHNlLAogICAgICBvbmNlT25seTogZmFsc2UsCiAgICAgIGV4aXN0aW5nOiBmYWxzZQogICAgfTsKCiAgICBmdW5jdGlvbiBnZXRBcnJpdmVPYnNlcnZlckNvbmZpZyhvcHRpb25zKSB7CiAgICAgIHZhciBjb25maWcgPSB7CiAgICAgICAgYXR0cmlidXRlczogZmFsc2UsCiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLAogICAgICAgIHN1YnRyZWU6IHRydWUKICAgICAgfTsKCiAgICAgIGlmIChvcHRpb25zLmZpcmVPbkF0dHJpYnV0ZXNNb2RpZmljYXRpb24pIHsKICAgICAgICBjb25maWcuYXR0cmlidXRlcyA9IHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb25maWc7CiAgICB9CgogICAgZnVuY3Rpb24gb25BcnJpdmVNdXRhdGlvbihtdXRhdGlvbnMsIHJlZ2lzdHJhdGlvbkRhdGEpIHsKICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24oIG11dGF0aW9uICkgewogICAgICAgIHZhciBuZXdOb2RlcyAgICA9IG11dGF0aW9uLmFkZGVkTm9kZXMsCiAgICAgICAgICAgIHRhcmdldE5vZGUgPSBtdXRhdGlvbi50YXJnZXQsCiAgICAgICAgICAgIGNhbGxiYWNrc1RvQmVDYWxsZWQgPSBbXSwKICAgICAgICAgICAgbm9kZTsKCiAgICAgICAgLy8gSWYgbmV3IG5vZGVzIGFyZSBhZGRlZAogICAgICAgIGlmKCBuZXdOb2RlcyAhPT0gbnVsbCAmJiBuZXdOb2Rlcy5sZW5ndGggPiAwICkgewogICAgICAgICAgdXRpbHMuY2hlY2tDaGlsZE5vZGVzUmVjdXJzaXZlbHkobmV3Tm9kZXMsIHJlZ2lzdHJhdGlvbkRhdGEsIG5vZGVNYXRjaEZ1bmMsIGNhbGxiYWNrc1RvQmVDYWxsZWQpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChtdXRhdGlvbi50eXBlID09PSAiYXR0cmlidXRlcyIpIHsKICAgICAgICAgIGlmIChub2RlTWF0Y2hGdW5jKHRhcmdldE5vZGUsIHJlZ2lzdHJhdGlvbkRhdGEsIGNhbGxiYWNrc1RvQmVDYWxsZWQpKSB7CiAgICAgICAgICAgIGNhbGxiYWNrc1RvQmVDYWxsZWQucHVzaCh7IGNhbGxiYWNrOiByZWdpc3RyYXRpb25EYXRhLmNhbGxiYWNrLCBlbGVtOiB0YXJnZXROb2RlIH0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdXRpbHMuY2FsbENhbGxiYWNrcyhjYWxsYmFja3NUb0JlQ2FsbGVkLCByZWdpc3RyYXRpb25EYXRhKTsKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gbm9kZU1hdGNoRnVuYyhub2RlLCByZWdpc3RyYXRpb25EYXRhLCBjYWxsYmFja3NUb0JlQ2FsbGVkKSB7CiAgICAgIC8vIGNoZWNrIGEgc2luZ2xlIG5vZGUgdG8gc2VlIGlmIGl0IG1hdGNoZXMgdGhlIHNlbGVjdG9yCiAgICAgIGlmICh1dGlscy5tYXRjaGVzU2VsZWN0b3Iobm9kZSwgcmVnaXN0cmF0aW9uRGF0YS5zZWxlY3RvcikpIHsKICAgICAgICBpZihub2RlLl9pZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBub2RlLl9pZCA9IGFycml2ZVVuaXF1ZUlkKys7CiAgICAgICAgfQogICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgYXJyaXZlIGV2ZW50IGlzIG5vdCBhbHJlYWR5IGZpcmVkIGZvciB0aGUgZWxlbWVudAogICAgICAgIGlmIChyZWdpc3RyYXRpb25EYXRhLmZpcmVkRWxlbXMuaW5kZXhPZihub2RlLl9pZCkgPT0gLTEpIHsKICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGEuZmlyZWRFbGVtcy5wdXNoKG5vZGUuX2lkKTsKCiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBhcnJpdmVFdmVudHMgPSBuZXcgTXV0YXRpb25FdmVudHMoZ2V0QXJyaXZlT2JzZXJ2ZXJDb25maWcsIG9uQXJyaXZlTXV0YXRpb24pOwoKICAgIHZhciBtdXRhdGlvbkJpbmRFdmVudCA9IGFycml2ZUV2ZW50cy5iaW5kRXZlbnQ7CgogICAgLy8gb3ZlcnJpZGUgYmluZEV2ZW50IGZ1bmN0aW9uCiAgICBhcnJpdmVFdmVudHMuYmluZEV2ZW50ID0gZnVuY3Rpb24oc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKSB7CgogICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAidW5kZWZpbmVkIikgewogICAgICAgIGNhbGxiYWNrID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0gYXJyaXZlRGVmYXVsdE9wdGlvbnM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3B0aW9ucyA9IHV0aWxzLm1lcmdlQXJyYXlzKGFycml2ZURlZmF1bHRPcHRpb25zLCBvcHRpb25zKTsKICAgICAgfQoKICAgICAgdmFyIGVsZW1lbnRzID0gdXRpbHMudG9FbGVtZW50c0FycmF5KHRoaXMpOwoKICAgICAgaWYgKG9wdGlvbnMuZXhpc3RpbmcpIHsKICAgICAgICB2YXIgZXhpc3RpbmcgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIG5vZGVzID0gZWxlbWVudHNbaV0ucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7CiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG5vZGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGV4aXN0aW5nLnB1c2goeyBjYWxsYmFjazogY2FsbGJhY2ssIGVsZW06IG5vZGVzW2pdIH0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gbm8gbmVlZCB0byBiaW5kIGV2ZW50IGlmIHRoZSBjYWxsYmFjayBoYXMgdG8gYmUgZmlyZWQgb25seSBvbmNlIGFuZCB3ZSBoYXZlIGFscmVhZHkgZm91bmQgdGhlIGVsZW1lbnQKICAgICAgICBpZiAob3B0aW9ucy5vbmNlT25seSAmJiBleGlzdGluZy5sZW5ndGgpIHsKICAgICAgICAgIHJldHVybiBjYWxsYmFjay5jYWxsKGV4aXN0aW5nWzBdLmVsZW0sIGV4aXN0aW5nWzBdLmVsZW0pOwogICAgICAgIH0KCiAgICAgICAgc2V0VGltZW91dCh1dGlscy5jYWxsQ2FsbGJhY2tzLCAxLCBleGlzdGluZyk7CiAgICAgIH0KCiAgICAgIG11dGF0aW9uQmluZEV2ZW50LmNhbGwodGhpcywgc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKTsKICAgIH07CgogICAgcmV0dXJuIGFycml2ZUV2ZW50czsKICB9OwoKCiAgLyoqCiAgICogQGNvbnN0cnVjdG9yCiAgICogUHJvY2Vzc2VzICdsZWF2ZScgZXZlbnRzCiAgICovCiAgdmFyIExlYXZlRXZlbnRzID0gZnVuY3Rpb24oKSB7CiAgICAvLyBEZWZhdWx0IG9wdGlvbnMgZm9yICdsZWF2ZScgZXZlbnQKICAgIHZhciBsZWF2ZURlZmF1bHRPcHRpb25zID0ge307CgogICAgZnVuY3Rpb24gZ2V0TGVhdmVPYnNlcnZlckNvbmZpZygpIHsKICAgICAgdmFyIGNvbmZpZyA9IHsKICAgICAgICBjaGlsZExpc3Q6IHRydWUsCiAgICAgICAgc3VidHJlZTogdHJ1ZQogICAgICB9OwoKICAgICAgcmV0dXJuIGNvbmZpZzsKICAgIH0KCiAgICBmdW5jdGlvbiBvbkxlYXZlTXV0YXRpb24obXV0YXRpb25zLCByZWdpc3RyYXRpb25EYXRhKSB7CiAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKCBtdXRhdGlvbiApIHsKICAgICAgICB2YXIgcmVtb3ZlZE5vZGVzICA9IG11dGF0aW9uLnJlbW92ZWROb2RlcywKICAgICAgICAgICAgY2FsbGJhY2tzVG9CZUNhbGxlZCA9IFtdOwoKICAgICAgICBpZiggcmVtb3ZlZE5vZGVzICE9PSBudWxsICYmIHJlbW92ZWROb2Rlcy5sZW5ndGggPiAwICkgewogICAgICAgICAgdXRpbHMuY2hlY2tDaGlsZE5vZGVzUmVjdXJzaXZlbHkocmVtb3ZlZE5vZGVzLCByZWdpc3RyYXRpb25EYXRhLCBub2RlTWF0Y2hGdW5jLCBjYWxsYmFja3NUb0JlQ2FsbGVkKTsKICAgICAgICB9CgogICAgICAgIHV0aWxzLmNhbGxDYWxsYmFja3MoY2FsbGJhY2tzVG9CZUNhbGxlZCwgcmVnaXN0cmF0aW9uRGF0YSk7CiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIG5vZGVNYXRjaEZ1bmMobm9kZSwgcmVnaXN0cmF0aW9uRGF0YSkgewogICAgICByZXR1cm4gdXRpbHMubWF0Y2hlc1NlbGVjdG9yKG5vZGUsIHJlZ2lzdHJhdGlvbkRhdGEuc2VsZWN0b3IpOwogICAgfQoKICAgIGxlYXZlRXZlbnRzID0gbmV3IE11dGF0aW9uRXZlbnRzKGdldExlYXZlT2JzZXJ2ZXJDb25maWcsIG9uTGVhdmVNdXRhdGlvbik7CgogICAgdmFyIG11dGF0aW9uQmluZEV2ZW50ID0gbGVhdmVFdmVudHMuYmluZEV2ZW50OwoKICAgIC8vIG92ZXJyaWRlIGJpbmRFdmVudCBmdW5jdGlvbgogICAgbGVhdmVFdmVudHMuYmluZEV2ZW50ID0gZnVuY3Rpb24oc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKSB7CgogICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAidW5kZWZpbmVkIikgewogICAgICAgIGNhbGxiYWNrID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0gbGVhdmVEZWZhdWx0T3B0aW9uczsKICAgICAgfSBlbHNlIHsKICAgICAgICBvcHRpb25zID0gdXRpbHMubWVyZ2VBcnJheXMobGVhdmVEZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7CiAgICAgIH0KCiAgICAgIG11dGF0aW9uQmluZEV2ZW50LmNhbGwodGhpcywgc2VsZWN0b3IsIG9wdGlvbnMsIGNhbGxiYWNrKTsKICAgIH07CgogICAgcmV0dXJuIGxlYXZlRXZlbnRzOwogIH07CgoKICB2YXIgYXJyaXZlRXZlbnRzID0gbmV3IEFycml2ZUV2ZW50cygpLAogICAgICBsZWF2ZUV2ZW50cyAgPSBuZXcgTGVhdmVFdmVudHMoKTsKCiAgZnVuY3Rpb24gZXhwb3NlVW5iaW5kQXBpKGV2ZW50T2JqLCBleHBvc2VUbywgZnVuY05hbWUpIHsKICAgIC8vIGV4cG9zZSB1bmJpbmQgZnVuY3Rpb24gd2l0aCBmdW5jdGlvbiBvdmVycmlkaW5nCiAgICB1dGlscy5hZGRNZXRob2QoZXhwb3NlVG8sIGZ1bmNOYW1lLCBldmVudE9iai51bmJpbmRFdmVudCk7CiAgICB1dGlscy5hZGRNZXRob2QoZXhwb3NlVG8sIGZ1bmNOYW1lLCBldmVudE9iai51bmJpbmRFdmVudFdpdGhTZWxlY3Rvck9yQ2FsbGJhY2spOwogICAgdXRpbHMuYWRkTWV0aG9kKGV4cG9zZVRvLCBmdW5jTmFtZSwgZXZlbnRPYmoudW5iaW5kRXZlbnRXaXRoU2VsZWN0b3JBbmRDYWxsYmFjayk7CiAgfQoKICAvKioqIGV4cG9zZSBBUElzICoqKi8KICBmdW5jdGlvbiBleHBvc2VBcGkoZXhwb3NlVG8pIHsKICAgIGV4cG9zZVRvLmFycml2ZSA9IGFycml2ZUV2ZW50cy5iaW5kRXZlbnQ7CiAgICBleHBvc2VVbmJpbmRBcGkoYXJyaXZlRXZlbnRzLCBleHBvc2VUbywgInVuYmluZEFycml2ZSIpOwoKICAgIGV4cG9zZVRvLmxlYXZlID0gbGVhdmVFdmVudHMuYmluZEV2ZW50OwogICAgZXhwb3NlVW5iaW5kQXBpKGxlYXZlRXZlbnRzLCBleHBvc2VUbywgInVuYmluZExlYXZlIik7CiAgfQoKICBpZiAoJCkgewogICAgZXhwb3NlQXBpKCQuZm4pOwogIH0KICBleHBvc2VBcGkoSFRNTEVsZW1lbnQucHJvdG90eXBlKTsKICBleHBvc2VBcGkoTm9kZUxpc3QucHJvdG90eXBlKTsKICBleHBvc2VBcGkoSFRNTENvbGxlY3Rpb24ucHJvdG90eXBlKTsKICBleHBvc2VBcGkoSFRNTERvY3VtZW50LnByb3RvdHlwZSk7CiAgZXhwb3NlQXBpKFdpbmRvdy5wcm90b3R5cGUpOwoKICB2YXIgQXJyaXZlID0ge307CiAgLy8gZXhwb3NlIGZ1bmN0aW9ucyB0byB1bmJpbmQgYWxsIGFycml2ZS9sZWF2ZSBldmVudHMKICBleHBvc2VVbmJpbmRBcGkoYXJyaXZlRXZlbnRzLCBBcnJpdmUsICJ1bmJpbmRBbGxBcnJpdmUiKTsKICBleHBvc2VVbmJpbmRBcGkobGVhdmVFdmVudHMsIEFycml2ZSwgInVuYmluZEFsbExlYXZlIik7CgogIHJldHVybiBBcnJpdmU7Cgp9KSh3aW5kb3csIHR5cGVvZiBqUXVlcnkgPT09ICd1bmRlZmluZWQnID8gbnVsbCA6IGpRdWVyeSwgdW5kZWZpbmVkKTs="}]},{"name":"IXL","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://www.ixl.com/awards/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685019813587,"data":{}},"enabled":true,"position":7,"file_url":"https://greasyfork.org/scripts/391448-ixl/code/IXL.user.js","uuid":"05321cc7-dbdd-4f0b-9fc2-dd85395a66bf","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgSVhMCi8vIEBuYW1lc3BhY2UgVmlvbGVudG1vbmtleSBTY3JpcHRzCi8vIEBtYXRjaCBodHRwczovL3d3dy5peGwuY29tL2F3YXJkcy8qCi8vIEBncmFudCBub25lCi8vIEBkZXNjcmlwdGlvbiBJdCBhZGRzIGNvbmZldHRpIHRvIHRoZSBpeGwgYXdhcmRzIHNjcmVlbiEKLy8gQGljb24gaHR0cHM6Ly93d3cuaXhsLmNvbS9peGwtZmF2aWNvbi5wbmcKLy8gQHZlcnNpb24gMS4yCi8vIEBhdXRob3IgQnJ5YW50IFJvYmluc29uCi8vID09L1VzZXJTY3JpcHQ9PQooZnVuY3Rpb24oKSB7CiAgICBjb25zdCBvcHRpb25zID0gewogICAgICAgICd0ZXh0JzogIiciICwKICAgICAgICAnc2l6ZSc6IDE1MCwKICAgICAgICAnd2VpZ2h0JzogODAwLAogICAgICAgICdzcGVlZCc6IDI1MDAKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSB7CiAgICAgICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSA9ICdmbG9hdGluZ0VsZW1lbnRzJwogICAgICAgIGVsZW1lbnQuc3R5bGUgPSBgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgbWFyZ2luOiBhdXRvOyBwb2ludGVyLWV2ZW50czogbm9uZTsgdXNlci1zZWxlY3Q6IG5vbmU7IGZvbnQtd2VpZ2h0OiAke29wdGlvbnMud2VpZ2h0fTsgZm9udC1zaXplOiAke29wdGlvbnMuc2l6ZX1weDsgcG9zaXRpb246IGFic29sdXRlOyB6LWluZGV4OiAyMTQ3NDgzNjQ3OyB0cmFuc2l0aW9uOiBhbGwgJHtvcHRpb25zLnNwZWVkLzEwMDB9cyBsaW5lYXI7IHRyYW5zZm9ybS1vcmlnaW46IGNlbnRlciBjZW50ZXI7IHRleHQtYWxpZ246IGNlbnRlcjtgOwogICAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBvcHRpb25zLnRleHQ7CgogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7CiAgICB9CgogICAgc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgIGxldCBlbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Zsb2F0aW5nRWxlbWVudHMnKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGVsZW1lbnRzW2ldLnN0eWxlLmNvbG9yID0gY29sb3IoKTsKICAgICAgICAgICAgZWxlbWVudHNbaV0uc3R5bGUub3BhY2l0eSA9IE1hdGgucmFuZG9tKCkgKyAuMTsKICAgICAgICAgICAgZWxlbWVudHNbaV0uc3R5bGUudHJhbnNmb3JtID0gYHJvdGF0ZSgke3JhbmRvbSgwLDM2MCl9ZGVnKSB0cmFuc2xhdGUoJHtyYW5kb20oLTEwMDAsMTAwMCl9cHgsICR7cmFuZG9tKC01MDAsNTAwKX1weCkgdHJhbnNsYXRlM2QoJHtyYW5kb20oMCwyMDApfXB4LCR7cmFuZG9tKDAsMjAwKX1weCwke3JhbmRvbSgwLDIwMCl9cHgpIHJvdGF0ZVgoJHtyYW5kb20oMCwzNjApfWRlZykgcm90YXRlWSgke3JhbmRvbSgwLDM2MCl9ZGVnKSByb3RhdGVaKCR7cmFuZG9tKDAsMzYwKX1kZWcpYDsKICAgICAgICB9CiAgICB9LCBvcHRpb25zLnNwZWVkKTsKCiAgICBmdW5jdGlvbiByYW5kb20obWluLCBtYXgpIHsgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluKTsgfQoKICAgIGZ1bmN0aW9uIGNvbG9yKCkgeyByZXR1cm4gWydyZWQnLCAnb3JhbmdlJywgJ3llbGxvdycsICdncmVlbicsICdibHVlJywgJ3B1cnBsZScsICdwaW5rJ11bTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyldOyB9Cn0pKCk7"},{"name":"Change Google Classroom User","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://classroom.google.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685022176487,"data":{}},"enabled":true,"position":8,"file_url":"https://greasyfork.org/scripts/372962-change-google-classroom-user/code/Change%20Google%20Classroom%20User.user.js","uuid":"e2a0bb73-f342-4c3f-9163-f25e44102115","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIENoYW5nZSBHb29nbGUgQ2xhc3Nyb29tIFVzZXIKLy8gQG5hbWVzcGFjZSAgIENoYW5nZSBHb29nbGUgQ2xhc3Nyb29tIFVzZXIgYnkgQzRpbGxpbgovLyBAZGVzY3JpcHRpb24gU3dpdGNoZXMgYmV0d2VlbiAvdS8wICYgL3UvMSBvbiBnb29nbGUgY2xhc3Nyb29tIGF1dG9tYXRpY2FsbHkuCi8vIEBtYXRjaCAgICAgICBodHRwczovL2NsYXNzcm9vbS5nb29nbGUuY29tLyoKLy8gQHJ1bi1hdCAgICAgIGRvY3VtZW50LWlkbGUKLy8gQGdyYW50ICAgICAgIG5vbmUKLy8gQGF1dGhvciAgICAgIEM0aWxsaW4gPGhpQGVtcmlrLm9yZz4KLy8gQG91anM6YXV0aG9yIEM0aWxsaW4KLy8gQHZlcnNpb24gICAgIDEuMi4yCi8vIEBob21lcGFnZVVSTCBodHRwczovL2dpdGh1Yi5jb20vQzRpbGxpbi9Vc2Vyc2NyaXB0cy90cmVlL21hc3Rlci9DaGFuZ2UtR29vZ2xlLUNsYXNzcm9vbS1Vc2VyCi8vIEBsaWNlbnNlICAgICBNSVQ7IGh0dHBzOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUCi8vIEBjb3B5cmlnaHQgICAyMDE4LTIwMjEsIEM0aWxsaW4gKGh0dHBzOi8vZ2l0aHViLmNvbS9DNGlsbGluKQovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbigpIHsKICBsZXQgcmVmcmVzaCA9IHNldEludGVydmFsKCgpID0+IHsKICAgIGlmICgoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiTHFyMmUiKS5sZW5ndGggIT0gMCkgJiYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5sZW5ndGggPCA3KSkgewogICAgICBzd2l0Y2hVc2VyKCkKICAgIH0KICAgIGlmICgoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidENENU1jIikubGVuZ3RoICE9IDApICYmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUubGVuZ3RoID4gNykpIHsKICAgICAgc3dpdGNoVXNlcigpCiAgICB9CiAgfSwgMzUwKQogIAogIGZ1bmN0aW9uIHN3aXRjaFVzZXIoKSB7CiAgICBjbGVhckludGVydmFsKHJlZnJlc2gpCiAgICBsZXQgdGltZSAgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZ2NzdS1zd2l0Y2hlcycpCiAgICBsZXQgbm93ID0gRGF0ZS5ub3coKQogICAgaWYgKG5vdy10aW1lID4gMTUwMDAgKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdnY3N1LXN3aXRjaGVzJywgbm93KQogICAgICBsZXQgdXNlcgogICAgICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnN1YnN0cmluZygzLDQpID09IDApIHsKICAgICAgICB1c2VyID0gMQogICAgICB9IGVsc2UgewogICAgICAgIHVzZXIgPSAwCiAgICAgIH0KICAgICAgbGV0IG5ld2xpbmsgPSAiaHR0cHM6Ly9jbGFzc3Jvb20uZ29vZ2xlLmNvbS91LyIrIHVzZXIgKyB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3Vic3RyaW5nKDQpICsgd2luZG93LmxvY2F0aW9uLnNlYXJjaCArIHdpbmRvdy5sb2NhdGlvbi5oYXNoCiAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKG5ld2xpbmspCiAgICB9CiAgfQp9KSgp"},{"name":"ChatGPT Search","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":["chat.openai.com"],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://*.google.com/search*","https://*.google.ad/search*","https://*.google.ae/search*","https://*.google.com.af/search*","https://*.google.com.ag/search*","https://*.google.com.ai/search*","https://*.google.al/search*","https://*.google.am/search*","https://*.google.co.ao/search*","https://*.google.com.ar/search*","https://*.google.as/search*","https://*.google.at/search*","https://*.google.com.au/search*","https://*.google.az/search*","https://*.google.ba/search*","https://*.google.com.bd/search*","https://*.google.be/search*","https://*.google.bf/search*","https://*.google.bg/search*","https://*.google.com.bh/search*","https://*.google.bi/search*","https://*.google.bj/search*","https://*.google.com.bn/search*","https://*.google.com.bo/search*","https://*.google.com.br/search*","https://*.google.bs/search*","https://*.google.bt/search*","https://*.google.co.bw/search*","https://*.google.by/search*","https://*.google.com.bz/search*","https://*.google.ca/search*","https://*.google.cd/search*","https://*.google.cf/search*","https://*.google.cg/search*","https://*.google.ch/search*","https://*.google.ci/search*","https://*.google.co.ck/search*","https://*.google.cl/search*","https://*.google.cm/search*","https://*.google.cn/search*","https://*.google.com.co/search*","https://*.google.co.cr/search*","https://*.google.com.cu/search*","https://*.google.cv/search*","https://*.google.com.cy/search*","https://*.google.cz/search*","https://*.google.de/search*","https://*.google.dj/search*","https://*.google.dk/search*","https://*.google.dm/search*","https://*.google.com.do/search*","https://*.google.dz/search*","https://*.google.com.ec/search*","https://*.google.ee/search*","https://*.google.com.eg/search*","https://*.google.es/search*","https://*.google.com.et/search*","https://*.google.fi/search*","https://*.google.com.fj/search*","https://*.google.fm/search*","https://*.google.fr/search*","https://*.google.ga/search*","https://*.google.ge/search*","https://*.google.gg/search*","https://*.google.com.gh/search*","https://*.google.com.gi/search*","https://*.google.gl/search*","https://*.google.gm/search*","https://*.google.gr/search*","https://*.google.com.gt/search*","https://*.google.gy/search*","https://*.google.com.hk/search*","https://*.google.hn/search*","https://*.google.hr/search*","https://*.google.ht/search*","https://*.google.hu/search*","https://*.google.co.id/search*","https://*.google.ie/search*","https://*.google.co.il/search*","https://*.google.im/search*","https://*.google.co.in/search*","https://*.google.iq/search*","https://*.google.is/search*","https://*.google.it/search*","https://*.google.je/search*","https://*.google.com.jm/search*","https://*.google.jo/search*","https://*.google.co.jp/search*","https://*.google.co.ke/search*","https://*.google.com.kh/search*","https://*.google.ki/search*","https://*.google.kg/search*","https://*.google.co.kr/search*","https://*.google.com.kw/search*","https://*.google.kz/search*","https://*.google.la/search*","https://*.google.com.lb/search*","https://*.google.li/search*","https://*.google.lk/search*","https://*.google.co.ls/search*","https://*.google.lt/search*","https://*.google.lu/search*","https://*.google.lv/search*","https://*.google.com.ly/search*","https://*.google.co.ma/search*","https://*.google.md/search*","https://*.google.me/search*","https://*.google.mg/search*","https://*.google.mk/search*","https://*.google.ml/search*","https://*.google.com.mm/search*","https://*.google.mn/search*","https://*.google.ms/search*","https://*.google.com.mt/search*","https://*.google.mu/search*","https://*.google.mv/search*","https://*.google.mw/search*","https://*.google.com.mx/search*","https://*.google.com.my/search*","https://*.google.co.mz/search*","https://*.google.com.na/search*","https://*.google.com.ng/search*","https://*.google.com.ni/search*","https://*.google.ne/search*","https://*.google.nl/search*","https://*.google.no/search*","https://*.google.com.np/search*","https://*.google.nr/search*","https://*.google.nu/search*","https://*.google.co.nz/search*","https://*.google.com.om/search*","https://*.google.com.pa/search*","https://*.google.com.pe/search*","https://*.google.com.pg/search*","https://*.google.com.ph/search*","https://*.google.com.pk/search*","https://*.google.pl/search*","https://*.google.pn/search*","https://*.google.com.pr/search*","https://*.google.ps/search*","https://*.google.pt/search*","https://*.google.com.py/search*","https://*.google.com.qa/search*","https://*.google.ro/search*","https://*.google.ru/search*","https://*.google.rw/search*","https://*.google.com.sa/search*","https://*.google.com.sb/search*","https://*.google.sc/search*","https://*.google.se/search*","https://*.google.com.sg/search*","https://*.google.sh/search*","https://*.google.si/search*","https://*.google.sk/search*","https://*.google.com.sl/search*","https://*.google.sn/search*","https://*.google.so/search*","https://*.google.sm/search*","https://*.google.sr/search*","https://*.google.st/search*","https://*.google.com.sv/search*","https://*.google.td/search*","https://*.google.tg/search*","https://*.google.co.th/search*","https://*.google.com.tj/search*","https://*.google.tl/search*","https://*.google.tm/search*","https://*.google.tn/search*","https://*.google.to/search*","https://*.google.com.tr/search*","https://*.google.tt/search*","https://*.google.com.tw/search*","https://*.google.co.tz/search*","https://*.google.com.ua/search*","https://*.google.co.ug/search*","https://*.google.co.uk/search*","https://*.google.com.uy/search*","https://*.google.co.uz/search*","https://*.google.com.vc/search*","https://*.google.co.ve/search*","https://*.google.vg/search*","https://*.google.co.vi/search*","https://*.google.com.vn/search*","https://*.google.vu/search*","https://*.google.ws/search*","https://*.google.rs/search*","https://*.google.co.za/search*","https://*.google.co.zm/search*","https://*.google.co.zw/search*","https://*.google.cat/search*","https://www.bing.com/search*","https://cn.bing.com/search*","https://www.baidu.com/s*","https://duckduckgo.com/*","https://www.deepl.com/translator*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685446880337,"data":{}},"enabled":true,"position":9,"file_url":"https://greasyfork.org/scripts/456077-chatgpt-search/code/ChatGPT%20Search.user.js","uuid":"30b472d8-6428-4852-8361-ea417efaefd2","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgICBDaGF0R1BUIFNlYXJjaAovLyBAbmFtZTp6aC1DTiAgICAgICAgIENoYXRHUFQg5pCc57SiCi8vIEBuYW1lOnpoLVNHICAgICAgICAgQ2hhdEdQVCDmkJzntKIKLy8gQG5hbWU6emgtVFcgICAgICAgICBDaGF0R1BUIOaQnOe0ogovLyBAbmFtZTp6aC1ISyAgICAgICAgIENoYXRHUFQg5pCc57SiCi8vIEBuYW1lc3BhY2UgICAgICAgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzQ1NjA3NwovLyBAdmVyc2lvbiAgICAgICAgICAgIDAuOC4wCi8vIEBhdXRob3IgICAgICAgICAgICAgWmhlbmcgQmFuZy1CbyhodHRwczovL2dpdGh1Yi5jb20vemhlbmdiYW5nYm8pCi8vIEBkZXNjcmlwdGlvbiAgICAgICAgQ2hhdEdQVCBhbnN3ZXJzIGRpc3BsYXllZCBpbiBzaWRlYmFyIGFmdGVyIHNlYXJjaCAoR29vZ2xlLCBCaW5nLCBCYWlkdSwgRHVja0R1Y2tHbyBhbmQgRGVlcEwpCi8vIEBkZXNjcmlwdGlvbjp6aC1DTiAg5L6n5qCP5pi+56S6IENoYXRHUFQg5Zue562U77yIR29vZ2xl44CBQmluZ+OAgeeZvuW6puOAgUR1Y2tEdWNrR2/lkoxEZWVwTO+8iQovLyBAZGVzY3JpcHRpb246emgtU0cgIOS+p+agj+aYvuekuiBDaGF0R1BUIOWbnuetlO+8iEdvb2dsZeOAgUJpbmfjgIHnmb7luqbjgIFEdWNrRHVja0dv5ZKMRGVlcEzvvIkKLy8gQGRlc2NyaXB0aW9uOnpoLVRXICDlgbTmrITpoa/npLogQ2hhdEdQVCDlm57nrZTvvIhHb29nbGXjgIFCaW5n44CB55m+5bqm44CBRHVja0R1Y2tHb+WSjERlZXBM77yJCi8vIEBkZXNjcmlwdGlvbjp6aC1ISyAg5YG05qyE6aGv56S6IENoYXRHUFQg5Zue562U77yIR29vZ2xl44CBQmluZ+OAgeeZvuW6puOAgUR1Y2tEdWNrR2/lkoxEZWVwTO+8iQovLyBAbGljZW5zZSAgICAgICAgICAgIE1JVAovLyBAaWNvbiAgICAgICAgICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS96aGVuZ2Jhbmdiby9vc3MvcmF3L21haW4vbG9nby9jaGF0LWdwdC11c2Vyc2NyaXB0LnBuZwovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmFkL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmFlL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5hZi9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uYWcvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLmFpL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmFsL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmFtL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLmFvL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5hci9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5hcy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5hdC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uYXUvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuYXovc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuYmEvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLmJkL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmJlL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmJmL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmJnL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5iaC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5iaS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5iai9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uYm4vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLmJvL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5ici9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5icy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5idC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jby5idy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5ieS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uYnovc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY2Evc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY2Qvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY2Yvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY2cvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY2gvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY2kvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY28uY2svc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY2wvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY20vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY24vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLmNvL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLmNyL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5jdS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jdi9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uY3kvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY3ovc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuZGUvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuZGovc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuZGsvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuZG0vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLmRvL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmR6L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5lYy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5lZS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uZWcvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuZXMvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLmV0L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmZpL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5mai9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5mbS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5mci9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5nYS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5nZS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5nZy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uZ2gvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLmdpL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmdsL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmdtL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmdyL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5ndC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5neS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uaGsvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuaG4vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuaHIvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuaHQvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuaHUvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY28uaWQvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuaWUvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY28uaWwvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuaW0vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY28uaW4vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuaXEvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuaXMvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuaXQvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuamUvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLmptL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmpvL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLmpwL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLmtlL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5raC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5raS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5rZy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jby5rci9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20ua3cvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUua3ovc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUubGEvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLmxiL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmxpL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmxrL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLmxzL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmx0L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmx1L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmx2L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5seS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jby5tYS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5tZC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5tZS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5tZy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5tay9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5tbC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20ubW0vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUubW4vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUubXMvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLm10L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLm11L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLm12L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLm13L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5teC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20ubXkvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY28ubXovc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLm5hL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5uZy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20ubmkvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUubmUvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUubmwvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUubm8vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLm5wL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLm5yL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLm51L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLm56L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5vbS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20ucGEvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLnBlL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5wZy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20ucGgvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLnBrL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnBsL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnBuL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5wci9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5wcy9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5wdC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20ucHkvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLnFhL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnJvL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnJ1L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnJ3L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5zYS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uc2Ivc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuc2Mvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuc2Uvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLnNnL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnNoL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnNpL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnNrL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS5zbC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5zbi9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5zby9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5zbS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5zci9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5zdC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20uc3Yvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUudGQvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUudGcvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY28udGgvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLnRqL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnRsL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnRtL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnRuL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnRvL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS50ci9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS50dC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20udHcvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY28udHovc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLnVhL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLnVnL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLnVrL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvbS51eS9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jby51ei9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly8qLmdvb2dsZS5jb20udmMvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY28udmUvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUudmcvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY28udmkvc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vKi5nb29nbGUuY29tLnZuL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnZ1L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLndzL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLnJzL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLnphL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLnptL3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNvLnp3L3NlYXJjaCoKLy8gQG1hdGNoICAgICAgICAgICAgICBodHRwczovLyouZ29vZ2xlLmNhdC9zZWFyY2gqCi8vIEBtYXRjaCAgICAgICAgICAgICAgaHR0cHM6Ly93d3cuYmluZy5jb20vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vY24uYmluZy5jb20vc2VhcmNoKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vd3d3LmJhaWR1LmNvbS9zKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vZHVja2R1Y2tnby5jb20vKgovLyBAbWF0Y2ggICAgICAgICAgICAgIGh0dHBzOi8vd3d3LmRlZXBsLmNvbS90cmFuc2xhdG9yKgovLyBAY29ubmVjdCAgICAgICAgICAgIGNoYXQub3BlbmFpLmNvbQovLyBAZ3JhbnQgICAgICAgICAgICAgIEdNX2FkZFN0eWxlCi8vIEBncmFudCAgICAgICAgICAgICAgR01fZGVsZXRlVmFsdWUKLy8gQGdyYW50ICAgICAgICAgICAgICBHTV9nZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgICAgICAgIEdNX2luZm8KLy8gQGdyYW50ICAgICAgICAgICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kCi8vIEBncmFudCAgICAgICAgICAgICAgR01fc2V0VmFsdWUKLy8gQGdyYW50ICAgICAgICAgICAgICBHTV91bnJlZ2lzdGVyTWVudUNvbW1hbmQKLy8gQGdyYW50ICAgICAgICAgICAgICBHTV94bWxodHRwUmVxdWVzdAovLyA9PS9Vc2VyU2NyaXB0PT0KCihlPT57Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpO3QuZGF0YXNldC5zb3VyY2U9InZpdGUtcGx1Z2luLW1vbmtleSIsdC5pbm5lclRleHQ9ZSxkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHQpfSkoIi5jaGF0LWdwdC1jb250YWluZXJ7bWF4LXdpZHRoOjM2OXB4O21hcmdpbi1ib3R0b206MzBweDtib3JkZXItcmFkaXVzOjhweDtib3JkZXI6MXB4IHNvbGlkICNkYWRjZTA7cGFkZGluZzoxNXB4O2ZsZXgtYmFzaXM6MDtmbGV4LWdyb3c6MTt3b3JkLXdyYXA6YnJlYWstd29yZDt3aGl0ZS1zcGFjZTpwcmUtd3JhcH0uY2hhdC1ncHQtY29udGFpbmVyIHB7bWFyZ2luOjB9LmNoYXQtZ3B0LWNvbnRhaW5lciAucHJlZml4e2ZvbnQtd2VpZ2h0OjcwMH0uY2hhdC1ncHQtY29udGFpbmVyIC5sb2FkaW5ne2NvbG9yOiNiNmI4YmE7YW5pbWF0aW9uOnB1bHNlIDJzIGN1YmljLWJlemllciguNCwwLC42LDEpIGluZmluaXRlfUBrZXlmcmFtZXMgcHVsc2V7MCUsdG97b3BhY2l0eToxfTUwJXtvcGFjaXR5Oi41fX0uY2hhdC1ncHQtY29udGFpbmVyLnNpZGViYXItZnJlZXttYXJnaW4tbGVmdDo2MHB4O2hlaWdodDpmaXQtY29udGVudH0uY2hhdC1ncHQtY29udGFpbmVyIHByZXt3aGl0ZS1zcGFjZTpwcmUtd3JhcDttaW4td2lkdGg6MDttYXJnaW4tYm90dG9tOjA7bGluZS1oZWlnaHQ6MjBweH0uY2hhdC1ncHQtdHJhbnNsYXRlLWJ1dHRvbntib3JkZXItcmFkaXVzOjhweDtib3JkZXI6MXB4IHNvbGlkICNkYWRjZTA7cGFkZGluZzo1cHh9LmNoYXQtZ3B0LXRyYW5zbGF0ZS1idXR0b246aG92ZXJ7Y29sb3I6IzAwNjQ5NDt0cmFuc2l0aW9uOmNvbG9yIC4xcyBlYXNlLW91dH0uY2hhdC1ncHQtdHJhbnNsYXRlLWJ1dHRvbltkaXNhYmxlZF17Y29sb3I6I2VlZX0iKTsKCihmdW5jdGlvbigpIHsKICAidXNlIHN0cmljdCI7CiAgdmFyIG1vbmtleVdpbmRvdyA9IHdpbmRvdzsKICB2YXIgR01faW5mbyA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4gbW9ua2V5V2luZG93LkdNX2luZm8pKCk7CiAgdmFyIEdNX3NldFZhbHVlID0gLyogQF9fUFVSRV9fICovICgoKSA9PiBtb25rZXlXaW5kb3cuR01fc2V0VmFsdWUpKCk7CiAgdmFyIEdNX2RlbGV0ZVZhbHVlID0gLyogQF9fUFVSRV9fICovICgoKSA9PiBtb25rZXlXaW5kb3cuR01fZGVsZXRlVmFsdWUpKCk7CiAgdmFyIEdNX2FkZFN0eWxlID0gLyogQF9fUFVSRV9fICovICgoKSA9PiBtb25rZXlXaW5kb3cuR01fYWRkU3R5bGUpKCk7CiAgdmFyIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IG1vbmtleVdpbmRvdy5HTV9yZWdpc3Rlck1lbnVDb21tYW5kKSgpOwogIHZhciBHTV91bnJlZ2lzdGVyTWVudUNvbW1hbmQgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IG1vbmtleVdpbmRvdy5HTV91bnJlZ2lzdGVyTWVudUNvbW1hbmQpKCk7CiAgdmFyIEdNX3htbGh0dHBSZXF1ZXN0ID0gLyogQF9fUFVSRV9fICovICgoKSA9PiBtb25rZXlXaW5kb3cuR01feG1saHR0cFJlcXVlc3QpKCk7CiAgdmFyIEdNX2dldFZhbHVlID0gLyogQF9fUFVSRV9fICovICgoKSA9PiBtb25rZXlXaW5kb3cuR01fZ2V0VmFsdWUpKCk7CiAgZnVuY3Rpb24gZ2V0VXNlcnNjcmlwdE1hbmFnZXIoKSB7CiAgICB0cnkgewogICAgICBjb25zdCB1c2Vyc2NyaXB0TWFuYWdlciA9IEdNX2luZm8uc2NyaXB0SGFuZGxlcjsKICAgICAgcmV0dXJuIHVzZXJzY3JpcHRNYW5hZ2VyOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgcmV0dXJuICJvdGhlciI7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHV1aWR2NCgpIHsKICAgIHZhciBzID0gW107CiAgICB2YXIgaGV4RGlnaXRzID0gIjAxMjM0NTY3ODlhYmNkZWYiOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzNjsgaSsrKSB7CiAgICAgIHNbaV0gPSBoZXhEaWdpdHMuc3Vic3RyKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2KSwgMSk7CiAgICB9CiAgICBzWzE0XSA9ICI0IjsKICAgIHNbMTldID0gaGV4RGlnaXRzLnN1YnN0cihzWzE5XSAmIDMgfCA4LCAxKTsKICAgIHNbOF0gPSBzWzEzXSA9IHNbMThdID0gc1syM10gPSAiLSI7CiAgICB2YXIgdXVpZCA9IHMuam9pbigiIik7CiAgICByZXR1cm4gdXVpZDsKICB9CiAgY29uc3QgbGFuZyA9IG5hdmlnYXRvci5hcHBOYW1lID09ICJOZXRzY2FwZSIgPyBuYXZpZ2F0b3IubGFuZ3VhZ2UgOiBuYXZpZ2F0b3IudXNlckxhbmd1YWdlOwogIGxldCBjb25maWcgPSB7fTsKICBzd2l0Y2ggKGxhbmcpIHsKICAgIGNhc2UgInpoLUNOIjoKICAgIGNhc2UgInpoLVNHIjoKICAgICAgY29uZmlnID0gewogICAgICAgIHdhaXRpbmdSZXNwb25zZTogIuetieW+hSBDaGF0R1BUIOWTjeW6lC4uLiIsCiAgICAgICAgbG9naW46ICLor7flnKjku6XkuIvlnLDlnYDnmbvlvZXvvJoiLAogICAgICAgIHRvb01hbnlSZXF1ZXN0czogIjHlsI/ml7blhoXor7fmsYLlpKrlpJrjgILor7fnqI3lkI7lho3or5XjgIIiLAogICAgICAgIGNoZWNrQ2xvdWZsYXJlOiAi6K+36YCa6L+HIENsb3VkZmxhcmUg5a6J5YWo5qOA5p+l77yM5Zyw5Z2A5Li6IiwKICAgICAgICB1bmtub3dFcnJvcjogIuWTpu+8jOWPr+iDveaYr+S4qumUmeivr++8jOivt+ajgOafpeaIluaPkOS6pOWIsCIsCiAgICAgICAgbmV0d29ya0V4Y2VwdGlvbjogIue9kee7nOW8guW4uO+8jOivt+WIt+aWsOmhtemdouOAgiIsCiAgICAgICAgY29udGFpbmVyUG9zaXRpb246ICLlrrnlmajkvY3nva4gLSDkvqfpnaIoMSkv6aG26YOoKDApOiAiLAogICAgICAgIGNoYXRHUFRUcmFuc2xhdGU6ICJDaGF0R1BUIOe/u+ivkSIKICAgICAgfTsKICAgICAgYnJlYWs7CiAgICBjYXNlICJ6aC1UVyI6CiAgICBjYXNlICJ6aC1ISyI6CiAgICAgIGNvbmZpZyA9IHsKICAgICAgICB3YWl0aW5nUmVzcG9uc2U6ICLnrYnlvoUgQ2hhdEdQVCDlm57mh4kuLi4iLAogICAgICAgIGxvZ2luOiAi6KuL5Zyo5Lul5LiL5Zyw5Z2A55m76YyE77yaIiwKICAgICAgICB0b29NYW55UmVxdWVzdHM6ICIx5bCP5pmC5YWn6KuL5rGC5aSq5aSa44CC6KuL56iN5b6M5YaN6Kmm44CCIiwKICAgICAgICBjaGVja0Nsb3VmbGFyZTogIuiri+mAmumBjiBDbG91ZGZsYXJlIOWuieWFqOaqouafpe+8jOWcsOWdgOeCuiIsCiAgICAgICAgdW5rbm93RXJyb3I6ICLlk6bvvIzlj6/og73mmK/lgIvpjK/oqqTvvIzoq4vmqqLmn6XmiJbmj5DkuqTliLAiLAogICAgICAgIG5ldHdvcmtFeGNlcHRpb246ICLntrLot6/nlbDluLjvvIzoq4vliLfmlrDpoIHpnaLjgIIiLAogICAgICAgIGNvbnRhaW5lclBvc2l0aW9uOiAi5a655Zmo5L2N572uIC0g5YG06Z2iKDEpL+mggumDqCgwKToiLAogICAgICAgIGNoYXRHUFRUcmFuc2xhdGU6ICJDaGF0R1BUIOe/u+itryIKICAgICAgfTsKICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICBjb25maWcgPSB7CiAgICAgICAgd2FpdGluZ1Jlc3BvbnNlOiAiV2FpdGluZyBmb3IgQ2hhdEdQVCByZXNwb25zZS4uLiIsCiAgICAgICAgbG9naW46ICJQbGVhc2UgbG9naW4gYXQgIiwKICAgICAgICB0b29NYW55UmVxdWVzdHM6ICJUb28gbWFueSByZXF1ZXN0cyBpbiAxIGhvdXIuIFRyeSBhZ2FpbiBsYXRlci4iLAogICAgICAgIGNoZWNrQ2xvdWZsYXJlOiAiUGxlYXNlIHBhc3MgQ2xvdWRmbGFyZSBzZWN1cml0eSBjaGVjayBhdCAiLAogICAgICAgIHVua25vd0Vycm9yOiAiT29wcywgbWF5YmUgaXQgaXMgYSBidWcsIHBsZWFzZSBjaGVjayBvciBzdWJtaXQgIiwKICAgICAgICBuZXR3b3JrRXhjZXB0aW9uOiAiTmV0d29yayBleGNlcHRpb24sIHBsZWFzZSByZWZyZXNoIHRoZSBwYWdlLiIsCiAgICAgICAgY29udGFpbmVyUG9zaXRpb246ICJDb250YWluZXIgUG9zaXRpb24gLSBTaWRlKDEpL1RvcCgwKTogIiwKICAgICAgICBjaGF0R1BUVHJhbnNsYXRlOiAiQ2hhdEdQVCBUcmFuc2xhdGUiCiAgICAgIH07CiAgfQogIGZ1bmN0aW9uIGkxOG4obmFtZSwgcGFyYW0pIHsKICAgIHJldHVybiBjb25maWdbbmFtZV0gPyBjb25maWdbbmFtZV0ucmVwbGFjZSgiI3QjIiwgcGFyYW0pIDogbmFtZTsKICB9CiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgZnVuY3Rpb24gZ2V0Q29udGFpbmVyKCkgewogICAgcmV0dXJuIGNvbnRhaW5lcjsKICB9CiAgZnVuY3Rpb24gaW5pdENvbnRhaW5lcigpIHsKICAgIGNvbnN0IGNvbnRhaW5lcjIgPSBnZXRDb250YWluZXIoKTsKICAgIGNvbnRhaW5lcjIuY2xhc3NOYW1lID0gImNoYXQtZ3B0LWNvbnRhaW5lciI7CiAgICBjb250YWluZXIyLmlubmVySFRNTCA9IGA8cCBjbGFzcz0ibG9hZGluZyI+JHtpMThuKCJ3YWl0aW5nUmVzcG9uc2UiKX08L3A+YDsKICB9CiAgZnVuY3Rpb24gY29udGFpbmVyU2hvdyhhbnN3ZXIpIHsKICAgIGNvbnN0IGNvbnRhaW5lcjIgPSBnZXRDb250YWluZXIoKTsKICAgIGNvbnRhaW5lcjIuaW5uZXJIVE1MID0gJzxwPjxzcGFuIGNsYXNzPSJwcmVmaXgiPkNoYXRHUFQ8L3NwYW4+PHByZT48L3ByZT48L3A+JzsKICAgIGNvbnRhaW5lcjIucXVlcnlTZWxlY3RvcigicHJlIikudGV4dENvbnRlbnQgPSBhbnN3ZXI7CiAgfQogIGZ1bmN0aW9uIGNvbnRhaW5lckFsZXJ0KGh0bWxTdHIpIHsKICAgIGNvbnN0IGNvbnRhaW5lcjIgPSBnZXRDb250YWluZXIoKTsKICAgIGNvbnRhaW5lcjIuaW5uZXJIVE1MID0gaHRtbFN0cjsKICB9CiAgZnVuY3Rpb24gYWxlcnRMb2dpbigpIHsKICAgIGNvbnRhaW5lckFsZXJ0KGA8cD4ke2kxOG4oImxvZ2luIil9PGEgaHJlZj0iaHR0cHM6Ly9jaGF0Lm9wZW5haS5jb20iIHRhcmdldD0iX2JsYW5rIiByZWw9Im5vcmVmZXJyZXIiPmNoYXQub3BlbmFpLmNvbTwvYT48L3A+YCk7CiAgfQogIGZ1bmN0aW9uIGFsZXJ0QmxvY2tlZEJ5Q2xvdWRmbGFyZSgpIHsKICAgIGNvbnRhaW5lckFsZXJ0KGA8cD4ke2kxOG4oImNoZWNrQ2xvdWZsYXJlIil9PGEgaHJlZj0iaHR0cHM6Ly9jaGF0Lm9wZW5haS5jb20iIHRhcmdldD0iX2JsYW5rIiByZWw9Im5vcmVmZXJyZXIiPmNoYXQub3BlbmFpLmNvbTwvYT48L3A+YCk7CiAgfQogIGZ1bmN0aW9uIGFsZXJ0RnJlcXVlbnRSZXF1ZXN0cygpIHsKICAgIGNvbnRhaW5lckFsZXJ0KGA8cD4ke2kxOG4oInRvb01hbnlSZXF1ZXN0cyIpfTwvcD5gKTsKICB9CiAgZnVuY3Rpb24gaXNCbG9ja2VkYnlDbG91ZGZsYXJlKHJlc3ApIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IGh0bWwgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHJlc3AsICJ0ZXh0L2h0bWwiKTsKICAgICAgY29uc3QgdGl0bGUgPSBodG1sLnF1ZXJ5U2VsZWN0b3IoInRpdGxlIik7CiAgICAgIHJldHVybiB0aXRsZS5pbm5lclRleHQgPT09ICJKdXN0IGEgbW9tZW50Li4uIjsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CiAgYXN5bmMgZnVuY3Rpb24gZ2V0QW5zd2VyKHF1ZXN0aW9uLCBjYWxsYmFjaykgewogICAgdHJ5IHsKICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBnZXRBY2Nlc3NUb2tlbigpOwogICAgICBHTV94bWxodHRwUmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jaGF0Lm9wZW5haS5jb20vYmFja2VuZC1hcGkvY29udmVyc2F0aW9uIiwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiQ29udGVudC1UeXBlIjogIglhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gCiAgICAgICAgfSwKICAgICAgICByZXNwb25zZVR5cGU6IHJlc3BvbnNlVHlwZSgpLAogICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgIGFjdGlvbjogIm5leHQiLAogICAgICAgICAgbWVzc2FnZXM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlkOiB1dWlkdjQoKSwKICAgICAgICAgICAgICByb2xlOiAidXNlciIsCiAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgY29udGVudF90eXBlOiAidGV4dCIsCiAgICAgICAgICAgICAgICBwYXJ0czogW3F1ZXN0aW9uXQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG1vZGVsOiAidGV4dC1kYXZpbmNpLTAwMi1yZW5kZXIiLAogICAgICAgICAgcGFyZW50X21lc3NhZ2VfaWQ6IHV1aWR2NCgpCiAgICAgICAgfSksCiAgICAgICAgb25sb2Fkc3RhcnQ6IG9ubG9hZHN0YXJ0KCksCiAgICAgICAgb25sb2FkOiBvbmxvYWQoKSwKICAgICAgICBvbmVycm9yOiBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgY29uc29sZS5lcnJvcigiZ2V0QW5zd2VyIGVycm9yOiAiLCBldmVudCk7CiAgICAgICAgfSwKICAgICAgICBvbnRpbWVvdXQ6IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJnZXRBbnN3ZXIgdGltZW91dDogIiwgZXZlbnQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBpZiAoZXJyb3IgPT09ICJVTkFVVEhPUklaRUQiKSB7CiAgICAgICAgcmVtb3ZlQWNjZXNzVG9rZW4oKTsKICAgICAgICBhbGVydExvZ2luKCk7CiAgICAgIH0KICAgICAgY29uc29sZS5lcnJvcigiZ2V0QW5zd2VyIGVycm9yOiAiLCBlcnJvcik7CiAgICB9CiAgICBmdW5jdGlvbiByZXNwb25zZVR5cGUoKSB7CiAgICAgIGlmIChnZXRVc2Vyc2NyaXB0TWFuYWdlcigpID09PSAiVGFtcGVybW9ua2V5IikgewogICAgICAgIHJldHVybiAic3RyZWFtIjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gInRleHQiOwogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBvbmxvYWQoKSB7CiAgICAgIGZ1bmN0aW9uIGZpbmlzaCgpIHsKICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICByZXR1cm4gY2FsbGJhY2soImZpbmlzaCIpOwogICAgICAgIH0KICAgICAgfQogICAgICBmaW5pc2goKTsKICAgICAgcmV0dXJuIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgaWYgKGV2ZW50LnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICByZW1vdmVBY2Nlc3NUb2tlbigpOwogICAgICAgICAgYWxlcnRMb2dpbigpOwogICAgICAgIH0KICAgICAgICBpZiAoZXZlbnQuc3RhdHVzID09PSA0MDMpIHsKICAgICAgICAgIGFsZXJ0QmxvY2tlZEJ5Q2xvdWRmbGFyZSgpOwogICAgICAgIH0KICAgICAgICBpZiAoZXZlbnQuc3RhdHVzID09PSA0MjkpIHsKICAgICAgICAgIGFsZXJ0RnJlcXVlbnRSZXF1ZXN0cygpOwogICAgICAgIH0KICAgICAgICBpZiAoZ2V0VXNlcnNjcmlwdE1hbmFnZXIoKSAhPT0gIlRhbXBlcm1vbmtleSIpIHsKICAgICAgICAgIGlmIChldmVudC5yZXNwb25zZSkgewogICAgICAgICAgICBjb25zdCBhbnN3ZXIgPSBKU09OLnBhcnNlKGV2ZW50LnJlc3BvbnNlLnNwbGl0KCJcblxuIikuc2xpY2UoLTMsIC0yKVswXS5zbGljZSg2KSkubWVzc2FnZS5jb250ZW50LnBhcnRzWzBdOwogICAgICAgICAgICBjb250YWluZXJTaG93KGFuc3dlcik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgfQogICAgZnVuY3Rpb24gb25sb2Fkc3RhcnQoKSB7CiAgICAgIGlmIChnZXRVc2Vyc2NyaXB0TWFuYWdlcigpID09PSAiVGFtcGVybW9ua2V5IikgewogICAgICAgIHJldHVybiBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgICAgIGNvbnN0IHJlYWRlciA9IHN0cmVhbS5yZXNwb25zZS5nZXRSZWFkZXIoKTsKICAgICAgICAgIHJlYWRlci5yZWFkKCkudGhlbihmdW5jdGlvbiBwcm9jZXNzVGV4dCh7IGRvbmUsIHZhbHVlIH0pIHsKICAgICAgICAgICAgaWYgKGRvbmUpIHsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IHJlc3BvbnNlSXRlbSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoLi4uQXJyYXkuZnJvbSh2YWx1ZSkpOwogICAgICAgICAgICBjb25zdCBpdGVtcyA9IHJlc3BvbnNlSXRlbS5zcGxpdCgiXG5cbiIpOwogICAgICAgICAgICBpZiAoaXRlbXMubGVuZ3RoID4gMikgewogICAgICAgICAgICAgIGNvbnN0IGxhc3RJdGVtID0gaXRlbXMuc2xpY2UoLTMsIC0yKVswXTsKICAgICAgICAgICAgICBpZiAobGFzdEl0ZW0uc3RhcnRzV2l0aCgiZGF0YTogW0RPTkVdIikpIHsKICAgICAgICAgICAgICAgIHJlc3BvbnNlSXRlbSA9IGl0ZW1zLnNsaWNlKC00LCAtMylbMF07CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlc3BvbnNlSXRlbSA9IGxhc3RJdGVtOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocmVzcG9uc2VJdGVtLnN0YXJ0c1dpdGgoImRhdGE6IHsiKSkgewogICAgICAgICAgICAgIGNvbnN0IGFuc3dlciA9IEpTT04ucGFyc2UocmVzcG9uc2VJdGVtLnNsaWNlKDYpKS5tZXNzYWdlLmNvbnRlbnQucGFydHNbMF07CiAgICAgICAgICAgICAgY29udGFpbmVyU2hvdyhhbnN3ZXIpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlSXRlbS5zdGFydHNXaXRoKCJkYXRhOiBbRE9ORV0iKSkgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVhZGVyLnJlYWQoKS50aGVuKHByb2Nlc3NUZXh0KTsKICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gcmVtb3ZlQWNjZXNzVG9rZW4oKSB7CiAgICBHTV9kZWxldGVWYWx1ZSgiYWNjZXNzVG9rZW4iKTsKICB9CiAgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamNldCkgPT4gewogICAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IEdNX2dldFZhbHVlKCJhY2Nlc3NUb2tlbiIpOwogICAgICBpZiAoIWFjY2Vzc1Rva2VuKSB7CiAgICAgICAgR01feG1saHR0cFJlcXVlc3QoewogICAgICAgICAgdXJsOiAiaHR0cHM6Ly9jaGF0Lm9wZW5haS5jb20vYXBpL2F1dGgvc2Vzc2lvbiIsCiAgICAgICAgICBvbmxvYWQ6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIGlmIChpc0Jsb2NrZWRieUNsb3VkZmxhcmUocmVzcG9uc2UucmVzcG9uc2VUZXh0KSkgewogICAgICAgICAgICAgIGFsZXJ0TG9naW4oKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4yID0gSlNPTi5wYXJzZShyZXNwb25zZS5yZXNwb25zZVRleHQpLmFjY2Vzc1Rva2VuOwogICAgICAgICAgICBpZiAoIWFjY2Vzc1Rva2VuMikgewogICAgICAgICAgICAgIHJlamNldCgiVU5BVVRIT1JJWkVEIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgR01fc2V0VmFsdWUoImFjY2Vzc1Rva2VuIiwgYWNjZXNzVG9rZW4yKTsKICAgICAgICAgICAgcmVzb2x2ZShhY2Nlc3NUb2tlbjIpOwogICAgICAgICAgfSwKICAgICAgICAgIG9uZXJyb3I6IGZ1bmN0aW9uKGVycm9yKSB7CiAgICAgICAgICAgIHJlamNldChlcnJvcik7CiAgICAgICAgICB9LAogICAgICAgICAgb250aW1lb3V0OiAoKSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoImdldEFjY2Vzc1Rva2VuIHRpbWVvdXQhIik7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzb2x2ZShhY2Nlc3NUb2tlbik7CiAgICAgIH0KICAgIH0pOwogIH0KICBjb25zdCBfZGVmYXVsdCA9ICIiOwogIGZ1bmN0aW9uIGdldFdlYnNpdGUoKSB7CiAgICBpZiAobG9jYXRpb24uaG9zdG5hbWUuaW5kZXhPZigiLmdvb2dsZS4iKSAhPT0gLTEpIHsKICAgICAgcmV0dXJuIGNvbmZpZ1JlcXVlc3RJbW1lZGlhdGVseSgiZ29vZ2xlIik7CiAgICB9CiAgICBzd2l0Y2ggKGxvY2F0aW9uLmhvc3RuYW1lKSB7CiAgICAgIGNhc2UgInd3dy5iaW5nLmNvbSI6CiAgICAgIGNhc2UgImNuLmJpbmcuY29tIjoKICAgICAgICByZXR1cm4gY29uZmlnUmVxdWVzdEltbWVkaWF0ZWx5KCJiaW5nIik7CiAgICAgIGNhc2UgInd3dy5iYWlkdS5jb20iOgogICAgICAgIHJldHVybiBjb25maWdSZXF1ZXN0SW1tZWRpYXRlbHkoImJhaWR1Iik7CiAgICAgIGNhc2UgImR1Y2tkdWNrZ28uY29tIjoKICAgICAgICByZXR1cm4gY29uZmlnUmVxdWVzdEltbWVkaWF0ZWx5KCJkdWNrZHVja2dvIik7CiAgICAgIGNhc2UgInd3dy5kZWVwbC5jb20iOgogICAgICAgIHJldHVybiBjb25maWdSZXF1ZXN0QWZ0ZXJDbGlja0J1dHRvbigiZGVlcGwiKTsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVua25vdyB3ZWJzaXRlOiAke2xvY2F0aW9uLmhvc3RuYW1lfWApOwogICAgfQogICAgZnVuY3Rpb24gY29uZmlnUmVxdWVzdEltbWVkaWF0ZWx5KG5hbWUpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lLAogICAgICAgIHR5cGU6ICJpbW1lZGlhdGVseSIKICAgICAgfTsKICAgIH0KICAgIGZ1bmN0aW9uIGNvbmZpZ1JlcXVlc3RBZnRlckNsaWNrQnV0dG9uKG5hbWUpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lLAogICAgICAgIHR5cGU6ICJhZnRlci1jbGljay1idXR0b24iCiAgICAgIH07CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldFF1ZXN0aW9uKCkgewogICAgc3dpdGNoIChnZXRXZWJzaXRlKCkubmFtZSkgewogICAgICBjYXNlICJiYWlkdSI6CiAgICAgICAgcmV0dXJuIG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpLnNlYXJjaFBhcmFtcy5nZXQoIndkIik7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpLnNlYXJjaFBhcmFtcy5nZXQoInEiKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZ2V0UG9zaXRpb24oKSB7CiAgICByZXR1cm4gR01fZ2V0VmFsdWUoImNvbnRhaW5lclBvc2l0aW9uIiwgMSk7CiAgfQogIGZ1bmN0aW9uIHNldFBvc2l0aW9uKG5ld1Bvc2l0aW9uKSB7CiAgICBHTV9zZXRWYWx1ZSgiY29udGFpbmVyUG9zaXRpb24iLCBuZXdQb3NpdGlvbik7CiAgfQogIGZ1bmN0aW9uIGluaXRVSSgpIHsKICAgIGluaXRDb250YWluZXIoKTsKICAgIHN3aXRjaCAoZ2V0V2Vic2l0ZSgpLm5hbWUpIHsKICAgICAgY2FzZSAiZ29vZ2xlIjoKICAgICAgICBnb29nbGVJbmplY3RDb250YWluZXIoKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiYmluZyI6CiAgICAgICAgYmluZ0luamVjdENvbnRhaW5lcigpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJiYWlkdSI6CiAgICAgICAgYmFpZHVJbmplY3RDb250YWluZXIoKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAiZHVja2R1Y2tnbyI6CiAgICAgICAgZHVja2R1Y2tnb0luamVjdENvbnRhaW5lcigpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJkZWVwbCI6CiAgICAgICAgZGVlcGxJbmplY3RDb250YWluZXIoKTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICBhbGVydFVua25vd0Vycm9yKCk7CiAgICB9CiAgICBmdW5jdGlvbiBnb29nbGVJbmplY3RDb250YWluZXIoKSB7CiAgICAgIGlmIChnZXRQb3NpdGlvbigpID09PSAxKSB7CiAgICAgICAgY29uc3QgY29udGFpbmVyMiA9IGdldENvbnRhaW5lcigpOwogICAgICAgIGNvbnN0IHNpZGVyYmFyQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJocyIpOwogICAgICAgIGlmIChzaWRlcmJhckNvbnRhaW5lcikgewogICAgICAgICAgc2lkZXJiYXJDb250YWluZXIucHJlcGVuZChjb250YWluZXIyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGFpbmVyMi5jbGFzc0xpc3QuYWRkKCJzaWRlYmFyLWZyZWUiKTsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyY250IikuYXBwZW5kQ2hpbGQoY29udGFpbmVyMik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIEdNX2FkZFN0eWxlKCIuY2hhdC1ncHQtY29udGFpbmVye21heC13aWR0aDogMTAwJSFpbXBvcnRhbnR9Iik7CiAgICAgICAgY29uc3QgY29udGFpbmVyMiA9IGdldENvbnRhaW5lcigpOwogICAgICAgIGNvbnN0IG1haW5Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjc2VhcmNoIik7CiAgICAgICAgaWYgKG1haW5Db250YWluZXIpIHsKICAgICAgICAgIG1haW5Db250YWluZXIucHJlcGVuZChjb250YWluZXIyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIGJpbmdJbmplY3RDb250YWluZXIoKSB7CiAgICAgIGlmIChnZXRQb3NpdGlvbigpID09PSAxKSB7CiAgICAgICAgY29uc3QgY29udGFpbmVyMiA9IGdldENvbnRhaW5lcigpOwogICAgICAgIGNvbnN0IHNpZGVyYmFyQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJfY29udGV4dCIpOwogICAgICAgIHNpZGVyYmFyQ29udGFpbmVyLnByZXBlbmQoY29udGFpbmVyMik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgR01fYWRkU3R5bGUoIi5jaGF0LWdwdC1jb250YWluZXJ7bWF4LXdpZHRoOiAxMDAlIWltcG9ydGFudH0iKTsKICAgICAgICBHTV9hZGRTdHlsZSgiLmNoYXQtZ3B0LWNvbnRhaW5lcnt3aWR0aDogNzB2d30iKTsKICAgICAgICBjb25zdCBjb250YWluZXIyID0gZ2V0Q29udGFpbmVyKCk7CiAgICAgICAgY29uc3QgbWFpbkJhckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIm1haW4iKTsKICAgICAgICBtYWluQmFyQ29udGFpbmVyLnByZXBlbmQoY29udGFpbmVyMik7CiAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIGJhaWR1SW5qZWN0Q29udGFpbmVyKCkgewogICAgICBpZiAoZ2V0UG9zaXRpb24oKSA9PT0gMSkgewogICAgICAgIGNvbnN0IGNvbnRhaW5lcjIgPSBnZXRDb250YWluZXIoKTsKICAgICAgICBjb25zdCBzaWRlcmJhckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb250ZW50X3JpZ2h0Iik7CiAgICAgICAgc2lkZXJiYXJDb250YWluZXIucHJlcGVuZChjb250YWluZXIyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBHTV9hZGRTdHlsZSgiLmNoYXQtZ3B0LWNvbnRhaW5lcnttYXgtd2lkdGg6IDEwMCUhaW1wb3J0YW50fSIpOwogICAgICAgIGNvbnN0IGNvbnRhaW5lcjIgPSBnZXRDb250YWluZXIoKTsKICAgICAgICBjb25zdCBzaWRlcmJhckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNjb250ZW50X2xlZnQiKTsKICAgICAgICBzaWRlcmJhckNvbnRhaW5lci5wcmVwZW5kKGNvbnRhaW5lcjIpOwogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBkdWNrZHVja2dvSW5qZWN0Q29udGFpbmVyKCkgewogICAgICBjb25zdCBjb250YWluZXIyID0gZ2V0Q29udGFpbmVyKCk7CiAgICAgIGNvbnN0IHNpZGVyYmFyQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicmVzdWx0cy0tc2lkZWJhciIpWzBdOwogICAgICBzaWRlcmJhckNvbnRhaW5lci5wcmVwZW5kKGNvbnRhaW5lcjIpOwogICAgfQogICAgZnVuY3Rpb24gZGVlcGxJbmplY3RDb250YWluZXIoKSB7CiAgICAgIGNvbnN0IGNvbnRhaW5lcjIgPSBnZXRDb250YWluZXIoKTsKICAgICAgY29udGFpbmVyMi5zdHlsZS5tYXhXaWR0aCA9ICIxMDAwcHgiOwogICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgYnV0dG9uLmlubmVySFRNTCA9IGkxOG4oImNoYXRHUFRUcmFuc2xhdGUiKTsKICAgICAgYnV0dG9uLmNsYXNzTmFtZSA9ICJjaGF0LWdwdC10cmFuc2xhdGUtYnV0dG9uIjsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibG10X190ZXh0YXJlYV9jb250YWluZXIiKVswXS5hcHBlbmRDaGlsZChidXR0b24pOwogICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbigpIHsKICAgICAgICBpbml0Q29udGFpbmVyKCk7CiAgICAgICAgYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICB0cnkgewogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibG10X19yYWlzZV9hbHRlcm5hdGl2ZXNfcGxhY2VtZW50IilbMF0uaW5zZXJ0QmVmb3JlKGNvbnRhaW5lcjIsIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImxtdF9fdHJhbnNsYXRpb25zX2FzX3RleHQiKVswXSk7CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJsbXRfX3RleHRhcmVhX2NvbnRhaW5lciIpWzFdLmluc2VydEJlZm9yZShjb250YWluZXIyLCBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJsbXRfX3RyYW5zbGF0aW9uc19hc190ZXh0IilbMF0pOwogICAgICAgIH0KICAgICAgICBsZXQgb3V0bGFuZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoInN0cm9uZ1tkYXRhLXRlc3RpZD0nZGVlcGwtdWktdG9vbHRpcC10YXJnZXQnXSIpWzBdLmlubmVySFRNTDsKICAgICAgICBsZXQgcXVlc3Rpb24gPSAiVHJhbnNsYXRlIHRoZSBmb2xsb3dpbmcgcGFyYWdyYXBoIGludG8gIiArIG91dGxhbmcgKyAiIGFuZCBvbmx5ICIgKyBvdXRsYW5nICsgIlxuXG4iICsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNvdXJjZS1kdW1teWRpdiIpLmlubmVySFRNTDsKICAgICAgICBnZXRBbnN3ZXIocXVlc3Rpb24sICh0KSA9PiB7CiAgICAgICAgICBidXR0b24uZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGluaXRNZW51KCkgewogICAgbGV0IHBvc2l0aW9uX2lkID0gR01fcmVnaXN0ZXJNZW51Q29tbWFuZChpMThuKCJjb250YWluZXJQb3NpdGlvbiIpICsgZ2V0UG9zaXRpb24oKSwgcG9zaXRpb25fc3dpdGNoLCAiTSIpOwogICAgZnVuY3Rpb24gcG9zaXRpb25fc3dpdGNoKCkgewogICAgICBHTV91bnJlZ2lzdGVyTWVudUNvbW1hbmQocG9zaXRpb25faWQpOwogICAgICBzZXRQb3NpdGlvbigoZ2V0UG9zaXRpb24oKSArIDEpICUgMik7CiAgICAgIHBvc2l0aW9uX2lkID0gR01fcmVnaXN0ZXJNZW51Q29tbWFuZChpMThuKCJjb250YWluZXJQb3NpdGlvbiIpICsgZ2V0UG9zaXRpb24oKSwgcG9zaXRpb25fc3dpdGNoLCAiTSIpOwogICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgIH0KICB9CiAgYXN5bmMgZnVuY3Rpb24gbWFpbigpIHsKICAgIGluaXRVSSgpOwogICAgaW5pdE1lbnUoKTsKICAgIGlmIChnZXRXZWJzaXRlKCkudHlwZSA9PT0gImltbWVkaWF0ZWx5IikgewogICAgICBnZXRBbnN3ZXIoZ2V0UXVlc3Rpb24oKSk7CiAgICB9CiAgfQogIG1haW4oKS5jYXRjaCgoZSkgPT4gewogICAgY29uc29sZS5lcnJvcihlKTsKICB9KTsKfSkoKTsK"},{"name":"Google Classroom Dark Mode Theme","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["*://classroom.google.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685022318377,"data":{}},"enabled":true,"position":10,"file_url":"https://openuserjs.org/install/ThaCheeseBun/Google_Classroom_Dark_Mode_Theme.user.js","uuid":"72b9e392-91db-4082-951a-dba71d202f70","source":"Ly8gPT1Vc2VyU2NyaXB0PT0NCi8vIEBuYW1lICAgICAgICAgR29vZ2xlIENsYXNzcm9vbSBEYXJrIE1vZGUgVGhlbWUNCi8vIEBuYW1lc3BhY2UgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzM5NTMxOS1nb29nbGUtY2xhc3Nyb29tLWRhcmstbW9kZS10aGVtZQ0KLy8gQHZlcnNpb24gICAgICAwLjUuMQ0KLy8gQGRlc2NyaXB0aW9uICBBIGRhcmsgbW9kZSB0aGVtZSBmb3IgR29vZ2xlIENsYXNzcm9vbS4gRm9yIGFsbCB0aGUgc3R1ZGVudHMgdGhhdCBwcmVmZXIgbmlnaHQgb3ZlciBkYXkuDQovLyBAYXV0aG9yICAgICAgIFRoYUNoZWVzZUJ1bg0KLy8gQG1hdGNoICAgICAgICAqOi8vY2xhc3Nyb29tLmdvb2dsZS5jb20vKg0KLy8gQGdyYW50ICAgICAgICBub25lDQovLyBAbGljZW5zZSAgICAgIE1JVDsgaHR0cHM6Ly9taXQtbGljZW5zZS5vcmcvDQovLyA9PS9Vc2VyU2NyaXB0PT0NCg0KKGZ1bmN0aW9uKCkgew0KICAgICd1c2Ugc3RyaWN0JzsNCg0KICAgIHZhciBzdHlsZSA9IGANCmJvZHkgew0KICAgIGJhY2tncm91bmQ6ICMyYzJjMmM7DQogICAgY29sb3I6ICNmZmY7DQp9DQoNCi8qIGhlbHAgYnRuICovDQouSzJtWFBiIHsNCiAgICBjb2xvcjogI2ZmZjsNCiAgICBmaWxsOiAjZmZmOw0KfQ0KDQovKiBsaW5rcyAqLw0KYSB7DQogICAgY29sb3I6IGRvZGdlcmJsdWU7DQp9DQphOnZpc2l0ZWQgew0KICAgIGNvbG9yOiBtZWRpdW1vcmNoaWQ7DQp9DQoNCi8qIHRvcCBiYXIgKi8NCi5qb0pnbGIgew0KICAgIGJhY2tncm91bmQ6ICMzYzNjM2M7DQogICAgYm9yZGVyLWJvdHRvbTogbm9uZTsNCn0NCi5qb0pnbGIsIC5qb0pnbGIua0xIbjMgew0KICAgIGJveC1zaGFkb3c6IDBweCAwcHggNnB4IDRweCByZ2JhKDI4LCAyOCwgMjgsIC40KTsNCn0NCg0KLyogZ29vZ2xlIGFwcHMgKi8NCi5nYl9xYSBzdmcsIC5nYl9DW2FyaWEtZXhwYW5kZWQ9InRydWUiXSAuZ2JfVmUgew0KICAgIGZpbGw6ICNmZmY7DQp9DQoNCi8qIGljb25zICovDQouSXFKVGVlLCAuVmlDaTQsIC54U1A1aWMsIC5janEyRGIgew0KICAgIGNvbG9yOiAjZmZmOw0KfQ0KDQovKiBjbGFzc3Jvb20gZWxlbXMgKi8NCi5Bb3BuZGQgew0KICAgIGJhY2tncm91bmQ6ICMzYzNjM2M7DQogICAgYm9yZGVyLWNvbG9yOiAjNWM1YzVjOw0KfQ0KLlNaMGtaZSB7DQogICAgYm9yZGVyLXRvcDogbm9uZSAhaW1wb3J0YW50Ow0KfQ0KLmFwRnNPLm9ua2NHZCwNCi5hcEZzTy5vbmtjR2Q6dmlzaXRlZCB7DQogICAgY29sb3I6ICNmZmY7DQp9DQoub0JTUkxlIHsNCiAgICBjb2xvcjogI2ZmZjsNCn0NCi5KUGRSNmIgew0KICAgIGJhY2tncm91bmQ6ICMzYzNjM2M7DQogICAgYm94LXNoYWRvdzogMHB4IDBweCAycHggMXB4IHJnYmEoMjgsIDI4LCAyOCwgLjQpOw0KfQ0KDQovKiBuYXYgbWVudSAqLw0KLmFzUVhWIHsNCiAgICBjb2xvcjogI2ZmZjsNCn0NCi5kREtoVmMsIC5pTGp6RGMgew0KICAgIGNvbG9yOiAjYWZhZmFmOw0KfQ0KLmtDdFl3ZSB7DQogICAgYm9yZGVyLWNvbG9yOiAjNGM0YzRjICFpbXBvcnRhbnQ7DQp9DQouRVRSa0NlIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjM2MzYzNjICFpbXBvcnRhbnQ7DQp9DQouRFNoeU1jLUFhVEZmZSAuWGk4Y3BiLnFzNDFxZSAuTGxjZkssIC5iRmpVbWItWXNsN0ZlLCAuVlVvS1ogew0KICAgIGJhY2tncm91bmQtY29sb3I6ICM0YzRjNGMgIWltcG9ydGFudDsNCn0NCi5YaThjcGI6aG92ZXIgLkxsY2ZLIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDc2LCA3NiwgNzYsIC41KSAhaW1wb3J0YW50Ow0KfQ0KDQovKiBjYWxlbmRhciAqLw0KLkV2dDdjYiwgLkV2dDdjYjp2aXNpdGVkLCAuZkt6N09kIC5UcFFtOWQgew0KICAgIGNvbG9yOiAjZmZmICFpbXBvcnRhbnQ7DQp9DQouQk9XNjQgew0KICAgIGJvcmRlci1jb2xvcjogIzVjNWM1YyAhaW1wb3J0YW50Ow0KfQ0KLndRdVBrIC5Kc3FMTS5ONFhWN2Qgew0KICAgIGNvbG9yOiAjYWZhZmFmICFpbXBvcnRhbnQ7DQp9DQoueWJPZG5mIC5PQTBxTmIgLkxNZ3ZSYlthcmlhLXNlbGVjdGVkPSJ0cnVlIl0gew0KICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoNzYsIDc2LCA3NiwgLjUpICFpbXBvcnRhbnQ7DQp9DQoubmNGSGVkIC5Nb2NHOGMuS0tqdlhiIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNGM0YzRjICFpbXBvcnRhbnQ7DQp9DQoNCi8qIHRvZG8gcGFnZSAqLw0KLlhwME9DZSwgLm5jRkhlZCB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogIzNjM2MzYyAhaW1wb3J0YW50Ow0KfQ0KLlhwME9DZSB7DQogICAgYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7DQp9DQouSFoza1djLCAuV09Qd1hlLCAuZ0prMjRjLCAuYXNRWFYtRkd6WUwgew0KICAgIGNvbG9yOiAjZmZmOw0KfQ0KLk1IeHRpYzpub3QoOmxhc3QtY2hpbGQpLCAuTEtxRlhjIHsNCiAgICBib3JkZXItY29sb3I6ICM0YzRjNGMgIWltcG9ydGFudDsNCn0NCi5NSHh0aWM6aG92ZXIgew0KICAgIGJveC1zaGFkb3c6IG5vbmUgIWltcG9ydGFudDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNGM0YzRjOw0KfQ0KDQovKiBjbGFzcyBwYWdlICovDQouZDRGZTBkIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjM2MzYzNjICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyLWNvbG9yOiAjNGM0YzRjICFpbXBvcnRhbnQ7DQp9DQouRVpyYm5kLCAuQTZkQzJjLCAuTzk4TGosIC5ycG80d2YsIC50TERFSGQsIC5jU3lQZ2IsIC53WlRBTmUgLkoxcmFOOmhvdmVyLCAudWR4U21jLCAubHppWnViLCAubHppWnViOnZpc2l0ZWQgew0KICAgIGNvbG9yOiAjZmZmICFpbXBvcnRhbnQ7DQp9DQouc2REQ21lLCAuSzZPdnFkLCAuVDhyVGpkLCAuTHpkd2hkLUJyWlNPZCwgLm9ua2NHZCwgLm9ua2NHZDp2aXNpdGVkLCAud1pUQU5lIC5KMXJhTiB7DQogICAgY29sb3I6ICNjY2M7DQp9DQouVm5PSHdmLVR2bTlkYiwgLkJFQUdTOm5vdCguUkRQWkUpLCAuVm5PSHdmLVd2ZDlDYywgLkNKWHplZSBhOmFjdGl2ZSwNCi5DSlh6ZWUgYTpmb2N1cywgLkNKWHplZSBhOmhvdmVyLCAuc2REQ21lLCAuSzZPdnFkLCAudm5ucjVlIC5zbkJ5YWMsDQoudm5ucjVlIC5Bd29yZ2UsIC5YcHhzVmIgLkF3b3JnZSwgLlVRdWFHYywgLndDRGttZiwgLmtzYU90ZCB7DQogICAgY29sb3I6ICNmZmYgIWltcG9ydGFudDsNCn0NCi5NeW1IMGQ6aG92ZXIgLlZCRWR0Yy1XdmQ5Q2MsIC5sM0YxeWU6bm90KC5SRFBaRSksIC5JTXZZSWQsIC5JTXZZSWQ6dmlzaXRlZCwgLm5STE96ZDpob3ZlciwgLm5STE96ZDpob3ZlciAqLCAuTzk4TGosIC5MemR3aGQtQnJaU09kIHsNCiAgICBjb2xvcjogI2NjYyAhaW1wb3J0YW50Ow0KfQ0KLkdXWjd5ZiwgLmhnakJEYywgLnZubnI1ZSAuQ0l5OUYsIC5xazBsZWU6Zm9jdXM6OmFmdGVyIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjM2MzYzNjICFpbXBvcnRhbnQ7DQogICAgYm94LXNoYWRvdzogbm9uZSAhaW1wb3J0YW50Ow0KfQ0KLnZubnI1ZSAuSTlPSkhlIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjM2MzYzNjICFpbXBvcnRhbnQ7DQp9DQoubmRjc0JmLmNqenBrYy1XdmQ5Q2Mgew0KICAgIGJvcmRlci1jb2xvcjogIzVjNWM1YzsNCn0NCi5ZNUZZSmUuUkRQWkUgew0KICAgIGZpbGw6ICNjY2M7DQogICAgY29sb3I6ICNjY2M7DQp9DQouT1o2VzBkOm5vdCguUkRQWkUpLCAubDNGMXllOm5vdCguUkRQWkUpIC5UcFFtOWQsIC53d25NdGI6bm90KC5SRFBaRSkgew0KICAgIGZpbGw6ICNmZmYgIWltcG9ydGFudDsNCiAgICBjb2xvcjogI2ZmZiAhaW1wb3J0YW50Ow0KfQ0KLlpvVDFEOmhvdmVyLmlkdHA0ZSwgLnRVSktHZDpub3QoLnhwMmRKKTpub3QoLnJaWHl5KTpob3ZlciAuaWR0cDRlLCAudFVKS0dkOm5vdCgueHAyZEopLm5kY3NCZiAuaWR0cDRlLCAuVjhhcHYsIC5QM1cwRGQtWXNsN0ZlOmZvY3VzIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNGM0YzRjICFpbXBvcnRhbnQ7DQp9DQouTmlhY2hlLCAuUVREMnVmIHsNCiAgICBib3JkZXItY29sb3I6ICMzYzNjM2MgIWltcG9ydGFudDsNCn0NCi5VSVNZOGQtWXNsN0ZlOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjM2MzYzNjICFpbXBvcnRhbnQ7DQogICAgY29sb3I6ICNjY2M7DQp9DQouZXVtWHpmOmFmdGVyIHsNCiAgICBib3JkZXItY29sb3I6ICNmZmYgIWltcG9ydGFudDsNCn0NCi50VUpLR2Q6bm90KDpmaXJzdC1jaGlsZCksIC55U2p1dmQgLmVxcXJPLCAuczJnM1hkLCAub2xlVjhkLCAuWk5FNHksIC5QZUdIZ2IuUThVOHVjIC5Pbm84NWMrLm9oOUNGYiwgLk85WXBIYiwgLnU3M0FwYywgLmQ2Q1dUZCB7DQogICAgYm9yZGVyLWNvbG9yOiAjNGM0YzRjICFpbXBvcnRhbnQ7DQp9DQoubFh1eFkgew0KICAgIC13ZWJraXQtYm94LXNoYWRvdzogMCAwIDhweCAwIHJnYmEoMCwgMCwgMCwgMC43NSk7DQogICAgLW1vei1ib3gtc2hhZG93OiAwIDAgOHB4IDAgcmdiYSgwLCAwLCAwLCAwLjc1KTsNCiAgICBib3gtc2hhZG93OiAwIDAgOHB4IDAgcmdiYSgwLCAwLCAwLCAwLjc1KQ0KfQ0KLkJFQUdTLCAuUDAyRFliLCAueWNibTFkIHsNCiAgICBib3JkZXItY29sb3I6ICM0YzRjNGMgIWltcG9ydGFudDsNCn0NCi5ZNXNFOGQ6bm90KC5SRFBaRSkgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMyYzJjMmMgIWltcG9ydGFudDsNCn0NCi5ZNXNFOGQ6bm90KC5SRFBaRSk6aG92ZXIgew0KICAgIGJveC1zaGFkb3c6IG5vbmUgIWltcG9ydGFudDsNCn0NCi5rc2FPdGQgew0KICAgIGNvbG9yOiAjMWU4ZTNlOw0KfQ0KLnVPMzJhYyB7DQogICAgYm9yZGVyLWNvbG9yOiAjNWM1YzVjICFpbXBvcnRhbnQ7DQp9DQoudVEzRVNkIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjM2MzYzNjICFpbXBvcnRhbnQ7DQp9DQoNCi8qIGRpYWxvZyAqLw0KLmlwaC1kaWFsb2cgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICM0YzRjNGMgIWltcG9ydGFudDsNCn0NCi5pcGgtZGlhbG9nLXRpdGxlLCAuaXBoLWRpYWxvZy1jb250ZW50IHsNCiAgICBjb2xvcjogI2ZmZiAhaW1wb3J0YW50Ow0KfQ0KDQovKiBqb2luIGNsYXNzcm9vbSAqLw0KLmdLa1pDZSwgLkQzb0JFZSAubjlJUzE6YmVmb3JlLCAuQWVBQWtmIHsNCiAgICBib3JkZXItY29sb3I6ICM0YzRjNGM7DQp9DQouRDNvQkVlIC5xVHM1WGMgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMzYzNjM2M7DQp9DQoucVRzNVhjLCAucG9GV05lIHsNCiAgICBjb2xvcjogI2ZmZjsNCn0NCi5JN09YZ2YuWkVlSHJkLCAuTlo5d2RjLCAuaTVzZWhlLCAua294NDJjIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmMyYzJjICFpbXBvcnRhbnQ7DQp9YDsNCiAgICB2YXIgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7DQogICAgZWxlbS5pbm5lclRleHQgPSBzdHlsZTsNCiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGVsZW0pOw0KfSkoKTs="},{"name":"Anti-adblocker","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":["http*://*deviantart.com/*","http*://*.deviantart.com/*"],"orig_matches":["https://openuserjs.org/?q=anti-adblock"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685022468929,"data":{}},"enabled":true,"position":11,"file_url":"https://openuserjs.org/src/scripts/Goodgy/Anti-adblocker.user.js","uuid":"b748c731-663f-4b6d-a748-85fbfc44e535","source":"Ly8gPT1Vc2VyU2NyaXB0PT0NCi8vIEBuYW1lICAgICAgICAgQW50aS1hZGJsb2NrZXINCi8vIEBuYW1lc3BhY2UgaHR0cHM6Ly9vcGVudXNlcmpzLm9yZy91c2Vycy9Hb29kZ3kNCi8vIEB1cGRhdGVVUkwgaHR0cHM6Ly9vcGVudXNlcmpzLm9yZy9tZXRhL0dvb2RneS9BbnRpLWFkYmxvY2tlci5tZXRhLmpzDQovLyBAZG93bmxvYWRVUkwgaHR0cHM6Ly9vcGVudXNlcmpzLm9yZy9zcmMvc2NyaXB0cy9Hb29kZ3kvQW50aS1hZGJsb2NrZXIudXNlci5qcw0KLy8gQHZlcnNpb24gICAgICAxLjENCi8vIEBkZXNjcmlwdGlvbiAgUmVtb3ZlcyBhbnkgbm90aWZpY2F0aW9uIHRoYXQgdGVsbHMgeW91IHRvIGRpc2FibGUgYWRibG9jay4NCi8vIEBhdXRob3IgICAgICAgR29vZGd5DQovLyBAcmVxdWlyZSAgICAgIGh0dHBzOi8vY29kZS5qcXVlcnkuY29tL2pxdWVyeS0zLjEuMC5taW4uanMNCi8vIEBpbmNsdWRlICAgICAgaHR0cCo6Ly8qZGV2aWFudGFydC5jb20vKg0KLy8gQGluY2x1ZGUgICAgICBodHRwKjovLyouZGV2aWFudGFydC5jb20vKg0KLy8gQG1hdGNoICAgICAgICBodHRwczovL29wZW51c2VyanMub3JnLz9xPWFudGktYWRibG9jaw0KLy8gQGdyYW50ICAgICAgICBub25lDQovLyA9PS9Vc2VyU2NyaXB0PT0NCg0KKGZ1bmN0aW9uKCkgew0KICAgICd1c2Ugc3RyaWN0JzsNCg0KDQogICAgZnVuY3Rpb24gcmVtb3ZlX2Jhbm5lcl9kZXZpYW50YXJ0KCl7DQogICAgICAgICQoJ2Rpdi5iYW5uZXItd3JhcCcpLmhpZGUoKTsNCiAgICAgICAgJCgnZGl2I2Jsb2NrLW5vdGljZScpLmhpZGUoKTsNCiAgICAgICAgJCgnZGl2I2Vsbmluby1tb2RhbCcpLmhpZGUoKTsNCiAgICAgICAgJCgnZGl2I21vZGFsZmFkZScpLmhpZGUoKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzdGFydF91cCgpew0KICAgICAgICB2YXIgY3VycmVudF9saW5rID0gJChkb2N1bWVudCkuYXR0cignVVJMJyk7DQoNCiAgICAgICAgaWYgKGN1cnJlbnRfbGluay5pbmRleE9mKCJkZXZpYW50YXJ0LmNvbSIpICE9LTEpIHsNCiAgICAgICAgICAgIHNldEludGVydmFsKHJlbW92ZV9iYW5uZXJfZGV2aWFudGFydCwxKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnNvbGUubG9nKCJEb25lIik7DQogICAgfQ0KDQogICAgLy8gSWYgdGhlIHdpbmRvdyBpcyBsb2FkZWQsIHN0YXJ0IHVwIHRoZSBib3QNCiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHsNCiAgICAgICAgc3RhcnRfdXAoKTsNCiAgICB9KTsNCn0pKCk7","requires":[{"meta":{"name":"jquery-3.1.0.min.js","url":"https://code.jquery.com/jquery-3.1.0.min.js","ts":1685022469409,"mimetype":"text/javascript"},"source":"LyohIGpRdWVyeSB2My4xLjAgfCAoYykgalF1ZXJ5IEZvdW5kYXRpb24gfCBqcXVlcnkub3JnL2xpY2Vuc2UgKi8KIWZ1bmN0aW9uKGEsYil7InVzZSBzdHJpY3QiOyJvYmplY3QiPT10eXBlb2YgbW9kdWxlJiYib2JqZWN0Ij09dHlwZW9mIG1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWEuZG9jdW1lbnQ/YihhLCEwKTpmdW5jdGlvbihhKXtpZighYS5kb2N1bWVudCl0aHJvdyBuZXcgRXJyb3IoImpRdWVyeSByZXF1aXJlcyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnQiKTtyZXR1cm4gYihhKX06YihhKX0oInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OnRoaXMsZnVuY3Rpb24oYSxiKXsidXNlIHN0cmljdCI7dmFyIGM9W10sZD1hLmRvY3VtZW50LGU9T2JqZWN0LmdldFByb3RvdHlwZU9mLGY9Yy5zbGljZSxnPWMuY29uY2F0LGg9Yy5wdXNoLGk9Yy5pbmRleE9mLGo9e30saz1qLnRvU3RyaW5nLGw9ai5oYXNPd25Qcm9wZXJ0eSxtPWwudG9TdHJpbmcsbj1tLmNhbGwoT2JqZWN0KSxvPXt9O2Z1bmN0aW9uIHAoYSxiKXtiPWJ8fGQ7dmFyIGM9Yi5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTtjLnRleHQ9YSxiLmhlYWQuYXBwZW5kQ2hpbGQoYykucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjKX12YXIgcT0iMy4xLjAiLHI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHIuZm4uaW5pdChhLGIpfSxzPS9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZyx0PS9eLW1zLS8sdT0vLShbYS16XSkvZyx2PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIudG9VcHBlckNhc2UoKX07ci5mbj1yLnByb3RvdHlwZT17anF1ZXJ5OnEsY29uc3RydWN0b3I6cixsZW5ndGg6MCx0b0FycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIGYuY2FsbCh0aGlzKX0sZ2V0OmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1hP2E8MD90aGlzW2ErdGhpcy5sZW5ndGhdOnRoaXNbYV06Zi5jYWxsKHRoaXMpfSxwdXNoU3RhY2s6ZnVuY3Rpb24oYSl7dmFyIGI9ci5tZXJnZSh0aGlzLmNvbnN0cnVjdG9yKCksYSk7cmV0dXJuIGIucHJldk9iamVjdD10aGlzLGJ9LGVhY2g6ZnVuY3Rpb24oYSl7cmV0dXJuIHIuZWFjaCh0aGlzLGEpfSxtYXA6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHIubWFwKHRoaXMsZnVuY3Rpb24oYixjKXtyZXR1cm4gYS5jYWxsKGIsYyxiKX0pKX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soZi5hcHBseSh0aGlzLGFyZ3VtZW50cykpfSxmaXJzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKDApfSxsYXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoLTEpfSxlcTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmxlbmd0aCxjPSthKyhhPDA/YjowKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soYz49MCYmYzxiP1t0aGlzW2NdXTpbXSl9LGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByZXZPYmplY3R8fHRoaXMuY29uc3RydWN0b3IoKX0scHVzaDpoLHNvcnQ6Yy5zb3J0LHNwbGljZTpjLnNwbGljZX0sci5leHRlbmQ9ci5mbi5leHRlbmQ9ZnVuY3Rpb24oKXt2YXIgYSxiLGMsZCxlLGYsZz1hcmd1bWVudHNbMF18fHt9LGg9MSxpPWFyZ3VtZW50cy5sZW5ndGgsaj0hMTtmb3IoImJvb2xlYW4iPT10eXBlb2YgZyYmKGo9ZyxnPWFyZ3VtZW50c1toXXx8e30saCsrKSwib2JqZWN0Ij09dHlwZW9mIGd8fHIuaXNGdW5jdGlvbihnKXx8KGc9e30pLGg9PT1pJiYoZz10aGlzLGgtLSk7aDxpO2grKylpZihudWxsIT0oYT1hcmd1bWVudHNbaF0pKWZvcihiIGluIGEpYz1nW2JdLGQ9YVtiXSxnIT09ZCYmKGomJmQmJihyLmlzUGxhaW5PYmplY3QoZCl8fChlPXIuaXNBcnJheShkKSkpPyhlPyhlPSExLGY9YyYmci5pc0FycmF5KGMpP2M6W10pOmY9YyYmci5pc1BsYWluT2JqZWN0KGMpP2M6e30sZ1tiXT1yLmV4dGVuZChqLGYsZCkpOnZvaWQgMCE9PWQmJihnW2JdPWQpKTtyZXR1cm4gZ30sci5leHRlbmQoe2V4cGFuZG86ImpRdWVyeSIrKHErTWF0aC5yYW5kb20oKSkucmVwbGFjZSgvXEQvZywiIiksaXNSZWFkeTohMCxlcnJvcjpmdW5jdGlvbihhKXt0aHJvdyBuZXcgRXJyb3IoYSl9LG5vb3A6ZnVuY3Rpb24oKXt9LGlzRnVuY3Rpb246ZnVuY3Rpb24oYSl7cmV0dXJuImZ1bmN0aW9uIj09PXIudHlwZShhKX0saXNBcnJheTpBcnJheS5pc0FycmF5LGlzV2luZG93OmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1hJiZhPT09YS53aW5kb3d9LGlzTnVtZXJpYzpmdW5jdGlvbihhKXt2YXIgYj1yLnR5cGUoYSk7cmV0dXJuKCJudW1iZXIiPT09Ynx8InN0cmluZyI9PT1iKSYmIWlzTmFOKGEtcGFyc2VGbG9hdChhKSl9LGlzUGxhaW5PYmplY3Q6ZnVuY3Rpb24oYSl7dmFyIGIsYztyZXR1cm4hKCFhfHwiW29iamVjdCBPYmplY3RdIiE9PWsuY2FsbChhKSkmJighKGI9ZShhKSl8fChjPWwuY2FsbChiLCJjb25zdHJ1Y3RvciIpJiZiLmNvbnN0cnVjdG9yLCJmdW5jdGlvbiI9PXR5cGVvZiBjJiZtLmNhbGwoYyk9PT1uKSl9LGlzRW1wdHlPYmplY3Q6ZnVuY3Rpb24oYSl7dmFyIGI7Zm9yKGIgaW4gYSlyZXR1cm4hMTtyZXR1cm4hMH0sdHlwZTpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09YT9hKyIiOiJvYmplY3QiPT10eXBlb2YgYXx8ImZ1bmN0aW9uIj09dHlwZW9mIGE/altrLmNhbGwoYSldfHwib2JqZWN0Ijp0eXBlb2YgYX0sZ2xvYmFsRXZhbDpmdW5jdGlvbihhKXtwKGEpfSxjYW1lbENhc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZSh0LCJtcy0iKS5yZXBsYWNlKHUsdil9LG5vZGVOYW1lOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWIudG9Mb3dlckNhc2UoKX0sZWFjaDpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MDtpZih3KGEpKXtmb3IoYz1hLmxlbmd0aDtkPGM7ZCsrKWlmKGIuY2FsbChhW2RdLGQsYVtkXSk9PT0hMSlicmVha31lbHNlIGZvcihkIGluIGEpaWYoYi5jYWxsKGFbZF0sZCxhW2RdKT09PSExKWJyZWFrO3JldHVybiBhfSx0cmltOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hPyIiOihhKyIiKS5yZXBsYWNlKHMsIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1ifHxbXTtyZXR1cm4gbnVsbCE9YSYmKHcoT2JqZWN0KGEpKT9yLm1lcmdlKGMsInN0cmluZyI9PXR5cGVvZiBhP1thXTphKTpoLmNhbGwoYyxhKSksY30saW5BcnJheTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGw9PWI/LTE6aS5jYWxsKGIsYSxjKX0sbWVyZ2U6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9K2IubGVuZ3RoLGQ9MCxlPWEubGVuZ3RoO2Q8YztkKyspYVtlKytdPWJbZF07cmV0dXJuIGEubGVuZ3RoPWUsYX0sZ3JlcDpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkLGU9W10sZj0wLGc9YS5sZW5ndGgsaD0hYztmPGc7ZisrKWQ9IWIoYVtmXSxmKSxkIT09aCYmZS5wdXNoKGFbZl0pO3JldHVybiBlfSxtYXA6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj0wLGg9W107aWYodyhhKSlmb3IoZD1hLmxlbmd0aDtmPGQ7ZisrKWU9YihhW2ZdLGYsYyksbnVsbCE9ZSYmaC5wdXNoKGUpO2Vsc2UgZm9yKGYgaW4gYSllPWIoYVtmXSxmLGMpLG51bGwhPWUmJmgucHVzaChlKTtyZXR1cm4gZy5hcHBseShbXSxoKX0sZ3VpZDoxLHByb3h5OmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlO2lmKCJzdHJpbmciPT10eXBlb2YgYiYmKGM9YVtiXSxiPWEsYT1jKSxyLmlzRnVuY3Rpb24oYSkpcmV0dXJuIGQ9Zi5jYWxsKGFyZ3VtZW50cywyKSxlPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYnx8dGhpcyxkLmNvbmNhdChmLmNhbGwoYXJndW1lbnRzKSkpfSxlLmd1aWQ9YS5ndWlkPWEuZ3VpZHx8ci5ndWlkKyssZX0sbm93OkRhdGUubm93LHN1cHBvcnQ6b30pLCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihyLmZuW1N5bWJvbC5pdGVyYXRvcl09Y1tTeW1ib2wuaXRlcmF0b3JdKSxyLmVhY2goIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3IgU3ltYm9sIi5zcGxpdCgiICIpLGZ1bmN0aW9uKGEsYil7alsiW29iamVjdCAiK2IrIl0iXT1iLnRvTG93ZXJDYXNlKCl9KTtmdW5jdGlvbiB3KGEpe3ZhciBiPSEhYSYmImxlbmd0aCJpbiBhJiZhLmxlbmd0aCxjPXIudHlwZShhKTtyZXR1cm4iZnVuY3Rpb24iIT09YyYmIXIuaXNXaW5kb3coYSkmJigiYXJyYXkiPT09Y3x8MD09PWJ8fCJudW1iZXIiPT10eXBlb2YgYiYmYj4wJiZiLTEgaW4gYSl9dmFyIHg9ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGgsaSxqLGssbCxtLG4sbyxwLHEscixzLHQsdT0ic2l6emxlIisxKm5ldyBEYXRlLHY9YS5kb2N1bWVudCx3PTAseD0wLHk9aGEoKSx6PWhhKCksQT1oYSgpLEI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT09PWImJihsPSEwKSwwfSxDPXt9Lmhhc093blByb3BlcnR5LEQ9W10sRT1ELnBvcCxGPUQucHVzaCxHPUQucHVzaCxIPUQuc2xpY2UsST1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKylpZihhW2NdPT09YilyZXR1cm4gYztyZXR1cm4tMX0sSj0iY2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWQiLEs9IltcXHgyMFxcdFxcclxcblxcZl0iLEw9Iig/OlxcXFwufFtcXHctXXxbXlwwLVxceGEwXSkrIixNPSJcXFsiK0srIiooIitMKyIpKD86IitLKyIqKFsqXiR8IX5dPz0pIitLKyIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIrTCsiKSl8KSIrSysiKlxcXSIsTj0iOigiK0wrIikoPzpcXCgoKCcoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwiKXwoKD86XFxcXC58W15cXFxcKClbXFxdXXwiK00rIikqKXwuKilcXCl8KSIsTz1uZXcgUmVnRXhwKEsrIisiLCJnIiksUD1uZXcgUmVnRXhwKCJeIitLKyIrfCgoPzpefFteXFxcXF0pKD86XFxcXC4pKikiK0srIiskIiwiZyIpLFE9bmV3IFJlZ0V4cCgiXiIrSysiKiwiK0srIioiKSxSPW5ldyBSZWdFeHAoIl4iK0srIiooWz4rfl18IitLKyIpIitLKyIqIiksUz1uZXcgUmVnRXhwKCI9IitLKyIqKFteXFxdJ1wiXSo/KSIrSysiKlxcXSIsImciKSxUPW5ldyBSZWdFeHAoTiksVT1uZXcgUmVnRXhwKCJeIitMKyIkIiksVj17SUQ6bmV3IFJlZ0V4cCgiXiMoIitMKyIpIiksQ0xBU1M6bmV3IFJlZ0V4cCgiXlxcLigiK0wrIikiKSxUQUc6bmV3IFJlZ0V4cCgiXigiK0wrInxbKl0pIiksQVRUUjpuZXcgUmVnRXhwKCJeIitNKSxQU0VVRE86bmV3IFJlZ0V4cCgiXiIrTiksQ0hJTEQ6bmV3IFJlZ0V4cCgiXjoob25seXxmaXJzdHxsYXN0fG50aHxudGgtbGFzdCktKGNoaWxkfG9mLXR5cGUpKD86XFwoIitLKyIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIitLKyIqKD86KFsrLV18KSIrSysiKihcXGQrKXwpKSIrSysiKlxcKXwpIiwiaSIpLGJvb2w6bmV3IFJlZ0V4cCgiXig/OiIrSisiKSQiLCJpIiksbmVlZHNDb250ZXh0Om5ldyBSZWdFeHAoIl4iK0srIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIrSysiKigoPzotXFxkKT9cXGQqKSIrSysiKlxcKXwpKD89W14tXXwkKSIsImkiKX0sVz0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLFg9L15oXGQkL2ksWT0vXltee10rXHtccypcW25hdGl2ZSBcdy8sWj0vXig/OiMoW1x3LV0rKXwoXHcrKXxcLihbXHctXSspKSQvLCQ9L1srfl0vLF89bmV3IFJlZ0V4cCgiXFxcXChbXFxkYS1mXXsxLDZ9IitLKyI/fCgiK0srIil8LikiLCJpZyIpLGFhPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD0iMHgiK2ItNjU1MzY7cmV0dXJuIGQhPT1kfHxjP2I6ZDwwP1N0cmluZy5mcm9tQ2hhckNvZGUoZCs2NTUzNik6U3RyaW5nLmZyb21DaGFyQ29kZShkPj4xMHw1NTI5NiwxMDIzJmR8NTYzMjApfSxiYT0vKFtcMC1ceDFmXHg3Zl18Xi0/XGQpfF4tJHxbXlx4ODAtXHVGRkZGXHctXS9nLGNhPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGI/IlwwIj09PWE/Ilx1ZmZmZCI6YS5zbGljZSgwLC0xKSsiXFwiK2EuY2hhckNvZGVBdChhLmxlbmd0aC0xKS50b1N0cmluZygxNikrIiAiOiJcXCIrYX0sZGE9ZnVuY3Rpb24oKXttKCl9LGVhPXRhKGZ1bmN0aW9uKGEpe3JldHVybiBhLmRpc2FibGVkPT09ITB9LHtkaXI6InBhcmVudE5vZGUiLG5leHQ6ImxlZ2VuZCJ9KTt0cnl7Ry5hcHBseShEPUguY2FsbCh2LmNoaWxkTm9kZXMpLHYuY2hpbGROb2RlcyksRFt2LmNoaWxkTm9kZXMubGVuZ3RoXS5ub2RlVHlwZX1jYXRjaChmYSl7Rz17YXBwbHk6RC5sZW5ndGg/ZnVuY3Rpb24oYSxiKXtGLmFwcGx5KGEsSC5jYWxsKGIpKX06ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmxlbmd0aCxkPTA7d2hpbGUoYVtjKytdPWJbZCsrXSk7YS5sZW5ndGg9Yy0xfX19ZnVuY3Rpb24gZ2EoYSxiLGQsZSl7dmFyIGYsaCxqLGssbCxvLHIscz1iJiZiLm93bmVyRG9jdW1lbnQsdz1iP2Iubm9kZVR5cGU6OTtpZihkPWR8fFtdLCJzdHJpbmciIT10eXBlb2YgYXx8IWF8fDEhPT13JiY5IT09dyYmMTEhPT13KXJldHVybiBkO2lmKCFlJiYoKGI/Yi5vd25lckRvY3VtZW50fHxiOnYpIT09biYmbShiKSxiPWJ8fG4scCkpe2lmKDExIT09dyYmKGw9Wi5leGVjKGEpKSlpZihmPWxbMV0pe2lmKDk9PT13KXtpZighKGo9Yi5nZXRFbGVtZW50QnlJZChmKSkpcmV0dXJuIGQ7aWYoai5pZD09PWYpcmV0dXJuIGQucHVzaChqKSxkfWVsc2UgaWYocyYmKGo9cy5nZXRFbGVtZW50QnlJZChmKSkmJnQoYixqKSYmai5pZD09PWYpcmV0dXJuIGQucHVzaChqKSxkfWVsc2V7aWYobFsyXSlyZXR1cm4gRy5hcHBseShkLGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYSkpLGQ7aWYoKGY9bFszXSkmJmMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmYi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKXJldHVybiBHLmFwcGx5KGQsYi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGYpKSxkfWlmKGMucXNhJiYhQVthKyIgIl0mJighcXx8IXEudGVzdChhKSkpe2lmKDEhPT13KXM9YixyPWE7ZWxzZSBpZigib2JqZWN0IiE9PWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSl7KGs9Yi5nZXRBdHRyaWJ1dGUoImlkIikpP2s9ay5yZXBsYWNlKGJhLGNhKTpiLnNldEF0dHJpYnV0ZSgiaWQiLGs9dSksbz1nKGEpLGg9by5sZW5ndGg7d2hpbGUoaC0tKW9baF09IiMiK2srIiAiK3NhKG9baF0pO3I9by5qb2luKCIsIikscz0kLnRlc3QoYSkmJnFhKGIucGFyZW50Tm9kZSl8fGJ9aWYocil0cnl7cmV0dXJuIEcuYXBwbHkoZCxzLnF1ZXJ5U2VsZWN0b3JBbGwocikpLGR9Y2F0Y2goeCl7fWZpbmFsbHl7az09PXUmJmIucmVtb3ZlQXR0cmlidXRlKCJpZCIpfX19cmV0dXJuIGkoYS5yZXBsYWNlKFAsIiQxIiksYixkLGUpfWZ1bmN0aW9uIGhhKCl7dmFyIGE9W107ZnVuY3Rpb24gYihjLGUpe3JldHVybiBhLnB1c2goYysiICIpPmQuY2FjaGVMZW5ndGgmJmRlbGV0ZSBiW2Euc2hpZnQoKV0sYltjKyIgIl09ZX1yZXR1cm4gYn1mdW5jdGlvbiBpYShhKXtyZXR1cm4gYVt1XT0hMCxhfWZ1bmN0aW9uIGphKGEpe3ZhciBiPW4uY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiKTt0cnl7cmV0dXJuISFhKGIpfWNhdGNoKGMpe3JldHVybiExfWZpbmFsbHl7Yi5wYXJlbnROb2RlJiZiLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYiksYj1udWxsfX1mdW5jdGlvbiBrYShhLGIpe3ZhciBjPWEuc3BsaXQoInwiKSxlPWMubGVuZ3RoO3doaWxlKGUtLSlkLmF0dHJIYW5kbGVbY1tlXV09Yn1mdW5jdGlvbiBsYShhLGIpe3ZhciBjPWImJmEsZD1jJiYxPT09YS5ub2RlVHlwZSYmMT09PWIubm9kZVR5cGUmJmEuc291cmNlSW5kZXgtYi5zb3VyY2VJbmRleDtpZihkKXJldHVybiBkO2lmKGMpd2hpbGUoYz1jLm5leHRTaWJsaW5nKWlmKGM9PT1iKXJldHVybi0xO3JldHVybiBhPzE6LTF9ZnVuY3Rpb24gbWEoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3ZhciBjPWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09YyYmYi50eXBlPT09YX19ZnVuY3Rpb24gbmEoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3ZhciBjPWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4oImlucHV0Ij09PWN8fCJidXR0b24iPT09YykmJmIudHlwZT09PWF9fWZ1bmN0aW9uIG9hKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4ibGFiZWwiaW4gYiYmYi5kaXNhYmxlZD09PWF8fCJmb3JtImluIGImJmIuZGlzYWJsZWQ9PT1hfHwiZm9ybSJpbiBiJiZiLmRpc2FibGVkPT09ITEmJihiLmlzRGlzYWJsZWQ9PT1hfHxiLmlzRGlzYWJsZWQhPT0hYSYmKCJsYWJlbCJpbiBifHwhZWEoYikpIT09YSl9fWZ1bmN0aW9uIHBhKGEpe3JldHVybiBpYShmdW5jdGlvbihiKXtyZXR1cm4gYj0rYixpYShmdW5jdGlvbihjLGQpe3ZhciBlLGY9YShbXSxjLmxlbmd0aCxiKSxnPWYubGVuZ3RoO3doaWxlKGctLSljW2U9ZltnXV0mJihjW2VdPSEoZFtlXT1jW2VdKSl9KX0pfWZ1bmN0aW9uIHFhKGEpe3JldHVybiBhJiYidW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWUmJmF9Yz1nYS5zdXBwb3J0PXt9LGY9Z2EuaXNYTUw9ZnVuY3Rpb24oYSl7dmFyIGI9YSYmKGEub3duZXJEb2N1bWVudHx8YSkuZG9jdW1lbnRFbGVtZW50O3JldHVybiEhYiYmIkhUTUwiIT09Yi5ub2RlTmFtZX0sbT1nYS5zZXREb2N1bWVudD1mdW5jdGlvbihhKXt2YXIgYixlLGc9YT9hLm93bmVyRG9jdW1lbnR8fGE6djtyZXR1cm4gZyE9PW4mJjk9PT1nLm5vZGVUeXBlJiZnLmRvY3VtZW50RWxlbWVudD8obj1nLG89bi5kb2N1bWVudEVsZW1lbnQscD0hZihuKSx2IT09biYmKGU9bi5kZWZhdWx0VmlldykmJmUudG9wIT09ZSYmKGUuYWRkRXZlbnRMaXN0ZW5lcj9lLmFkZEV2ZW50TGlzdGVuZXIoInVubG9hZCIsZGEsITEpOmUuYXR0YWNoRXZlbnQmJmUuYXR0YWNoRXZlbnQoIm9udW5sb2FkIixkYSkpLGMuYXR0cmlidXRlcz1qYShmdW5jdGlvbihhKXtyZXR1cm4gYS5jbGFzc05hbWU9ImkiLCFhLmdldEF0dHJpYnV0ZSgiY2xhc3NOYW1lIil9KSxjLmdldEVsZW1lbnRzQnlUYWdOYW1lPWphKGZ1bmN0aW9uKGEpe3JldHVybiBhLmFwcGVuZENoaWxkKG4uY3JlYXRlQ29tbWVudCgiIikpLCFhLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RofSksYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lPVkudGVzdChuLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpLGMuZ2V0QnlJZD1qYShmdW5jdGlvbihhKXtyZXR1cm4gby5hcHBlbmRDaGlsZChhKS5pZD11LCFuLmdldEVsZW1lbnRzQnlOYW1lfHwhbi5nZXRFbGVtZW50c0J5TmFtZSh1KS5sZW5ndGh9KSxjLmdldEJ5SWQ/KGQuZmluZC5JRD1mdW5jdGlvbihhLGIpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgYi5nZXRFbGVtZW50QnlJZCYmcCl7dmFyIGM9Yi5nZXRFbGVtZW50QnlJZChhKTtyZXR1cm4gYz9bY106W119fSxkLmZpbHRlci5JRD1mdW5jdGlvbihhKXt2YXIgYj1hLnJlcGxhY2UoXyxhYSk7cmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybiBhLmdldEF0dHJpYnV0ZSgiaWQiKT09PWJ9fSk6KGRlbGV0ZSBkLmZpbmQuSUQsZC5maWx0ZXIuSUQ9ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXBsYWNlKF8sYWEpO3JldHVybiBmdW5jdGlvbihhKXt2YXIgYz0idW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0QXR0cmlidXRlTm9kZSYmYS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpO3JldHVybiBjJiZjLnZhbHVlPT09Yn19KSxkLmZpbmQuVEFHPWMuZ2V0RWxlbWVudHNCeVRhZ05hbWU/ZnVuY3Rpb24oYSxiKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIGIuZ2V0RWxlbWVudHNCeVRhZ05hbWU/Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKTpjLnFzYT9iLnF1ZXJ5U2VsZWN0b3JBbGwoYSk6dm9pZCAwfTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9W10sZT0wLGY9Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKTtpZigiKiI9PT1hKXt3aGlsZShjPWZbZSsrXSkxPT09Yy5ub2RlVHlwZSYmZC5wdXNoKGMpO3JldHVybiBkfXJldHVybiBmfSxkLmZpbmQuQ0xBU1M9Yy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZmdW5jdGlvbihhLGIpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgYi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZwKXJldHVybiBiLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYSl9LHI9W10scT1bXSwoYy5xc2E9WS50ZXN0KG4ucXVlcnlTZWxlY3RvckFsbCkpJiYoamEoZnVuY3Rpb24oYSl7by5hcHBlbmRDaGlsZChhKS5pbm5lckhUTUw9IjxhIGlkPSciK3UrIic+PC9hPjxzZWxlY3QgaWQ9JyIrdSsiLVxyXFwnIG1zYWxsb3djYXB0dXJlPScnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IixhLnF1ZXJ5U2VsZWN0b3JBbGwoIlttc2FsbG93Y2FwdHVyZV49JyddIikubGVuZ3RoJiZxLnB1c2goIlsqXiRdPSIrSysiKig/OicnfFwiXCIpIiksYS5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RofHxxLnB1c2goIlxcWyIrSysiKig/OnZhbHVlfCIrSisiKSIpLGEucXVlcnlTZWxlY3RvckFsbCgiW2lkfj0iK3UrIi1dIikubGVuZ3RofHxxLnB1c2goIn49IiksYS5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aHx8cS5wdXNoKCI6Y2hlY2tlZCIpLGEucXVlcnlTZWxlY3RvckFsbCgiYSMiK3UrIisqIikubGVuZ3RofHxxLnB1c2goIi4jLitbK35dIil9KSxqYShmdW5jdGlvbihhKXthLmlubmVySFRNTD0iPGEgaHJlZj0nJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjwvYT48c2VsZWN0IGRpc2FibGVkPSdkaXNhYmxlZCc+PG9wdGlvbi8+PC9zZWxlY3Q+Ijt2YXIgYj1uLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7Yi5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKSxhLmFwcGVuZENoaWxkKGIpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPWRdIikubGVuZ3RoJiZxLnB1c2goIm5hbWUiK0srIipbKl4kfCF+XT89IiksMiE9PWEucXVlcnlTZWxlY3RvckFsbCgiOmVuYWJsZWQiKS5sZW5ndGgmJnEucHVzaCgiOmVuYWJsZWQiLCI6ZGlzYWJsZWQiKSxvLmFwcGVuZENoaWxkKGEpLmRpc2FibGVkPSEwLDIhPT1hLnF1ZXJ5U2VsZWN0b3JBbGwoIjpkaXNhYmxlZCIpLmxlbmd0aCYmcS5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLGEucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpLHEucHVzaCgiLC4qOiIpfSkpLChjLm1hdGNoZXNTZWxlY3Rvcj1ZLnRlc3Qocz1vLm1hdGNoZXN8fG8ud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxvLm1vek1hdGNoZXNTZWxlY3Rvcnx8by5vTWF0Y2hlc1NlbGVjdG9yfHxvLm1zTWF0Y2hlc1NlbGVjdG9yKSkmJmphKGZ1bmN0aW9uKGEpe2MuZGlzY29ubmVjdGVkTWF0Y2g9cy5jYWxsKGEsIioiKSxzLmNhbGwoYSwiW3MhPScnXTp4Iiksci5wdXNoKCIhPSIsTil9KSxxPXEubGVuZ3RoJiZuZXcgUmVnRXhwKHEuam9pbigifCIpKSxyPXIubGVuZ3RoJiZuZXcgUmVnRXhwKHIuam9pbigifCIpKSxiPVkudGVzdChvLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKSx0PWJ8fFkudGVzdChvLmNvbnRhaW5zKT9mdW5jdGlvbihhLGIpe3ZhciBjPTk9PT1hLm5vZGVUeXBlP2EuZG9jdW1lbnRFbGVtZW50OmEsZD1iJiZiLnBhcmVudE5vZGU7cmV0dXJuIGE9PT1kfHwhKCFkfHwxIT09ZC5ub2RlVHlwZXx8IShjLmNvbnRhaW5zP2MuY29udGFpbnMoZCk6YS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiYmMTYmYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihkKSkpfTpmdW5jdGlvbihhLGIpe2lmKGIpd2hpbGUoYj1iLnBhcmVudE5vZGUpaWYoYj09PWEpcmV0dXJuITA7cmV0dXJuITF9LEI9Yj9mdW5jdGlvbihhLGIpe2lmKGE9PT1iKXJldHVybiBsPSEwLDA7dmFyIGQ9IWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24tIWIuY29tcGFyZURvY3VtZW50UG9zaXRpb247cmV0dXJuIGQ/ZDooZD0oYS5vd25lckRvY3VtZW50fHxhKT09PShiLm93bmVyRG9jdW1lbnR8fGIpP2EuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYik6MSwxJmR8fCFjLnNvcnREZXRhY2hlZCYmYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihhKT09PWQ/YT09PW58fGEub3duZXJEb2N1bWVudD09PXYmJnQodixhKT8tMTpiPT09bnx8Yi5vd25lckRvY3VtZW50PT09diYmdCh2LGIpPzE6az9JKGssYSktSShrLGIpOjA6NCZkPy0xOjEpfTpmdW5jdGlvbihhLGIpe2lmKGE9PT1iKXJldHVybiBsPSEwLDA7dmFyIGMsZD0wLGU9YS5wYXJlbnROb2RlLGY9Yi5wYXJlbnROb2RlLGc9W2FdLGg9W2JdO2lmKCFlfHwhZilyZXR1cm4gYT09PW4/LTE6Yj09PW4/MTplPy0xOmY/MTprP0koayxhKS1JKGssYik6MDtpZihlPT09ZilyZXR1cm4gbGEoYSxiKTtjPWE7d2hpbGUoYz1jLnBhcmVudE5vZGUpZy51bnNoaWZ0KGMpO2M9Yjt3aGlsZShjPWMucGFyZW50Tm9kZSloLnVuc2hpZnQoYyk7d2hpbGUoZ1tkXT09PWhbZF0pZCsrO3JldHVybiBkP2xhKGdbZF0saFtkXSk6Z1tkXT09PXY/LTE6aFtkXT09PXY/MTowfSxuKTpufSxnYS5tYXRjaGVzPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGdhKGEsbnVsbCxudWxsLGIpfSxnYS5tYXRjaGVzU2VsZWN0b3I9ZnVuY3Rpb24oYSxiKXtpZigoYS5vd25lckRvY3VtZW50fHxhKSE9PW4mJm0oYSksYj1iLnJlcGxhY2UoUywiPSckMSddIiksYy5tYXRjaGVzU2VsZWN0b3ImJnAmJiFBW2IrIiAiXSYmKCFyfHwhci50ZXN0KGIpKSYmKCFxfHwhcS50ZXN0KGIpKSl0cnl7dmFyIGQ9cy5jYWxsKGEsYik7aWYoZHx8Yy5kaXNjb25uZWN0ZWRNYXRjaHx8YS5kb2N1bWVudCYmMTEhPT1hLmRvY3VtZW50Lm5vZGVUeXBlKXJldHVybiBkfWNhdGNoKGUpe31yZXR1cm4gZ2EoYixuLG51bGwsW2FdKS5sZW5ndGg+MH0sZ2EuY29udGFpbnM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4oYS5vd25lckRvY3VtZW50fHxhKSE9PW4mJm0oYSksdChhLGIpfSxnYS5hdHRyPWZ1bmN0aW9uKGEsYil7KGEub3duZXJEb2N1bWVudHx8YSkhPT1uJiZtKGEpO3ZhciBlPWQuYXR0ckhhbmRsZVtiLnRvTG93ZXJDYXNlKCldLGY9ZSYmQy5jYWxsKGQuYXR0ckhhbmRsZSxiLnRvTG93ZXJDYXNlKCkpP2UoYSxiLCFwKTp2b2lkIDA7cmV0dXJuIHZvaWQgMCE9PWY/ZjpjLmF0dHJpYnV0ZXN8fCFwP2EuZ2V0QXR0cmlidXRlKGIpOihmPWEuZ2V0QXR0cmlidXRlTm9kZShiKSkmJmYuc3BlY2lmaWVkP2YudmFsdWU6bnVsbH0sZ2EuZXNjYXBlPWZ1bmN0aW9uKGEpe3JldHVybihhKyIiKS5yZXBsYWNlKGJhLGNhKX0sZ2EuZXJyb3I9ZnVuY3Rpb24oYSl7dGhyb3cgbmV3IEVycm9yKCJTeW50YXggZXJyb3IsIHVucmVjb2duaXplZCBleHByZXNzaW9uOiAiK2EpfSxnYS51bmlxdWVTb3J0PWZ1bmN0aW9uKGEpe3ZhciBiLGQ9W10sZT0wLGY9MDtpZihsPSFjLmRldGVjdER1cGxpY2F0ZXMsaz0hYy5zb3J0U3RhYmxlJiZhLnNsaWNlKDApLGEuc29ydChCKSxsKXt3aGlsZShiPWFbZisrXSliPT09YVtmXSYmKGU9ZC5wdXNoKGYpKTt3aGlsZShlLS0pYS5zcGxpY2UoZFtlXSwxKX1yZXR1cm4gaz1udWxsLGF9LGU9Z2EuZ2V0VGV4dD1mdW5jdGlvbihhKXt2YXIgYixjPSIiLGQ9MCxmPWEubm9kZVR5cGU7aWYoZil7aWYoMT09PWZ8fDk9PT1mfHwxMT09PWYpe2lmKCJzdHJpbmciPT10eXBlb2YgYS50ZXh0Q29udGVudClyZXR1cm4gYS50ZXh0Q29udGVudDtmb3IoYT1hLmZpcnN0Q2hpbGQ7YTthPWEubmV4dFNpYmxpbmcpYys9ZShhKX1lbHNlIGlmKDM9PT1mfHw0PT09ZilyZXR1cm4gYS5ub2RlVmFsdWV9ZWxzZSB3aGlsZShiPWFbZCsrXSljKz1lKGIpO3JldHVybiBjfSxkPWdhLnNlbGVjdG9ycz17Y2FjaGVMZW5ndGg6NTAsY3JlYXRlUHNldWRvOmlhLG1hdGNoOlYsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6ITB9LCIgIjp7ZGlyOiJwYXJlbnROb2RlIn0sIisiOntkaXI6InByZXZpb3VzU2libGluZyIsZmlyc3Q6ITB9LCJ+Ijp7ZGlyOiJwcmV2aW91c1NpYmxpbmcifX0scHJlRmlsdGVyOntBVFRSOmZ1bmN0aW9uKGEpe3JldHVybiBhWzFdPWFbMV0ucmVwbGFjZShfLGFhKSxhWzNdPShhWzNdfHxhWzRdfHxhWzVdfHwiIikucmVwbGFjZShfLGFhKSwifj0iPT09YVsyXSYmKGFbM109IiAiK2FbM10rIiAiKSxhLnNsaWNlKDAsNCl9LENISUxEOmZ1bmN0aW9uKGEpe3JldHVybiBhWzFdPWFbMV0udG9Mb3dlckNhc2UoKSwibnRoIj09PWFbMV0uc2xpY2UoMCwzKT8oYVszXXx8Z2EuZXJyb3IoYVswXSksYVs0XT0rKGFbNF0/YVs1XSsoYVs2XXx8MSk6MiooImV2ZW4iPT09YVszXXx8Im9kZCI9PT1hWzNdKSksYVs1XT0rKGFbN10rYVs4XXx8Im9kZCI9PT1hWzNdKSk6YVszXSYmZ2EuZXJyb3IoYVswXSksYX0sUFNFVURPOmZ1bmN0aW9uKGEpe3ZhciBiLGM9IWFbNl0mJmFbMl07cmV0dXJuIFYuQ0hJTEQudGVzdChhWzBdKT9udWxsOihhWzNdP2FbMl09YVs0XXx8YVs1XXx8IiI6YyYmVC50ZXN0KGMpJiYoYj1nKGMsITApKSYmKGI9Yy5pbmRleE9mKCIpIixjLmxlbmd0aC1iKS1jLmxlbmd0aCkmJihhWzBdPWFbMF0uc2xpY2UoMCxiKSxhWzJdPWMuc2xpY2UoMCxiKSksYS5zbGljZSgwLDMpKX19LGZpbHRlcjp7VEFHOmZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShfLGFhKS50b0xvd2VyQ2FzZSgpO3JldHVybiIqIj09PWE/ZnVuY3Rpb24oKXtyZXR1cm4hMH06ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWJ9fSxDTEFTUzpmdW5jdGlvbihhKXt2YXIgYj15W2ErIiAiXTtyZXR1cm4gYnx8KGI9bmV3IFJlZ0V4cCgiKF58IitLKyIpIithKyIoIitLKyJ8JCkiKSkmJnkoYSxmdW5jdGlvbihhKXtyZXR1cm4gYi50ZXN0KCJzdHJpbmciPT10eXBlb2YgYS5jbGFzc05hbWUmJmEuY2xhc3NOYW1lfHwidW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0QXR0cmlidXRlJiZhLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIpfSl9LEFUVFI6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmdW5jdGlvbihkKXt2YXIgZT1nYS5hdHRyKGQsYSk7cmV0dXJuIG51bGw9PWU/IiE9Ij09PWI6IWJ8fChlKz0iIiwiPSI9PT1iP2U9PT1jOiIhPSI9PT1iP2UhPT1jOiJePSI9PT1iP2MmJjA9PT1lLmluZGV4T2YoYyk6Iio9Ij09PWI/YyYmZS5pbmRleE9mKGMpPi0xOiIkPSI9PT1iP2MmJmUuc2xpY2UoLWMubGVuZ3RoKT09PWM6In49Ij09PWI/KCIgIitlLnJlcGxhY2UoTywiICIpKyIgIikuaW5kZXhPZihjKT4tMToifD0iPT09YiYmKGU9PT1jfHxlLnNsaWNlKDAsYy5sZW5ndGgrMSk9PT1jKyItIikpfX0sQ0hJTEQ6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj0ibnRoIiE9PWEuc2xpY2UoMCwzKSxnPSJsYXN0IiE9PWEuc2xpY2UoLTQpLGg9Im9mLXR5cGUiPT09YjtyZXR1cm4gMT09PWQmJjA9PT1lP2Z1bmN0aW9uKGEpe3JldHVybiEhYS5wYXJlbnROb2RlfTpmdW5jdGlvbihiLGMsaSl7dmFyIGosayxsLG0sbixvLHA9ZiE9PWc/Im5leHRTaWJsaW5nIjoicHJldmlvdXNTaWJsaW5nIixxPWIucGFyZW50Tm9kZSxyPWgmJmIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxzPSFpJiYhaCx0PSExO2lmKHEpe2lmKGYpe3doaWxlKHApe209Yjt3aGlsZShtPW1bcF0paWYoaD9tLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1yOjE9PT1tLm5vZGVUeXBlKXJldHVybiExO289cD0ib25seSI9PT1hJiYhbyYmIm5leHRTaWJsaW5nIn1yZXR1cm4hMH1pZihvPVtnP3EuZmlyc3RDaGlsZDpxLmxhc3RDaGlsZF0sZyYmcyl7bT1xLGw9bVt1XXx8KG1bdV09e30pLGs9bFttLnVuaXF1ZUlEXXx8KGxbbS51bmlxdWVJRF09e30pLGo9a1thXXx8W10sbj1qWzBdPT09dyYmalsxXSx0PW4mJmpbMl0sbT1uJiZxLmNoaWxkTm9kZXNbbl07d2hpbGUobT0rK24mJm0mJm1bcF18fCh0PW49MCl8fG8ucG9wKCkpaWYoMT09PW0ubm9kZVR5cGUmJisrdCYmbT09PWIpe2tbYV09W3csbix0XTticmVha319ZWxzZSBpZihzJiYobT1iLGw9bVt1XXx8KG1bdV09e30pLGs9bFttLnVuaXF1ZUlEXXx8KGxbbS51bmlxdWVJRF09e30pLGo9a1thXXx8W10sbj1qWzBdPT09dyYmalsxXSx0PW4pLHQ9PT0hMSl3aGlsZShtPSsrbiYmbSYmbVtwXXx8KHQ9bj0wKXx8by5wb3AoKSlpZigoaD9tLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1yOjE9PT1tLm5vZGVUeXBlKSYmKyt0JiYocyYmKGw9bVt1XXx8KG1bdV09e30pLGs9bFttLnVuaXF1ZUlEXXx8KGxbbS51bmlxdWVJRF09e30pLGtbYV09W3csdF0pLG09PT1iKSlicmVhaztyZXR1cm4gdC09ZSx0PT09ZHx8dCVkPT09MCYmdC9kPj0wfX19LFBTRVVETzpmdW5jdGlvbihhLGIpe3ZhciBjLGU9ZC5wc2V1ZG9zW2FdfHxkLnNldEZpbHRlcnNbYS50b0xvd2VyQ2FzZSgpXXx8Z2EuZXJyb3IoInVuc3VwcG9ydGVkIHBzZXVkbzogIithKTtyZXR1cm4gZVt1XT9lKGIpOmUubGVuZ3RoPjE/KGM9W2EsYSwiIixiXSxkLnNldEZpbHRlcnMuaGFzT3duUHJvcGVydHkoYS50b0xvd2VyQ2FzZSgpKT9pYShmdW5jdGlvbihhLGMpe3ZhciBkLGY9ZShhLGIpLGc9Zi5sZW5ndGg7d2hpbGUoZy0tKWQ9SShhLGZbZ10pLGFbZF09IShjW2RdPWZbZ10pfSk6ZnVuY3Rpb24oYSl7cmV0dXJuIGUoYSwwLGMpfSk6ZX19LHBzZXVkb3M6e25vdDppYShmdW5jdGlvbihhKXt2YXIgYj1bXSxjPVtdLGQ9aChhLnJlcGxhY2UoUCwiJDEiKSk7cmV0dXJuIGRbdV0/aWEoZnVuY3Rpb24oYSxiLGMsZSl7dmFyIGYsZz1kKGEsbnVsbCxlLFtdKSxoPWEubGVuZ3RoO3doaWxlKGgtLSkoZj1nW2hdKSYmKGFbaF09IShiW2hdPWYpKX0pOmZ1bmN0aW9uKGEsZSxmKXtyZXR1cm4gYlswXT1hLGQoYixudWxsLGYsYyksYlswXT1udWxsLCFjLnBvcCgpfX0pLGhhczppYShmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGdhKGEsYikubGVuZ3RoPjB9fSksY29udGFpbnM6aWEoZnVuY3Rpb24oYSl7cmV0dXJuIGE9YS5yZXBsYWNlKF8sYWEpLGZ1bmN0aW9uKGIpe3JldHVybihiLnRleHRDb250ZW50fHxiLmlubmVyVGV4dHx8ZShiKSkuaW5kZXhPZihhKT4tMX19KSxsYW5nOmlhKGZ1bmN0aW9uKGEpe3JldHVybiBVLnRlc3QoYXx8IiIpfHxnYS5lcnJvcigidW5zdXBwb3J0ZWQgbGFuZzogIithKSxhPWEucmVwbGFjZShfLGFhKS50b0xvd2VyQ2FzZSgpLGZ1bmN0aW9uKGIpe3ZhciBjO2RvIGlmKGM9cD9iLmxhbmc6Yi5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIil8fGIuZ2V0QXR0cmlidXRlKCJsYW5nIikpcmV0dXJuIGM9Yy50b0xvd2VyQ2FzZSgpLGM9PT1hfHwwPT09Yy5pbmRleE9mKGErIi0iKTt3aGlsZSgoYj1iLnBhcmVudE5vZGUpJiYxPT09Yi5ub2RlVHlwZSk7cmV0dXJuITF9fSksdGFyZ2V0OmZ1bmN0aW9uKGIpe3ZhciBjPWEubG9jYXRpb24mJmEubG9jYXRpb24uaGFzaDtyZXR1cm4gYyYmYy5zbGljZSgxKT09PWIuaWR9LHJvb3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1vfSxmb2N1czpmdW5jdGlvbihhKXtyZXR1cm4gYT09PW4uYWN0aXZlRWxlbWVudCYmKCFuLmhhc0ZvY3VzfHxuLmhhc0ZvY3VzKCkpJiYhIShhLnR5cGV8fGEuaHJlZnx8fmEudGFiSW5kZXgpfSxlbmFibGVkOm9hKCExKSxkaXNhYmxlZDpvYSghMCksY2hlY2tlZDpmdW5jdGlvbihhKXt2YXIgYj1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PWImJiEhYS5jaGVja2VkfHwib3B0aW9uIj09PWImJiEhYS5zZWxlY3RlZH0sc2VsZWN0ZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucGFyZW50Tm9kZSYmYS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsYS5zZWxlY3RlZD09PSEwfSxlbXB0eTpmdW5jdGlvbihhKXtmb3IoYT1hLmZpcnN0Q2hpbGQ7YTthPWEubmV4dFNpYmxpbmcpaWYoYS5ub2RlVHlwZTw2KXJldHVybiExO3JldHVybiEwfSxwYXJlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuIWQucHNldWRvcy5lbXB0eShhKX0saGVhZGVyOmZ1bmN0aW9uKGEpe3JldHVybiBYLnRlc3QoYS5ub2RlTmFtZSl9LGlucHV0OmZ1bmN0aW9uKGEpe3JldHVybiBXLnRlc3QoYS5ub2RlTmFtZSl9LGJ1dHRvbjpmdW5jdGlvbihhKXt2YXIgYj1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PWImJiJidXR0b24iPT09YS50eXBlfHwiYnV0dG9uIj09PWJ9LHRleHQ6ZnVuY3Rpb24oYSl7dmFyIGI7cmV0dXJuImlucHV0Ij09PWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKSYmInRleHQiPT09YS50eXBlJiYobnVsbD09KGI9YS5nZXRBdHRyaWJ1dGUoInR5cGUiKSl8fCJ0ZXh0Ij09PWIudG9Mb3dlckNhc2UoKSl9LGZpcnN0OnBhKGZ1bmN0aW9uKCl7cmV0dXJuWzBdfSksbGFzdDpwYShmdW5jdGlvbihhLGIpe3JldHVybltiLTFdfSksZXE6cGEoZnVuY3Rpb24oYSxiLGMpe3JldHVybltjPDA/YytiOmNdfSksZXZlbjpwYShmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wO2M8YjtjKz0yKWEucHVzaChjKTtyZXR1cm4gYX0pLG9kZDpwYShmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0xO2M8YjtjKz0yKWEucHVzaChjKTtyZXR1cm4gYX0pLGx0OnBhKGZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9YzwwP2MrYjpjOy0tZD49MDspYS5wdXNoKGQpO3JldHVybiBhfSksZ3Q6cGEoZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD1jPDA/YytiOmM7KytkPGI7KWEucHVzaChkKTtyZXR1cm4gYX0pfX0sZC5wc2V1ZG9zLm50aD1kLnBzZXVkb3MuZXE7Zm9yKGIgaW57cmFkaW86ITAsY2hlY2tib3g6ITAsZmlsZTohMCxwYXNzd29yZDohMCxpbWFnZTohMH0pZC5wc2V1ZG9zW2JdPW1hKGIpO2ZvcihiIGlue3N1Ym1pdDohMCxyZXNldDohMH0pZC5wc2V1ZG9zW2JdPW5hKGIpO2Z1bmN0aW9uIHJhKCl7fXJhLnByb3RvdHlwZT1kLmZpbHRlcnM9ZC5wc2V1ZG9zLGQuc2V0RmlsdGVycz1uZXcgcmEsZz1nYS50b2tlbml6ZT1mdW5jdGlvbihhLGIpe3ZhciBjLGUsZixnLGgsaSxqLGs9elthKyIgIl07aWYoaylyZXR1cm4gYj8wOmsuc2xpY2UoMCk7aD1hLGk9W10saj1kLnByZUZpbHRlcjt3aGlsZShoKXtjJiYhKGU9US5leGVjKGgpKXx8KGUmJihoPWguc2xpY2UoZVswXS5sZW5ndGgpfHxoKSxpLnB1c2goZj1bXSkpLGM9ITEsKGU9Ui5leGVjKGgpKSYmKGM9ZS5zaGlmdCgpLGYucHVzaCh7dmFsdWU6Yyx0eXBlOmVbMF0ucmVwbGFjZShQLCIgIil9KSxoPWguc2xpY2UoYy5sZW5ndGgpKTtmb3IoZyBpbiBkLmZpbHRlcikhKGU9VltnXS5leGVjKGgpKXx8altnXSYmIShlPWpbZ10oZSkpfHwoYz1lLnNoaWZ0KCksZi5wdXNoKHt2YWx1ZTpjLHR5cGU6ZyxtYXRjaGVzOmV9KSxoPWguc2xpY2UoYy5sZW5ndGgpKTtpZighYylicmVha31yZXR1cm4gYj9oLmxlbmd0aDpoP2dhLmVycm9yKGEpOnooYSxpKS5zbGljZSgwKX07ZnVuY3Rpb24gc2EoYSl7Zm9yKHZhciBiPTAsYz1hLmxlbmd0aCxkPSIiO2I8YztiKyspZCs9YVtiXS52YWx1ZTtyZXR1cm4gZH1mdW5jdGlvbiB0YShhLGIsYyl7dmFyIGQ9Yi5kaXIsZT1iLm5leHQsZj1lfHxkLGc9YyYmInBhcmVudE5vZGUiPT09ZixoPXgrKztyZXR1cm4gYi5maXJzdD9mdW5jdGlvbihiLGMsZSl7d2hpbGUoYj1iW2RdKWlmKDE9PT1iLm5vZGVUeXBlfHxnKXJldHVybiBhKGIsYyxlKX06ZnVuY3Rpb24oYixjLGkpe3ZhciBqLGssbCxtPVt3LGhdO2lmKGkpe3doaWxlKGI9YltkXSlpZigoMT09PWIubm9kZVR5cGV8fGcpJiZhKGIsYyxpKSlyZXR1cm4hMH1lbHNlIHdoaWxlKGI9YltkXSlpZigxPT09Yi5ub2RlVHlwZXx8ZylpZihsPWJbdV18fChiW3VdPXt9KSxrPWxbYi51bmlxdWVJRF18fChsW2IudW5pcXVlSURdPXt9KSxlJiZlPT09Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKWI9YltkXXx8YjtlbHNle2lmKChqPWtbZl0pJiZqWzBdPT09dyYmalsxXT09PWgpcmV0dXJuIG1bMl09alsyXTtpZihrW2ZdPW0sbVsyXT1hKGIsYyxpKSlyZXR1cm4hMH19fWZ1bmN0aW9uIHVhKGEpe3JldHVybiBhLmxlbmd0aD4xP2Z1bmN0aW9uKGIsYyxkKXt2YXIgZT1hLmxlbmd0aDt3aGlsZShlLS0paWYoIWFbZV0oYixjLGQpKXJldHVybiExO3JldHVybiEwfTphWzBdfWZ1bmN0aW9uIHZhKGEsYixjKXtmb3IodmFyIGQ9MCxlPWIubGVuZ3RoO2Q8ZTtkKyspZ2EoYSxiW2RdLGMpO3JldHVybiBjfWZ1bmN0aW9uIHdhKGEsYixjLGQsZSl7Zm9yKHZhciBmLGc9W10saD0wLGk9YS5sZW5ndGgsaj1udWxsIT1iO2g8aTtoKyspKGY9YVtoXSkmJihjJiYhYyhmLGQsZSl8fChnLnB1c2goZiksaiYmYi5wdXNoKGgpKSk7cmV0dXJuIGd9ZnVuY3Rpb24geGEoYSxiLGMsZCxlLGYpe3JldHVybiBkJiYhZFt1XSYmKGQ9eGEoZCkpLGUmJiFlW3VdJiYoZT14YShlLGYpKSxpYShmdW5jdGlvbihmLGcsaCxpKXt2YXIgaixrLGwsbT1bXSxuPVtdLG89Zy5sZW5ndGgscD1mfHx2YShifHwiKiIsaC5ub2RlVHlwZT9baF06aCxbXSkscT0hYXx8IWYmJmI/cDp3YShwLG0sYSxoLGkpLHI9Yz9lfHwoZj9hOm98fGQpP1tdOmc6cTtpZihjJiZjKHEscixoLGkpLGQpe2o9d2EocixuKSxkKGosW10saCxpKSxrPWoubGVuZ3RoO3doaWxlKGstLSkobD1qW2tdKSYmKHJbbltrXV09IShxW25ba11dPWwpKX1pZihmKXtpZihlfHxhKXtpZihlKXtqPVtdLGs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiZqLnB1c2gocVtrXT1sKTtlKG51bGwscj1bXSxqLGkpfWs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiYoaj1lP0koZixsKTptW2tdKT4tMSYmKGZbal09IShnW2pdPWwpKX19ZWxzZSByPXdhKHI9PT1nP3Iuc3BsaWNlKG8sci5sZW5ndGgpOnIpLGU/ZShudWxsLGcscixpKTpHLmFwcGx5KGcscil9KX1mdW5jdGlvbiB5YShhKXtmb3IodmFyIGIsYyxlLGY9YS5sZW5ndGgsZz1kLnJlbGF0aXZlW2FbMF0udHlwZV0saD1nfHxkLnJlbGF0aXZlWyIgIl0saT1nPzE6MCxrPXRhKGZ1bmN0aW9uKGEpe3JldHVybiBhPT09Yn0saCwhMCksbD10YShmdW5jdGlvbihhKXtyZXR1cm4gSShiLGEpPi0xfSxoLCEwKSxtPVtmdW5jdGlvbihhLGMsZCl7dmFyIGU9IWcmJihkfHxjIT09ail8fCgoYj1jKS5ub2RlVHlwZT9rKGEsYyxkKTpsKGEsYyxkKSk7cmV0dXJuIGI9bnVsbCxlfV07aTxmO2krKylpZihjPWQucmVsYXRpdmVbYVtpXS50eXBlXSltPVt0YSh1YShtKSxjKV07ZWxzZXtpZihjPWQuZmlsdGVyW2FbaV0udHlwZV0uYXBwbHkobnVsbCxhW2ldLm1hdGNoZXMpLGNbdV0pe2ZvcihlPSsraTtlPGY7ZSsrKWlmKGQucmVsYXRpdmVbYVtlXS50eXBlXSlicmVhaztyZXR1cm4geGEoaT4xJiZ1YShtKSxpPjEmJnNhKGEuc2xpY2UoMCxpLTEpLmNvbmNhdCh7dmFsdWU6IiAiPT09YVtpLTJdLnR5cGU/IioiOiIifSkpLnJlcGxhY2UoUCwiJDEiKSxjLGk8ZSYmeWEoYS5zbGljZShpLGUpKSxlPGYmJnlhKGE9YS5zbGljZShlKSksZTxmJiZzYShhKSl9bS5wdXNoKGMpfXJldHVybiB1YShtKX1mdW5jdGlvbiB6YShhLGIpe3ZhciBjPWIubGVuZ3RoPjAsZT1hLmxlbmd0aD4wLGY9ZnVuY3Rpb24oZixnLGgsaSxrKXt2YXIgbCxvLHEscj0wLHM9IjAiLHQ9ZiYmW10sdT1bXSx2PWoseD1mfHxlJiZkLmZpbmQuVEFHKCIqIixrKSx5PXcrPW51bGw9PXY/MTpNYXRoLnJhbmRvbSgpfHwuMSx6PXgubGVuZ3RoO2ZvcihrJiYoaj1nPT09bnx8Z3x8ayk7cyE9PXomJm51bGwhPShsPXhbc10pO3MrKyl7aWYoZSYmbCl7bz0wLGd8fGwub3duZXJEb2N1bWVudD09PW58fChtKGwpLGg9IXApO3doaWxlKHE9YVtvKytdKWlmKHEobCxnfHxuLGgpKXtpLnB1c2gobCk7YnJlYWt9ayYmKHc9eSl9YyYmKChsPSFxJiZsKSYmci0tLGYmJnQucHVzaChsKSl9aWYocis9cyxjJiZzIT09cil7bz0wO3doaWxlKHE9YltvKytdKXEodCx1LGcsaCk7aWYoZil7aWYocj4wKXdoaWxlKHMtLSl0W3NdfHx1W3NdfHwodVtzXT1FLmNhbGwoaSkpO3U9d2EodSl9Ry5hcHBseShpLHUpLGsmJiFmJiZ1Lmxlbmd0aD4wJiZyK2IubGVuZ3RoPjEmJmdhLnVuaXF1ZVNvcnQoaSl9cmV0dXJuIGsmJih3PXksaj12KSx0fTtyZXR1cm4gYz9pYShmKTpmfXJldHVybiBoPWdhLmNvbXBpbGU9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPVtdLGU9W10sZj1BW2ErIiAiXTtpZighZil7Ynx8KGI9ZyhhKSksYz1iLmxlbmd0aDt3aGlsZShjLS0pZj15YShiW2NdKSxmW3VdP2QucHVzaChmKTplLnB1c2goZik7Zj1BKGEsemEoZSxkKSksZi5zZWxlY3Rvcj1hfXJldHVybiBmfSxpPWdhLnNlbGVjdD1mdW5jdGlvbihhLGIsZSxmKXt2YXIgaSxqLGssbCxtLG49ImZ1bmN0aW9uIj09dHlwZW9mIGEmJmEsbz0hZiYmZyhhPW4uc2VsZWN0b3J8fGEpO2lmKGU9ZXx8W10sMT09PW8ubGVuZ3RoKXtpZihqPW9bMF09b1swXS5zbGljZSgwKSxqLmxlbmd0aD4yJiYiSUQiPT09KGs9alswXSkudHlwZSYmYy5nZXRCeUlkJiY5PT09Yi5ub2RlVHlwZSYmcCYmZC5yZWxhdGl2ZVtqWzFdLnR5cGVdKXtpZihiPShkLmZpbmQuSUQoay5tYXRjaGVzWzBdLnJlcGxhY2UoXyxhYSksYil8fFtdKVswXSwhYilyZXR1cm4gZTtuJiYoYj1iLnBhcmVudE5vZGUpLGE9YS5zbGljZShqLnNoaWZ0KCkudmFsdWUubGVuZ3RoKX1pPVYubmVlZHNDb250ZXh0LnRlc3QoYSk/MDpqLmxlbmd0aDt3aGlsZShpLS0pe2lmKGs9altpXSxkLnJlbGF0aXZlW2w9ay50eXBlXSlicmVhaztpZigobT1kLmZpbmRbbF0pJiYoZj1tKGsubWF0Y2hlc1swXS5yZXBsYWNlKF8sYWEpLCQudGVzdChqWzBdLnR5cGUpJiZxYShiLnBhcmVudE5vZGUpfHxiKSkpe2lmKGouc3BsaWNlKGksMSksYT1mLmxlbmd0aCYmc2EoaiksIWEpcmV0dXJuIEcuYXBwbHkoZSxmKSxlO2JyZWFrfX19cmV0dXJuKG58fGgoYSxvKSkoZixiLCFwLGUsIWJ8fCQudGVzdChhKSYmcWEoYi5wYXJlbnROb2RlKXx8YiksZX0sYy5zb3J0U3RhYmxlPXUuc3BsaXQoIiIpLnNvcnQoQikuam9pbigiIik9PT11LGMuZGV0ZWN0RHVwbGljYXRlcz0hIWwsbSgpLGMuc29ydERldGFjaGVkPWphKGZ1bmN0aW9uKGEpe3JldHVybiAxJmEuY29tcGFyZURvY3VtZW50UG9zaXRpb24obi5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIpKX0pLGphKGZ1bmN0aW9uKGEpe3JldHVybiBhLmlubmVySFRNTD0iPGEgaHJlZj0nIyc+PC9hPiIsIiMiPT09YS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJlZiIpfSl8fGthKCJ0eXBlfGhyZWZ8aGVpZ2h0fHdpZHRoIixmdW5jdGlvbihhLGIsYyl7aWYoIWMpcmV0dXJuIGEuZ2V0QXR0cmlidXRlKGIsInR5cGUiPT09Yi50b0xvd2VyQ2FzZSgpPzE6Mil9KSxjLmF0dHJpYnV0ZXMmJmphKGZ1bmN0aW9uKGEpe3JldHVybiBhLmlubmVySFRNTD0iPGlucHV0Lz4iLGEuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwiIiksIiI9PT1hLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpfSl8fGthKCJ2YWx1ZSIsZnVuY3Rpb24oYSxiLGMpe2lmKCFjJiYiaW5wdXQiPT09YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKXJldHVybiBhLmRlZmF1bHRWYWx1ZX0pLGphKGZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hLmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKX0pfHxrYShKLGZ1bmN0aW9uKGEsYixjKXt2YXIgZDtpZighYylyZXR1cm4gYVtiXT09PSEwP2IudG9Mb3dlckNhc2UoKTooZD1hLmdldEF0dHJpYnV0ZU5vZGUoYikpJiZkLnNwZWNpZmllZD9kLnZhbHVlOm51bGx9KSxnYX0oYSk7ci5maW5kPXgsci5leHByPXguc2VsZWN0b3JzLHIuZXhwclsiOiJdPXIuZXhwci5wc2V1ZG9zLHIudW5pcXVlU29ydD1yLnVuaXF1ZT14LnVuaXF1ZVNvcnQsci50ZXh0PXguZ2V0VGV4dCxyLmlzWE1MRG9jPXguaXNYTUwsci5jb250YWlucz14LmNvbnRhaW5zLHIuZXNjYXBlU2VsZWN0b3I9eC5lc2NhcGU7dmFyIHk9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGU9dm9pZCAwIT09Yzt3aGlsZSgoYT1hW2JdKSYmOSE9PWEubm9kZVR5cGUpaWYoMT09PWEubm9kZVR5cGUpe2lmKGUmJnIoYSkuaXMoYykpYnJlYWs7ZC5wdXNoKGEpfXJldHVybiBkfSx6PWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVtdO2E7YT1hLm5leHRTaWJsaW5nKTE9PT1hLm5vZGVUeXBlJiZhIT09YiYmYy5wdXNoKGEpO3JldHVybiBjfSxBPXIuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQsQj0vXjwoW2Etel1bXlwvXDA+Olx4MjBcdFxyXG5cZl0qKVtceDIwXHRcclxuXGZdKlwvPz4oPzo8XC9cMT58KSQvaSxDPS9eLlteOiNcW1wuLF0qJC87ZnVuY3Rpb24gRChhLGIsYyl7aWYoci5pc0Z1bmN0aW9uKGIpKXJldHVybiByLmdyZXAoYSxmdW5jdGlvbihhLGQpe3JldHVybiEhYi5jYWxsKGEsZCxhKSE9PWN9KTtpZihiLm5vZGVUeXBlKXJldHVybiByLmdyZXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gYT09PWIhPT1jfSk7aWYoInN0cmluZyI9PXR5cGVvZiBiKXtpZihDLnRlc3QoYikpcmV0dXJuIHIuZmlsdGVyKGIsYSxjKTtiPXIuZmlsdGVyKGIsYSl9cmV0dXJuIHIuZ3JlcChhLGZ1bmN0aW9uKGEpe3JldHVybiBpLmNhbGwoYixhKT4tMSE9PWMmJjE9PT1hLm5vZGVUeXBlfSl9ci5maWx0ZXI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWJbMF07cmV0dXJuIGMmJihhPSI6bm90KCIrYSsiKSIpLDE9PT1iLmxlbmd0aCYmMT09PWQubm9kZVR5cGU/ci5maW5kLm1hdGNoZXNTZWxlY3RvcihkLGEpP1tkXTpbXTpyLmZpbmQubWF0Y2hlcyhhLHIuZ3JlcChiLGZ1bmN0aW9uKGEpe3JldHVybiAxPT09YS5ub2RlVHlwZX0pKX0sci5mbi5leHRlbmQoe2ZpbmQ6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkPXRoaXMubGVuZ3RoLGU9dGhpcztpZigic3RyaW5nIiE9dHlwZW9mIGEpcmV0dXJuIHRoaXMucHVzaFN0YWNrKHIoYSkuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKGI9MDtiPGQ7YisrKWlmKHIuY29udGFpbnMoZVtiXSx0aGlzKSlyZXR1cm4hMH0pKTtmb3IoYz10aGlzLnB1c2hTdGFjayhbXSksYj0wO2I8ZDtiKyspci5maW5kKGEsZVtiXSxjKTtyZXR1cm4gZD4xP3IudW5pcXVlU29ydChjKTpjfSxmaWx0ZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKEQodGhpcyxhfHxbXSwhMSkpfSxub3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKEQodGhpcyxhfHxbXSwhMCkpfSxpczpmdW5jdGlvbihhKXtyZXR1cm4hIUQodGhpcywic3RyaW5nIj09dHlwZW9mIGEmJkEudGVzdChhKT9yKGEpOmF8fFtdLCExKS5sZW5ndGh9fSk7dmFyIEUsRj0vXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSspKSQvLEc9ci5mbi5pbml0PWZ1bmN0aW9uKGEsYixjKXt2YXIgZSxmO2lmKCFhKXJldHVybiB0aGlzO2lmKGM9Y3x8RSwic3RyaW5nIj09dHlwZW9mIGEpe2lmKGU9IjwiPT09YVswXSYmIj4iPT09YVthLmxlbmd0aC0xXSYmYS5sZW5ndGg+PTM/W251bGwsYSxudWxsXTpGLmV4ZWMoYSksIWV8fCFlWzFdJiZiKXJldHVybiFifHxiLmpxdWVyeT8oYnx8YykuZmluZChhKTp0aGlzLmNvbnN0cnVjdG9yKGIpLmZpbmQoYSk7aWYoZVsxXSl7aWYoYj1iIGluc3RhbmNlb2Ygcj9iWzBdOmIsci5tZXJnZSh0aGlzLHIucGFyc2VIVE1MKGVbMV0sYiYmYi5ub2RlVHlwZT9iLm93bmVyRG9jdW1lbnR8fGI6ZCwhMCkpLEIudGVzdChlWzFdKSYmci5pc1BsYWluT2JqZWN0KGIpKWZvcihlIGluIGIpci5pc0Z1bmN0aW9uKHRoaXNbZV0pP3RoaXNbZV0oYltlXSk6dGhpcy5hdHRyKGUsYltlXSk7cmV0dXJuIHRoaXN9cmV0dXJuIGY9ZC5nZXRFbGVtZW50QnlJZChlWzJdKSxmJiYodGhpc1swXT1mLHRoaXMubGVuZ3RoPTEpLHRoaXN9cmV0dXJuIGEubm9kZVR5cGU/KHRoaXNbMF09YSx0aGlzLmxlbmd0aD0xLHRoaXMpOnIuaXNGdW5jdGlvbihhKT92b2lkIDAhPT1jLnJlYWR5P2MucmVhZHkoYSk6YShyKTpyLm1ha2VBcnJheShhLHRoaXMpfTtHLnByb3RvdHlwZT1yLmZuLEU9cihkKTt2YXIgSD0vXig/OnBhcmVudHN8cHJldig/OlVudGlsfEFsbCkpLyxJPXtjaGlsZHJlbjohMCxjb250ZW50czohMCxuZXh0OiEwLHByZXY6ITB9O3IuZm4uZXh0ZW5kKHtoYXM6ZnVuY3Rpb24oYSl7dmFyIGI9cihhLHRoaXMpLGM9Yi5sZW5ndGg7cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKHZhciBhPTA7YTxjO2ErKylpZihyLmNvbnRhaW5zKHRoaXMsYlthXSkpcmV0dXJuITB9KX0sY2xvc2VzdDpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MCxlPXRoaXMubGVuZ3RoLGY9W10sZz0ic3RyaW5nIiE9dHlwZW9mIGEmJnIoYSk7aWYoIUEudGVzdChhKSlmb3IoO2Q8ZTtkKyspZm9yKGM9dGhpc1tkXTtjJiZjIT09YjtjPWMucGFyZW50Tm9kZSlpZihjLm5vZGVUeXBlPDExJiYoZz9nLmluZGV4KGMpPi0xOjE9PT1jLm5vZGVUeXBlJiZyLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGMsYSkpKXtmLnB1c2goYyk7YnJlYWt9cmV0dXJuIHRoaXMucHVzaFN0YWNrKGYubGVuZ3RoPjE/ci51bmlxdWVTb3J0KGYpOmYpfSxpbmRleDpmdW5jdGlvbihhKXtyZXR1cm4gYT8ic3RyaW5nIj09dHlwZW9mIGE/aS5jYWxsKHIoYSksdGhpc1swXSk6aS5jYWxsKHRoaXMsYS5qcXVlcnk/YVswXTphKTp0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGU/dGhpcy5maXJzdCgpLnByZXZBbGwoKS5sZW5ndGg6LTF9LGFkZDpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnB1c2hTdGFjayhyLnVuaXF1ZVNvcnQoci5tZXJnZSh0aGlzLmdldCgpLHIoYSxiKSkpKX0sYWRkQmFjazpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hZGQobnVsbD09YT90aGlzLnByZXZPYmplY3Q6dGhpcy5wcmV2T2JqZWN0LmZpbHRlcihhKSl9fSk7ZnVuY3Rpb24gSihhLGIpe3doaWxlKChhPWFbYl0pJiYxIT09YS5ub2RlVHlwZSk7cmV0dXJuIGF9ci5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5wYXJlbnROb2RlO3JldHVybiBiJiYxMSE9PWIubm9kZVR5cGU/YjpudWxsfSxwYXJlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiB5KGEsInBhcmVudE5vZGUiKX0scGFyZW50c1VudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4geShhLCJwYXJlbnROb2RlIixjKX0sbmV4dDpmdW5jdGlvbihhKXtyZXR1cm4gSihhLCJuZXh0U2libGluZyIpfSxwcmV2OmZ1bmN0aW9uKGEpe3JldHVybiBKKGEsInByZXZpb3VzU2libGluZyIpfSxuZXh0QWxsOmZ1bmN0aW9uKGEpe3JldHVybiB5KGEsIm5leHRTaWJsaW5nIil9LHByZXZBbGw6ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRVbnRpbDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIHkoYSwibmV4dFNpYmxpbmciLGMpfSxwcmV2VW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB5KGEsInByZXZpb3VzU2libGluZyIsYyl9LHNpYmxpbmdzOmZ1bmN0aW9uKGEpe3JldHVybiB6KChhLnBhcmVudE5vZGV8fHt9KS5maXJzdENoaWxkLGEpfSxjaGlsZHJlbjpmdW5jdGlvbihhKXtyZXR1cm4geihhLmZpcnN0Q2hpbGQpfSxjb250ZW50czpmdW5jdGlvbihhKXtyZXR1cm4gYS5jb250ZW50RG9jdW1lbnR8fHIubWVyZ2UoW10sYS5jaGlsZE5vZGVzKX19LGZ1bmN0aW9uKGEsYil7ci5mblthXT1mdW5jdGlvbihjLGQpe3ZhciBlPXIubWFwKHRoaXMsYixjKTtyZXR1cm4iVW50aWwiIT09YS5zbGljZSgtNSkmJihkPWMpLGQmJiJzdHJpbmciPT10eXBlb2YgZCYmKGU9ci5maWx0ZXIoZCxlKSksdGhpcy5sZW5ndGg+MSYmKElbYV18fHIudW5pcXVlU29ydChlKSxILnRlc3QoYSkmJmUucmV2ZXJzZSgpKSx0aGlzLnB1c2hTdGFjayhlKX19KTt2YXIgSz0vXFMrL2c7ZnVuY3Rpb24gTChhKXt2YXIgYj17fTtyZXR1cm4gci5lYWNoKGEubWF0Y2goSyl8fFtdLGZ1bmN0aW9uKGEsYyl7YltjXT0hMH0pLGJ9ci5DYWxsYmFja3M9ZnVuY3Rpb24oYSl7YT0ic3RyaW5nIj09dHlwZW9mIGE/TChhKTpyLmV4dGVuZCh7fSxhKTt2YXIgYixjLGQsZSxmPVtdLGc9W10saD0tMSxpPWZ1bmN0aW9uKCl7Zm9yKGU9YS5vbmNlLGQ9Yj0hMDtnLmxlbmd0aDtoPS0xKXtjPWcuc2hpZnQoKTt3aGlsZSgrK2g8Zi5sZW5ndGgpZltoXS5hcHBseShjWzBdLGNbMV0pPT09ITEmJmEuc3RvcE9uRmFsc2UmJihoPWYubGVuZ3RoLGM9ITEpfWEubWVtb3J5fHwoYz0hMSksYj0hMSxlJiYoZj1jP1tdOiIiKX0saj17YWRkOmZ1bmN0aW9uKCl7cmV0dXJuIGYmJihjJiYhYiYmKGg9Zi5sZW5ndGgtMSxnLnB1c2goYykpLGZ1bmN0aW9uIGQoYil7ci5lYWNoKGIsZnVuY3Rpb24oYixjKXtyLmlzRnVuY3Rpb24oYyk/YS51bmlxdWUmJmouaGFzKGMpfHxmLnB1c2goYyk6YyYmYy5sZW5ndGgmJiJzdHJpbmciIT09ci50eXBlKGMpJiZkKGMpfSl9KGFyZ3VtZW50cyksYyYmIWImJmkoKSksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHIuZWFjaChhcmd1bWVudHMsZnVuY3Rpb24oYSxiKXt2YXIgYzt3aGlsZSgoYz1yLmluQXJyYXkoYixmLGMpKT4tMSlmLnNwbGljZShjLDEpLGM8PWgmJmgtLX0pLHRoaXN9LGhhczpmdW5jdGlvbihhKXtyZXR1cm4gYT9yLmluQXJyYXkoYSxmKT4tMTpmLmxlbmd0aD4wfSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiBmJiYoZj1bXSksdGhpc30sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiBlPWc9W10sZj1jPSIiLHRoaXN9LGRpc2FibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIWZ9LGxvY2s6ZnVuY3Rpb24oKXtyZXR1cm4gZT1nPVtdLGN8fGJ8fChmPWM9IiIpLHRoaXN9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiEhZX0sZmlyZVdpdGg6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gZXx8KGM9Y3x8W10sYz1bYSxjLnNsaWNlP2Muc2xpY2UoKTpjXSxnLnB1c2goYyksYnx8aSgpKSx0aGlzfSxmaXJlOmZ1bmN0aW9uKCl7cmV0dXJuIGouZmlyZVdpdGgodGhpcyxhcmd1bWVudHMpLHRoaXN9LGZpcmVkOmZ1bmN0aW9uKCl7cmV0dXJuISFkfX07cmV0dXJuIGp9O2Z1bmN0aW9uIE0oYSl7cmV0dXJuIGF9ZnVuY3Rpb24gTihhKXt0aHJvdyBhfWZ1bmN0aW9uIE8oYSxiLGMpe3ZhciBkO3RyeXthJiZyLmlzRnVuY3Rpb24oZD1hLnByb21pc2UpP2QuY2FsbChhKS5kb25lKGIpLmZhaWwoYyk6YSYmci5pc0Z1bmN0aW9uKGQ9YS50aGVuKT9kLmNhbGwoYSxiLGMpOmIuY2FsbCh2b2lkIDAsYSl9Y2F0Y2goYSl7Yy5jYWxsKHZvaWQgMCxhKX19ci5leHRlbmQoe0RlZmVycmVkOmZ1bmN0aW9uKGIpe3ZhciBjPVtbIm5vdGlmeSIsInByb2dyZXNzIixyLkNhbGxiYWNrcygibWVtb3J5Iiksci5DYWxsYmFja3MoIm1lbW9yeSIpLDJdLFsicmVzb2x2ZSIsImRvbmUiLHIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLDAsInJlc29sdmVkIl0sWyJyZWplY3QiLCJmYWlsIixyLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSxyLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwxLCJyZWplY3RlZCJdXSxkPSJwZW5kaW5nIixlPXtzdGF0ZTpmdW5jdGlvbigpe3JldHVybiBkfSxhbHdheXM6ZnVuY3Rpb24oKXtyZXR1cm4gZi5kb25lKGFyZ3VtZW50cykuZmFpbChhcmd1bWVudHMpLHRoaXN9LCJjYXRjaCI6ZnVuY3Rpb24oYSl7cmV0dXJuIGUudGhlbihudWxsLGEpfSxwaXBlOmZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzO3JldHVybiByLkRlZmVycmVkKGZ1bmN0aW9uKGIpe3IuZWFjaChjLGZ1bmN0aW9uKGMsZCl7dmFyIGU9ci5pc0Z1bmN0aW9uKGFbZFs0XV0pJiZhW2RbNF1dO2ZbZFsxXV0oZnVuY3Rpb24oKXt2YXIgYT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTthJiZyLmlzRnVuY3Rpb24oYS5wcm9taXNlKT9hLnByb21pc2UoKS5wcm9ncmVzcyhiLm5vdGlmeSkuZG9uZShiLnJlc29sdmUpLmZhaWwoYi5yZWplY3QpOmJbZFswXSsiV2l0aCJdKHRoaXMsZT9bYV06YXJndW1lbnRzKX0pfSksYT1udWxsfSkucHJvbWlzZSgpfSx0aGVuOmZ1bmN0aW9uKGIsZCxlKXt2YXIgZj0wO2Z1bmN0aW9uIGcoYixjLGQsZSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGg9dGhpcyxpPWFyZ3VtZW50cyxqPWZ1bmN0aW9uKCl7dmFyIGEsajtpZighKGI8Zikpe2lmKGE9ZC5hcHBseShoLGkpLGE9PT1jLnByb21pc2UoKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGVuYWJsZSBzZWxmLXJlc29sdXRpb24iKTtqPWEmJigib2JqZWN0Ij09dHlwZW9mIGF8fCJmdW5jdGlvbiI9PXR5cGVvZiBhKSYmYS50aGVuLHIuaXNGdW5jdGlvbihqKT9lP2ouY2FsbChhLGcoZixjLE0sZSksZyhmLGMsTixlKSk6KGYrKyxqLmNhbGwoYSxnKGYsYyxNLGUpLGcoZixjLE4sZSksZyhmLGMsTSxjLm5vdGlmeVdpdGgpKSk6KGQhPT1NJiYoaD12b2lkIDAsaT1bYV0pLChlfHxjLnJlc29sdmVXaXRoKShoLGkpKX19LGs9ZT9qOmZ1bmN0aW9uKCl7dHJ5e2ooKX1jYXRjaChhKXtyLkRlZmVycmVkLmV4Y2VwdGlvbkhvb2smJnIuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayhhLGsuc3RhY2tUcmFjZSksYisxPj1mJiYoZCE9PU4mJihoPXZvaWQgMCxpPVthXSksYy5yZWplY3RXaXRoKGgsaSkpfX07Yj9rKCk6KHIuRGVmZXJyZWQuZ2V0U3RhY2tIb29rJiYoay5zdGFja1RyYWNlPXIuRGVmZXJyZWQuZ2V0U3RhY2tIb29rKCkpLGEuc2V0VGltZW91dChrKSl9fXJldHVybiByLkRlZmVycmVkKGZ1bmN0aW9uKGEpe2NbMF1bM10uYWRkKGcoMCxhLHIuaXNGdW5jdGlvbihlKT9lOk0sYS5ub3RpZnlXaXRoKSksY1sxXVszXS5hZGQoZygwLGEsci5pc0Z1bmN0aW9uKGIpP2I6TSkpLGNbMl1bM10uYWRkKGcoMCxhLHIuaXNGdW5jdGlvbihkKT9kOk4pKX0pLnByb21pc2UoKX0scHJvbWlzZTpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9YT9yLmV4dGVuZChhLGUpOmV9fSxmPXt9O3JldHVybiByLmVhY2goYyxmdW5jdGlvbihhLGIpe3ZhciBnPWJbMl0saD1iWzVdO2VbYlsxXV09Zy5hZGQsaCYmZy5hZGQoZnVuY3Rpb24oKXtkPWh9LGNbMy1hXVsyXS5kaXNhYmxlLGNbMF1bMl0ubG9jayksZy5hZGQoYlszXS5maXJlKSxmW2JbMF1dPWZ1bmN0aW9uKCl7cmV0dXJuIGZbYlswXSsiV2l0aCJdKHRoaXM9PT1mP3ZvaWQgMDp0aGlzLGFyZ3VtZW50cyksdGhpc30sZltiWzBdKyJXaXRoIl09Zy5maXJlV2l0aH0pLGUucHJvbWlzZShmKSxiJiZiLmNhbGwoZixmKSxmfSx3aGVuOmZ1bmN0aW9uKGEpe3ZhciBiPWFyZ3VtZW50cy5sZW5ndGgsYz1iLGQ9QXJyYXkoYyksZT1mLmNhbGwoYXJndW1lbnRzKSxnPXIuRGVmZXJyZWQoKSxoPWZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihjKXtkW2FdPXRoaXMsZVthXT1hcmd1bWVudHMubGVuZ3RoPjE/Zi5jYWxsKGFyZ3VtZW50cyk6YywtLWJ8fGcucmVzb2x2ZVdpdGgoZCxlKX19O2lmKGI8PTEmJihPKGEsZy5kb25lKGgoYykpLnJlc29sdmUsZy5yZWplY3QpLCJwZW5kaW5nIj09PWcuc3RhdGUoKXx8ci5pc0Z1bmN0aW9uKGVbY10mJmVbY10udGhlbikpKXJldHVybiBnLnRoZW4oKTt3aGlsZShjLS0pTyhlW2NdLGgoYyksZy5yZWplY3QpO3JldHVybiBnLnByb21pc2UoKX19KTt2YXIgUD0vXihFdmFsfEludGVybmFsfFJhbmdlfFJlZmVyZW5jZXxTeW50YXh8VHlwZXxVUkkpRXJyb3IkLztyLkRlZmVycmVkLmV4Y2VwdGlvbkhvb2s9ZnVuY3Rpb24oYixjKXthLmNvbnNvbGUmJmEuY29uc29sZS53YXJuJiZiJiZQLnRlc3QoYi5uYW1lKSYmYS5jb25zb2xlLndhcm4oImpRdWVyeS5EZWZlcnJlZCBleGNlcHRpb246ICIrYi5tZXNzYWdlLGIuc3RhY2ssYyl9LHIucmVhZHlFeGNlcHRpb249ZnVuY3Rpb24oYil7YS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dGhyb3cgYn0pfTt2YXIgUT1yLkRlZmVycmVkKCk7ci5mbi5yZWFkeT1mdW5jdGlvbihhKXtyZXR1cm4gUS50aGVuKGEpWyJjYXRjaCJdKGZ1bmN0aW9uKGEpe3IucmVhZHlFeGNlcHRpb24oYSl9KSx0aGlzfSxyLmV4dGVuZCh7aXNSZWFkeTohMSxyZWFkeVdhaXQ6MSxob2xkUmVhZHk6ZnVuY3Rpb24oYSl7YT9yLnJlYWR5V2FpdCsrOnIucmVhZHkoITApfSxyZWFkeTpmdW5jdGlvbihhKXsoYT09PSEwPy0tci5yZWFkeVdhaXQ6ci5pc1JlYWR5KXx8KHIuaXNSZWFkeT0hMCxhIT09ITAmJi0tci5yZWFkeVdhaXQ+MHx8US5yZXNvbHZlV2l0aChkLFtyXSkpfX0pLHIucmVhZHkudGhlbj1RLnRoZW47ZnVuY3Rpb24gUigpe2QucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsUiksYS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixSKSxyLnJlYWR5KCl9ImNvbXBsZXRlIj09PWQucmVhZHlTdGF0ZXx8ImxvYWRpbmciIT09ZC5yZWFkeVN0YXRlJiYhZC5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGw/YS5zZXRUaW1lb3V0KHIucmVhZHkpOihkLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLFIpLGEuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsUikpO3ZhciBTPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe3ZhciBoPTAsaT1hLmxlbmd0aCxqPW51bGw9PWM7aWYoIm9iamVjdCI9PT1yLnR5cGUoYykpe2U9ITA7Zm9yKGggaW4gYylTKGEsYixoLGNbaF0sITAsZixnKX1lbHNlIGlmKHZvaWQgMCE9PWQmJihlPSEwLApyLmlzRnVuY3Rpb24oZCl8fChnPSEwKSxqJiYoZz8oYi5jYWxsKGEsZCksYj1udWxsKTooaj1iLGI9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBqLmNhbGwocihhKSxjKX0pKSxiKSlmb3IoO2g8aTtoKyspYihhW2hdLGMsZz9kOmQuY2FsbChhW2hdLGgsYihhW2hdLGMpKSk7cmV0dXJuIGU/YTpqP2IuY2FsbChhKTppP2IoYVswXSxjKTpmfSxUPWZ1bmN0aW9uKGEpe3JldHVybiAxPT09YS5ub2RlVHlwZXx8OT09PWEubm9kZVR5cGV8fCErYS5ub2RlVHlwZX07ZnVuY3Rpb24gVSgpe3RoaXMuZXhwYW5kbz1yLmV4cGFuZG8rVS51aWQrK31VLnVpZD0xLFUucHJvdG90eXBlPXtjYWNoZTpmdW5jdGlvbihhKXt2YXIgYj1hW3RoaXMuZXhwYW5kb107cmV0dXJuIGJ8fChiPXt9LFQoYSkmJihhLm5vZGVUeXBlP2FbdGhpcy5leHBhbmRvXT1iOk9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLHRoaXMuZXhwYW5kbyx7dmFsdWU6Yixjb25maWd1cmFibGU6ITB9KSkpLGJ9LHNldDpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT10aGlzLmNhY2hlKGEpO2lmKCJzdHJpbmciPT10eXBlb2YgYillW3IuY2FtZWxDYXNlKGIpXT1jO2Vsc2UgZm9yKGQgaW4gYillW3IuY2FtZWxDYXNlKGQpXT1iW2RdO3JldHVybiBlfSxnZXQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdm9pZCAwPT09Yj90aGlzLmNhY2hlKGEpOmFbdGhpcy5leHBhbmRvXSYmYVt0aGlzLmV4cGFuZG9dW3IuY2FtZWxDYXNlKGIpXX0sYWNjZXNzOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdm9pZCAwPT09Ynx8YiYmInN0cmluZyI9PXR5cGVvZiBiJiZ2b2lkIDA9PT1jP3RoaXMuZ2V0KGEsYik6KHRoaXMuc2V0KGEsYixjKSx2b2lkIDAhPT1jP2M6Yil9LHJlbW92ZTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9YVt0aGlzLmV4cGFuZG9dO2lmKHZvaWQgMCE9PWQpe2lmKHZvaWQgMCE9PWIpe3IuaXNBcnJheShiKT9iPWIubWFwKHIuY2FtZWxDYXNlKTooYj1yLmNhbWVsQ2FzZShiKSxiPWIgaW4gZD9bYl06Yi5tYXRjaChLKXx8W10pLGM9Yi5sZW5ndGg7d2hpbGUoYy0tKWRlbGV0ZSBkW2JbY11dfSh2b2lkIDA9PT1ifHxyLmlzRW1wdHlPYmplY3QoZCkpJiYoYS5ub2RlVHlwZT9hW3RoaXMuZXhwYW5kb109dm9pZCAwOmRlbGV0ZSBhW3RoaXMuZXhwYW5kb10pfX0saGFzRGF0YTpmdW5jdGlvbihhKXt2YXIgYj1hW3RoaXMuZXhwYW5kb107cmV0dXJuIHZvaWQgMCE9PWImJiFyLmlzRW1wdHlPYmplY3QoYil9fTt2YXIgVj1uZXcgVSxXPW5ldyBVLFg9L14oPzpce1tcd1xXXSpcfXxcW1tcd1xXXSpcXSkkLyxZPS9bQS1aXS9nO2Z1bmN0aW9uIFooYSxiLGMpe3ZhciBkO2lmKHZvaWQgMD09PWMmJjE9PT1hLm5vZGVUeXBlKWlmKGQ9ImRhdGEtIitiLnJlcGxhY2UoWSwiLSQmIikudG9Mb3dlckNhc2UoKSxjPWEuZ2V0QXR0cmlidXRlKGQpLCJzdHJpbmciPT10eXBlb2YgYyl7dHJ5e2M9InRydWUiPT09Y3x8ImZhbHNlIiE9PWMmJigibnVsbCI9PT1jP251bGw6K2MrIiI9PT1jPytjOlgudGVzdChjKT9KU09OLnBhcnNlKGMpOmMpfWNhdGNoKGUpe31XLnNldChhLGIsYyl9ZWxzZSBjPXZvaWQgMDtyZXR1cm4gY31yLmV4dGVuZCh7aGFzRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gVy5oYXNEYXRhKGEpfHxWLmhhc0RhdGEoYSl9LGRhdGE6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBXLmFjY2VzcyhhLGIsYyl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oYSxiKXtXLnJlbW92ZShhLGIpfSxfZGF0YTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIFYuYWNjZXNzKGEsYixjKX0sX3JlbW92ZURhdGE6ZnVuY3Rpb24oYSxiKXtWLnJlbW92ZShhLGIpfX0pLHIuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9dGhpc1swXSxnPWYmJmYuYXR0cmlidXRlcztpZih2b2lkIDA9PT1hKXtpZih0aGlzLmxlbmd0aCYmKGU9Vy5nZXQoZiksMT09PWYubm9kZVR5cGUmJiFWLmdldChmLCJoYXNEYXRhQXR0cnMiKSkpe2M9Zy5sZW5ndGg7d2hpbGUoYy0tKWdbY10mJihkPWdbY10ubmFtZSwwPT09ZC5pbmRleE9mKCJkYXRhLSIpJiYoZD1yLmNhbWVsQ2FzZShkLnNsaWNlKDUpKSxaKGYsZCxlW2RdKSkpO1Yuc2V0KGYsImhhc0RhdGFBdHRycyIsITApfXJldHVybiBlfXJldHVybiJvYmplY3QiPT10eXBlb2YgYT90aGlzLmVhY2goZnVuY3Rpb24oKXtXLnNldCh0aGlzLGEpfSk6Uyh0aGlzLGZ1bmN0aW9uKGIpe3ZhciBjO2lmKGYmJnZvaWQgMD09PWIpe2lmKGM9Vy5nZXQoZixhKSx2b2lkIDAhPT1jKXJldHVybiBjO2lmKGM9WihmLGEpLHZvaWQgMCE9PWMpcmV0dXJuIGN9ZWxzZSB0aGlzLmVhY2goZnVuY3Rpb24oKXtXLnNldCh0aGlzLGEsYil9KX0sbnVsbCxiLGFyZ3VtZW50cy5sZW5ndGg+MSxudWxsLCEwKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Vy5yZW1vdmUodGhpcyxhKX0pfX0pLHIuZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ7aWYoYSlyZXR1cm4gYj0oYnx8ImZ4IikrInF1ZXVlIixkPVYuZ2V0KGEsYiksYyYmKCFkfHxyLmlzQXJyYXkoYyk/ZD1WLmFjY2VzcyhhLGIsci5tYWtlQXJyYXkoYykpOmQucHVzaChjKSksZHx8W119LGRlcXVldWU6ZnVuY3Rpb24oYSxiKXtiPWJ8fCJmeCI7dmFyIGM9ci5xdWV1ZShhLGIpLGQ9Yy5sZW5ndGgsZT1jLnNoaWZ0KCksZj1yLl9xdWV1ZUhvb2tzKGEsYiksZz1mdW5jdGlvbigpe3IuZGVxdWV1ZShhLGIpfTsiaW5wcm9ncmVzcyI9PT1lJiYoZT1jLnNoaWZ0KCksZC0tKSxlJiYoImZ4Ij09PWImJmMudW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBmLnN0b3AsZS5jYWxsKGEsZyxmKSksIWQmJmYmJmYuZW1wdHkuZmlyZSgpfSxfcXVldWVIb29rczpmdW5jdGlvbihhLGIpe3ZhciBjPWIrInF1ZXVlSG9va3MiO3JldHVybiBWLmdldChhLGMpfHxWLmFjY2VzcyhhLGMse2VtcHR5OnIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLmFkZChmdW5jdGlvbigpe1YucmVtb3ZlKGEsW2IrInF1ZXVlIixjXSl9KX0pfX0pLHIuZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIpe3ZhciBjPTI7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBhJiYoYj1hLGE9ImZ4IixjLS0pLGFyZ3VtZW50cy5sZW5ndGg8Yz9yLnF1ZXVlKHRoaXNbMF0sYSk6dm9pZCAwPT09Yj90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBjPXIucXVldWUodGhpcyxhLGIpO3IuX3F1ZXVlSG9va3ModGhpcyxhKSwiZngiPT09YSYmImlucHJvZ3Jlc3MiIT09Y1swXSYmci5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7ci5kZXF1ZXVlKHRoaXMsYSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShhfHwiZngiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MSxlPXIuRGVmZXJyZWQoKSxmPXRoaXMsZz10aGlzLmxlbmd0aCxoPWZ1bmN0aW9uKCl7LS1kfHxlLnJlc29sdmVXaXRoKGYsW2ZdKX07InN0cmluZyIhPXR5cGVvZiBhJiYoYj1hLGE9dm9pZCAwKSxhPWF8fCJmeCI7d2hpbGUoZy0tKWM9Vi5nZXQoZltnXSxhKyJxdWV1ZUhvb2tzIiksYyYmYy5lbXB0eSYmKGQrKyxjLmVtcHR5LmFkZChoKSk7cmV0dXJuIGgoKSxlLnByb21pc2UoYil9fSk7dmFyICQ9L1srLV0/KD86XGQqXC58KVxkKyg/OltlRV1bKy1dP1xkK3wpLy5zb3VyY2UsXz1uZXcgUmVnRXhwKCJeKD86KFsrLV0pPXwpKCIrJCsiKShbYS16JV0qKSQiLCJpIiksYWE9WyJUb3AiLCJSaWdodCIsIkJvdHRvbSIsIkxlZnQiXSxiYT1mdW5jdGlvbihhLGIpe3JldHVybiBhPWJ8fGEsIm5vbmUiPT09YS5zdHlsZS5kaXNwbGF5fHwiIj09PWEuc3R5bGUuZGlzcGxheSYmci5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSkmJiJub25lIj09PXIuY3NzKGEsImRpc3BsYXkiKX0sY2E9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGUsZixnPXt9O2ZvcihmIGluIGIpZ1tmXT1hLnN0eWxlW2ZdLGEuc3R5bGVbZl09YltmXTtlPWMuYXBwbHkoYSxkfHxbXSk7Zm9yKGYgaW4gYilhLnN0eWxlW2ZdPWdbZl07cmV0dXJuIGV9O2Z1bmN0aW9uIGRhKGEsYixjLGQpe3ZhciBlLGY9MSxnPTIwLGg9ZD9mdW5jdGlvbigpe3JldHVybiBkLmN1cigpfTpmdW5jdGlvbigpe3JldHVybiByLmNzcyhhLGIsIiIpfSxpPWgoKSxqPWMmJmNbM118fChyLmNzc051bWJlcltiXT8iIjoicHgiKSxrPShyLmNzc051bWJlcltiXXx8InB4IiE9PWomJitpKSYmXy5leGVjKHIuY3NzKGEsYikpO2lmKGsmJmtbM10hPT1qKXtqPWp8fGtbM10sYz1jfHxbXSxrPStpfHwxO2RvIGY9Znx8Ii41IixrLz1mLHIuc3R5bGUoYSxiLGsraik7d2hpbGUoZiE9PShmPWgoKS9pKSYmMSE9PWYmJi0tZyl9cmV0dXJuIGMmJihrPStrfHwraXx8MCxlPWNbMV0/aysoY1sxXSsxKSpjWzJdOitjWzJdLGQmJihkLnVuaXQ9aixkLnN0YXJ0PWssZC5lbmQ9ZSkpLGV9dmFyIGVhPXt9O2Z1bmN0aW9uIGZhKGEpe3ZhciBiLGM9YS5vd25lckRvY3VtZW50LGQ9YS5ub2RlTmFtZSxlPWVhW2RdO3JldHVybiBlP2U6KGI9Yy5ib2R5LmFwcGVuZENoaWxkKGMuY3JlYXRlRWxlbWVudChkKSksZT1yLmNzcyhiLCJkaXNwbGF5IiksYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpLCJub25lIj09PWUmJihlPSJibG9jayIpLGVhW2RdPWUsZSl9ZnVuY3Rpb24gZ2EoYSxiKXtmb3IodmFyIGMsZCxlPVtdLGY9MCxnPWEubGVuZ3RoO2Y8ZztmKyspZD1hW2ZdLGQuc3R5bGUmJihjPWQuc3R5bGUuZGlzcGxheSxiPygibm9uZSI9PT1jJiYoZVtmXT1WLmdldChkLCJkaXNwbGF5Iil8fG51bGwsZVtmXXx8KGQuc3R5bGUuZGlzcGxheT0iIikpLCIiPT09ZC5zdHlsZS5kaXNwbGF5JiZiYShkKSYmKGVbZl09ZmEoZCkpKToibm9uZSIhPT1jJiYoZVtmXT0ibm9uZSIsVi5zZXQoZCwiZGlzcGxheSIsYykpKTtmb3IoZj0wO2Y8ZztmKyspbnVsbCE9ZVtmXSYmKGFbZl0uc3R5bGUuZGlzcGxheT1lW2ZdKTtyZXR1cm4gYX1yLmZuLmV4dGVuZCh7c2hvdzpmdW5jdGlvbigpe3JldHVybiBnYSh0aGlzLCEwKX0saGlkZTpmdW5jdGlvbigpe3JldHVybiBnYSh0aGlzKX0sdG9nZ2xlOmZ1bmN0aW9uKGEpe3JldHVybiJib29sZWFuIj09dHlwZW9mIGE/YT90aGlzLnNob3coKTp0aGlzLmhpZGUoKTp0aGlzLmVhY2goZnVuY3Rpb24oKXtiYSh0aGlzKT9yKHRoaXMpLnNob3coKTpyKHRoaXMpLmhpZGUoKX0pfX0pO3ZhciBoYT0vXig/OmNoZWNrYm94fHJhZGlvKSQvaSxpYT0vPChbYS16XVteXC9cMD5ceDIwXHRcclxuXGZdKykvaSxqYT0vXiR8XC8oPzpqYXZhfGVjbWEpc2NyaXB0L2ksa2E9e29wdGlvbjpbMSwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsIjwvc2VsZWN0PiJdLHRoZWFkOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSxjb2w6WzIsIjx0YWJsZT48Y29sZ3JvdXA+IiwiPC9jb2xncm91cD48L3RhYmxlPiJdLHRyOlsyLCI8dGFibGU+PHRib2R5PiIsIjwvdGJvZHk+PC90YWJsZT4iXSx0ZDpbMywiPHRhYmxlPjx0Ym9keT48dHI+IiwiPC90cj48L3Rib2R5PjwvdGFibGU+Il0sX2RlZmF1bHQ6WzAsIiIsIiJdfTtrYS5vcHRncm91cD1rYS5vcHRpb24sa2EudGJvZHk9a2EudGZvb3Q9a2EuY29sZ3JvdXA9a2EuY2FwdGlvbj1rYS50aGVhZCxrYS50aD1rYS50ZDtmdW5jdGlvbiBsYShhLGIpe3ZhciBjPSJ1bmRlZmluZWQiIT10eXBlb2YgYS5nZXRFbGVtZW50c0J5VGFnTmFtZT9hLmdldEVsZW1lbnRzQnlUYWdOYW1lKGJ8fCIqIik6InVuZGVmaW5lZCIhPXR5cGVvZiBhLnF1ZXJ5U2VsZWN0b3JBbGw/YS5xdWVyeVNlbGVjdG9yQWxsKGJ8fCIqIik6W107cmV0dXJuIHZvaWQgMD09PWJ8fGImJnIubm9kZU5hbWUoYSxiKT9yLm1lcmdlKFthXSxjKTpjfWZ1bmN0aW9uIG1hKGEsYil7Zm9yKHZhciBjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKVYuc2V0KGFbY10sImdsb2JhbEV2YWwiLCFifHxWLmdldChiW2NdLCJnbG9iYWxFdmFsIikpfXZhciBuYT0vPHwmIz9cdys7LztmdW5jdGlvbiBvYShhLGIsYyxkLGUpe2Zvcih2YXIgZixnLGgsaSxqLGssbD1iLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxtPVtdLG49MCxvPWEubGVuZ3RoO248bztuKyspaWYoZj1hW25dLGZ8fDA9PT1mKWlmKCJvYmplY3QiPT09ci50eXBlKGYpKXIubWVyZ2UobSxmLm5vZGVUeXBlP1tmXTpmKTtlbHNlIGlmKG5hLnRlc3QoZikpe2c9Z3x8bC5hcHBlbmRDaGlsZChiLmNyZWF0ZUVsZW1lbnQoImRpdiIpKSxoPShpYS5leGVjKGYpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpLGk9a2FbaF18fGthLl9kZWZhdWx0LGcuaW5uZXJIVE1MPWlbMV0rci5odG1sUHJlZmlsdGVyKGYpK2lbMl0saz1pWzBdO3doaWxlKGstLSlnPWcubGFzdENoaWxkO3IubWVyZ2UobSxnLmNoaWxkTm9kZXMpLGc9bC5maXJzdENoaWxkLGcudGV4dENvbnRlbnQ9IiJ9ZWxzZSBtLnB1c2goYi5jcmVhdGVUZXh0Tm9kZShmKSk7bC50ZXh0Q29udGVudD0iIixuPTA7d2hpbGUoZj1tW24rK10paWYoZCYmci5pbkFycmF5KGYsZCk+LTEpZSYmZS5wdXNoKGYpO2Vsc2UgaWYoaj1yLmNvbnRhaW5zKGYub3duZXJEb2N1bWVudCxmKSxnPWxhKGwuYXBwZW5kQ2hpbGQoZiksInNjcmlwdCIpLGomJm1hKGcpLGMpe2s9MDt3aGlsZShmPWdbaysrXSlqYS50ZXN0KGYudHlwZXx8IiIpJiZjLnB1c2goZil9cmV0dXJuIGx9IWZ1bmN0aW9uKCl7dmFyIGE9ZC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksYj1hLmFwcGVuZENoaWxkKGQuY3JlYXRlRWxlbWVudCgiZGl2IikpLGM9ZC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO2Muc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSxjLnNldEF0dHJpYnV0ZSgiY2hlY2tlZCIsImNoZWNrZWQiKSxjLnNldEF0dHJpYnV0ZSgibmFtZSIsInQiKSxiLmFwcGVuZENoaWxkKGMpLG8uY2hlY2tDbG9uZT1iLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCxiLmlubmVySFRNTD0iPHRleHRhcmVhPng8L3RleHRhcmVhPiIsby5ub0Nsb25lQ2hlY2tlZD0hIWIuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlfSgpO3ZhciBwYT1kLmRvY3VtZW50RWxlbWVudCxxYT0vXmtleS8scmE9L14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51fGRyYWd8ZHJvcCl8Y2xpY2svLHNhPS9eKFteLl0qKSg/OlwuKC4rKXwpLztmdW5jdGlvbiB0YSgpe3JldHVybiEwfWZ1bmN0aW9uIHVhKCl7cmV0dXJuITF9ZnVuY3Rpb24gdmEoKXt0cnl7cmV0dXJuIGQuYWN0aXZlRWxlbWVudH1jYXRjaChhKXt9fWZ1bmN0aW9uIHdhKGEsYixjLGQsZSxmKXt2YXIgZyxoO2lmKCJvYmplY3QiPT10eXBlb2YgYil7InN0cmluZyIhPXR5cGVvZiBjJiYoZD1kfHxjLGM9dm9pZCAwKTtmb3IoaCBpbiBiKXdhKGEsaCxjLGQsYltoXSxmKTtyZXR1cm4gYX1pZihudWxsPT1kJiZudWxsPT1lPyhlPWMsZD1jPXZvaWQgMCk6bnVsbD09ZSYmKCJzdHJpbmciPT10eXBlb2YgYz8oZT1kLGQ9dm9pZCAwKTooZT1kLGQ9YyxjPXZvaWQgMCkpLGU9PT0hMSllPXVhO2Vsc2UgaWYoIWUpcmV0dXJuIGE7cmV0dXJuIDE9PT1mJiYoZz1lLGU9ZnVuY3Rpb24oYSl7cmV0dXJuIHIoKS5vZmYoYSksZy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGUuZ3VpZD1nLmd1aWR8fChnLmd1aWQ9ci5ndWlkKyspKSxhLmVhY2goZnVuY3Rpb24oKXtyLmV2ZW50LmFkZCh0aGlzLGIsZSxkLGMpfSl9ci5ldmVudD17Z2xvYmFsOnt9LGFkZDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmLGcsaCxpLGosayxsLG0sbixvLHAscT1WLmdldChhKTtpZihxKXtjLmhhbmRsZXImJihmPWMsYz1mLmhhbmRsZXIsZT1mLnNlbGVjdG9yKSxlJiZyLmZpbmQubWF0Y2hlc1NlbGVjdG9yKHBhLGUpLGMuZ3VpZHx8KGMuZ3VpZD1yLmd1aWQrKyksKGk9cS5ldmVudHMpfHwoaT1xLmV2ZW50cz17fSksKGc9cS5oYW5kbGUpfHwoZz1xLmhhbmRsZT1mdW5jdGlvbihiKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIHImJnIuZXZlbnQudHJpZ2dlcmVkIT09Yi50eXBlP3IuZXZlbnQuZGlzcGF0Y2guYXBwbHkoYSxhcmd1bWVudHMpOnZvaWQgMH0pLGI9KGJ8fCIiKS5tYXRjaChLKXx8WyIiXSxqPWIubGVuZ3RoO3doaWxlKGotLSloPXNhLmV4ZWMoYltqXSl8fFtdLG49cD1oWzFdLG89KGhbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxuJiYobD1yLmV2ZW50LnNwZWNpYWxbbl18fHt9LG49KGU/bC5kZWxlZ2F0ZVR5cGU6bC5iaW5kVHlwZSl8fG4sbD1yLmV2ZW50LnNwZWNpYWxbbl18fHt9LGs9ci5leHRlbmQoe3R5cGU6bixvcmlnVHlwZTpwLGRhdGE6ZCxoYW5kbGVyOmMsZ3VpZDpjLmd1aWQsc2VsZWN0b3I6ZSxuZWVkc0NvbnRleHQ6ZSYmci5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGUpLG5hbWVzcGFjZTpvLmpvaW4oIi4iKX0sZiksKG09aVtuXSl8fChtPWlbbl09W10sbS5kZWxlZ2F0ZUNvdW50PTAsbC5zZXR1cCYmbC5zZXR1cC5jYWxsKGEsZCxvLGcpIT09ITF8fGEuYWRkRXZlbnRMaXN0ZW5lciYmYS5hZGRFdmVudExpc3RlbmVyKG4sZykpLGwuYWRkJiYobC5hZGQuY2FsbChhLGspLGsuaGFuZGxlci5ndWlkfHwoay5oYW5kbGVyLmd1aWQ9Yy5ndWlkKSksZT9tLnNwbGljZShtLmRlbGVnYXRlQ291bnQrKywwLGspOm0ucHVzaChrKSxyLmV2ZW50Lmdsb2JhbFtuXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZixnLGgsaSxqLGssbCxtLG4sbyxwLHE9Vi5oYXNEYXRhKGEpJiZWLmdldChhKTtpZihxJiYoaT1xLmV2ZW50cykpe2I9KGJ8fCIiKS5tYXRjaChLKXx8WyIiXSxqPWIubGVuZ3RoO3doaWxlKGotLSlpZihoPXNhLmV4ZWMoYltqXSl8fFtdLG49cD1oWzFdLG89KGhbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxuKXtsPXIuZXZlbnQuc3BlY2lhbFtuXXx8e30sbj0oZD9sLmRlbGVnYXRlVHlwZTpsLmJpbmRUeXBlKXx8bixtPWlbbl18fFtdLGg9aFsyXSYmbmV3IFJlZ0V4cCgiKF58XFwuKSIrby5qb2luKCJcXC4oPzouKlxcLnwpIikrIihcXC58JCkiKSxnPWY9bS5sZW5ndGg7d2hpbGUoZi0tKWs9bVtmXSwhZSYmcCE9PWsub3JpZ1R5cGV8fGMmJmMuZ3VpZCE9PWsuZ3VpZHx8aCYmIWgudGVzdChrLm5hbWVzcGFjZSl8fGQmJmQhPT1rLnNlbGVjdG9yJiYoIioqIiE9PWR8fCFrLnNlbGVjdG9yKXx8KG0uc3BsaWNlKGYsMSksay5zZWxlY3RvciYmbS5kZWxlZ2F0ZUNvdW50LS0sbC5yZW1vdmUmJmwucmVtb3ZlLmNhbGwoYSxrKSk7ZyYmIW0ubGVuZ3RoJiYobC50ZWFyZG93biYmbC50ZWFyZG93bi5jYWxsKGEsbyxxLmhhbmRsZSkhPT0hMXx8ci5yZW1vdmVFdmVudChhLG4scS5oYW5kbGUpLGRlbGV0ZSBpW25dKX1lbHNlIGZvcihuIGluIGkpci5ldmVudC5yZW1vdmUoYSxuK2Jbal0sYyxkLCEwKTtyLmlzRW1wdHlPYmplY3QoaSkmJlYucmVtb3ZlKGEsImhhbmRsZSBldmVudHMiKX19LGRpc3BhdGNoOmZ1bmN0aW9uKGEpe3ZhciBiPXIuZXZlbnQuZml4KGEpLGMsZCxlLGYsZyxoLGk9bmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLGo9KFYuZ2V0KHRoaXMsImV2ZW50cyIpfHx7fSlbYi50eXBlXXx8W10saz1yLmV2ZW50LnNwZWNpYWxbYi50eXBlXXx8e307Zm9yKGlbMF09YixjPTE7Yzxhcmd1bWVudHMubGVuZ3RoO2MrKylpW2NdPWFyZ3VtZW50c1tjXTtpZihiLmRlbGVnYXRlVGFyZ2V0PXRoaXMsIWsucHJlRGlzcGF0Y2h8fGsucHJlRGlzcGF0Y2guY2FsbCh0aGlzLGIpIT09ITEpe2g9ci5ldmVudC5oYW5kbGVycy5jYWxsKHRoaXMsYixqKSxjPTA7d2hpbGUoKGY9aFtjKytdKSYmIWIuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSl7Yi5jdXJyZW50VGFyZ2V0PWYuZWxlbSxkPTA7d2hpbGUoKGc9Zi5oYW5kbGVyc1tkKytdKSYmIWIuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSliLnJuYW1lc3BhY2UmJiFiLnJuYW1lc3BhY2UudGVzdChnLm5hbWVzcGFjZSl8fChiLmhhbmRsZU9iaj1nLGIuZGF0YT1nLmRhdGEsZT0oKHIuZXZlbnQuc3BlY2lhbFtnLm9yaWdUeXBlXXx8e30pLmhhbmRsZXx8Zy5oYW5kbGVyKS5hcHBseShmLmVsZW0saSksdm9pZCAwIT09ZSYmKGIucmVzdWx0PWUpPT09ITEmJihiLnByZXZlbnREZWZhdWx0KCksYi5zdG9wUHJvcGFnYXRpb24oKSkpfXJldHVybiBrLnBvc3REaXNwYXRjaCYmay5wb3N0RGlzcGF0Y2guY2FsbCh0aGlzLGIpLGIucmVzdWx0fX0saGFuZGxlcnM6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZixnPVtdLGg9Yi5kZWxlZ2F0ZUNvdW50LGk9YS50YXJnZXQ7aWYoaCYmaS5ub2RlVHlwZSYmKCJjbGljayIhPT1hLnR5cGV8fGlzTmFOKGEuYnV0dG9uKXx8YS5idXR0b248MSkpZm9yKDtpIT09dGhpcztpPWkucGFyZW50Tm9kZXx8dGhpcylpZigxPT09aS5ub2RlVHlwZSYmKGkuZGlzYWJsZWQhPT0hMHx8ImNsaWNrIiE9PWEudHlwZSkpe2ZvcihkPVtdLGM9MDtjPGg7YysrKWY9YltjXSxlPWYuc2VsZWN0b3IrIiAiLHZvaWQgMD09PWRbZV0mJihkW2VdPWYubmVlZHNDb250ZXh0P3IoZSx0aGlzKS5pbmRleChpKT4tMTpyLmZpbmQoZSx0aGlzLG51bGwsW2ldKS5sZW5ndGgpLGRbZV0mJmQucHVzaChmKTtkLmxlbmd0aCYmZy5wdXNoKHtlbGVtOmksaGFuZGxlcnM6ZH0pfXJldHVybiBoPGIubGVuZ3RoJiZnLnB1c2goe2VsZW06dGhpcyxoYW5kbGVyczpiLnNsaWNlKGgpfSksZ30sYWRkUHJvcDpmdW5jdGlvbihhLGIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShyLkV2ZW50LnByb3RvdHlwZSxhLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCxnZXQ6ci5pc0Z1bmN0aW9uKGIpP2Z1bmN0aW9uKCl7aWYodGhpcy5vcmlnaW5hbEV2ZW50KXJldHVybiBiKHRoaXMub3JpZ2luYWxFdmVudCl9OmZ1bmN0aW9uKCl7aWYodGhpcy5vcmlnaW5hbEV2ZW50KXJldHVybiB0aGlzLm9yaWdpbmFsRXZlbnRbYV19LHNldDpmdW5jdGlvbihiKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxhLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTpifSl9fSl9LGZpeDpmdW5jdGlvbihhKXtyZXR1cm4gYVtyLmV4cGFuZG9dP2E6bmV3IHIuRXZlbnQoYSl9LHNwZWNpYWw6e2xvYWQ6e25vQnViYmxlOiEwfSxmb2N1czp7dHJpZ2dlcjpmdW5jdGlvbigpe2lmKHRoaXMhPT12YSgpJiZ0aGlzLmZvY3VzKXJldHVybiB0aGlzLmZvY3VzKCksITF9LGRlbGVnYXRlVHlwZToiZm9jdXNpbiJ9LGJsdXI6e3RyaWdnZXI6ZnVuY3Rpb24oKXtpZih0aGlzPT09dmEoKSYmdGhpcy5ibHVyKXJldHVybiB0aGlzLmJsdXIoKSwhMX0sZGVsZWdhdGVUeXBlOiJmb2N1c291dCJ9LGNsaWNrOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7aWYoImNoZWNrYm94Ij09PXRoaXMudHlwZSYmdGhpcy5jbGljayYmci5ub2RlTmFtZSh0aGlzLCJpbnB1dCIpKXJldHVybiB0aGlzLmNsaWNrKCksITF9LF9kZWZhdWx0OmZ1bmN0aW9uKGEpe3JldHVybiByLm5vZGVOYW1lKGEudGFyZ2V0LCJhIil9fSxiZWZvcmV1bmxvYWQ6e3Bvc3REaXNwYXRjaDpmdW5jdGlvbihhKXt2b2lkIDAhPT1hLnJlc3VsdCYmYS5vcmlnaW5hbEV2ZW50JiYoYS5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlPWEucmVzdWx0KX19fX0sci5yZW1vdmVFdmVudD1mdW5jdGlvbihhLGIsYyl7YS5yZW1vdmVFdmVudExpc3RlbmVyJiZhLnJlbW92ZUV2ZW50TGlzdGVuZXIoYixjKX0sci5FdmVudD1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzIGluc3RhbmNlb2Ygci5FdmVudD8oYSYmYS50eXBlPyh0aGlzLm9yaWdpbmFsRXZlbnQ9YSx0aGlzLnR5cGU9YS50eXBlLHRoaXMuaXNEZWZhdWx0UHJldmVudGVkPWEuZGVmYXVsdFByZXZlbnRlZHx8dm9pZCAwPT09YS5kZWZhdWx0UHJldmVudGVkJiZhLnJldHVyblZhbHVlPT09ITE/dGE6dWEsdGhpcy50YXJnZXQ9YS50YXJnZXQmJjM9PT1hLnRhcmdldC5ub2RlVHlwZT9hLnRhcmdldC5wYXJlbnROb2RlOmEudGFyZ2V0LHRoaXMuY3VycmVudFRhcmdldD1hLmN1cnJlbnRUYXJnZXQsdGhpcy5yZWxhdGVkVGFyZ2V0PWEucmVsYXRlZFRhcmdldCk6dGhpcy50eXBlPWEsYiYmci5leHRlbmQodGhpcyxiKSx0aGlzLnRpbWVTdGFtcD1hJiZhLnRpbWVTdGFtcHx8ci5ub3coKSx2b2lkKHRoaXNbci5leHBhbmRvXT0hMCkpOm5ldyByLkV2ZW50KGEsYil9LHIuRXZlbnQucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpyLkV2ZW50LGlzRGVmYXVsdFByZXZlbnRlZDp1YSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDp1YSxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDp1YSxpc1NpbXVsYXRlZDohMSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD10YSxhJiYhdGhpcy5pc1NpbXVsYXRlZCYmYS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD10YSxhJiYhdGhpcy5pc1NpbXVsYXRlZCYmYS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9dGEsYSYmIXRoaXMuaXNTaW11bGF0ZWQmJmEuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5zdG9wUHJvcGFnYXRpb24oKX19LHIuZWFjaCh7YWx0S2V5OiEwLGJ1YmJsZXM6ITAsY2FuY2VsYWJsZTohMCxjaGFuZ2VkVG91Y2hlczohMCxjdHJsS2V5OiEwLGRldGFpbDohMCxldmVudFBoYXNlOiEwLG1ldGFLZXk6ITAscGFnZVg6ITAscGFnZVk6ITAsc2hpZnRLZXk6ITAsdmlldzohMCwiY2hhciI6ITAsY2hhckNvZGU6ITAsa2V5OiEwLGtleUNvZGU6ITAsYnV0dG9uOiEwLGJ1dHRvbnM6ITAsY2xpZW50WDohMCxjbGllbnRZOiEwLG9mZnNldFg6ITAsb2Zmc2V0WTohMCxwb2ludGVySWQ6ITAscG9pbnRlclR5cGU6ITAsc2NyZWVuWDohMCxzY3JlZW5ZOiEwLHRhcmdldFRvdWNoZXM6ITAsdG9FbGVtZW50OiEwLHRvdWNoZXM6ITAsd2hpY2g6ZnVuY3Rpb24oYSl7dmFyIGI9YS5idXR0b247cmV0dXJuIG51bGw9PWEud2hpY2gmJnFhLnRlc3QoYS50eXBlKT9udWxsIT1hLmNoYXJDb2RlP2EuY2hhckNvZGU6YS5rZXlDb2RlOiFhLndoaWNoJiZ2b2lkIDAhPT1iJiZyYS50ZXN0KGEudHlwZSk/MSZiPzE6MiZiPzM6NCZiPzI6MDphLndoaWNofX0sci5ldmVudC5hZGRQcm9wKSxyLmVhY2goe21vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQiLHBvaW50ZXJlbnRlcjoicG9pbnRlcm92ZXIiLHBvaW50ZXJsZWF2ZToicG9pbnRlcm91dCJ9LGZ1bmN0aW9uKGEsYil7ci5ldmVudC5zcGVjaWFsW2FdPXtkZWxlZ2F0ZVR5cGU6YixiaW5kVHlwZTpiLGhhbmRsZTpmdW5jdGlvbihhKXt2YXIgYyxkPXRoaXMsZT1hLnJlbGF0ZWRUYXJnZXQsZj1hLmhhbmRsZU9iajtyZXR1cm4gZSYmKGU9PT1kfHxyLmNvbnRhaW5zKGQsZSkpfHwoYS50eXBlPWYub3JpZ1R5cGUsYz1mLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGEudHlwZT1iKSxjfX19KSxyLmZuLmV4dGVuZCh7b246ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHdhKHRoaXMsYSxiLGMsZCl9LG9uZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gd2EodGhpcyxhLGIsYyxkLDEpfSxvZmY6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU7aWYoYSYmYS5wcmV2ZW50RGVmYXVsdCYmYS5oYW5kbGVPYmopcmV0dXJuIGQ9YS5oYW5kbGVPYmoscihhLmRlbGVnYXRlVGFyZ2V0KS5vZmYoZC5uYW1lc3BhY2U/ZC5vcmlnVHlwZSsiLiIrZC5uYW1lc3BhY2U6ZC5vcmlnVHlwZSxkLnNlbGVjdG9yLGQuaGFuZGxlciksdGhpcztpZigib2JqZWN0Ij09dHlwZW9mIGEpe2ZvcihlIGluIGEpdGhpcy5vZmYoZSxiLGFbZV0pO3JldHVybiB0aGlzfXJldHVybiBiIT09ITEmJiJmdW5jdGlvbiIhPXR5cGVvZiBifHwoYz1iLGI9dm9pZCAwKSxjPT09ITEmJihjPXVhKSx0aGlzLmVhY2goZnVuY3Rpb24oKXtyLmV2ZW50LnJlbW92ZSh0aGlzLGEsYyxiKX0pfX0pO3ZhciB4YT0vPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbYS16XVteXC9cMD5ceDIwXHRcclxuXGZdKilbXj5dKilcLz4vZ2kseWE9LzxzY3JpcHR8PHN0eWxlfDxsaW5rL2ksemE9L2NoZWNrZWRccyooPzpbXj1dfD1ccyouY2hlY2tlZC4pL2ksQWE9L150cnVlXC8oLiopLyxCYT0vXlxzKjwhKD86XFtDREFUQVxbfC0tKXwoPzpcXVxdfC0tKT5ccyokL2c7ZnVuY3Rpb24gQ2EoYSxiKXtyZXR1cm4gci5ub2RlTmFtZShhLCJ0YWJsZSIpJiZyLm5vZGVOYW1lKDExIT09Yi5ub2RlVHlwZT9iOmIuZmlyc3RDaGlsZCwidHIiKT9hLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpWzBdfHxhOmF9ZnVuY3Rpb24gRGEoYSl7cmV0dXJuIGEudHlwZT0obnVsbCE9PWEuZ2V0QXR0cmlidXRlKCJ0eXBlIikpKyIvIithLnR5cGUsYX1mdW5jdGlvbiBFYShhKXt2YXIgYj1BYS5leGVjKGEudHlwZSk7cmV0dXJuIGI/YS50eXBlPWJbMV06YS5yZW1vdmVBdHRyaWJ1dGUoInR5cGUiKSxhfWZ1bmN0aW9uIEZhKGEsYil7dmFyIGMsZCxlLGYsZyxoLGksajtpZigxPT09Yi5ub2RlVHlwZSl7aWYoVi5oYXNEYXRhKGEpJiYoZj1WLmFjY2VzcyhhKSxnPVYuc2V0KGIsZiksaj1mLmV2ZW50cykpe2RlbGV0ZSBnLmhhbmRsZSxnLmV2ZW50cz17fTtmb3IoZSBpbiBqKWZvcihjPTAsZD1qW2VdLmxlbmd0aDtjPGQ7YysrKXIuZXZlbnQuYWRkKGIsZSxqW2VdW2NdKX1XLmhhc0RhdGEoYSkmJihoPVcuYWNjZXNzKGEpLGk9ci5leHRlbmQoe30saCksVy5zZXQoYixpKSl9fWZ1bmN0aW9uIEdhKGEsYil7dmFyIGM9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOyJpbnB1dCI9PT1jJiZoYS50ZXN0KGEudHlwZSk/Yi5jaGVja2VkPWEuY2hlY2tlZDoiaW5wdXQiIT09YyYmInRleHRhcmVhIiE9PWN8fChiLmRlZmF1bHRWYWx1ZT1hLmRlZmF1bHRWYWx1ZSl9ZnVuY3Rpb24gSGEoYSxiLGMsZCl7Yj1nLmFwcGx5KFtdLGIpO3ZhciBlLGYsaCxpLGosayxsPTAsbT1hLmxlbmd0aCxuPW0tMSxxPWJbMF0scz1yLmlzRnVuY3Rpb24ocSk7aWYoc3x8bT4xJiYic3RyaW5nIj09dHlwZW9mIHEmJiFvLmNoZWNrQ2xvbmUmJnphLnRlc3QocSkpcmV0dXJuIGEuZWFjaChmdW5jdGlvbihlKXt2YXIgZj1hLmVxKGUpO3MmJihiWzBdPXEuY2FsbCh0aGlzLGUsZi5odG1sKCkpKSxIYShmLGIsYyxkKX0pO2lmKG0mJihlPW9hKGIsYVswXS5vd25lckRvY3VtZW50LCExLGEsZCksZj1lLmZpcnN0Q2hpbGQsMT09PWUuY2hpbGROb2Rlcy5sZW5ndGgmJihlPWYpLGZ8fGQpKXtmb3IoaD1yLm1hcChsYShlLCJzY3JpcHQiKSxEYSksaT1oLmxlbmd0aDtsPG07bCsrKWo9ZSxsIT09biYmKGo9ci5jbG9uZShqLCEwLCEwKSxpJiZyLm1lcmdlKGgsbGEoaiwic2NyaXB0IikpKSxjLmNhbGwoYVtsXSxqLGwpO2lmKGkpZm9yKGs9aFtoLmxlbmd0aC0xXS5vd25lckRvY3VtZW50LHIubWFwKGgsRWEpLGw9MDtsPGk7bCsrKWo9aFtsXSxqYS50ZXN0KGoudHlwZXx8IiIpJiYhVi5hY2Nlc3MoaiwiZ2xvYmFsRXZhbCIpJiZyLmNvbnRhaW5zKGssaikmJihqLnNyYz9yLl9ldmFsVXJsJiZyLl9ldmFsVXJsKGouc3JjKTpwKGoudGV4dENvbnRlbnQucmVwbGFjZShCYSwiIiksaykpfXJldHVybiBhfWZ1bmN0aW9uIElhKGEsYixjKXtmb3IodmFyIGQsZT1iP3IuZmlsdGVyKGIsYSk6YSxmPTA7bnVsbCE9KGQ9ZVtmXSk7ZisrKWN8fDEhPT1kLm5vZGVUeXBlfHxyLmNsZWFuRGF0YShsYShkKSksZC5wYXJlbnROb2RlJiYoYyYmci5jb250YWlucyhkLm93bmVyRG9jdW1lbnQsZCkmJm1hKGxhKGQsInNjcmlwdCIpKSxkLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZCkpO3JldHVybiBhfXIuZXh0ZW5kKHtodG1sUHJlZmlsdGVyOmZ1bmN0aW9uKGEpe3JldHVybiBhLnJlcGxhY2UoeGEsIjwkMT48LyQyPiIpfSxjbG9uZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmLGcsaD1hLmNsb25lTm9kZSghMCksaT1yLmNvbnRhaW5zKGEub3duZXJEb2N1bWVudCxhKTtpZighKG8ubm9DbG9uZUNoZWNrZWR8fDEhPT1hLm5vZGVUeXBlJiYxMSE9PWEubm9kZVR5cGV8fHIuaXNYTUxEb2MoYSkpKWZvcihnPWxhKGgpLGY9bGEoYSksZD0wLGU9Zi5sZW5ndGg7ZDxlO2QrKylHYShmW2RdLGdbZF0pO2lmKGIpaWYoYylmb3IoZj1mfHxsYShhKSxnPWd8fGxhKGgpLGQ9MCxlPWYubGVuZ3RoO2Q8ZTtkKyspRmEoZltkXSxnW2RdKTtlbHNlIEZhKGEsaCk7cmV0dXJuIGc9bGEoaCwic2NyaXB0IiksZy5sZW5ndGg+MCYmbWEoZywhaSYmbGEoYSwic2NyaXB0IikpLGh9LGNsZWFuRGF0YTpmdW5jdGlvbihhKXtmb3IodmFyIGIsYyxkLGU9ci5ldmVudC5zcGVjaWFsLGY9MDt2b2lkIDAhPT0oYz1hW2ZdKTtmKyspaWYoVChjKSl7aWYoYj1jW1YuZXhwYW5kb10pe2lmKGIuZXZlbnRzKWZvcihkIGluIGIuZXZlbnRzKWVbZF0/ci5ldmVudC5yZW1vdmUoYyxkKTpyLnJlbW92ZUV2ZW50KGMsZCxiLmhhbmRsZSk7Y1tWLmV4cGFuZG9dPXZvaWQgMH1jW1cuZXhwYW5kb10mJihjW1cuZXhwYW5kb109dm9pZCAwKX19fSksci5mbi5leHRlbmQoe2RldGFjaDpmdW5jdGlvbihhKXtyZXR1cm4gSWEodGhpcyxhLCEwKX0scmVtb3ZlOmZ1bmN0aW9uKGEpe3JldHVybiBJYSh0aGlzLGEpfSx0ZXh0OmZ1bmN0aW9uKGEpe3JldHVybiBTKHRoaXMsZnVuY3Rpb24oYSl7cmV0dXJuIHZvaWQgMD09PWE/ci50ZXh0KHRoaXMpOnRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uKCl7MSE9PXRoaXMubm9kZVR5cGUmJjExIT09dGhpcy5ub2RlVHlwZSYmOSE9PXRoaXMubm9kZVR5cGV8fCh0aGlzLnRleHRDb250ZW50PWEpfSl9LG51bGwsYSxhcmd1bWVudHMubGVuZ3RoKX0sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIEhhKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgYj1DYSh0aGlzLGEpO2IuYXBwZW5kQ2hpbGQoYSl9fSl9LHByZXBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gSGEodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oYSl7aWYoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpe3ZhciBiPUNhKHRoaXMsYSk7Yi5pbnNlcnRCZWZvcmUoYSxiLmZpcnN0Q2hpbGQpfX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtyZXR1cm4gSGEodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsdGhpcyl9KX0sYWZ0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gSGEodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsdGhpcy5uZXh0U2libGluZyl9KX0sZW1wdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGEsYj0wO251bGwhPShhPXRoaXNbYl0pO2IrKykxPT09YS5ub2RlVHlwZSYmKHIuY2xlYW5EYXRhKGxhKGEsITEpKSxhLnRleHRDb250ZW50PSIiKTtyZXR1cm4gdGhpc30sY2xvbmU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1udWxsIT1hJiZhLGI9bnVsbD09Yj9hOmIsdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gci5jbG9uZSh0aGlzLGEsYil9KX0saHRtbDpmdW5jdGlvbihhKXtyZXR1cm4gUyh0aGlzLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXNbMF18fHt9LGM9MCxkPXRoaXMubGVuZ3RoO2lmKHZvaWQgMD09PWEmJjE9PT1iLm5vZGVUeXBlKXJldHVybiBiLmlubmVySFRNTDtpZigic3RyaW5nIj09dHlwZW9mIGEmJiF5YS50ZXN0KGEpJiYha2FbKGlhLmV4ZWMoYSl8fFsiIiwiIl0pWzFdLnRvTG93ZXJDYXNlKCldKXthPXIuaHRtbFByZWZpbHRlcihhKTt0cnl7Zm9yKDtjPGQ7YysrKWI9dGhpc1tjXXx8e30sMT09PWIubm9kZVR5cGUmJihyLmNsZWFuRGF0YShsYShiLCExKSksYi5pbm5lckhUTUw9YSk7Yj0wfWNhdGNoKGUpe319YiYmdGhpcy5lbXB0eSgpLmFwcGVuZChhKX0sbnVsbCxhLGFyZ3VtZW50cy5sZW5ndGgpfSxyZXBsYWNlV2l0aDpmdW5jdGlvbigpe3ZhciBhPVtdO3JldHVybiBIYSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihiKXt2YXIgYz10aGlzLnBhcmVudE5vZGU7ci5pbkFycmF5KHRoaXMsYSk8MCYmKHIuY2xlYW5EYXRhKGxhKHRoaXMpKSxjJiZjLnJlcGxhY2VDaGlsZChiLHRoaXMpKX0sYSl9fSksci5lYWNoKHthcHBlbmRUbzoiYXBwZW5kIixwcmVwZW5kVG86InByZXBlbmQiLGluc2VydEJlZm9yZToiYmVmb3JlIixpbnNlcnRBZnRlcjoiYWZ0ZXIiLHJlcGxhY2VBbGw6InJlcGxhY2VXaXRoIn0sZnVuY3Rpb24oYSxiKXtyLmZuW2FdPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYyxkPVtdLGU9cihhKSxmPWUubGVuZ3RoLTEsZz0wO2c8PWY7ZysrKWM9Zz09PWY/dGhpczp0aGlzLmNsb25lKCEwKSxyKGVbZ10pW2JdKGMpLGguYXBwbHkoZCxjLmdldCgpKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soZCl9fSk7dmFyIEphPS9ebWFyZ2luLyxLYT1uZXcgUmVnRXhwKCJeKCIrJCsiKSg/IXB4KVthLXolXSskIiwiaSIpLExhPWZ1bmN0aW9uKGIpe3ZhciBjPWIub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldztyZXR1cm4gYyYmYy5vcGVuZXJ8fChjPWEpLGMuZ2V0Q29tcHV0ZWRTdHlsZShiKX07IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYigpe2lmKGkpe2kuc3R5bGUuY3NzVGV4dD0iYm94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7bWFyZ2luOmF1dG87Ym9yZGVyOjFweDtwYWRkaW5nOjFweDt0b3A6MSU7d2lkdGg6NTAlIixpLmlubmVySFRNTD0iIixwYS5hcHBlbmRDaGlsZChoKTt2YXIgYj1hLmdldENvbXB1dGVkU3R5bGUoaSk7Yz0iMSUiIT09Yi50b3AsZz0iMnB4Ij09PWIubWFyZ2luTGVmdCxlPSI0cHgiPT09Yi53aWR0aCxpLnN0eWxlLm1hcmdpblJpZ2h0PSI1MCUiLGY9IjRweCI9PT1iLm1hcmdpblJpZ2h0LHBhLnJlbW92ZUNoaWxkKGgpLGk9bnVsbH19dmFyIGMsZSxmLGcsaD1kLmNyZWF0ZUVsZW1lbnQoImRpdiIpLGk9ZC5jcmVhdGVFbGVtZW50KCJkaXYiKTtpLnN0eWxlJiYoaS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iY29udGVudC1ib3giLGkuY2xvbmVOb2RlKCEwKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iIixvLmNsZWFyQ2xvbmVTdHlsZT0iY29udGVudC1ib3giPT09aS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCxoLnN0eWxlLmNzc1RleHQ9ImJvcmRlcjowO3dpZHRoOjhweDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHg7cGFkZGluZzowO21hcmdpbi10b3A6MXB4O3Bvc2l0aW9uOmFic29sdXRlIixoLmFwcGVuZENoaWxkKGkpLHIuZXh0ZW5kKG8se3BpeGVsUG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm4gYigpLGN9LGJveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIGIoKSxlfSxwaXhlbE1hcmdpblJpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIGIoKSxmfSxyZWxpYWJsZU1hcmdpbkxlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gYigpLGd9fSkpfSgpO2Z1bmN0aW9uIE1hKGEsYixjKXt2YXIgZCxlLGYsZyxoPWEuc3R5bGU7cmV0dXJuIGM9Y3x8TGEoYSksYyYmKGc9Yy5nZXRQcm9wZXJ0eVZhbHVlKGIpfHxjW2JdLCIiIT09Z3x8ci5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSl8fChnPXIuc3R5bGUoYSxiKSksIW8ucGl4ZWxNYXJnaW5SaWdodCgpJiZLYS50ZXN0KGcpJiZKYS50ZXN0KGIpJiYoZD1oLndpZHRoLGU9aC5taW5XaWR0aCxmPWgubWF4V2lkdGgsaC5taW5XaWR0aD1oLm1heFdpZHRoPWgud2lkdGg9ZyxnPWMud2lkdGgsaC53aWR0aD1kLGgubWluV2lkdGg9ZSxoLm1heFdpZHRoPWYpKSx2b2lkIDAhPT1nP2crIiI6Z31mdW5jdGlvbiBOYShhLGIpe3JldHVybntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYSgpP3ZvaWQgZGVsZXRlIHRoaXMuZ2V0Oih0aGlzLmdldD1iKS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fX12YXIgT2E9L14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLFBhPXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxRYT17bGV0dGVyU3BhY2luZzoiMCIsZm9udFdlaWdodDoiNDAwIn0sUmE9WyJXZWJraXQiLCJNb3oiLCJtcyJdLFNhPWQuY3JlYXRlRWxlbWVudCgiZGl2Iikuc3R5bGU7ZnVuY3Rpb24gVGEoYSl7aWYoYSBpbiBTYSlyZXR1cm4gYTt2YXIgYj1hWzBdLnRvVXBwZXJDYXNlKCkrYS5zbGljZSgxKSxjPVJhLmxlbmd0aDt3aGlsZShjLS0paWYoYT1SYVtjXStiLGEgaW4gU2EpcmV0dXJuIGF9ZnVuY3Rpb24gVWEoYSxiLGMpe3ZhciBkPV8uZXhlYyhiKTtyZXR1cm4gZD9NYXRoLm1heCgwLGRbMl0tKGN8fDApKSsoZFszXXx8InB4Iik6Yn1mdW5jdGlvbiBWYShhLGIsYyxkLGUpe2Zvcih2YXIgZj1jPT09KGQ/ImJvcmRlciI6ImNvbnRlbnQiKT80OiJ3aWR0aCI9PT1iPzE6MCxnPTA7Zjw0O2YrPTIpIm1hcmdpbiI9PT1jJiYoZys9ci5jc3MoYSxjK2FhW2ZdLCEwLGUpKSxkPygiY29udGVudCI9PT1jJiYoZy09ci5jc3MoYSwicGFkZGluZyIrYWFbZl0sITAsZSkpLCJtYXJnaW4iIT09YyYmKGctPXIuY3NzKGEsImJvcmRlciIrYWFbZl0rIldpZHRoIiwhMCxlKSkpOihnKz1yLmNzcyhhLCJwYWRkaW5nIithYVtmXSwhMCxlKSwicGFkZGluZyIhPT1jJiYoZys9ci5jc3MoYSwiYm9yZGVyIithYVtmXSsiV2lkdGgiLCEwLGUpKSk7cmV0dXJuIGd9ZnVuY3Rpb24gV2EoYSxiLGMpe3ZhciBkLGU9ITAsZj1MYShhKSxnPSJib3JkZXItYm94Ij09PXIuY3NzKGEsImJveFNpemluZyIsITEsZik7aWYoYS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCYmKGQ9YS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVtiXSksZDw9MHx8bnVsbD09ZCl7aWYoZD1NYShhLGIsZiksKGQ8MHx8bnVsbD09ZCkmJihkPWEuc3R5bGVbYl0pLEthLnRlc3QoZCkpcmV0dXJuIGQ7ZT1nJiYoby5ib3hTaXppbmdSZWxpYWJsZSgpfHxkPT09YS5zdHlsZVtiXSksZD1wYXJzZUZsb2F0KGQpfHwwfXJldHVybiBkK1ZhKGEsYixjfHwoZz8iYm9yZGVyIjoiY29udGVudCIpLGUsZikrInB4In1yLmV4dGVuZCh7Y3NzSG9va3M6e29wYWNpdHk6e2dldDpmdW5jdGlvbihhLGIpe2lmKGIpe3ZhciBjPU1hKGEsIm9wYWNpdHkiKTtyZXR1cm4iIj09PWM/IjEiOmN9fX19LGNzc051bWJlcjp7YW5pbWF0aW9uSXRlcmF0aW9uQ291bnQ6ITAsY29sdW1uQ291bnQ6ITAsZmlsbE9wYWNpdHk6ITAsZmxleEdyb3c6ITAsZmxleFNocmluazohMCxmb250V2VpZ2h0OiEwLGxpbmVIZWlnaHQ6ITAsb3BhY2l0eTohMCxvcmRlcjohMCxvcnBoYW5zOiEwLHdpZG93czohMCx6SW5kZXg6ITAsem9vbTohMH0sY3NzUHJvcHM6eyJmbG9hdCI6ImNzc0Zsb2F0In0sc3R5bGU6ZnVuY3Rpb24oYSxiLGMsZCl7aWYoYSYmMyE9PWEubm9kZVR5cGUmJjghPT1hLm5vZGVUeXBlJiZhLnN0eWxlKXt2YXIgZSxmLGcsaD1yLmNhbWVsQ2FzZShiKSxpPWEuc3R5bGU7cmV0dXJuIGI9ci5jc3NQcm9wc1toXXx8KHIuY3NzUHJvcHNbaF09VGEoaCl8fGgpLGc9ci5jc3NIb29rc1tiXXx8ci5jc3NIb29rc1toXSx2b2lkIDA9PT1jP2cmJiJnZXQiaW4gZyYmdm9pZCAwIT09KGU9Zy5nZXQoYSwhMSxkKSk/ZTppW2JdOihmPXR5cGVvZiBjLCJzdHJpbmciPT09ZiYmKGU9Xy5leGVjKGMpKSYmZVsxXSYmKGM9ZGEoYSxiLGUpLGY9Im51bWJlciIpLG51bGwhPWMmJmM9PT1jJiYoIm51bWJlciI9PT1mJiYoYys9ZSYmZVszXXx8KHIuY3NzTnVtYmVyW2hdPyIiOiJweCIpKSxvLmNsZWFyQ2xvbmVTdHlsZXx8IiIhPT1jfHwwIT09Yi5pbmRleE9mKCJiYWNrZ3JvdW5kIil8fChpW2JdPSJpbmhlcml0IiksZyYmInNldCJpbiBnJiZ2b2lkIDA9PT0oYz1nLnNldChhLGMsZCkpfHwoaVtiXT1jKSksdm9pZCAwKX19LGNzczpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZSxmLGcsaD1yLmNhbWVsQ2FzZShiKTtyZXR1cm4gYj1yLmNzc1Byb3BzW2hdfHwoci5jc3NQcm9wc1toXT1UYShoKXx8aCksZz1yLmNzc0hvb2tzW2JdfHxyLmNzc0hvb2tzW2hdLGcmJiJnZXQiaW4gZyYmKGU9Zy5nZXQoYSwhMCxjKSksdm9pZCAwPT09ZSYmKGU9TWEoYSxiLGQpKSwibm9ybWFsIj09PWUmJmIgaW4gUWEmJihlPVFhW2JdKSwiIj09PWN8fGM/KGY9cGFyc2VGbG9hdChlKSxjPT09ITB8fGlzRmluaXRlKGYpP2Z8fDA6ZSk6ZX19KSxyLmVhY2goWyJoZWlnaHQiLCJ3aWR0aCJdLGZ1bmN0aW9uKGEsYil7ci5jc3NIb29rc1tiXT17Z2V0OmZ1bmN0aW9uKGEsYyxkKXtpZihjKXJldHVybiFPYS50ZXN0KHIuY3NzKGEsImRpc3BsYXkiKSl8fGEuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgmJmEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg/V2EoYSxiLGQpOmNhKGEsUGEsZnVuY3Rpb24oKXtyZXR1cm4gV2EoYSxiLGQpfSl9LHNldDpmdW5jdGlvbihhLGMsZCl7dmFyIGUsZj1kJiZMYShhKSxnPWQmJlZhKGEsYixkLCJib3JkZXItYm94Ij09PXIuY3NzKGEsImJveFNpemluZyIsITEsZiksZik7cmV0dXJuIGcmJihlPV8uZXhlYyhjKSkmJiJweCIhPT0oZVszXXx8InB4IikmJihhLnN0eWxlW2JdPWMsYz1yLmNzcyhhLGIpKSxVYShhLGMsZyl9fX0pLHIuY3NzSG9va3MubWFyZ2luTGVmdD1OYShvLnJlbGlhYmxlTWFyZ2luTGVmdCxmdW5jdGlvbihhLGIpe2lmKGIpcmV0dXJuKHBhcnNlRmxvYXQoTWEoYSwibWFyZ2luTGVmdCIpKXx8YS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0LWNhKGEse21hcmdpbkxlZnQ6MH0sZnVuY3Rpb24oKXtyZXR1cm4gYS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0fSkpKyJweCJ9KSxyLmVhY2goe21hcmdpbjoiIixwYWRkaW5nOiIiLGJvcmRlcjoiV2lkdGgifSxmdW5jdGlvbihhLGIpe3IuY3NzSG9va3NbYStiXT17ZXhwYW5kOmZ1bmN0aW9uKGMpe2Zvcih2YXIgZD0wLGU9e30sZj0ic3RyaW5nIj09dHlwZW9mIGM/Yy5zcGxpdCgiICIpOltjXTtkPDQ7ZCsrKWVbYSthYVtkXStiXT1mW2RdfHxmW2QtMl18fGZbMF07cmV0dXJuIGV9fSxKYS50ZXN0KGEpfHwoci5jc3NIb29rc1thK2JdLnNldD1VYSl9KSxyLmZuLmV4dGVuZCh7Y3NzOmZ1bmN0aW9uKGEsYil7cmV0dXJuIFModGhpcyxmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmPXt9LGc9MDtpZihyLmlzQXJyYXkoYikpe2ZvcihkPUxhKGEpLGU9Yi5sZW5ndGg7ZzxlO2crKylmW2JbZ11dPXIuY3NzKGEsYltnXSwhMSxkKTtyZXR1cm4gZn1yZXR1cm4gdm9pZCAwIT09Yz9yLnN0eWxlKGEsYixjKTpyLmNzcyhhLGIpfSxhLGIsYXJndW1lbnRzLmxlbmd0aD4xKX19KTtmdW5jdGlvbiBYYShhLGIsYyxkLGUpe3JldHVybiBuZXcgWGEucHJvdG90eXBlLmluaXQoYSxiLGMsZCxlKX1yLlR3ZWVuPVhhLFhhLnByb3RvdHlwZT17Y29uc3RydWN0b3I6WGEsaW5pdDpmdW5jdGlvbihhLGIsYyxkLGUsZil7dGhpcy5lbGVtPWEsdGhpcy5wcm9wPWMsdGhpcy5lYXNpbmc9ZXx8ci5lYXNpbmcuX2RlZmF1bHQsdGhpcy5vcHRpb25zPWIsdGhpcy5zdGFydD10aGlzLm5vdz10aGlzLmN1cigpLHRoaXMuZW5kPWQsdGhpcy51bml0PWZ8fChyLmNzc051bWJlcltjXT8iIjoicHgiKX0sY3VyOmZ1bmN0aW9uKCl7dmFyIGE9WGEucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIGEmJmEuZ2V0P2EuZ2V0KHRoaXMpOlhhLnByb3BIb29rcy5fZGVmYXVsdC5nZXQodGhpcyl9LHJ1bjpmdW5jdGlvbihhKXt2YXIgYixjPVhhLnByb3BIb29rc1t0aGlzLnByb3BdO3JldHVybiB0aGlzLm9wdGlvbnMuZHVyYXRpb24/dGhpcy5wb3M9Yj1yLmVhc2luZ1t0aGlzLmVhc2luZ10oYSx0aGlzLm9wdGlvbnMuZHVyYXRpb24qYSwwLDEsdGhpcy5vcHRpb25zLmR1cmF0aW9uKTp0aGlzLnBvcz1iPWEsdGhpcy5ub3c9KHRoaXMuZW5kLXRoaXMuc3RhcnQpKmIrdGhpcy5zdGFydCx0aGlzLm9wdGlvbnMuc3RlcCYmdGhpcy5vcHRpb25zLnN0ZXAuY2FsbCh0aGlzLmVsZW0sdGhpcy5ub3csdGhpcyksYyYmYy5zZXQ/Yy5zZXQodGhpcyk6WGEucHJvcEhvb2tzLl9kZWZhdWx0LnNldCh0aGlzKSx0aGlzfX0sWGEucHJvdG90eXBlLmluaXQucHJvdG90eXBlPVhhLnByb3RvdHlwZSxYYS5wcm9wSG9va3M9e19kZWZhdWx0OntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI7cmV0dXJuIDEhPT1hLmVsZW0ubm9kZVR5cGV8fG51bGwhPWEuZWxlbVthLnByb3BdJiZudWxsPT1hLmVsZW0uc3R5bGVbYS5wcm9wXT9hLmVsZW1bYS5wcm9wXTooYj1yLmNzcyhhLmVsZW0sYS5wcm9wLCIiKSxiJiYiYXV0byIhPT1iP2I6MCl9LHNldDpmdW5jdGlvbihhKXtyLmZ4LnN0ZXBbYS5wcm9wXT9yLmZ4LnN0ZXBbYS5wcm9wXShhKToxIT09YS5lbGVtLm5vZGVUeXBlfHxudWxsPT1hLmVsZW0uc3R5bGVbci5jc3NQcm9wc1thLnByb3BdXSYmIXIuY3NzSG9va3NbYS5wcm9wXT9hLmVsZW1bYS5wcm9wXT1hLm5vdzpyLnN0eWxlKGEuZWxlbSxhLnByb3AsYS5ub3crYS51bml0KX19fSxYYS5wcm9wSG9va3Muc2Nyb2xsVG9wPVhhLnByb3BIb29rcy5zY3JvbGxMZWZ0PXtzZXQ6ZnVuY3Rpb24oYSl7YS5lbGVtLm5vZGVUeXBlJiZhLmVsZW0ucGFyZW50Tm9kZSYmKGEuZWxlbVthLnByb3BdPWEubm93KX19LHIuZWFzaW5nPXtsaW5lYXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGF9LHN3aW5nOmZ1bmN0aW9uKGEpe3JldHVybi41LU1hdGguY29zKGEqTWF0aC5QSSkvMn0sX2RlZmF1bHQ6InN3aW5nIn0sci5meD1YYS5wcm90b3R5cGUuaW5pdCxyLmZ4LnN0ZXA9e307dmFyIFlhLFphLCRhPS9eKD86dG9nZ2xlfHNob3d8aGlkZSkkLyxfYT0vcXVldWVIb29rcyQvO2Z1bmN0aW9uIGFiKCl7WmEmJihhLnJlcXVlc3RBbmltYXRpb25GcmFtZShhYiksci5meC50aWNrKCkpfWZ1bmN0aW9uIGJiKCl7cmV0dXJuIGEuc2V0VGltZW91dChmdW5jdGlvbigpe1lhPXZvaWQgMH0pLFlhPXIubm93KCl9ZnVuY3Rpb24gY2IoYSxiKXt2YXIgYyxkPTAsZT17aGVpZ2h0OmF9O2ZvcihiPWI/MTowO2Q8NDtkKz0yLWIpYz1hYVtkXSxlWyJtYXJnaW4iK2NdPWVbInBhZGRpbmciK2NdPWE7cmV0dXJuIGImJihlLm9wYWNpdHk9ZS53aWR0aD1hKSxlfWZ1bmN0aW9uIGRiKGEsYixjKXtmb3IodmFyIGQsZT0oZ2IudHdlZW5lcnNbYl18fFtdKS5jb25jYXQoZ2IudHdlZW5lcnNbIioiXSksZj0wLGc9ZS5sZW5ndGg7ZjxnO2YrKylpZihkPWVbZl0uY2FsbChjLGIsYSkpcmV0dXJuIGR9ZnVuY3Rpb24gZWIoYSxiLGMpe3ZhciBkLGUsZixnLGgsaSxqLGssbD0id2lkdGgiaW4gYnx8ImhlaWdodCJpbiBiLG09dGhpcyxuPXt9LG89YS5zdHlsZSxwPWEubm9kZVR5cGUmJmJhKGEpLHE9Vi5nZXQoYSwiZnhzaG93Iik7Yy5xdWV1ZXx8KGc9ci5fcXVldWVIb29rcyhhLCJmeCIpLG51bGw9PWcudW5xdWV1ZWQmJihnLnVucXVldWVkPTAsaD1nLmVtcHR5LmZpcmUsZy5lbXB0eS5maXJlPWZ1bmN0aW9uKCl7Zy51bnF1ZXVlZHx8aCgpfSksZy51bnF1ZXVlZCsrLG0uYWx3YXlzKGZ1bmN0aW9uKCl7bS5hbHdheXMoZnVuY3Rpb24oKXtnLnVucXVldWVkLS0sci5xdWV1ZShhLCJmeCIpLmxlbmd0aHx8Zy5lbXB0eS5maXJlKCl9KX0pKTtmb3IoZCBpbiBiKWlmKGU9YltkXSwkYS50ZXN0KGUpKXtpZihkZWxldGUgYltkXSxmPWZ8fCJ0b2dnbGUiPT09ZSxlPT09KHA/ImhpZGUiOiJzaG93Iikpe2lmKCJzaG93IiE9PWV8fCFxfHx2b2lkIDA9PT1xW2RdKWNvbnRpbnVlO3A9ITB9bltkXT1xJiZxW2RdfHxyLnN0eWxlKGEsZCl9aWYoaT0hci5pc0VtcHR5T2JqZWN0KGIpLGl8fCFyLmlzRW1wdHlPYmplY3Qobikpe2wmJjE9PT1hLm5vZGVUeXBlJiYoYy5vdmVyZmxvdz1bby5vdmVyZmxvdyxvLm92ZXJmbG93WCxvLm92ZXJmbG93WV0saj1xJiZxLmRpc3BsYXksbnVsbD09aiYmKGo9Vi5nZXQoYSwiZGlzcGxheSIpKSxrPXIuY3NzKGEsImRpc3BsYXkiKSwibm9uZSI9PT1rJiYoaj9rPWo6KGdhKFthXSwhMCksaj1hLnN0eWxlLmRpc3BsYXl8fGosaz1yLmNzcyhhLCJkaXNwbGF5IiksZ2EoW2FdKSkpLCgiaW5saW5lIj09PWt8fCJpbmxpbmUtYmxvY2siPT09ayYmbnVsbCE9aikmJiJub25lIj09PXIuY3NzKGEsImZsb2F0IikmJihpfHwobS5kb25lKGZ1bmN0aW9uKCl7by5kaXNwbGF5PWp9KSxudWxsPT1qJiYoaz1vLmRpc3BsYXksaj0ibm9uZSI9PT1rPyIiOmspKSxvLmRpc3BsYXk9ImlubGluZS1ibG9jayIpKSxjLm92ZXJmbG93JiYoby5vdmVyZmxvdz0iaGlkZGVuIixtLmFsd2F5cyhmdW5jdGlvbigpe28ub3ZlcmZsb3c9Yy5vdmVyZmxvd1swXSxvLm92ZXJmbG93WD1jLm92ZXJmbG93WzFdLG8ub3ZlcmZsb3dZPWMub3ZlcmZsb3dbMl19KSksaT0hMTtmb3IoZCBpbiBuKWl8fChxPyJoaWRkZW4iaW4gcSYmKHA9cS5oaWRkZW4pOnE9Vi5hY2Nlc3MoYSwiZnhzaG93Iix7ZGlzcGxheTpqfSksZiYmKHEuaGlkZGVuPSFwKSxwJiZnYShbYV0sITApLG0uZG9uZShmdW5jdGlvbigpe3B8fGdhKFthXSksVi5yZW1vdmUoYSwiZnhzaG93Iik7Zm9yKGQgaW4gbilyLnN0eWxlKGEsZCxuW2RdKX0pKSxpPWRiKHA/cVtkXTowLGQsbSksZCBpbiBxfHwocVtkXT1pLnN0YXJ0LHAmJihpLmVuZD1pLnN0YXJ0LGkuc3RhcnQ9MCkpfX1mdW5jdGlvbiBmYihhLGIpe3ZhciBjLGQsZSxmLGc7Zm9yKGMgaW4gYSlpZihkPXIuY2FtZWxDYXNlKGMpLGU9YltkXSxmPWFbY10sci5pc0FycmF5KGYpJiYoZT1mWzFdLGY9YVtjXT1mWzBdKSxjIT09ZCYmKGFbZF09ZixkZWxldGUgYVtjXSksZz1yLmNzc0hvb2tzW2RdLGcmJiJleHBhbmQiaW4gZyl7Zj1nLmV4cGFuZChmKSxkZWxldGUgYVtkXTtmb3IoYyBpbiBmKWMgaW4gYXx8KGFbY109ZltjXSxiW2NdPWUpfWVsc2UgYltkXT1lfWZ1bmN0aW9uIGdiKGEsYixjKXt2YXIgZCxlLGY9MCxnPWdiLnByZWZpbHRlcnMubGVuZ3RoLGg9ci5EZWZlcnJlZCgpLmFsd2F5cyhmdW5jdGlvbigpe2RlbGV0ZSBpLmVsZW19KSxpPWZ1bmN0aW9uKCl7aWYoZSlyZXR1cm4hMTtmb3IodmFyIGI9WWF8fGJiKCksYz1NYXRoLm1heCgwLGouc3RhcnRUaW1lK2ouZHVyYXRpb24tYiksZD1jL2ouZHVyYXRpb258fDAsZj0xLWQsZz0wLGk9ai50d2VlbnMubGVuZ3RoO2c8aTtnKyspai50d2VlbnNbZ10ucnVuKGYpO3JldHVybiBoLm5vdGlmeVdpdGgoYSxbaixmLGNdKSxmPDEmJmk/YzooaC5yZXNvbHZlV2l0aChhLFtqXSksITEpfSxqPWgucHJvbWlzZSh7ZWxlbTphLHByb3BzOnIuZXh0ZW5kKHt9LGIpLG9wdHM6ci5leHRlbmQoITAse3NwZWNpYWxFYXNpbmc6e30sZWFzaW5nOnIuZWFzaW5nLl9kZWZhdWx0fSxjKSxvcmlnaW5hbFByb3BlcnRpZXM6YixvcmlnaW5hbE9wdGlvbnM6YyxzdGFydFRpbWU6WWF8fGJiKCksZHVyYXRpb246Yy5kdXJhdGlvbix0d2VlbnM6W10sY3JlYXRlVHdlZW46ZnVuY3Rpb24oYixjKXt2YXIgZD1yLlR3ZWVuKGEsai5vcHRzLGIsYyxqLm9wdHMuc3BlY2lhbEVhc2luZ1tiXXx8ai5vcHRzLmVhc2luZyk7cmV0dXJuIGoudHdlZW5zLnB1c2goZCksZH0sc3RvcDpmdW5jdGlvbihiKXt2YXIgYz0wLGQ9Yj9qLnR3ZWVucy5sZW5ndGg6MDtpZihlKXJldHVybiB0aGlzO2ZvcihlPSEwO2M8ZDtjKyspai50d2VlbnNbY10ucnVuKDEpO3JldHVybiBiPyhoLm5vdGlmeVdpdGgoYSxbaiwxLDBdKSxoLnJlc29sdmVXaXRoKGEsW2osYl0pKTpoLnJlamVjdFdpdGgoYSxbaixiXSksdGhpc319KSxrPWoucHJvcHM7Zm9yKGZiKGssai5vcHRzLnNwZWNpYWxFYXNpbmcpO2Y8ZztmKyspaWYoZD1nYi5wcmVmaWx0ZXJzW2ZdLmNhbGwoaixhLGssai5vcHRzKSlyZXR1cm4gci5pc0Z1bmN0aW9uKGQuc3RvcCkmJihyLl9xdWV1ZUhvb2tzKGouZWxlbSxqLm9wdHMucXVldWUpLnN0b3A9ci5wcm94eShkLnN0b3AsZCkpLGQ7cmV0dXJuIHIubWFwKGssZGIsaiksci5pc0Z1bmN0aW9uKGoub3B0cy5zdGFydCkmJmoub3B0cy5zdGFydC5jYWxsKGEsaiksci5meC50aW1lcihyLmV4dGVuZChpLHtlbGVtOmEsYW5pbTpqLHF1ZXVlOmoub3B0cy5xdWV1ZX0pKSxqLnByb2dyZXNzKGoub3B0cy5wcm9ncmVzcykuZG9uZShqLm9wdHMuZG9uZSxqLm9wdHMuY29tcGxldGUpLmZhaWwoai5vcHRzLmZhaWwpLmFsd2F5cyhqLm9wdHMuYWx3YXlzKX1yLkFuaW1hdGlvbj1yLmV4dGVuZChnYix7dHdlZW5lcnM6eyIqIjpbZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNyZWF0ZVR3ZWVuKGEsYik7cmV0dXJuIGRhKGMuZWxlbSxhLF8uZXhlYyhiKSxjKSxjfV19LHR3ZWVuZXI6ZnVuY3Rpb24oYSxiKXtyLmlzRnVuY3Rpb24oYSk/KGI9YSxhPVsiKiJdKTphPWEubWF0Y2goSyk7Zm9yKHZhciBjLGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspYz1hW2RdLGdiLnR3ZWVuZXJzW2NdPWdiLnR3ZWVuZXJzW2NdfHxbXSxnYi50d2VlbmVyc1tjXS51bnNoaWZ0KGIpfSxwcmVmaWx0ZXJzOltlYl0scHJlZmlsdGVyOmZ1bmN0aW9uKGEsYil7Yj9nYi5wcmVmaWx0ZXJzLnVuc2hpZnQoYSk6Z2IucHJlZmlsdGVycy5wdXNoKGEpfX0pLHIuc3BlZWQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBlPWEmJiJvYmplY3QiPT10eXBlb2YgYT9yLmV4dGVuZCh7fSxhKTp7Y29tcGxldGU6Y3x8IWMmJmJ8fHIuaXNGdW5jdGlvbihhKSYmYSxkdXJhdGlvbjphLGVhc2luZzpjJiZifHxiJiYhci5pc0Z1bmN0aW9uKGIpJiZifTtyZXR1cm4gci5meC5vZmZ8fGQuaGlkZGVuP2UuZHVyYXRpb249MDplLmR1cmF0aW9uPSJudW1iZXIiPT10eXBlb2YgZS5kdXJhdGlvbj9lLmR1cmF0aW9uOmUuZHVyYXRpb24gaW4gci5meC5zcGVlZHM/ci5meC5zcGVlZHNbZS5kdXJhdGlvbl06ci5meC5zcGVlZHMuX2RlZmF1bHQsbnVsbCE9ZS5xdWV1ZSYmZS5xdWV1ZSE9PSEwfHwoZS5xdWV1ZT0iZngiKSxlLm9sZD1lLmNvbXBsZXRlLGUuY29tcGxldGU9ZnVuY3Rpb24oKXtyLmlzRnVuY3Rpb24oZS5vbGQpJiZlLm9sZC5jYWxsKHRoaXMpLGUucXVldWUmJnIuZGVxdWV1ZSh0aGlzLGUucXVldWUpfSxlfSxyLmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmZpbHRlcihiYSkuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTpifSxhLGMsZCl9LGFuaW1hdGU6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9ci5pc0VtcHR5T2JqZWN0KGEpLGY9ci5zcGVlZChiLGMsZCksZz1mdW5jdGlvbigpe3ZhciBiPWdiKHRoaXMsci5leHRlbmQoe30sYSksZik7KGV8fFYuZ2V0KHRoaXMsImZpbmlzaCIpKSYmYi5zdG9wKCEwKX07cmV0dXJuIGcuZmluaXNoPWcsZXx8Zi5xdWV1ZT09PSExP3RoaXMuZWFjaChnKTp0aGlzLnF1ZXVlKGYucXVldWUsZyl9LHN0b3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWZ1bmN0aW9uKGEpe3ZhciBiPWEuc3RvcDtkZWxldGUgYS5zdG9wLGIoYyl9O3JldHVybiJzdHJpbmciIT10eXBlb2YgYSYmKGM9YixiPWEsYT12b2lkIDApLGImJmEhPT0hMSYmdGhpcy5xdWV1ZShhfHwiZngiLFtdKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj0hMCxlPW51bGwhPWEmJmErInF1ZXVlSG9va3MiLGY9ci50aW1lcnMsZz1WLmdldCh0aGlzKTtpZihlKWdbZV0mJmdbZV0uc3RvcCYmZChnW2VdKTtlbHNlIGZvcihlIGluIGcpZ1tlXSYmZ1tlXS5zdG9wJiZfYS50ZXN0KGUpJiZkKGdbZV0pO2ZvcihlPWYubGVuZ3RoO2UtLTspZltlXS5lbGVtIT09dGhpc3x8bnVsbCE9YSYmZltlXS5xdWV1ZSE9PWF8fChmW2VdLmFuaW0uc3RvcChjKSxiPSExLGYuc3BsaWNlKGUsMSkpOyFiJiZjfHxyLmRlcXVldWUodGhpcyxhKX0pfSxmaW5pc2g6ZnVuY3Rpb24oYSl7cmV0dXJuIGEhPT0hMSYmKGE9YXx8ImZ4IiksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGIsYz1WLmdldCh0aGlzKSxkPWNbYSsicXVldWUiXSxlPWNbYSsicXVldWVIb29rcyJdLGY9ci50aW1lcnMsZz1kP2QubGVuZ3RoOjA7Zm9yKGMuZmluaXNoPSEwLHIucXVldWUodGhpcyxhLFtdKSxlJiZlLnN0b3AmJmUuc3RvcC5jYWxsKHRoaXMsITApLGI9Zi5sZW5ndGg7Yi0tOylmW2JdLmVsZW09PT10aGlzJiZmW2JdLnF1ZXVlPT09YSYmKGZbYl0uYW5pbS5zdG9wKCEwKSxmLnNwbGljZShiLDEpKTtmb3IoYj0wO2I8ZztiKyspZFtiXSYmZFtiXS5maW5pc2gmJmRbYl0uZmluaXNoLmNhbGwodGhpcyk7ZGVsZXRlIGMuZmluaXNofSl9fSksci5lYWNoKFsidG9nZ2xlIiwic2hvdyIsImhpZGUiXSxmdW5jdGlvbihhLGIpe3ZhciBjPXIuZm5bYl07ci5mbltiXT1mdW5jdGlvbihhLGQsZSl7cmV0dXJuIG51bGw9PWF8fCJib29sZWFuIj09dHlwZW9mIGE/Yy5hcHBseSh0aGlzLGFyZ3VtZW50cyk6dGhpcy5hbmltYXRlKGNiKGIsITApLGEsZCxlKX19KSxyLmVhY2goe3NsaWRlRG93bjpjYigic2hvdyIpLHNsaWRlVXA6Y2IoImhpZGUiKSxzbGlkZVRvZ2dsZTpjYigidG9nZ2xlIiksZmFkZUluOntvcGFjaXR5OiJzaG93In0sZmFkZU91dDp7b3BhY2l0eToiaGlkZSJ9LGZhZGVUb2dnbGU6e29wYWNpdHk6InRvZ2dsZSJ9fSxmdW5jdGlvbihhLGIpe3IuZm5bYV09ZnVuY3Rpb24oYSxjLGQpe3JldHVybiB0aGlzLmFuaW1hdGUoYixhLGMsZCl9fSksci50aW1lcnM9W10sci5meC50aWNrPWZ1bmN0aW9uKCl7dmFyIGEsYj0wLGM9ci50aW1lcnM7Zm9yKFlhPXIubm93KCk7YjxjLmxlbmd0aDtiKyspYT1jW2JdLGEoKXx8Y1tiXSE9PWF8fGMuc3BsaWNlKGItLSwxKTtjLmxlbmd0aHx8ci5meC5zdG9wKCksWWE9dm9pZCAwfSxyLmZ4LnRpbWVyPWZ1bmN0aW9uKGEpe3IudGltZXJzLnB1c2goYSksYSgpP3IuZnguc3RhcnQoKTpyLnRpbWVycy5wb3AoKX0sci5meC5pbnRlcnZhbD0xMyxyLmZ4LnN0YXJ0PWZ1bmN0aW9uKCl7WmF8fChaYT1hLnJlcXVlc3RBbmltYXRpb25GcmFtZT9hLnJlcXVlc3RBbmltYXRpb25GcmFtZShhYik6YS5zZXRJbnRlcnZhbChyLmZ4LnRpY2ssci5meC5pbnRlcnZhbCkpfSxyLmZ4LnN0b3A9ZnVuY3Rpb24oKXthLmNhbmNlbEFuaW1hdGlvbkZyYW1lP2EuY2FuY2VsQW5pbWF0aW9uRnJhbWUoWmEpOmEuY2xlYXJJbnRlcnZhbChaYSksWmE9bnVsbH0sci5meC5zcGVlZHM9e3Nsb3c6NjAwLGZhc3Q6MjAwLF9kZWZhdWx0OjQwMH0sci5mbi5kZWxheT1mdW5jdGlvbihiLGMpe3JldHVybiBiPXIuZng/ci5meC5zcGVlZHNbYl18fGI6YixjPWN8fCJmeCIsdGhpcy5xdWV1ZShjLGZ1bmN0aW9uKGMsZCl7dmFyIGU9YS5zZXRUaW1lb3V0KGMsYik7ZC5zdG9wPWZ1bmN0aW9uKCl7YS5jbGVhclRpbWVvdXQoZSl9fSl9LGZ1bmN0aW9uKCl7dmFyIGE9ZC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpLGI9ZC5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKSxjPWIuYXBwZW5kQ2hpbGQoZC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKSk7YS50eXBlPSJjaGVja2JveCIsby5jaGVja09uPSIiIT09YS52YWx1ZSxvLm9wdFNlbGVjdGVkPWMuc2VsZWN0ZWQsYT1kLmNyZWF0ZUVsZW1lbnQoImlucHV0IiksYS52YWx1ZT0idCIsYS50eXBlPSJyYWRpbyIsby5yYWRpb1ZhbHVlPSJ0Ij09PWEudmFsdWV9KCk7dmFyIGhiLGliPXIuZXhwci5hdHRySGFuZGxlO3IuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIFModGhpcyxyLmF0dHIsYSxiLGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3IucmVtb3ZlQXR0cih0aGlzLGEpfSl9fSksci5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj1hLm5vZGVUeXBlO2lmKDMhPT1mJiY4IT09ZiYmMiE9PWYpcmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBhLmdldEF0dHJpYnV0ZT9yLnByb3AoYSxiLGMpOigxPT09ZiYmci5pc1hNTERvYyhhKXx8KGU9ci5hdHRySG9va3NbYi50b0xvd2VyQ2FzZSgpXXx8KHIuZXhwci5tYXRjaC5ib29sLnRlc3QoYik/aGI6dm9pZCAwKSksdm9pZCAwIT09Yz9udWxsPT09Yz92b2lkIHIucmVtb3ZlQXR0cihhLGIpOmUmJiJzZXQiaW4gZSYmdm9pZCAwIT09KGQ9ZS5zZXQoYSxjLGIpKT9kOihhLnNldEF0dHJpYnV0ZShiLGMrIiIpLGMpOmUmJiJnZXQiaW4gZSYmbnVsbCE9PShkPWUuZ2V0KGEsYikpP2Q6KGQ9ci5maW5kLmF0dHIoYSxiKSxudWxsPT1kP3ZvaWQgMDpkKSl9LGF0dHJIb29rczp7dHlwZTp7c2V0OmZ1bmN0aW9uKGEsYil7aWYoIW8ucmFkaW9WYWx1ZSYmInJhZGlvIj09PWImJnIubm9kZU5hbWUoYSwiaW5wdXQiKSl7dmFyIGM9YS52YWx1ZTtyZXR1cm4gYS5zZXRBdHRyaWJ1dGUoInR5cGUiLGIpLGMmJihhLnZhbHVlPWMpLGJ9fX19LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPTAsZT1iJiZiLm1hdGNoKEspOwppZihlJiYxPT09YS5ub2RlVHlwZSl3aGlsZShjPWVbZCsrXSlhLnJlbW92ZUF0dHJpYnV0ZShjKX19KSxoYj17c2V0OmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYj09PSExP3IucmVtb3ZlQXR0cihhLGMpOmEuc2V0QXR0cmlidXRlKGMsYyksY319LHIuZWFjaChyLmV4cHIubWF0Y2guYm9vbC5zb3VyY2UubWF0Y2goL1x3Ky9nKSxmdW5jdGlvbihhLGIpe3ZhciBjPWliW2JdfHxyLmZpbmQuYXR0cjtpYltiXT1mdW5jdGlvbihhLGIsZCl7dmFyIGUsZixnPWIudG9Mb3dlckNhc2UoKTtyZXR1cm4gZHx8KGY9aWJbZ10saWJbZ109ZSxlPW51bGwhPWMoYSxiLGQpP2c6bnVsbCxpYltnXT1mKSxlfX0pO3ZhciBqYj0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLGtiPS9eKD86YXxhcmVhKSQvaTtyLmZuLmV4dGVuZCh7cHJvcDpmdW5jdGlvbihhLGIpe3JldHVybiBTKHRoaXMsci5wcm9wLGEsYixhcmd1bWVudHMubGVuZ3RoPjEpfSxyZW1vdmVQcm9wOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtkZWxldGUgdGhpc1tyLnByb3BGaXhbYV18fGFdfSl9fSksci5leHRlbmQoe3Byb3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj1hLm5vZGVUeXBlO2lmKDMhPT1mJiY4IT09ZiYmMiE9PWYpcmV0dXJuIDE9PT1mJiZyLmlzWE1MRG9jKGEpfHwoYj1yLnByb3BGaXhbYl18fGIsZT1yLnByb3BIb29rc1tiXSksdm9pZCAwIT09Yz9lJiYic2V0ImluIGUmJnZvaWQgMCE9PShkPWUuc2V0KGEsYyxiKSk/ZDphW2JdPWM6ZSYmImdldCJpbiBlJiZudWxsIT09KGQ9ZS5nZXQoYSxiKSk/ZDphW2JdfSxwcm9wSG9va3M6e3RhYkluZGV4OntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9ci5maW5kLmF0dHIoYSwidGFiaW5kZXgiKTtyZXR1cm4gYj9wYXJzZUludChiLDEwKTpqYi50ZXN0KGEubm9kZU5hbWUpfHxrYi50ZXN0KGEubm9kZU5hbWUpJiZhLmhyZWY/MDotMX19fSxwcm9wRml4OnsiZm9yIjoiaHRtbEZvciIsImNsYXNzIjoiY2xhc3NOYW1lIn19KSxvLm9wdFNlbGVjdGVkfHwoci5wcm9wSG9va3Muc2VsZWN0ZWQ9e2dldDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7cmV0dXJuIGImJmIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsbnVsbH0sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPWEucGFyZW50Tm9kZTtiJiYoYi5zZWxlY3RlZEluZGV4LGIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgpfX0pLHIuZWFjaChbInRhYkluZGV4IiwicmVhZE9ubHkiLCJtYXhMZW5ndGgiLCJjZWxsU3BhY2luZyIsImNlbGxQYWRkaW5nIiwicm93U3BhbiIsImNvbFNwYW4iLCJ1c2VNYXAiLCJmcmFtZUJvcmRlciIsImNvbnRlbnRFZGl0YWJsZSJdLGZ1bmN0aW9uKCl7ci5wcm9wRml4W3RoaXMudG9Mb3dlckNhc2UoKV09dGhpc30pO3ZhciBsYj0vW1x0XHJcblxmXS9nO2Z1bmN0aW9uIG1iKGEpe3JldHVybiBhLmdldEF0dHJpYnV0ZSYmYS5nZXRBdHRyaWJ1dGUoImNsYXNzIil8fCIifXIuZm4uZXh0ZW5kKHthZGRDbGFzczpmdW5jdGlvbihhKXt2YXIgYixjLGQsZSxmLGcsaCxpPTA7aWYoci5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7cih0aGlzKS5hZGRDbGFzcyhhLmNhbGwodGhpcyxiLG1iKHRoaXMpKSl9KTtpZigic3RyaW5nIj09dHlwZW9mIGEmJmEpe2I9YS5tYXRjaChLKXx8W107d2hpbGUoYz10aGlzW2krK10paWYoZT1tYihjKSxkPTE9PT1jLm5vZGVUeXBlJiYoIiAiK2UrIiAiKS5yZXBsYWNlKGxiLCIgIikpe2c9MDt3aGlsZShmPWJbZysrXSlkLmluZGV4T2YoIiAiK2YrIiAiKTwwJiYoZCs9ZisiICIpO2g9ci50cmltKGQpLGUhPT1oJiZjLnNldEF0dHJpYnV0ZSgiY2xhc3MiLGgpfX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGgsaT0wO2lmKHIuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3IodGhpcykucmVtb3ZlQ2xhc3MoYS5jYWxsKHRoaXMsYixtYih0aGlzKSkpfSk7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMuYXR0cigiY2xhc3MiLCIiKTtpZigic3RyaW5nIj09dHlwZW9mIGEmJmEpe2I9YS5tYXRjaChLKXx8W107d2hpbGUoYz10aGlzW2krK10paWYoZT1tYihjKSxkPTE9PT1jLm5vZGVUeXBlJiYoIiAiK2UrIiAiKS5yZXBsYWNlKGxiLCIgIikpe2c9MDt3aGlsZShmPWJbZysrXSl3aGlsZShkLmluZGV4T2YoIiAiK2YrIiAiKT4tMSlkPWQucmVwbGFjZSgiICIrZisiICIsIiAiKTtoPXIudHJpbShkKSxlIT09aCYmYy5zZXRBdHRyaWJ1dGUoImNsYXNzIixoKX19cmV0dXJuIHRoaXN9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKGEsYil7dmFyIGM9dHlwZW9mIGE7cmV0dXJuImJvb2xlYW4iPT10eXBlb2YgYiYmInN0cmluZyI9PT1jP2I/dGhpcy5hZGRDbGFzcyhhKTp0aGlzLnJlbW92ZUNsYXNzKGEpOnIuaXNGdW5jdGlvbihhKT90aGlzLmVhY2goZnVuY3Rpb24oYyl7cih0aGlzKS50b2dnbGVDbGFzcyhhLmNhbGwodGhpcyxjLG1iKHRoaXMpLGIpLGIpfSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGIsZCxlLGY7aWYoInN0cmluZyI9PT1jKXtkPTAsZT1yKHRoaXMpLGY9YS5tYXRjaChLKXx8W107d2hpbGUoYj1mW2QrK10pZS5oYXNDbGFzcyhiKT9lLnJlbW92ZUNsYXNzKGIpOmUuYWRkQ2xhc3MoYil9ZWxzZSB2b2lkIDAhPT1hJiYiYm9vbGVhbiIhPT1jfHwoYj1tYih0aGlzKSxiJiZWLnNldCh0aGlzLCJfX2NsYXNzTmFtZV9fIixiKSx0aGlzLnNldEF0dHJpYnV0ZSYmdGhpcy5zZXRBdHRyaWJ1dGUoImNsYXNzIixifHxhPT09ITE/IiI6Vi5nZXQodGhpcywiX19jbGFzc05hbWVfXyIpfHwiIikpfSl9LGhhc0NsYXNzOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZD0wO2I9IiAiK2ErIiAiO3doaWxlKGM9dGhpc1tkKytdKWlmKDE9PT1jLm5vZGVUeXBlJiYoIiAiK21iKGMpKyIgIikucmVwbGFjZShsYiwiICIpLmluZGV4T2YoYik+LTEpcmV0dXJuITA7cmV0dXJuITF9fSk7dmFyIG5iPS9cci9nLG9iPS9bXHgyMFx0XHJcblxmXSsvZztyLmZuLmV4dGVuZCh7dmFsOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlPXRoaXNbMF07e2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIGQ9ci5pc0Z1bmN0aW9uKGEpLHRoaXMuZWFjaChmdW5jdGlvbihjKXt2YXIgZTsxPT09dGhpcy5ub2RlVHlwZSYmKGU9ZD9hLmNhbGwodGhpcyxjLHIodGhpcykudmFsKCkpOmEsbnVsbD09ZT9lPSIiOiJudW1iZXIiPT10eXBlb2YgZT9lKz0iIjpyLmlzQXJyYXkoZSkmJihlPXIubWFwKGUsZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWE/IiI6YSsiIn0pKSxiPXIudmFsSG9va3NbdGhpcy50eXBlXXx8ci52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldLGImJiJzZXQiaW4gYiYmdm9pZCAwIT09Yi5zZXQodGhpcyxlLCJ2YWx1ZSIpfHwodGhpcy52YWx1ZT1lKSl9KTtpZihlKXJldHVybiBiPXIudmFsSG9va3NbZS50eXBlXXx8ci52YWxIb29rc1tlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldLGImJiJnZXQiaW4gYiYmdm9pZCAwIT09KGM9Yi5nZXQoZSwidmFsdWUiKSk/YzooYz1lLnZhbHVlLCJzdHJpbmciPT10eXBlb2YgYz9jLnJlcGxhY2UobmIsIiIpOm51bGw9PWM/IiI6Yyl9fX0pLHIuZXh0ZW5kKHt2YWxIb29rczp7b3B0aW9uOntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9ci5maW5kLmF0dHIoYSwidmFsdWUiKTtyZXR1cm4gbnVsbCE9Yj9iOnIudHJpbShyLnRleHQoYSkpLnJlcGxhY2Uob2IsIiAiKX19LHNlbGVjdDp7Z2V0OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYixjLGQ9YS5vcHRpb25zLGU9YS5zZWxlY3RlZEluZGV4LGY9InNlbGVjdC1vbmUiPT09YS50eXBlLGc9Zj9udWxsOltdLGg9Zj9lKzE6ZC5sZW5ndGgsaT1lPDA/aDpmP2U6MDtpPGg7aSsrKWlmKGM9ZFtpXSwoYy5zZWxlY3RlZHx8aT09PWUpJiYhYy5kaXNhYmxlZCYmKCFjLnBhcmVudE5vZGUuZGlzYWJsZWR8fCFyLm5vZGVOYW1lKGMucGFyZW50Tm9kZSwib3B0Z3JvdXAiKSkpe2lmKGI9cihjKS52YWwoKSxmKXJldHVybiBiO2cucHVzaChiKX1yZXR1cm4gZ30sc2V0OmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlPWEub3B0aW9ucyxmPXIubWFrZUFycmF5KGIpLGc9ZS5sZW5ndGg7d2hpbGUoZy0tKWQ9ZVtnXSwoZC5zZWxlY3RlZD1yLmluQXJyYXkoci52YWxIb29rcy5vcHRpb24uZ2V0KGQpLGYpPi0xKSYmKGM9ITApO3JldHVybiBjfHwoYS5zZWxlY3RlZEluZGV4PS0xKSxmfX19fSksci5lYWNoKFsicmFkaW8iLCJjaGVja2JveCJdLGZ1bmN0aW9uKCl7ci52YWxIb29rc1t0aGlzXT17c2V0OmZ1bmN0aW9uKGEsYil7aWYoci5pc0FycmF5KGIpKXJldHVybiBhLmNoZWNrZWQ9ci5pbkFycmF5KHIoYSkudmFsKCksYik+LTF9fSxvLmNoZWNrT258fChyLnZhbEhvb2tzW3RoaXNdLmdldD1mdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09PWEuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpPyJvbiI6YS52YWx1ZX0pfSk7dmFyIHBiPS9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLztyLmV4dGVuZChyLmV2ZW50LHt0cmlnZ2VyOmZ1bmN0aW9uKGIsYyxlLGYpe3ZhciBnLGgsaSxqLGssbSxuLG89W2V8fGRdLHA9bC5jYWxsKGIsInR5cGUiKT9iLnR5cGU6YixxPWwuY2FsbChiLCJuYW1lc3BhY2UiKT9iLm5hbWVzcGFjZS5zcGxpdCgiLiIpOltdO2lmKGg9aT1lPWV8fGQsMyE9PWUubm9kZVR5cGUmJjghPT1lLm5vZGVUeXBlJiYhcGIudGVzdChwK3IuZXZlbnQudHJpZ2dlcmVkKSYmKHAuaW5kZXhPZigiLiIpPi0xJiYocT1wLnNwbGl0KCIuIikscD1xLnNoaWZ0KCkscS5zb3J0KCkpLGs9cC5pbmRleE9mKCI6Iik8MCYmIm9uIitwLGI9YltyLmV4cGFuZG9dP2I6bmV3IHIuRXZlbnQocCwib2JqZWN0Ij09dHlwZW9mIGImJmIpLGIuaXNUcmlnZ2VyPWY/MjozLGIubmFtZXNwYWNlPXEuam9pbigiLiIpLGIucm5hbWVzcGFjZT1iLm5hbWVzcGFjZT9uZXcgUmVnRXhwKCIoXnxcXC4pIitxLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpOm51bGwsYi5yZXN1bHQ9dm9pZCAwLGIudGFyZ2V0fHwoYi50YXJnZXQ9ZSksYz1udWxsPT1jP1tiXTpyLm1ha2VBcnJheShjLFtiXSksbj1yLmV2ZW50LnNwZWNpYWxbcF18fHt9LGZ8fCFuLnRyaWdnZXJ8fG4udHJpZ2dlci5hcHBseShlLGMpIT09ITEpKXtpZighZiYmIW4ubm9CdWJibGUmJiFyLmlzV2luZG93KGUpKXtmb3Ioaj1uLmRlbGVnYXRlVHlwZXx8cCxwYi50ZXN0KGorcCl8fChoPWgucGFyZW50Tm9kZSk7aDtoPWgucGFyZW50Tm9kZSlvLnB1c2goaCksaT1oO2k9PT0oZS5vd25lckRvY3VtZW50fHxkKSYmby5wdXNoKGkuZGVmYXVsdFZpZXd8fGkucGFyZW50V2luZG93fHxhKX1nPTA7d2hpbGUoKGg9b1tnKytdKSYmIWIuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSliLnR5cGU9Zz4xP2o6bi5iaW5kVHlwZXx8cCxtPShWLmdldChoLCJldmVudHMiKXx8e30pW2IudHlwZV0mJlYuZ2V0KGgsImhhbmRsZSIpLG0mJm0uYXBwbHkoaCxjKSxtPWsmJmhba10sbSYmbS5hcHBseSYmVChoKSYmKGIucmVzdWx0PW0uYXBwbHkoaCxjKSxiLnJlc3VsdD09PSExJiZiLnByZXZlbnREZWZhdWx0KCkpO3JldHVybiBiLnR5cGU9cCxmfHxiLmlzRGVmYXVsdFByZXZlbnRlZCgpfHxuLl9kZWZhdWx0JiZuLl9kZWZhdWx0LmFwcGx5KG8ucG9wKCksYykhPT0hMXx8IVQoZSl8fGsmJnIuaXNGdW5jdGlvbihlW3BdKSYmIXIuaXNXaW5kb3coZSkmJihpPWVba10saSYmKGVba109bnVsbCksci5ldmVudC50cmlnZ2VyZWQ9cCxlW3BdKCksci5ldmVudC50cmlnZ2VyZWQ9dm9pZCAwLGkmJihlW2tdPWkpKSxiLnJlc3VsdH19LHNpbXVsYXRlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1yLmV4dGVuZChuZXcgci5FdmVudCxjLHt0eXBlOmEsaXNTaW11bGF0ZWQ6ITB9KTtyLmV2ZW50LnRyaWdnZXIoZCxudWxsLGIpfX0pLHIuZm4uZXh0ZW5kKHt0cmlnZ2VyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3IuZXZlbnQudHJpZ2dlcihhLGIsdGhpcyl9KX0sdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzWzBdO2lmKGMpcmV0dXJuIHIuZXZlbnQudHJpZ2dlcihhLGIsYywhMCl9fSksci5lYWNoKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgcmVzaXplIHNjcm9sbCBjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGNvbnRleHRtZW51Ii5zcGxpdCgiICIpLGZ1bmN0aW9uKGEsYil7ci5mbltiXT1mdW5jdGlvbihhLGMpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPjA/dGhpcy5vbihiLG51bGwsYSxjKTp0aGlzLnRyaWdnZXIoYil9fSksci5mbi5leHRlbmQoe2hvdmVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMubW91c2VlbnRlcihhKS5tb3VzZWxlYXZlKGJ8fGEpfX0pLG8uZm9jdXNpbj0ib25mb2N1c2luImluIGEsby5mb2N1c2lufHxyLmVhY2goe2ZvY3VzOiJmb2N1c2luIixibHVyOiJmb2N1c291dCJ9LGZ1bmN0aW9uKGEsYil7dmFyIGM9ZnVuY3Rpb24oYSl7ci5ldmVudC5zaW11bGF0ZShiLGEudGFyZ2V0LHIuZXZlbnQuZml4KGEpKX07ci5ldmVudC5zcGVjaWFsW2JdPXtzZXR1cDpmdW5jdGlvbigpe3ZhciBkPXRoaXMub3duZXJEb2N1bWVudHx8dGhpcyxlPVYuYWNjZXNzKGQsYik7ZXx8ZC5hZGRFdmVudExpc3RlbmVyKGEsYywhMCksVi5hY2Nlc3MoZCxiLChlfHwwKSsxKX0sdGVhcmRvd246ZnVuY3Rpb24oKXt2YXIgZD10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsZT1WLmFjY2VzcyhkLGIpLTE7ZT9WLmFjY2VzcyhkLGIsZSk6KGQucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLGMsITApLFYucmVtb3ZlKGQsYikpfX19KTt2YXIgcWI9YS5sb2NhdGlvbixyYj1yLm5vdygpLHNiPS9cPy87ci5wYXJzZVhNTD1mdW5jdGlvbihiKXt2YXIgYztpZighYnx8InN0cmluZyIhPXR5cGVvZiBiKXJldHVybiBudWxsO3RyeXtjPShuZXcgYS5ET01QYXJzZXIpLnBhcnNlRnJvbVN0cmluZyhiLCJ0ZXh0L3htbCIpfWNhdGNoKGQpe2M9dm9pZCAwfXJldHVybiBjJiYhYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgicGFyc2VyZXJyb3IiKS5sZW5ndGh8fHIuZXJyb3IoIkludmFsaWQgWE1MOiAiK2IpLGN9O3ZhciB0Yj0vXFtcXSQvLHViPS9ccj9cbi9nLHZiPS9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSx3Yj0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxrZXlnZW4pL2k7ZnVuY3Rpb24geGIoYSxiLGMsZCl7dmFyIGU7aWYoci5pc0FycmF5KGIpKXIuZWFjaChiLGZ1bmN0aW9uKGIsZSl7Y3x8dGIudGVzdChhKT9kKGEsZSk6eGIoYSsiWyIrKCJvYmplY3QiPT10eXBlb2YgZSYmbnVsbCE9ZT9iOiIiKSsiXSIsZSxjLGQpfSk7ZWxzZSBpZihjfHwib2JqZWN0IiE9PXIudHlwZShiKSlkKGEsYik7ZWxzZSBmb3IoZSBpbiBiKXhiKGErIlsiK2UrIl0iLGJbZV0sYyxkKX1yLnBhcmFtPWZ1bmN0aW9uKGEsYil7dmFyIGMsZD1bXSxlPWZ1bmN0aW9uKGEsYil7dmFyIGM9ci5pc0Z1bmN0aW9uKGIpP2IoKTpiO2RbZC5sZW5ndGhdPWVuY29kZVVSSUNvbXBvbmVudChhKSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KG51bGw9PWM/IiI6Yyl9O2lmKHIuaXNBcnJheShhKXx8YS5qcXVlcnkmJiFyLmlzUGxhaW5PYmplY3QoYSkpci5lYWNoKGEsZnVuY3Rpb24oKXtlKHRoaXMubmFtZSx0aGlzLnZhbHVlKX0pO2Vsc2UgZm9yKGMgaW4gYSl4YihjLGFbY10sYixlKTtyZXR1cm4gZC5qb2luKCImIil9LHIuZm4uZXh0ZW5kKHtzZXJpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gci5wYXJhbSh0aGlzLnNlcmlhbGl6ZUFycmF5KCkpfSxzZXJpYWxpemVBcnJheTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPXIucHJvcCh0aGlzLCJlbGVtZW50cyIpO3JldHVybiBhP3IubWFrZUFycmF5KGEpOnRoaXN9KS5maWx0ZXIoZnVuY3Rpb24oKXt2YXIgYT10aGlzLnR5cGU7cmV0dXJuIHRoaXMubmFtZSYmIXIodGhpcykuaXMoIjpkaXNhYmxlZCIpJiZ3Yi50ZXN0KHRoaXMubm9kZU5hbWUpJiYhdmIudGVzdChhKSYmKHRoaXMuY2hlY2tlZHx8IWhhLnRlc3QoYSkpfSkubWFwKGZ1bmN0aW9uKGEsYil7dmFyIGM9cih0aGlzKS52YWwoKTtyZXR1cm4gbnVsbD09Yz9udWxsOnIuaXNBcnJheShjKT9yLm1hcChjLGZ1bmN0aW9uKGEpe3JldHVybntuYW1lOmIubmFtZSx2YWx1ZTphLnJlcGxhY2UodWIsIlxyXG4iKX19KTp7bmFtZTpiLm5hbWUsdmFsdWU6Yy5yZXBsYWNlKHViLCJcclxuIil9fSkuZ2V0KCl9fSk7dmFyIHliPS8lMjAvZyx6Yj0vIy4qJC8sQWI9LyhbPyZdKV89W14mXSovLEJiPS9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKSQvZ20sQ2I9L14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sRGI9L14oPzpHRVR8SEVBRCkkLyxFYj0vXlwvXC8vLEZiPXt9LEdiPXt9LEhiPSIqLyIuY29uY2F0KCIqIiksSWI9ZC5jcmVhdGVFbGVtZW50KCJhIik7SWIuaHJlZj1xYi5ocmVmO2Z1bmN0aW9uIEpiKGEpe3JldHVybiBmdW5jdGlvbihiLGMpeyJzdHJpbmciIT10eXBlb2YgYiYmKGM9YixiPSIqIik7dmFyIGQsZT0wLGY9Yi50b0xvd2VyQ2FzZSgpLm1hdGNoKEspfHxbXTtpZihyLmlzRnVuY3Rpb24oYykpd2hpbGUoZD1mW2UrK10pIisiPT09ZFswXT8oZD1kLnNsaWNlKDEpfHwiKiIsKGFbZF09YVtkXXx8W10pLnVuc2hpZnQoYykpOihhW2RdPWFbZF18fFtdKS5wdXNoKGMpfX1mdW5jdGlvbiBLYihhLGIsYyxkKXt2YXIgZT17fSxmPWE9PT1HYjtmdW5jdGlvbiBnKGgpe3ZhciBpO3JldHVybiBlW2hdPSEwLHIuZWFjaChhW2hdfHxbXSxmdW5jdGlvbihhLGgpe3ZhciBqPWgoYixjLGQpO3JldHVybiJzdHJpbmciIT10eXBlb2Yganx8Znx8ZVtqXT9mPyEoaT1qKTp2b2lkIDA6KGIuZGF0YVR5cGVzLnVuc2hpZnQoaiksZyhqKSwhMSl9KSxpfXJldHVybiBnKGIuZGF0YVR5cGVzWzBdKXx8IWVbIioiXSYmZygiKiIpfWZ1bmN0aW9uIExiKGEsYil7dmFyIGMsZCxlPXIuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zfHx7fTtmb3IoYyBpbiBiKXZvaWQgMCE9PWJbY10mJigoZVtjXT9hOmR8fChkPXt9KSlbY109YltjXSk7cmV0dXJuIGQmJnIuZXh0ZW5kKCEwLGEsZCksYX1mdW5jdGlvbiBNYihhLGIsYyl7dmFyIGQsZSxmLGcsaD1hLmNvbnRlbnRzLGk9YS5kYXRhVHlwZXM7d2hpbGUoIioiPT09aVswXSlpLnNoaWZ0KCksdm9pZCAwPT09ZCYmKGQ9YS5taW1lVHlwZXx8Yi5nZXRSZXNwb25zZUhlYWRlcigiQ29udGVudC1UeXBlIikpO2lmKGQpZm9yKGUgaW4gaClpZihoW2VdJiZoW2VdLnRlc3QoZCkpe2kudW5zaGlmdChlKTticmVha31pZihpWzBdaW4gYylmPWlbMF07ZWxzZXtmb3IoZSBpbiBjKXtpZighaVswXXx8YS5jb252ZXJ0ZXJzW2UrIiAiK2lbMF1dKXtmPWU7YnJlYWt9Z3x8KGc9ZSl9Zj1mfHxnfWlmKGYpcmV0dXJuIGYhPT1pWzBdJiZpLnVuc2hpZnQoZiksY1tmXX1mdW5jdGlvbiBOYihhLGIsYyxkKXt2YXIgZSxmLGcsaCxpLGo9e30saz1hLmRhdGFUeXBlcy5zbGljZSgpO2lmKGtbMV0pZm9yKGcgaW4gYS5jb252ZXJ0ZXJzKWpbZy50b0xvd2VyQ2FzZSgpXT1hLmNvbnZlcnRlcnNbZ107Zj1rLnNoaWZ0KCk7d2hpbGUoZilpZihhLnJlc3BvbnNlRmllbGRzW2ZdJiYoY1thLnJlc3BvbnNlRmllbGRzW2ZdXT1iKSwhaSYmZCYmYS5kYXRhRmlsdGVyJiYoYj1hLmRhdGFGaWx0ZXIoYixhLmRhdGFUeXBlKSksaT1mLGY9ay5zaGlmdCgpKWlmKCIqIj09PWYpZj1pO2Vsc2UgaWYoIioiIT09aSYmaSE9PWYpe2lmKGc9altpKyIgIitmXXx8alsiKiAiK2ZdLCFnKWZvcihlIGluIGopaWYoaD1lLnNwbGl0KCIgIiksaFsxXT09PWYmJihnPWpbaSsiICIraFswXV18fGpbIiogIitoWzBdXSkpe2c9PT0hMD9nPWpbZV06altlXSE9PSEwJiYoZj1oWzBdLGsudW5zaGlmdChoWzFdKSk7YnJlYWt9aWYoZyE9PSEwKWlmKGcmJmFbInRocm93cyJdKWI9ZyhiKTtlbHNlIHRyeXtiPWcoYil9Y2F0Y2gobCl7cmV0dXJue3N0YXRlOiJwYXJzZXJlcnJvciIsZXJyb3I6Zz9sOiJObyBjb252ZXJzaW9uIGZyb20gIitpKyIgdG8gIitmfX19cmV0dXJue3N0YXRlOiJzdWNjZXNzIixkYXRhOmJ9fXIuZXh0ZW5kKHthY3RpdmU6MCxsYXN0TW9kaWZpZWQ6e30sZXRhZzp7fSxhamF4U2V0dGluZ3M6e3VybDpxYi5ocmVmLHR5cGU6IkdFVCIsaXNMb2NhbDpDYi50ZXN0KHFiLnByb3RvY29sKSxnbG9iYWw6ITAscHJvY2Vzc0RhdGE6ITAsYXN5bmM6ITAsY29udGVudFR5cGU6ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCIsYWNjZXB0czp7IioiOkhiLHRleHQ6InRleHQvcGxhaW4iLGh0bWw6InRleHQvaHRtbCIseG1sOiJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIixqc29uOiJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQifSxjb250ZW50czp7eG1sOi9cYnhtbFxiLyxodG1sOi9cYmh0bWwvLGpzb246L1xianNvblxiL30scmVzcG9uc2VGaWVsZHM6e3htbDoicmVzcG9uc2VYTUwiLHRleHQ6InJlc3BvbnNlVGV4dCIsanNvbjoicmVzcG9uc2VKU09OIn0sY29udmVydGVyczp7IiogdGV4dCI6U3RyaW5nLCJ0ZXh0IGh0bWwiOiEwLCJ0ZXh0IGpzb24iOkpTT04ucGFyc2UsInRleHQgeG1sIjpyLnBhcnNlWE1MfSxmbGF0T3B0aW9uczp7dXJsOiEwLGNvbnRleHQ6ITB9fSxhamF4U2V0dXA6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9MYihMYihhLHIuYWpheFNldHRpbmdzKSxiKTpMYihyLmFqYXhTZXR0aW5ncyxhKX0sYWpheFByZWZpbHRlcjpKYihGYiksYWpheFRyYW5zcG9ydDpKYihHYiksYWpheDpmdW5jdGlvbihiLGMpeyJvYmplY3QiPT10eXBlb2YgYiYmKGM9YixiPXZvaWQgMCksYz1jfHx7fTt2YXIgZSxmLGcsaCxpLGosayxsLG0sbixvPXIuYWpheFNldHVwKHt9LGMpLHA9by5jb250ZXh0fHxvLHE9by5jb250ZXh0JiYocC5ub2RlVHlwZXx8cC5qcXVlcnkpP3IocCk6ci5ldmVudCxzPXIuRGVmZXJyZWQoKSx0PXIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHU9by5zdGF0dXNDb2RlfHx7fSx2PXt9LHc9e30seD0iY2FuY2VsZWQiLHk9e3JlYWR5U3RhdGU6MCxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbihhKXt2YXIgYjtpZihrKXtpZighaCl7aD17fTt3aGlsZShiPUJiLmV4ZWMoZykpaFtiWzFdLnRvTG93ZXJDYXNlKCldPWJbMl19Yj1oW2EudG9Mb3dlckNhc2UoKV19cmV0dXJuIG51bGw9PWI/bnVsbDpifSxnZXRBbGxSZXNwb25zZUhlYWRlcnM6ZnVuY3Rpb24oKXtyZXR1cm4gaz9nOm51bGx9LHNldFJlcXVlc3RIZWFkZXI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbnVsbD09ayYmKGE9d1thLnRvTG93ZXJDYXNlKCldPXdbYS50b0xvd2VyQ2FzZSgpXXx8YSx2W2FdPWIpLHRoaXN9LG92ZXJyaWRlTWltZVR5cGU6ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWsmJihvLm1pbWVUeXBlPWEpLHRoaXN9LHN0YXR1c0NvZGU6ZnVuY3Rpb24oYSl7dmFyIGI7aWYoYSlpZihrKXkuYWx3YXlzKGFbeS5zdGF0dXNdKTtlbHNlIGZvcihiIGluIGEpdVtiXT1bdVtiXSxhW2JdXTtyZXR1cm4gdGhpc30sYWJvcnQ6ZnVuY3Rpb24oYSl7dmFyIGI9YXx8eDtyZXR1cm4gZSYmZS5hYm9ydChiKSxBKDAsYiksdGhpc319O2lmKHMucHJvbWlzZSh5KSxvLnVybD0oKGJ8fG8udXJsfHxxYi5ocmVmKSsiIikucmVwbGFjZShFYixxYi5wcm90b2NvbCsiLy8iKSxvLnR5cGU9Yy5tZXRob2R8fGMudHlwZXx8by5tZXRob2R8fG8udHlwZSxvLmRhdGFUeXBlcz0oby5kYXRhVHlwZXx8IioiKS50b0xvd2VyQ2FzZSgpLm1hdGNoKEspfHxbIiJdLG51bGw9PW8uY3Jvc3NEb21haW4pe2o9ZC5jcmVhdGVFbGVtZW50KCJhIik7dHJ5e2ouaHJlZj1vLnVybCxqLmhyZWY9ai5ocmVmLG8uY3Jvc3NEb21haW49SWIucHJvdG9jb2wrIi8vIitJYi5ob3N0IT1qLnByb3RvY29sKyIvLyIrai5ob3N0fWNhdGNoKHope28uY3Jvc3NEb21haW49ITB9fWlmKG8uZGF0YSYmby5wcm9jZXNzRGF0YSYmInN0cmluZyIhPXR5cGVvZiBvLmRhdGEmJihvLmRhdGE9ci5wYXJhbShvLmRhdGEsby50cmFkaXRpb25hbCkpLEtiKEZiLG8sYyx5KSxrKXJldHVybiB5O2w9ci5ldmVudCYmby5nbG9iYWwsbCYmMD09PXIuYWN0aXZlKysmJnIuZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0Iiksby50eXBlPW8udHlwZS50b1VwcGVyQ2FzZSgpLG8uaGFzQ29udGVudD0hRGIudGVzdChvLnR5cGUpLGY9by51cmwucmVwbGFjZSh6YiwiIiksby5oYXNDb250ZW50P28uZGF0YSYmby5wcm9jZXNzRGF0YSYmMD09PShvLmNvbnRlbnRUeXBlfHwiIikuaW5kZXhPZigiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikmJihvLmRhdGE9by5kYXRhLnJlcGxhY2UoeWIsIisiKSk6KG49by51cmwuc2xpY2UoZi5sZW5ndGgpLG8uZGF0YSYmKGYrPShzYi50ZXN0KGYpPyImIjoiPyIpK28uZGF0YSxkZWxldGUgby5kYXRhKSxvLmNhY2hlPT09ITEmJihmPWYucmVwbGFjZShBYiwiIiksbj0oc2IudGVzdChmKT8iJiI6Ij8iKSsiXz0iK3JiKysgK24pLG8udXJsPWYrbiksby5pZk1vZGlmaWVkJiYoci5sYXN0TW9kaWZpZWRbZl0mJnkuc2V0UmVxdWVzdEhlYWRlcigiSWYtTW9kaWZpZWQtU2luY2UiLHIubGFzdE1vZGlmaWVkW2ZdKSxyLmV0YWdbZl0mJnkuc2V0UmVxdWVzdEhlYWRlcigiSWYtTm9uZS1NYXRjaCIsci5ldGFnW2ZdKSksKG8uZGF0YSYmby5oYXNDb250ZW50JiZvLmNvbnRlbnRUeXBlIT09ITF8fGMuY29udGVudFR5cGUpJiZ5LnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsby5jb250ZW50VHlwZSkseS5zZXRSZXF1ZXN0SGVhZGVyKCJBY2NlcHQiLG8uZGF0YVR5cGVzWzBdJiZvLmFjY2VwdHNbby5kYXRhVHlwZXNbMF1dP28uYWNjZXB0c1tvLmRhdGFUeXBlc1swXV0rKCIqIiE9PW8uZGF0YVR5cGVzWzBdPyIsICIrSGIrIjsgcT0wLjAxIjoiIik6by5hY2NlcHRzWyIqIl0pO2ZvcihtIGluIG8uaGVhZGVycyl5LnNldFJlcXVlc3RIZWFkZXIobSxvLmhlYWRlcnNbbV0pO2lmKG8uYmVmb3JlU2VuZCYmKG8uYmVmb3JlU2VuZC5jYWxsKHAseSxvKT09PSExfHxrKSlyZXR1cm4geS5hYm9ydCgpO2lmKHg9ImFib3J0Iix0LmFkZChvLmNvbXBsZXRlKSx5LmRvbmUoby5zdWNjZXNzKSx5LmZhaWwoby5lcnJvciksZT1LYihHYixvLGMseSkpe2lmKHkucmVhZHlTdGF0ZT0xLGwmJnEudHJpZ2dlcigiYWpheFNlbmQiLFt5LG9dKSxrKXJldHVybiB5O28uYXN5bmMmJm8udGltZW91dD4wJiYoaT1hLnNldFRpbWVvdXQoZnVuY3Rpb24oKXt5LmFib3J0KCJ0aW1lb3V0Iil9LG8udGltZW91dCkpO3RyeXtrPSExLGUuc2VuZCh2LEEpfWNhdGNoKHope2lmKGspdGhyb3cgejtBKC0xLHopfX1lbHNlIEEoLTEsIk5vIFRyYW5zcG9ydCIpO2Z1bmN0aW9uIEEoYixjLGQsaCl7dmFyIGosbSxuLHYsdyx4PWM7a3x8KGs9ITAsaSYmYS5jbGVhclRpbWVvdXQoaSksZT12b2lkIDAsZz1ofHwiIix5LnJlYWR5U3RhdGU9Yj4wPzQ6MCxqPWI+PTIwMCYmYjwzMDB8fDMwND09PWIsZCYmKHY9TWIobyx5LGQpKSx2PU5iKG8sdix5LGopLGo/KG8uaWZNb2RpZmllZCYmKHc9eS5nZXRSZXNwb25zZUhlYWRlcigiTGFzdC1Nb2RpZmllZCIpLHcmJihyLmxhc3RNb2RpZmllZFtmXT13KSx3PXkuZ2V0UmVzcG9uc2VIZWFkZXIoImV0YWciKSx3JiYoci5ldGFnW2ZdPXcpKSwyMDQ9PT1ifHwiSEVBRCI9PT1vLnR5cGU/eD0ibm9jb250ZW50IjozMDQ9PT1iP3g9Im5vdG1vZGlmaWVkIjooeD12LnN0YXRlLG09di5kYXRhLG49di5lcnJvcixqPSFuKSk6KG49eCwhYiYmeHx8KHg9ImVycm9yIixiPDAmJihiPTApKSkseS5zdGF0dXM9Yix5LnN0YXR1c1RleHQ9KGN8fHgpKyIiLGo/cy5yZXNvbHZlV2l0aChwLFttLHgseV0pOnMucmVqZWN0V2l0aChwLFt5LHgsbl0pLHkuc3RhdHVzQ29kZSh1KSx1PXZvaWQgMCxsJiZxLnRyaWdnZXIoaj8iYWpheFN1Y2Nlc3MiOiJhamF4RXJyb3IiLFt5LG8saj9tOm5dKSx0LmZpcmVXaXRoKHAsW3kseF0pLGwmJihxLnRyaWdnZXIoImFqYXhDb21wbGV0ZSIsW3ksb10pLC0tci5hY3RpdmV8fHIuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKSkpfXJldHVybiB5fSxnZXRKU09OOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gci5nZXQoYSxiLGMsImpzb24iKX0sZ2V0U2NyaXB0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIHIuZ2V0KGEsdm9pZCAwLGIsInNjcmlwdCIpfX0pLHIuZWFjaChbImdldCIsInBvc3QiXSxmdW5jdGlvbihhLGIpe3JbYl09ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIHIuaXNGdW5jdGlvbihjKSYmKGU9ZXx8ZCxkPWMsYz12b2lkIDApLHIuYWpheChyLmV4dGVuZCh7dXJsOmEsdHlwZTpiLGRhdGFUeXBlOmUsZGF0YTpjLHN1Y2Nlc3M6ZH0sci5pc1BsYWluT2JqZWN0KGEpJiZhKSl9fSksci5fZXZhbFVybD1mdW5jdGlvbihhKXtyZXR1cm4gci5hamF4KHt1cmw6YSx0eXBlOiJHRVQiLGRhdGFUeXBlOiJzY3JpcHQiLGNhY2hlOiEwLGFzeW5jOiExLGdsb2JhbDohMSwidGhyb3dzIjohMH0pfSxyLmZuLmV4dGVuZCh7d3JhcEFsbDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4gdGhpc1swXSYmKHIuaXNGdW5jdGlvbihhKSYmKGE9YS5jYWxsKHRoaXNbMF0pKSxiPXIoYSx0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKCEwKSx0aGlzWzBdLnBhcmVudE5vZGUmJmIuaW5zZXJ0QmVmb3JlKHRoaXNbMF0pLGIubWFwKGZ1bmN0aW9uKCl7dmFyIGE9dGhpczt3aGlsZShhLmZpcnN0RWxlbWVudENoaWxkKWE9YS5maXJzdEVsZW1lbnRDaGlsZDtyZXR1cm4gYX0pLmFwcGVuZCh0aGlzKSksdGhpc30sd3JhcElubmVyOmZ1bmN0aW9uKGEpe3JldHVybiByLmlzRnVuY3Rpb24oYSk/dGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3IodGhpcykud3JhcElubmVyKGEuY2FsbCh0aGlzLGIpKX0pOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiPXIodGhpcyksYz1iLmNvbnRlbnRzKCk7Yy5sZW5ndGg/Yy53cmFwQWxsKGEpOmIuYXBwZW5kKGEpfSl9LHdyYXA6ZnVuY3Rpb24oYSl7dmFyIGI9ci5pc0Z1bmN0aW9uKGEpO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYyl7cih0aGlzKS53cmFwQWxsKGI/YS5jYWxsKHRoaXMsYyk6YSl9KX0sdW53cmFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnBhcmVudChhKS5ub3QoImJvZHkiKS5lYWNoKGZ1bmN0aW9uKCl7cih0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpfSksdGhpc319KSxyLmV4cHIucHNldWRvcy5oaWRkZW49ZnVuY3Rpb24oYSl7cmV0dXJuIXIuZXhwci5wc2V1ZG9zLnZpc2libGUoYSl9LHIuZXhwci5wc2V1ZG9zLnZpc2libGU9ZnVuY3Rpb24oYSl7cmV0dXJuISEoYS5vZmZzZXRXaWR0aHx8YS5vZmZzZXRIZWlnaHR8fGEuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgpfSxyLmFqYXhTZXR0aW5ncy54aHI9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIG5ldyBhLlhNTEh0dHBSZXF1ZXN0fWNhdGNoKGIpe319O3ZhciBPYj17MDoyMDAsMTIyMzoyMDR9LFBiPXIuYWpheFNldHRpbmdzLnhocigpO28uY29ycz0hIVBiJiYid2l0aENyZWRlbnRpYWxzImluIFBiLG8uYWpheD1QYj0hIVBiLHIuYWpheFRyYW5zcG9ydChmdW5jdGlvbihiKXt2YXIgYyxkO2lmKG8uY29yc3x8UGImJiFiLmNyb3NzRG9tYWluKXJldHVybntzZW5kOmZ1bmN0aW9uKGUsZil7dmFyIGcsaD1iLnhocigpO2lmKGgub3BlbihiLnR5cGUsYi51cmwsYi5hc3luYyxiLnVzZXJuYW1lLGIucGFzc3dvcmQpLGIueGhyRmllbGRzKWZvcihnIGluIGIueGhyRmllbGRzKWhbZ109Yi54aHJGaWVsZHNbZ107Yi5taW1lVHlwZSYmaC5vdmVycmlkZU1pbWVUeXBlJiZoLm92ZXJyaWRlTWltZVR5cGUoYi5taW1lVHlwZSksYi5jcm9zc0RvbWFpbnx8ZVsiWC1SZXF1ZXN0ZWQtV2l0aCJdfHwoZVsiWC1SZXF1ZXN0ZWQtV2l0aCJdPSJYTUxIdHRwUmVxdWVzdCIpO2ZvcihnIGluIGUpaC5zZXRSZXF1ZXN0SGVhZGVyKGcsZVtnXSk7Yz1mdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXtjJiYoYz1kPWgub25sb2FkPWgub25lcnJvcj1oLm9uYWJvcnQ9aC5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbCwiYWJvcnQiPT09YT9oLmFib3J0KCk6ImVycm9yIj09PWE/Im51bWJlciIhPXR5cGVvZiBoLnN0YXR1cz9mKDAsImVycm9yIik6ZihoLnN0YXR1cyxoLnN0YXR1c1RleHQpOmYoT2JbaC5zdGF0dXNdfHxoLnN0YXR1cyxoLnN0YXR1c1RleHQsInRleHQiIT09KGgucmVzcG9uc2VUeXBlfHwidGV4dCIpfHwic3RyaW5nIiE9dHlwZW9mIGgucmVzcG9uc2VUZXh0P3tiaW5hcnk6aC5yZXNwb25zZX06e3RleHQ6aC5yZXNwb25zZVRleHR9LGguZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpKX19LGgub25sb2FkPWMoKSxkPWgub25lcnJvcj1jKCJlcnJvciIpLHZvaWQgMCE9PWgub25hYm9ydD9oLm9uYWJvcnQ9ZDpoLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpezQ9PT1oLnJlYWR5U3RhdGUmJmEuc2V0VGltZW91dChmdW5jdGlvbigpe2MmJmQoKX0pfSxjPWMoImFib3J0Iik7dHJ5e2guc2VuZChiLmhhc0NvbnRlbnQmJmIuZGF0YXx8bnVsbCl9Y2F0Y2goaSl7aWYoYyl0aHJvdyBpfX0sYWJvcnQ6ZnVuY3Rpb24oKXtjJiZjKCl9fX0pLHIuYWpheFByZWZpbHRlcihmdW5jdGlvbihhKXthLmNyb3NzRG9tYWluJiYoYS5jb250ZW50cy5zY3JpcHQ9ITEpfSksci5hamF4U2V0dXAoe2FjY2VwdHM6e3NjcmlwdDoidGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHQifSxjb250ZW50czp7c2NyaXB0Oi9cYig/OmphdmF8ZWNtYSlzY3JpcHRcYi99LGNvbnZlcnRlcnM6eyJ0ZXh0IHNjcmlwdCI6ZnVuY3Rpb24oYSl7cmV0dXJuIHIuZ2xvYmFsRXZhbChhKSxhfX19KSxyLmFqYXhQcmVmaWx0ZXIoInNjcmlwdCIsZnVuY3Rpb24oYSl7dm9pZCAwPT09YS5jYWNoZSYmKGEuY2FjaGU9ITEpLGEuY3Jvc3NEb21haW4mJihhLnR5cGU9IkdFVCIpfSksci5hamF4VHJhbnNwb3J0KCJzY3JpcHQiLGZ1bmN0aW9uKGEpe2lmKGEuY3Jvc3NEb21haW4pe3ZhciBiLGM7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oZSxmKXtiPXIoIjxzY3JpcHQ+IikucHJvcCh7Y2hhcnNldDphLnNjcmlwdENoYXJzZXQsc3JjOmEudXJsfSkub24oImxvYWQgZXJyb3IiLGM9ZnVuY3Rpb24oYSl7Yi5yZW1vdmUoKSxjPW51bGwsYSYmZigiZXJyb3IiPT09YS50eXBlPzQwNDoyMDAsYS50eXBlKX0pLGQuaGVhZC5hcHBlbmRDaGlsZChiWzBdKX0sYWJvcnQ6ZnVuY3Rpb24oKXtjJiZjKCl9fX19KTt2YXIgUWI9W10sUmI9Lyg9KVw/KD89JnwkKXxcP1w/LztyLmFqYXhTZXR1cCh7anNvbnA6ImNhbGxiYWNrIixqc29ucENhbGxiYWNrOmZ1bmN0aW9uKCl7dmFyIGE9UWIucG9wKCl8fHIuZXhwYW5kbysiXyIrcmIrKztyZXR1cm4gdGhpc1thXT0hMCxhfX0pLHIuYWpheFByZWZpbHRlcigianNvbiBqc29ucCIsZnVuY3Rpb24oYixjLGQpe3ZhciBlLGYsZyxoPWIuanNvbnAhPT0hMSYmKFJiLnRlc3QoYi51cmwpPyJ1cmwiOiJzdHJpbmciPT10eXBlb2YgYi5kYXRhJiYwPT09KGIuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmUmIudGVzdChiLmRhdGEpJiYiZGF0YSIpO2lmKGh8fCJqc29ucCI9PT1iLmRhdGFUeXBlc1swXSlyZXR1cm4gZT1iLmpzb25wQ2FsbGJhY2s9ci5pc0Z1bmN0aW9uKGIuanNvbnBDYWxsYmFjayk/Yi5qc29ucENhbGxiYWNrKCk6Yi5qc29ucENhbGxiYWNrLGg/YltoXT1iW2hdLnJlcGxhY2UoUmIsIiQxIitlKTpiLmpzb25wIT09ITEmJihiLnVybCs9KHNiLnRlc3QoYi51cmwpPyImIjoiPyIpK2IuanNvbnArIj0iK2UpLGIuY29udmVydGVyc1sic2NyaXB0IGpzb24iXT1mdW5jdGlvbigpe3JldHVybiBnfHxyLmVycm9yKGUrIiB3YXMgbm90IGNhbGxlZCIpLGdbMF19LGIuZGF0YVR5cGVzWzBdPSJqc29uIixmPWFbZV0sYVtlXT1mdW5jdGlvbigpe2c9YXJndW1lbnRzfSxkLmFsd2F5cyhmdW5jdGlvbigpe3ZvaWQgMD09PWY/cihhKS5yZW1vdmVQcm9wKGUpOmFbZV09ZixiW2VdJiYoYi5qc29ucENhbGxiYWNrPWMuanNvbnBDYWxsYmFjayxRYi5wdXNoKGUpKSxnJiZyLmlzRnVuY3Rpb24oZikmJmYoZ1swXSksZz1mPXZvaWQgMH0pLCJzY3JpcHQifSksby5jcmVhdGVIVE1MRG9jdW1lbnQ9ZnVuY3Rpb24oKXt2YXIgYT1kLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikuYm9keTtyZXR1cm4gYS5pbm5lckhUTUw9Ijxmb3JtPjwvZm9ybT48Zm9ybT48L2Zvcm0+IiwyPT09YS5jaGlsZE5vZGVzLmxlbmd0aH0oKSxyLnBhcnNlSFRNTD1mdW5jdGlvbihhLGIsYyl7aWYoInN0cmluZyIhPXR5cGVvZiBhKXJldHVybltdOyJib29sZWFuIj09dHlwZW9mIGImJihjPWIsYj0hMSk7dmFyIGUsZixnO3JldHVybiBifHwoby5jcmVhdGVIVE1MRG9jdW1lbnQ/KGI9ZC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoIiIpLGU9Yi5jcmVhdGVFbGVtZW50KCJiYXNlIiksZS5ocmVmPWQubG9jYXRpb24uaHJlZixiLmhlYWQuYXBwZW5kQ2hpbGQoZSkpOmI9ZCksZj1CLmV4ZWMoYSksZz0hYyYmW10sZj9bYi5jcmVhdGVFbGVtZW50KGZbMV0pXTooZj1vYShbYV0sYixnKSxnJiZnLmxlbmd0aCYmcihnKS5yZW1vdmUoKSxyLm1lcmdlKFtdLGYuY2hpbGROb2RlcykpfSxyLmZuLmxvYWQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnPXRoaXMsaD1hLmluZGV4T2YoIiAiKTtyZXR1cm4gaD4tMSYmKGQ9ci50cmltKGEuc2xpY2UoaCkpLGE9YS5zbGljZSgwLGgpKSxyLmlzRnVuY3Rpb24oYik/KGM9YixiPXZvaWQgMCk6YiYmIm9iamVjdCI9PXR5cGVvZiBiJiYoZT0iUE9TVCIpLGcubGVuZ3RoPjAmJnIuYWpheCh7dXJsOmEsdHlwZTplfHwiR0VUIixkYXRhVHlwZToiaHRtbCIsZGF0YTpifSkuZG9uZShmdW5jdGlvbihhKXtmPWFyZ3VtZW50cyxnLmh0bWwoZD9yKCI8ZGl2PiIpLmFwcGVuZChyLnBhcnNlSFRNTChhKSkuZmluZChkKTphKX0pLmFsd2F5cyhjJiZmdW5jdGlvbihhLGIpe2cuZWFjaChmdW5jdGlvbigpe2MuYXBwbHkodGhpcyxmfHxbYS5yZXNwb25zZVRleHQsYixhXSl9KX0pLHRoaXN9LHIuZWFjaChbImFqYXhTdGFydCIsImFqYXhTdG9wIiwiYWpheENvbXBsZXRlIiwiYWpheEVycm9yIiwiYWpheFN1Y2Nlc3MiLCJhamF4U2VuZCJdLGZ1bmN0aW9uKGEsYil7ci5mbltiXT1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5vbihiLGEpfX0pLHIuZXhwci5wc2V1ZG9zLmFuaW1hdGVkPWZ1bmN0aW9uKGEpe3JldHVybiByLmdyZXAoci50aW1lcnMsZnVuY3Rpb24oYil7cmV0dXJuIGE9PT1iLmVsZW19KS5sZW5ndGh9O2Z1bmN0aW9uIFNiKGEpe3JldHVybiByLmlzV2luZG93KGEpP2E6OT09PWEubm9kZVR5cGUmJmEuZGVmYXVsdFZpZXd9ci5vZmZzZXQ9e3NldE9mZnNldDpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmLGcsaCxpLGosaz1yLmNzcyhhLCJwb3NpdGlvbiIpLGw9cihhKSxtPXt9OyJzdGF0aWMiPT09ayYmKGEuc3R5bGUucG9zaXRpb249InJlbGF0aXZlIiksaD1sLm9mZnNldCgpLGY9ci5jc3MoYSwidG9wIiksaT1yLmNzcyhhLCJsZWZ0Iiksaj0oImFic29sdXRlIj09PWt8fCJmaXhlZCI9PT1rKSYmKGYraSkuaW5kZXhPZigiYXV0byIpPi0xLGo/KGQ9bC5wb3NpdGlvbigpLGc9ZC50b3AsZT1kLmxlZnQpOihnPXBhcnNlRmxvYXQoZil8fDAsZT1wYXJzZUZsb2F0KGkpfHwwKSxyLmlzRnVuY3Rpb24oYikmJihiPWIuY2FsbChhLGMsci5leHRlbmQoe30saCkpKSxudWxsIT1iLnRvcCYmKG0udG9wPWIudG9wLWgudG9wK2cpLG51bGwhPWIubGVmdCYmKG0ubGVmdD1iLmxlZnQtaC5sZWZ0K2UpLCJ1c2luZyJpbiBiP2IudXNpbmcuY2FsbChhLG0pOmwuY3NzKG0pfX0sci5mbi5leHRlbmQoe29mZnNldDpmdW5jdGlvbihhKXtpZihhcmd1bWVudHMubGVuZ3RoKXJldHVybiB2b2lkIDA9PT1hP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3Iub2Zmc2V0LnNldE9mZnNldCh0aGlzLGEsYil9KTt2YXIgYixjLGQsZSxmPXRoaXNbMF07aWYoZilyZXR1cm4gZi5nZXRDbGllbnRSZWN0cygpLmxlbmd0aD8oZD1mLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGQud2lkdGh8fGQuaGVpZ2h0PyhlPWYub3duZXJEb2N1bWVudCxjPVNiKGUpLGI9ZS5kb2N1bWVudEVsZW1lbnQse3RvcDpkLnRvcCtjLnBhZ2VZT2Zmc2V0LWIuY2xpZW50VG9wLGxlZnQ6ZC5sZWZ0K2MucGFnZVhPZmZzZXQtYi5jbGllbnRMZWZ0fSk6ZCk6e3RvcDowLGxlZnQ6MH19LHBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYodGhpc1swXSl7dmFyIGEsYixjPXRoaXNbMF0sZD17dG9wOjAsbGVmdDowfTtyZXR1cm4iZml4ZWQiPT09ci5jc3MoYywicG9zaXRpb24iKT9iPWMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk6KGE9dGhpcy5vZmZzZXRQYXJlbnQoKSxiPXRoaXMub2Zmc2V0KCksci5ub2RlTmFtZShhWzBdLCJodG1sIil8fChkPWEub2Zmc2V0KCkpLGQ9e3RvcDpkLnRvcCtyLmNzcyhhWzBdLCJib3JkZXJUb3BXaWR0aCIsITApLGxlZnQ6ZC5sZWZ0K3IuY3NzKGFbMF0sImJvcmRlckxlZnRXaWR0aCIsITApfSkse3RvcDpiLnRvcC1kLnRvcC1yLmNzcyhjLCJtYXJnaW5Ub3AiLCEwKSxsZWZ0OmIubGVmdC1kLmxlZnQtci5jc3MoYywibWFyZ2luTGVmdCIsITApfX19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPXRoaXMub2Zmc2V0UGFyZW50O3doaWxlKGEmJiJzdGF0aWMiPT09ci5jc3MoYSwicG9zaXRpb24iKSlhPWEub2Zmc2V0UGFyZW50O3JldHVybiBhfHxwYX0pfX0pLHIuZWFjaCh7c2Nyb2xsTGVmdDoicGFnZVhPZmZzZXQiLHNjcm9sbFRvcDoicGFnZVlPZmZzZXQifSxmdW5jdGlvbihhLGIpe3ZhciBjPSJwYWdlWU9mZnNldCI9PT1iO3IuZm5bYV09ZnVuY3Rpb24oZCl7cmV0dXJuIFModGhpcyxmdW5jdGlvbihhLGQsZSl7dmFyIGY9U2IoYSk7cmV0dXJuIHZvaWQgMD09PWU/Zj9mW2JdOmFbZF06dm9pZChmP2Yuc2Nyb2xsVG8oYz9mLnBhZ2VYT2Zmc2V0OmUsYz9lOmYucGFnZVlPZmZzZXQpOmFbZF09ZSl9LGEsZCxhcmd1bWVudHMubGVuZ3RoKX19KSxyLmVhY2goWyJ0b3AiLCJsZWZ0Il0sZnVuY3Rpb24oYSxiKXtyLmNzc0hvb2tzW2JdPU5hKG8ucGl4ZWxQb3NpdGlvbixmdW5jdGlvbihhLGMpe2lmKGMpcmV0dXJuIGM9TWEoYSxiKSxLYS50ZXN0KGMpP3IoYSkucG9zaXRpb24oKVtiXSsicHgiOmN9KX0pLHIuZWFjaCh7SGVpZ2h0OiJoZWlnaHQiLFdpZHRoOiJ3aWR0aCJ9LGZ1bmN0aW9uKGEsYil7ci5lYWNoKHtwYWRkaW5nOiJpbm5lciIrYSxjb250ZW50OmIsIiI6Im91dGVyIithfSxmdW5jdGlvbihjLGQpe3IuZm5bZF09ZnVuY3Rpb24oZSxmKXt2YXIgZz1hcmd1bWVudHMubGVuZ3RoJiYoY3x8ImJvb2xlYW4iIT10eXBlb2YgZSksaD1jfHwoZT09PSEwfHxmPT09ITA/Im1hcmdpbiI6ImJvcmRlciIpO3JldHVybiBTKHRoaXMsZnVuY3Rpb24oYixjLGUpe3ZhciBmO3JldHVybiByLmlzV2luZG93KGIpPzA9PT1kLmluZGV4T2YoIm91dGVyIik/YlsiaW5uZXIiK2FdOmIuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyJjbGllbnQiK2FdOjk9PT1iLm5vZGVUeXBlPyhmPWIuZG9jdW1lbnRFbGVtZW50LE1hdGgubWF4KGIuYm9keVsic2Nyb2xsIithXSxmWyJzY3JvbGwiK2FdLGIuYm9keVsib2Zmc2V0IithXSxmWyJvZmZzZXQiK2FdLGZbImNsaWVudCIrYV0pKTp2b2lkIDA9PT1lP3IuY3NzKGIsYyxoKTpyLnN0eWxlKGIsYyxlLGgpfSxiLGc/ZTp2b2lkIDAsZyl9fSl9KSxyLmZuLmV4dGVuZCh7YmluZDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIHRoaXMub24oYSxudWxsLGIsYyl9LHVuYmluZDpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLm9mZihhLG51bGwsYil9LGRlbGVnYXRlOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLm9uKGIsYSxjLGQpfSx1bmRlbGVnYXRlOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vZmYoYSwiKioiKTp0aGlzLm9mZihiLGF8fCIqKiIsYyl9fSksci5wYXJzZUpTT049SlNPTi5wYXJzZSwiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kJiZkZWZpbmUoImpxdWVyeSIsW10sZnVuY3Rpb24oKXtyZXR1cm4gcn0pO3ZhciBUYj1hLmpRdWVyeSxVYj1hLiQ7cmV0dXJuIHIubm9Db25mbGljdD1mdW5jdGlvbihiKXtyZXR1cm4gYS4kPT09ciYmKGEuJD1VYiksYiYmYS5qUXVlcnk9PT1yJiYoYS5qUXVlcnk9VGIpLHJ9LGJ8fChhLmpRdWVyeT1hLiQ9cikscn0pOwo="}]},{"name":"The New York Times Paywall Bypass","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":["/^(?:^http.://www.nytimes.com/\\d{4}\\/.*)$/","https://www.nytimes.com/slideshow*","https://www.nytimes.com/live*","https://www.nytimes.com/interactive*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685022661000,"data":{}},"enabled":true,"position":12,"file_url":"https://greasyfork.org/scripts/441034-the-new-york-times-paywall-bypass/code/The%20New%20York%20Times%20Paywall%20Bypass.user.js","uuid":"132a7801-1bb3-4a64-9abf-8272100dc2b6","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgVGhlIE5ldyBZb3JrIFRpbWVzIFBheXdhbGwgQnlwYXNzCi8vIEBuYW1lc3BhY2UgaHR0cHM6Ly9qb3NoY2FudGNvLmRlCi8vIEB2ZXJzaW9uIDEuMi4wCi8vIEBkZXNjcmlwdGlvbiBSZW1vdmVzIHBheXdhbGxzIHdoZW4gdHJ5aW5nIHRvIHZpZXcgY29udGVudCBvbiBUaGUgTmV3IFlvcmsgVGltZXMKLy8gQGF1dGhvciBKb3NodWEgRm91bnRhaW4KLy8gQGxpY2Vuc2UgR1BMLTMuMC1vci1sYXRlcgovLyBAZ3JhbnQgR01fYWRkU3R5bGUKLy8gQHJ1bi1hdCBkb2N1bWVudC1zdGFydAovLyBAaW5jbHVkZSAvXig/Ol5odHRwLjovL3d3dy5ueXRpbWVzLmNvbS9cZHs0fVwvLiopJC8KLy8gQGluY2x1ZGUgaHR0cHM6Ly93d3cubnl0aW1lcy5jb20vc2xpZGVzaG93KgovLyBAaW5jbHVkZSBodHRwczovL3d3dy5ueXRpbWVzLmNvbS9saXZlKgovLyBAaW5jbHVkZSBodHRwczovL3d3dy5ueXRpbWVzLmNvbS9pbnRlcmFjdGl2ZSoKLy8gPT0vVXNlclNjcmlwdD09CgooZnVuY3Rpb24oKSB7CiAgICBsZXQgY3NzID0gYAogICAgICAgICNhcHAgPiBkaXYgPiBkaXY6bm90KFtpZF0pLCAjc2l0ZS1jb250ZW50IHsKICAgICAgICAgICAgcG9zaXRpb246IHN0YXRpYyAhaW1wb3J0YW50OwogICAgICAgIH0KICAgICAgICAjZ2F0ZXdheS1jb250ZW50LCAjc3RhbmRhbG9uZS1oZWFkZXIsICNhcHAgPiBkaXYgPiBkaXY6Zmlyc3QtY2hpbGQgPiBkaXY6bGFzdC1jaGlsZCB7CiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgfQogICAgYDsKICAgIGlmICh0eXBlb2YgR01fYWRkU3R5bGUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgR01fYWRkU3R5bGUoY3NzKTsKICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IHN0eWxlTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7CiAgICAgICAgc3R5bGVOb2RlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcykpOwogICAgICAgIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJoZWFkIikgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5hcHBlbmRDaGlsZChzdHlsZU5vZGUpOwogICAgfQp9KSgpOw=="},{"name":"Bypass Paywalls","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["*://*.adweek.com/*","*://*.ad.nl/*","*://*.americanbanker.com/*","*://*.ambito.com/*","*://*.baltimoresun.com/*","*://*.barrons.com/*","*://*.bloombergquint.com/*","*://*.bloomberg.com/*","*://*.bndestem.nl/*","*://*.bostonglobe.com/*","*://*.bd.nl/*","*://*.brisbanetimes.com.au/*","*://*.businessinsider.com/*","*://*.caixinglobal.com/*","*://*.centralwesterndaily.com.au/*","*://*.acs.org/*","*://*.chicagotribune.com/*","*://*.corriere.it/*","*://*.chicagobusiness.com/*","*://*.dailypress.com/*","*://*.gelderlander.nl/*","*://*.groene.nl/*","*://*.destentor.nl/*","*://*.speld.nl/*","*://*.tijd.be/*","*://*.volkskrant.nl/*","*://*.demorgen.be/*","*://*.denverpost.com/*","*://*.df.cl/*","*://*.editorialedomani.it/*","*://*.dynamed.com/*","*://*.ed.nl/*","*://*.elmercurio.com/*","*://*.elpais.com/*","*://*.elperiodico.com/*","*://*.elu24.ee/*","*://*.britannica.com/*","*://*.estadao.com.br/*","*://*.examiner.com.au/*","*://*.expansion.com/*","*://*.fnlondon.com/*","*://*.financialpost.com/*","*://*.ft.com/*","*://*.firstthings.com/*","*://*.foreignpolicy.com/*","*://*.fortune.com/*","*://*.genomeweb.com/*","*://*.glassdoor.com/*","*://*.globes.co.il/*","*://*.grubstreet.com/*","*://*.haaretz.co.il/*","*://*.haaretz.com/*","*://*.handelsblatt.com/*","*://*.harpers.org/*","*://*.courant.com/*","*://*.hbr.org/*","*://*.heraldsun.com.au/*","*://*.fd.nl/*","*://*.historyextra.com/*","*://*.humo.be/*","*://*.ilmanifesto.it/*","*://*.inc.com/*","*://*.interest.co.nz/*","*://*.investorschronicle.co.uk)","*://*.lecho.be/*","*://*.labusinessjournal.com/*","*://*.lanacion.com.ar/*","*://*.repubblica.it/*","*://*.lastampa.it/*","*://*.latercera.com/*","*://*.lavoixdunord.fr/*","*://*.ledevoir.com/*","*://*.leparisien.fr/*","*://*.lesechos.fr/*","*://*.loebclassics.com/*","*://*.lrb.co.uk/*","*://*.latimes.com/*","*://*.mit.edu/*","*://*.technologyreview.com/*","*://*.medium.com/*","*://*.medscape.com/*","*://*.mexiconewsdaily.com/*","*://*.mv-voice.com/*","*://*.nationalgeographic.com/*","*://*.nydailynews.com/*","*://*.nrc.nl/*","*://*.ntnews.com.au/*","*://*.nationalpost.com/*","*://*.nzz.ch/*","*://*.nymag.com/*","*://*.nzherald.co.nz/*","*://*.ocregister.com/*","*://*.orlandosentinel.com/*","*://*.pzc.nl/*","*://*.paloaltoonline.com/*","*://*.parool.nl/*","*://*.postimees.ee/*","*://*.qz.com/*","*://*.quora.com/*","*://*.gelocal.it/*","*://*.republic.ru/*","*://*.reuters.com/*","*://*.sandiegouniontribune.com/*","*://*.sfchronicle.com/*","*://*.scientificamerican.com/*","*://*.seekingalpha.com/*","*://*.slate.com/*","*://*.sofrep.com/*","*://*.statista.com/*","*://*.startribune.com/*","*://*.stuff.co.nz/*","*://*.sun-sentinel.com/*","*://*.techinasia.com/*","*://*.telegraaf.nl/*","*://*.adelaidenow.com.au/*","*://*.theadvocate.com.au/*","*://*.theage.com.au/*","*://*.the-american-interest.com/*","*://*.theathletic.com/*","*://*.theathletic.co.uk/*","*://*.theatlantic.com/*","*://*.afr.com/*","*://*.theaustralian.com.au/*","*://*.bizjournals.com/*","*://*.canberratimes.com.au/*","*://*.thecourier.com.au/*","*://*.couriermail.com.au/*","*://*.thecut.com/*","*://*.dailytelegraph.com.au/*","*://*.thediplomat.com/*","*://*.economist.com/*","*://*.theglobeandmail.com/*","*://*.theherald.com.au/*","*://*.thehindu.com/*","*://*.irishtimes.com/*","*://*.kansascity.com/*","*://*.mercurynews.com/*","*://*.themercury.com.au/*","*://*.mcall.com/*","*://*.thenation.com/*","*://*.thenational.scot/*","*://*.newstatesman.com/*","*://*.nytimes.com/*","*://*.newyorker.com/*","*://*.news-gazette.com/*","*://*.theolivepress.es/*","*://*.inquirer.com/*","*://*.thesaturdaypaper.com.au/*","*://*.seattletimes.com/*","*://*.spectator.com.au/*","*://*.spectator.co.uk/*","*://*.smh.com.au/*","*://*.telegraph.co.uk/*","*://*.thestar.com/*","*://*.wsj.com/*","*://*.washingtonpost.com/*","*://*.thewrap.com/*","*://*.themarker.com/*","*://*.the-tls.co.uk/*","*://*.towardsdatascience.com/*","*://*.trouw.nl/*","*://*.tubantia.nl/*","*://*.vanityfair.com/*","*://*.vn.nl/*","*://*.vulture.com/*","*://*.journalnow.com/*","*://*.wired.com/*","*://*.worldpoliticsreview.com/*","*://*.zeit.de/*"],"orig_noframes":null,"orig_run_at":"document-end","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685022692508,"data":{}},"enabled":true,"position":13,"file_url":"https://github.com/LegeBeker/bypass-paywalls-tampermonkey/raw/master/bypass-paywalls-tampermonkey.user.js","uuid":"3d957d56-775a-4d10-826b-cfc44bf2aec9","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBCeXBhc3MgUGF5d2FsbHMKLy8gQGRlc2NyaXB0aW9uICBBIHdheSB0byBieXBhc3MgcGF5d2FsbHMgZm9yIHBvcHVsYXIgbmV3cyBzaXRlcwovLyBAYXV0aG9yICAgICAgIExlZ2VCZWtlciAoaHR0cHM6Ly9naXRodWIuY29tL0xlZ2VCZWtlciksIChGb3JrIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2lhbWFkYW1kZXYvYnlwYXNzLXBheXdhbGxzLWNocm9tZSkKLy8gQG5hbWVzcGFjZSAgICBodHRwczovL2dpdGh1Yi5jb20vTGVnZUJla2VyL2J5cGFzcy1wYXl3YWxscy10YW1wZXJtb25rZXkvCi8vIEBzdXBwb3J0VVJMICAgaHR0cHM6Ly9naXRodWIuY29tL0xlZ2VCZWtlci9ieXBhc3MtcGF5d2FsbHMtdGFtcGVybW9ua2V5L2lzc3VlcwovLyBAdXBkYXRlVVJMICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9MZWdlQmVrZXIvYnlwYXNzLXBheXdhbGxzLXRhbXBlcm1vbmtleS9yYXcvbWFzdGVyL2J5cGFzcy1wYXl3YWxscy10YW1wZXJtb25rZXkudXNlci5qcwovLyBAZG93bmxvYWRVUkwgIGh0dHBzOi8vZ2l0aHViLmNvbS9MZWdlQmVrZXIvYnlwYXNzLXBheXdhbGxzLXRhbXBlcm1vbmtleS9yYXcvbWFzdGVyL2J5cGFzcy1wYXl3YWxscy10YW1wZXJtb25rZXkudXNlci5qcwovLyBAaWNvbiAgICAgICAgIGRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBSUFBQUFDQUNBUUFBQUJwTjZsQUFBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFDQmpTRkpOQUFCNkpnQUFnSVFBQVBvQUFBQ0E2QUFBZFRBQUFPcGdBQUE2bUFBQUYzQ2N1bEU4QUFBQUFtSkxSMFFBLzRlUHpMOEFBQUFKY0VoWmN3QUFDeE1BQUFzVEFRQ2FuQmdBQUFBSGRFbE5SUWZrQmhBUExBTTFQQ3dpQUFBQlowbEVRVlI0MnUzYVBVb0RVUmlHMGJzQlU2VzJVS0xyTVFvV3JrSVkzWXU5SU5oYUJsZGlkQk5HckpMWFFoUzlNWVU0Z3VNOVR6a3pDZHlUK2ZsSVVvb2tTWklrU1ZKVi9ua0FBQUFBQUFCQXl3QzlpdzFzcmdFQUFBQUFBQUFBYkY3Z2QvZjNQWm45OXZzQkFBQUFBQUFBQVBvRCtQRmdNdlJCQ0FBQUFBQUFBQURRRzBEemd4QUFBQUFBQUFEZyt3Q1RJQUFBQUFBQUFPRC9BWDRaQWdBQUFBQUFBUDRRd05BQ0FBQUFBQUFBQUJpRUFBQUFBQUFBQUFBR0lRQUFtZ2RZVkZ1MlBoMCtxdll1QnI3OGVqMlBKZmZWcG9OUEx6aXM5ajRNSEtCZXo3emt0dDZVOGZ2aDQ4eXJ2VGVEWHY3NmVtWWw1MnVQem5tbUdXV1V3N1d6SXprZDhNbi8xWHE2a3YyczBtckxURW9wdVdvVzRQTDE1TmpOVTVQTFgyVG43ZnFZTm5nWnJITDg4Ulp4MWhqQktsMTlsenhxNkVKNHpzbFhENHJ0WEdUWndHZC9uZDNOVDh1OWRKbmxibTFBL2crM3ZMdk0wbVZTSkVtU0pFbVNKRWxTbzcwQXFnQUpBRE9ZbGZRQUFBQWxkRVZZZEdSaGRHVTZZM0psWVhSbEFESXdNakF0TURZdE1UWlVNVFU2TkRNNk5UY3JNREE2TURBVC9tVklBQUFBSlhSRldIUmtZWFJsT20xdlpHbG1lUUF5TURJd0xUQTJMVEUyVkRFMU9qUXpPalUzS3pBd09qQXdZcVBkOUFBQUFBQkpSVTVFcmtKZ2dnPT0KLy8gQHJ1bi1hdCAgICAgICBkb2N1bWVudC1lbmQKLy8gQHZlcnNpb24gICAgICAwLjEuMQovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmFkd2Vlay5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmFkLm5sLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5hbWVyaWNhbmJhbmtlci5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmFtYml0by5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmJhbHRpbW9yZXN1bi5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmJhcnJvbnMuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5ibG9vbWJlcmdxdWludC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmJsb29tYmVyZy5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmJuZGVzdGVtLm5sLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5ib3N0b25nbG9iZS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmJkLm5sLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5icmlzYmFuZXRpbWVzLmNvbS5hdS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouYnVzaW5lc3NpbnNpZGVyLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouY2FpeGluZ2xvYmFsLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouY2VudHJhbHdlc3Rlcm5kYWlseS5jb20uYXUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmFjcy5vcmcvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmNoaWNhZ290cmlidW5lLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouY29ycmllcmUuaXQvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmNoaWNhZ29idXNpbmVzcy5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmRhaWx5cHJlc3MuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5nZWxkZXJsYW5kZXIubmwvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmdyb2VuZS5ubC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZGVzdGVudG9yLm5sLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5zcGVsZC5ubC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGlqZC5iZS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudm9sa3NrcmFudC5ubC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZGVtb3JnZW4uYmUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmRlbnZlcnBvc3QuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5kZi5jbC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZWRpdG9yaWFsZWRvbWFuaS5pdC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZHluYW1lZC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmVkLm5sLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5lbG1lcmN1cmlvLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZWxwYWlzLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZWxwZXJpb2RpY28uY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5lbHUyNC5lZS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouYnJpdGFubmljYS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmVzdGFkYW8uY29tLmJyLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5leGFtaW5lci5jb20uYXUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmV4cGFuc2lvbi5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmZubG9uZG9uLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZmluYW5jaWFscG9zdC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmZ0LmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZmlyc3R0aGluZ3MuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5mb3JlaWducG9saWN5LmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZm9ydHVuZS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmdlbm9tZXdlYi5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmdsYXNzZG9vci5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmdsb2Jlcy5jby5pbC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZ3J1YnN0cmVldC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmhhYXJldHouY28uaWwvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmhhYXJldHouY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5oYW5kZWxzYmxhdHQuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5oYXJwZXJzLm9yZy8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouY291cmFudC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmhici5vcmcvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmhlcmFsZHN1bi5jb20uYXUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmZkLm5sLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5oaXN0b3J5ZXh0cmEuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5odW1vLmJlLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5pbG1hbmlmZXN0by5pdC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouaW5jLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouaW50ZXJlc3QuY28ubnovKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmludmVzdG9yc2Nocm9uaWNsZS5jby51aykKLy8gQG1hdGNoICAgICAgICAqOi8vKi5sZWNoby5iZS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoubGFidXNpbmVzc2pvdXJuYWwuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5sYW5hY2lvbi5jb20uYXIvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnJlcHViYmxpY2EuaXQvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmxhc3RhbXBhLml0LyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5sYXRlcmNlcmEuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5sYXZvaXhkdW5vcmQuZnIvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmxlZGV2b2lyLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoubGVwYXJpc2llbi5mci8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoubGVzZWNob3MuZnIvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmxvZWJjbGFzc2ljcy5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmxyYi5jby51ay8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoubGF0aW1lcy5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLm1pdC5lZHUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRlY2hub2xvZ3lyZXZpZXcuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5tZWRpdW0uY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5tZWRzY2FwZS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLm1leGljb25ld3NkYWlseS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLm12LXZvaWNlLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoubmF0aW9uYWxnZW9ncmFwaGljLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoubnlkYWlseW5ld3MuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5ucmMubmwvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLm50bmV3cy5jb20uYXUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLm5hdGlvbmFscG9zdC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLm56ei5jaC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoubnltYWcuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5uemhlcmFsZC5jby5uei8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoub2NyZWdpc3Rlci5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLm9ybGFuZG9zZW50aW5lbC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnB6Yy5ubC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoucGFsb2FsdG9vbmxpbmUuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5wYXJvb2wubmwvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnBvc3RpbWVlcy5lZS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoucXouY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5xdW9yYS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmdlbG9jYWwuaXQvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnJlcHVibGljLnJ1LyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5yZXV0ZXJzLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouc2FuZGllZ291bmlvbnRyaWJ1bmUuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5zZmNocm9uaWNsZS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnNjaWVudGlmaWNhbWVyaWNhbi5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnNlZWtpbmdhbHBoYS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnNsYXRlLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouc29mcmVwLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouc3RhdGlzdGEuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5zdGFydHJpYnVuZS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnN0dWZmLmNvLm56LyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5zdW4tc2VudGluZWwuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi50ZWNoaW5hc2lhLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGVsZWdyYWFmLm5sLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5hZGVsYWlkZW5vdy5jb20uYXUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZWFkdm9jYXRlLmNvbS5hdS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGhlYWdlLmNvbS5hdS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGhlLWFtZXJpY2FuLWludGVyZXN0LmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGhlYXRobGV0aWMuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi50aGVhdGhsZXRpYy5jby51ay8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGhlYXRsYW50aWMuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5hZnIuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi50aGVhdXN0cmFsaWFuLmNvbS5hdS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouYml6am91cm5hbHMuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5jYW5iZXJyYXRpbWVzLmNvbS5hdS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGhlY291cmllci5jb20uYXUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmNvdXJpZXJtYWlsLmNvbS5hdS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGhlY3V0LmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouZGFpbHl0ZWxlZ3JhcGguY29tLmF1LyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi50aGVkaXBsb21hdC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmVjb25vbWlzdC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZWdsb2JlYW5kbWFpbC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZWhlcmFsZC5jb20uYXUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZWhpbmR1LmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouaXJpc2h0aW1lcy5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLmthbnNhc2NpdHkuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5tZXJjdXJ5bmV3cy5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZW1lcmN1cnkuY29tLmF1LyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5tY2FsbC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZW5hdGlvbi5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZW5hdGlvbmFsLnNjb3QvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLm5ld3N0YXRlc21hbi5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLm55dGltZXMuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5uZXd5b3JrZXIuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5uZXdzLWdhemV0dGUuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi50aGVvbGl2ZXByZXNzLmVzLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5pbnF1aXJlci5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZXNhdHVyZGF5cGFwZXIuY29tLmF1LyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5zZWF0dGxldGltZXMuY29tLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5zcGVjdGF0b3IuY29tLmF1LyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi5zcGVjdGF0b3IuY28udWsvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnNtaC5jb20uYXUvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRlbGVncmFwaC5jby51ay8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGhlc3Rhci5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLndzai5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLndhc2hpbmd0b25wb3N0LmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudGhld3JhcC5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZW1hcmtlci5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRoZS10bHMuY28udWsvKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRvd2FyZHNkYXRhc2NpZW5jZS5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnRyb3V3Lm5sLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi50dWJhbnRpYS5ubC8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoudmFuaXR5ZmFpci5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnZuLm5sLyoKLy8gQG1hdGNoICAgICAgICAqOi8vKi52dWx0dXJlLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyouam91cm5hbG5vdy5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLndpcmVkLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgKjovLyoud29ybGRwb2xpdGljc3Jldmlldy5jb20vKgovLyBAbWF0Y2ggICAgICAgICo6Ly8qLnplaXQuZGUvKgovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbiAoKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgaWYgKCFtYXRjaERvbWFpbihbJ3NlZWtpbmdhbHBoYS5jb20nLCAnc2ZjaHJvbmljbGUuY29tJywgJ2Nlbi5hY3Mub3JnJywgJ2VsbXVuZG8uZXMnXSkpIHsKICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmNsZWFyKCk7CiAgICB9CgogICAgaWYgKG1hdGNoRG9tYWluKCdlbG1lcmN1cmlvLmNvbScpKSB7CiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJy9pbnZlcnNpb25lcy8nKSkgewogICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgcGF5d2FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtb2RhbF9saW1pdF9hcnRpY3Vsb3MnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7CiAgICAgICAgICAgICAgICByZW1vdmVET01FbGVtZW50KHBheXdhbGwpOwogICAgICAgICAgICAgICAgaWYgKGJvZHkuaGFzQXR0cmlidXRlKCdjbGFzcycpKSB7IGJvZHkucmVtb3ZlQXR0cmlidXRlKCdjbGFzcycpOyB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2VzdGFkYW8uY29tLmJyJykpIHsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29uc3QgcGF5d2FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwYXl3YWxsLXdyYXBwZXItaWZyYW1lLWVzdGFkYW8nKTsKICAgICAgICAgICAgY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKTsKCiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQocGF5d2FsbCk7CiAgICAgICAgICAgIGJvZHkucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpOwogICAgICAgIH0sIDMwMCk7IC8vIERlbGF5IChpbiBtaWxsaXNlY29uZHMpCiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdyZXAucmVwdWJibGljYS5pdCcpKSB7CiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoJy9wd2EvJykpIHsKICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWYucmVwbGFjZSgnL3B3YS8nLCAnL3dzL2RldGFpbC8nKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIDUwMCk7CiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCcvd3MvZGV0YWlsLycpKSB7CiAgICAgICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGF5d2FsbCcpOwogICAgICAgICAgICBpZiAocGF5d2FsbCkgewogICAgICAgICAgICAgICAgYW1wVW5oaWRlU3Vic2NyaXB0aW9uc1NlY3Rpb24oKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2FtZXJpY2FuYmFua2VyLmNvbScpKSB7CiAgICAgICAgY29uc3QgaW5saW5lR2F0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbmxpbmUtZ2F0ZScpOwogICAgICAgIGlmIChpbmxpbmVHYXRlKSB7CiAgICAgICAgICAgIGlubGluZUdhdGUuY2xhc3NMaXN0LnJlbW92ZSgnaW5saW5lLWdhdGUnKTsKICAgICAgICAgICAgY29uc3QgaW5saW5lR2F0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5saW5lLWdhdGVkJyk7CiAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbSBvZiBpbmxpbmVHYXRlZCkgeyBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2lubGluZS1nYXRlZCcpOyB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbigndGVsZWdyYWFmLm5sJykpIHsKICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuc3RhcnRzV2l0aCgnaHR0cHM6Ly93d3cudGVsZWdyYWFmLm5sL2Vycm9yP3JlZj0vJykpIHsKICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5zcGxpdCgnJicpWzBdLnJlcGxhY2UoJ2Vycm9yP3JlZj0vJywgJycpOwogICAgICAgIH0KICAgICAgICBjb25zdCBhcnRpY2xlV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5BcnRpY2xlUGFnZVdyYXBwZXJfX3VpZCcpOwogICAgICAgIGNvbnN0IHNwb3RYQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLkFydGljbGVCb2R5QmxvY2tzX19pbmxpbmVBcnRpY2xlU3BvdFhCYW5uZXInKTsKICAgICAgICBjb25zdCBwYXl3YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLlBvcHVwQmFja2Ryb3BfX2Jsb2NrJyk7CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChzcG90WEJhbm5lciwgcGF5d2FsbCk7CiAgICAgICAgY29uc3QgcHJlbWl1bSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5QcmVtaXVtTGFiZWxXaXRoTGluZV9fYm9keScpOwogICAgICAgIGNvbnN0IGFydGljbGVJZCA9IGFydGljbGVXcmFwcGVyID8gYXJ0aWNsZVdyYXBwZXIuaW5uZXJUZXh0IDogJzEyMyc7CiAgICAgICAgY29uc3QgYXJ0aWNsZUJvZHlEb25lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FydGljbGVCb2R5JyArIGFydGljbGVJZCk7CiAgICAgICAgaWYgKHByZW1pdW0gJiYgIWFydGljbGVCb2R5RG9uZSkgewogICAgICAgICAgICBjb25zdCBhcnRpY2xlQm9keU9sZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tpZF49YXJ0aWNsZUJvZHldJyk7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQoYXJ0aWNsZUJvZHlPbGQpOwogICAgICAgICAgICBjb25zdCBqc29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2NyaXB0W3R5cGU9ImFwcGxpY2F0aW9uL2xkK2pzb24iXVtkYXRhLXJlYWN0LWhlbG1ldD0idHJ1ZSJdJyk7CiAgICAgICAgICAgIGlmIChqc29uKSB7CiAgICAgICAgICAgICAgICBjb25zdCBqc29uVGV4dCA9IEpTT04ucGFyc2UoanNvbi50ZXh0KS5hcnRpY2xlQm9keTsKICAgICAgICAgICAgICAgIGNvbnN0IGFydGljbGVCb2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2VjdGlvbi5UZXh0QXJ0aWNsZVBhZ2VfX2JvZHlUZXh0Jyk7CiAgICAgICAgICAgICAgICBpZiAoYXJ0aWNsZUJvZHkpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBkaXZNYWluID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgZGl2TWFpbi5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2FydGljbGVCb2R5JyArIGFydGljbGVJZCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGl2RWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgIGRpdkVsZW0uc2V0QXR0cmlidXRlKCdkYXRhLWVsZW1lbnQnLCAnYXJ0aWNsZUJvZHlCbG9ja3MnKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0QXJyYXkgPSBqc29uVGV4dC5zcGxpdCgnXG5cbicpOwogICAgICAgICAgICAgICAgICAgIHRleHRBcnJheS5mb3JFYWNoKHBUZXh0ID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsKICAgICAgICAgICAgICAgICAgICAgICAgcERpdi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ0FydGljbGVCb2R5QmxvY2tzX19wYXJhZ3JhcGggQXJ0aWNsZUJvZHlCbG9ja3NfX3BhcmFncmFwaC0tbmlldXdzJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHBEaXYuaW5uZXJUZXh0ID0gcFRleHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpdkVsZW0uYXBwZW5kQ2hpbGQocERpdik7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgZGl2TWFpbi5hcHBlbmRDaGlsZChkaXZFbGVtKTsKICAgICAgICAgICAgICAgICAgICBhcnRpY2xlQm9keS5hcHBlbmRDaGlsZChkaXZNYWluKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oWydhZC5ubCcsICdlZC5ubCcsICdibmRlc3RlbS5ubCcsICdiZC5ubCcsICd0dWJhbnRpYS5ubCcsICdkZXN0ZW50b3IubmwnLCAncHpjLm5sJywgJ2dlbGRlcmxhbmRlci5ubCddKSkgewogICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJ0aWNsZV9fY29tcG9uZW50LmFydGljbGVfX2NvbXBvbmVudC0tcGF5d2FsbC1tb2R1bGUtbm90aWZpY2F0aW9uJyk7CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ3dhc2hpbmd0b25wb3N0LmNvbScpKSB7CiAgICAgICAgY29uc3QgbGVhZGVyYm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGVhZGVyYm9hcmQtd3JhcHBlcicpOwogICAgICAgIGNvbnN0IGFkdmVydHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdkaXZbZGF0YS1xYT0iYXJ0aWNsZS1ib2R5LWFkIl0nKTsKICAgICAgICBjb25zdCBzb2Z0d2FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tpZF49InNvZnR3YWxsIl0nKTsKICAgICAgICByZW1vdmVET01FbGVtZW50KGxlYWRlcmJvYXJkLCBzb2Z0d2FsbCwgLi4uYWR2ZXJ0cyk7CiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCcvZ2Rwci1jb25zZW50LycpKSB7CiAgICAgICAgICAgIGNvbnN0IGZyZWVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2Rwci1jb25zZW50LWNvbnRhaW5lciAuY29udGludWUtYnRuLmJ1dHRvbi5mcmVlJyk7CiAgICAgICAgICAgIGlmIChmcmVlQnV0dG9uKSB7IGZyZWVCdXR0b24uY2xpY2soKTsgfQogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBjb25zdCBnZHByY2hlY2tib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2Rwci1jb25zZW50LWNvbnRhaW5lciAuY29uc2VudC1wYWdlOm5vdCguaGlkZSkgI2FncmVlJyk7CiAgICAgICAgICAgICAgICBpZiAoZ2RwcmNoZWNrYm94KSB7CiAgICAgICAgICAgICAgICAgICAgZ2RwcmNoZWNrYm94LmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGdkcHJjaGVja2JveC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2hhbmdlJykpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nZHByLWNvbnNlbnQtY29udGFpbmVyIC5jb25zZW50LXBhZ2U6bm90KC5oaWRlKSAuY29udGludWUtYnRuLmJ1dHRvbi5hY2NlcHQtY29uc2VudCcpLmNsaWNrKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIDMwMCk7IC8vIERlbGF5IChpbiBtaWxsaXNlY29uZHMpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgIGZ1bmN0aW9uIG1haW4oZWxlbWVudCkgewogICAgICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChlbGVtZW50KTsKICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdXJsLnNwbGl0KCc/JylbMF0gKyAnP291dHB1dFR5cGU9YW1wJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXVybC5pbmNsdWRlcygnb3V0cHV0VHlwZT1hbXAnKSkgewogICAgICAgICAgICAgICAgd2FpdERPTUVsZW1lbnQoJ2RpdltpZF49InBheXdhbGwtIl0nLCAnRElWJywgbWFpbiwgZmFsc2UpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uc1NlY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3N1YnNjcmlwdGlvbnMtc2VjdGlvbj0iY29udGVudCJdJyk7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN1YnNjcmlwdGlvbnNTZWN0aW9uIG9mIHN1YnNjcmlwdGlvbnNTZWN0aW9ucykgeyBzdWJzY3JpcHRpb25zU2VjdGlvbi5yZW1vdmVBdHRyaWJ1dGUoJ3N1YnNjcmlwdGlvbnMtc2VjdGlvbicpOyB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCd3c2ouY29tJykgJiYgIW1hdGNoRG9tYWluKCdjbi53c2ouY29tJykpIHsKICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoJy9hcnRpY2xlcy8nKSkgewogICAgICAgICAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5jbG9zZS1idG5bcm9sZT0iYnV0dG9uIl0nKTsKICAgICAgICAgICAgaWYgKGNsb3NlQnV0dG9uKSB7IGNsb3NlQnV0dG9uLmNsaWNrKCk7IH0KICAgICAgICB9CiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsKICAgICAgICAgICAgY29uc3QgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgIGNvbnN0IHNuaXBwZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc25pcHBldC1wcm9tb3Rpb24nKTsKICAgICAgICAgICAgY29uc3Qgd3NqUHJvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPSJwYWdlLnNpdGUiXVtjb250ZW50PSJ3c2pwcm8iXScpOwogICAgICAgICAgICBpZiAoc25pcHBldCB8fCB3c2pQcm8pIHsKICAgICAgICAgICAgICAgIGlmICghd2luZG93LmxvY2F0aW9uLmhhc2gpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCc/JykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmwucmVwbGFjZSgnPycsICcjcmVmcmVzaGVkPycpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7IHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdXJsICsgJyNyZWZyZXNoZWQnOyB9CiAgICAgICAgICAgICAgICB9IGVsc2UgeyB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnJlcGxhY2UoJ3dzai5jb20nLCAnd3NqLmNvbS9hbXAnKS5yZXBsYWNlKCcjcmVmcmVzaGVkJywgJycpOyB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ3Nsb2FucmV2aWV3Lm1pdC5lZHUnKSkgewogICAgICAgIGNvbnN0IHJlYWRNb3JlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ0bi1yZWFkLW1vcmUnKTsKICAgICAgICBpZiAocmVhZE1vcmUpIHsKICAgICAgICAgICAgcmVhZE1vcmUuY2xpY2soKTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdtZXhpY29uZXdzZGFpbHkuY29tJykpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LnBpZ2Vvbi13aWRnZXQtcHJvbXB0Jyk7CiAgICAgICAgICAgIGNvbnN0IGNwcm9PdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNwcm8tb3ZlcmxheScpOwogICAgICAgICAgICByZW1vdmVET01FbGVtZW50KHBvcHVwLCBjcHJvT3ZlcmxheSk7CiAgICAgICAgfSwgNTAwKTsgLy8gRGVsYXkgKGluIG1pbGxpc2Vjb25kcykKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ3RoZS1hbWVyaWNhbi1pbnRlcmVzdC5jb20nKSkgewogICAgICAgIGNvbnN0IGNvdW50ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXJ0aWNsZS1jb3VudGVyJyk7CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChjb3VudGVyKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ256aGVyYWxkLmNvLm56JykpIHsKICAgICAgICBjb25zdCBhcnRpY2xlQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcnRpY2xlX19jb250ZW50Jyk7CiAgICAgICAgaWYgKGFydGljbGVDb250ZW50KSB7CiAgICAgICAgICAgIGNvbnN0IGFydGljbGVPZmZlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcnRpY2xlLW9mZmVyJyk7CiAgICAgICAgICAgIGlmIChhcnRpY2xlT2ZmZXIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGNzc1NlbGVjdG9yID0gYXJ0aWNsZUNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgncCcpWzVdLmdldEF0dHJpYnV0ZSgnY2xhc3MnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGhpZGRlbk5vdFBhcnMgPSBhcnRpY2xlQ29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGNzc1NlbGVjdG9yICsgJzpub3QocCknKTsKICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaGlkZGVuTm90UGFyIG9mIGhpZGRlbk5vdFBhcnMpIHsKICAgICAgICAgICAgICAgICAgICBoaWRkZW5Ob3RQYXIuY2xhc3NMaXN0LnJlbW92ZShjc3NTZWxlY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgaGlkZGVuTm90UGFyLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IGhpZGRlblBhcnMgPSBhcnRpY2xlQ29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCdwLicgKyBjc3NTZWxlY3Rvcik7CiAgICAgICAgICAgICAgICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGhpZGRlblBhciBvZiBoaWRkZW5QYXJzKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFySHRtbCA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoJzxkaXYgc3R5bGU9Im1hcmdpbjogMTBweCAwcHg7IGZvbnQtc2l6ZTogMTdweCI+JyArIGhpZGRlblBhci5pbm5lckhUTUwgKyAnPC9kaXY+JywgJ3RleHQvaHRtbCcpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhckRvbSA9IHBhckh0bWwucXVlcnlTZWxlY3RvcignZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgYXJ0aWNsZUNvbnRlbnQuaW5zZXJ0QmVmb3JlKHBhckRvbSwgaGlkZGVuUGFyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0U3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AgPiBzcGFuJyk7CiAgICAgICAgICAgICAgICBpZiAoZmlyc3RTcGFuKSB7IGZpcnN0U3Bhbi5yZW1vdmVBdHRyaWJ1dGUoJ2NsYXNzJyk7IH0KICAgICAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQoYXJ0aWNsZU9mZmVyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb25zdCBwcmVtaXVtVG9hc3RlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcmVtaXVtLXRvYXN0ZXInKTsKICAgICAgICByZW1vdmVET01FbGVtZW50KHByZW1pdW1Ub2FzdGVyKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2ludGVyZXN0LmNvLm56JykpIHsKICAgICAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BwLWFibG9jay1iYW5uZXItd3JhcHBlcicpOwogICAgICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmxhY2stb3ZlcmxheScpOwogICAgICAgIHJlbW92ZURPTUVsZW1lbnQob3ZlcmxheSwgd3JhcHBlcik7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdzdHVmZi5jby5ueicpKSB7CiAgICAgICAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy54MCcpOwogICAgICAgIHJlbW92ZURPTUVsZW1lbnQob3ZlcmxheSk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCd0aGVuYXRpb25hbC5zY290JykpIHsKICAgICAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlbXBsYXRlLWNvbnRhaW5lcicpOwogICAgICAgIHJlbW92ZURPTUVsZW1lbnQob3ZlcmxheSk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCd0aGVzdGFyLmNvbScpKSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmFzaWMtcGF5d2FsbC1uZXcnKTsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsKTsKICAgICAgICAgICAgY29uc3QgdGJjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRleHQtYmxvY2stY29udGFpbmVyJyk7CiAgICAgICAgICAgIGZvciAoY29uc3QgZWwgb2YgdGJjKSB7CiAgICAgICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAxMDAwKTsgLy8gRGVsYXkgKGluIG1pbGxpc2Vjb25kcykKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2Fmci5jb20nKSkgewogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGhpZGRlbkltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW1nJyk7CiAgICAgICAgICAgIGZvciAoY29uc3QgaW1hZ2Ugb2YgaGlkZGVuSW1hZ2UpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHNyYyA9IGltYWdlLnNyYzsKICAgICAgICAgICAgICAgIGlmICgnc3JjOiAnICsgc3JjLmluZGV4T2YoJy5naWYnKSAhPT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhU3JjID0gaW1hZ2UuZ2V0QXR0cmlidXRlKCdkYXRhLXNyYycpOwogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhU3JjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlLnNldEF0dHJpYnV0ZSgnc3JjJywgZGF0YVNyYyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHBsaXN0YSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2RpdltkYXRhLXBsaXN0YS1wbGFjZW1lbnQ9InVuZGVyQXJ0aWNsZV9Hcm91cCJdJyk7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQocGxpc3RhKTsKICAgICAgICB9KTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oWydwYXJvb2wubmwnLCAndHJvdXcubmwnLCAndm9sa3NrcmFudC5ubCcsICdkZW1vcmdlbi5iZScsICdodW1vLmJlJ10pKSB7CiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsKICAgICAgICAgICAgY29uc3QgdG9wQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2RhdGEtdGVtcHRhdGlvbi1wb3NpdGlvbj0iUEFHRV9UT1AiXScpOwogICAgICAgICAgICBjb25zdCBwYXl3YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2RhdGEtdGVtcHRhdGlvbi1wb3NpdGlvbj0iQVJUSUNMRV9CT1RUT00iXScpOwogICAgICAgICAgICBjb25zdCBoaWRkZW5TZWN0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2RhdGEtdGVtcHRhdGlvbi1wb3NpdGlvbj0iQVJUSUNMRV9JTkxJTkUiXScpOwogICAgICAgICAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2RhdGEtdGVtcHRhdGlvbi1wb3NpdGlvbj0iUEFHRV9CT1RUT00iXScpOwogICAgICAgICAgICByZW1vdmVET01FbGVtZW50KHRvcEJhbm5lciwgcGF5d2FsbCwgaGlkZGVuU2VjdGlvbiwgb3ZlcmxheSk7CiAgICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdmaXJzdHRoaW5ncy5jb20nKSkgewogICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwYXl3YWxsJylbMF07CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2Jsb29tYmVyZy5jb20nKSkgewogICAgICAgIGJsb2NrRWxlbWVudCgnI2dyYXBoaWNzLXBheXdhbGwtb3ZlcmxheScsIHRydWUpOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignYmxvb21iZXJncXVpbnQuY29tJykpIHsKICAgICAgICBjb25zdCBhcnRpY2xlc0xlZnRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3BheXdhbGwtbWV0ZXItbW9kdWxlX19zdG9yeS1wYXl3YWxsLWNvbnRhaW5lcl9fMVVnQ0UnKVswXTsKICAgICAgICBjb25zdCBwYXl3YWxsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BheXdhbGxEbXAnKTsKICAgICAgICByZW1vdmVET01FbGVtZW50KGFydGljbGVzTGVmdE1vZGFsLCBwYXl3YWxsKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ21lZGl1bS5jb20nKSB8fCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzY3JpcHRbc3JjXj0iaHR0cHM6Ly9jZG4tY2xpZW50Lm1lZGl1bS5jb20vIl0nKSkgewogICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYjcGF5d2FsbC1iYWNrZ3JvdW5kLWNvbG9yJyk7CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsKTsKICAgICAgICBpZiAocGF5d2FsbCkgewogICAgICAgICAgICBleHRlbnNpb25BcGkucnVudGltZS5zZW5kTWVzc2FnZSh7IHJlcXVlc3Q6ICdyZWZyZXNoQ3VycmVudFRhYicgfSk7CiAgICAgICAgfQogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29uc3QgbWV0ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbaWQqPSJoaWdobGlnaHQtbWV0ZXItIl0nKTsKICAgICAgICAgICAgaWYgKG1ldGVyKSB7CiAgICAgICAgICAgICAgICBtZXRlci5oaWRkZW4gPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfSwgNTAwKTsgLy8gRGVsYXkgKGluIG1pbGxpc2Vjb25kcykKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ3RoZWdsb2JlYW5kbWFpbC5jb20nKSkgewogICAgICAgIGNvbnN0IGFydGljbGVCb2R5U3Vic2NyaWJlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jLWFydGljbGUtYm9keS0tc3Vic2NyaWJlZCcpOwogICAgICAgIGlmIChhcnRpY2xlQm9keVN1YnNjcmliZWQpIHsKICAgICAgICAgICAgYXJ0aWNsZUJvZHlTdWJzY3JpYmVkLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKFsnZXhhbWluZXIuY29tLmF1JywgJ3RoZWNvdXJpZXIuY29tLmF1JywgJ3RoZWFkdm9jYXRlLmNvbS5hdSddKSkgewogICAgICAgIGNvbnN0IHN1YnNjcmliZVRydW5jYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZS10cnVuY2F0ZScpOwogICAgICAgIGlmIChzdWJzY3JpYmVUcnVuY2F0ZSkgeyBzdWJzY3JpYmVUcnVuY2F0ZS5jbGFzc0xpc3QucmVtb3ZlKCdzdWJzY3JpYmUtdHJ1bmNhdGUnKTsgfQogICAgICAgIGNvbnN0IHN1YnNjcmliZXJIaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zdWJzY3JpYmVyLWhpZGVyJyk7CiAgICAgICAgZm9yIChjb25zdCBlbCBvZiBzdWJzY3JpYmVySGlkZXIpIHsKICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnc3Vic2NyaWJlci1oaWRlcicpOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2NhbmJlcnJhdGltZXMuY29tLmF1JykpIHsKICAgICAgICBjb25zdCBwYXl3YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZS1hcnRpY2xlLm5ld3MtYXJ0aWNsZS1ib2R5LmFydGljbGVfX2JvZHknKTsKICAgICAgICBwYXl3YWxsLmNsYXNzTGlzdC5yZW1vdmUoJ3N1YnNjcmliZS1hcnRpY2xlJyk7CiAgICAgICAgY29uc3Qgc3Vic2NyaWJlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc3Vic2NyaWJlci1jb250YWluZXInKVswXTsKICAgICAgICByZW1vdmVET01FbGVtZW50KHN1YnNjcmliZSk7CiAgICAgICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3N1YnNjcmliZXItaGlkZXInKTsKICAgICAgICBmb3IgKGNvbnN0IGVsIG9mIGNvbnRlbnQpIHsKICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnc3Vic2NyaWJlci1oaWRlcicpOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2xlZGV2b2lyLmNvbScpKSB7CiAgICAgICAgY29uc3QgY291bnRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mdWxsLmhpZGRlbi1wcmludC5wb3B1cC1tc2cnKTsKICAgICAgICByZW1vdmVET01FbGVtZW50KGNvdW50ZXIpOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignZnQuY29tJykpIHsKICAgICAgICBjb25zdCBjb29raWVCYW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuby1iYW5uZXJfX291dGVyJyk7CiAgICAgICAgY29uc3QgcmliYm9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWFydGljbGUtcmliYm9uJyk7CiAgICAgICAgY29uc3QgYWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm8tYWRzJyk7CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChjb29raWVCYW5uZXIsIGFkcywgcmliYm9uKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ3RoZWhpbmR1LmNvbScpKSB7CiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsKICAgICAgICAgICAgY29uc3QgY291bnRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0ZXN0Jyk7CiAgICAgICAgICAgIGNvbnN0IGNvQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvLWJhbm5lcicpOwogICAgICAgICAgICBjb25zdCBzdXBwb3J0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LnN1cHBvcnQtamxtJyk7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQoY291bnRlciwgY29CYW5uZXIsIHN1cHBvcnQpOwogICAgICAgIH0pOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignbnl0aW1lcy5jb20nKSkgewogICAgICAgIGNvbnN0IHByZXZpZXdCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3NzLTNzMWNlMCcpOwogICAgICAgIGlmIChwcmV2aWV3QnV0dG9uKSB7IHByZXZpZXdCdXR0b24uY2xpY2soKTsgfQogICAgICAgIGJsb2NrRWxlbWVudCgnLmNzcy0zZmJvd2EnKTsgLy8gUHJldmVudCBib3R0b20gZG9jayBmcm9tIGFwcGVhcmluZwogICAgICAgIGJsb2NrRWxlbWVudCgnI2dhdGV3YXktY29udGVudCcpOyAvLyBSZW1vdmUgcGF5d2FsbAogICAgICAgIGJsb2NrRWxlbWVudCgnLmNzcy0xYmQ4YmZsJyk7IC8vIFJlbW92ZSBmaWx0ZXIKICAgICAgICAvLyBSZXN0b3JlIHNjcm9sbGluZwogICAgICAgIGRvY3VtZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jc3MtbWNtMjlmJykuc2V0QXR0cmlidXRlKCdzdHlsZScsICdwb3NpdGlvbjpyZWxhdGl2ZScpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ3RlY2hub2xvZ3lyZXZpZXcuY29tJykpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbnN0IGJvZHlPYnNjdXJlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHlbY2xhc3MqPSJib2R5X19vYnNjdXJlQ29udGVudCJdJyk7CiAgICAgICAgICAgIGlmIChib2R5T2JzY3VyZWQpIHsgcmVtb3ZlQ2xhc3Nlc0J5UHJlZml4KGJvZHlPYnNjdXJlZCwgJ2JvZHlfX29ic2N1cmVDb250ZW50Jyk7IH0KICAgICAgICAgICAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2RpdltjbGFzcyo9Im92ZXJsYXlGb290ZXJfX3dyYXBwZXIiXScpOwogICAgICAgICAgICBpZiAob3ZlcmxheSkgeyBvdmVybGF5LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpub25lJyk7IH0KICAgICAgICAgICAgY29uc3QgY29udGVudEJvZHlIaWRkZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXZbY2xhc3MqPSJjb250ZW50Qm9keV9fY29udGVudEhpZGRlbiJdJyk7CiAgICAgICAgICAgIGlmIChjb250ZW50Qm9keUhpZGRlbikgeyByZW1vdmVDbGFzc2VzQnlQcmVmaXgoY29udGVudEJvZHlIaWRkZW4sICdjb250ZW50Qm9keV9fY29udGVudEhpZGRlbicpOyB9CiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRCb2R5T3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2RpdltjbGFzcyo9ImNvbnRlbnRCb2R5X19vdmVybGF5Il0nKTsKICAgICAgICAgICAgaWYgKGNvbnRlbnRCb2R5T3ZlcmxheSkgeyBjb250ZW50Qm9keU92ZXJsYXkucmVtb3ZlQXR0cmlidXRlKCdjbGFzcycpOyB9CiAgICAgICAgfSwgNTAwKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2xlcGFyaXNpZW4uZnInKSkgewogICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLnNjcm9sbExpc3RlbmVyKTsKICAgICAgICBjb25zdCBwYXl3YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlbGF0aXZlLnBpYW5vLXBheXdhbGwuYmVsb3dfbmF2LnN0aWNreScpOwogICAgICAgIHJlbW92ZURPTUVsZW1lbnQocGF5d2FsbCk7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjb250ZW50Jyk7CiAgICAgICAgICAgIGZvciAoY29uc3QgZWwgb2YgY29udGVudCkgewogICAgICAgICAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpOwogICAgICAgICAgICB9CiAgICAgICAgfSwgMzAwKTsgLy8gRGVsYXkgKGluIG1pbGxpc2Vjb25kcykKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2NhaXhpbmdsb2JhbC5jb20nKSkgewogICAgICAgIGNvbnN0IHBheVRpcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29ucy1wYXktdGlwJyk7CiAgICAgICAgZm9yIChjb25zdCBwYXlUaXAgb2YgcGF5VGlwcykgewogICAgICAgICAgICBwYXlUaXAucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpOwogICAgICAgIH0KICAgICAgICBjb25zdCBhcHBDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcENvbnRlbnQnKTsKICAgICAgICBpZiAoYXBwQ29udGVudCkgewogICAgICAgICAgICBjb25zdCBwSGlkZGVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgncDpub3QoW3N0eWxlPSJkaXNwbGF5OmJsb2NrOyJdJyk7CiAgICAgICAgICAgIGZvciAoY29uc3QgZWwgb2YgcEhpZGRlbikgewogICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5OmJsb2NrOycpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignYml6am91cm5hbHMuY29tJykpIHsKICAgICAgICBjb25zdCBzaGVldE92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2hlZXQtb3ZlcmxheScpOwogICAgICAgIGNvbnN0IGNodW5rUGF5d2FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaHVuay0tcGF5d2FsbCcpOwogICAgICAgIHJlbW92ZURPTUVsZW1lbnQoc2hlZXRPdmVybGF5LCBjaHVua1BheXdhbGwpOwogICAgICAgIGNvbnN0IG92ZXJsYWlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlzLW92ZXJsYWlkJyk7CiAgICAgICAgZm9yIChjb25zdCBlbCBvZiBvdmVybGFpZCkgewogICAgICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1vdmVybGFpZCcpOwogICAgICAgIH0KICAgICAgICBjb25zdCBib2R5SGlkZGVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLXByZS1jaHVua3NfX3N0b3J5LWJvZHknKTsKICAgICAgICBib2R5SGlkZGVuLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ3RoZS10bHMuY28udWsnKSkgewogICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGxzLXN1YnNjcmlwdGlvbnMtYmFubmVyX19jbG9zZWQtc2tpbicpOwogICAgICAgIHJlbW92ZURPTUVsZW1lbnQocGF5d2FsbCk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdjZW4uYWNzLm9yZycpKSB7CiAgICAgICAgY29uc3QgcGF5d2FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZXRlcmVkQmFyJyk7CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2VscGVyaW9kaWNvLmNvbScpKSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbnN0IHVuYXZhaWxhYmxlQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZWQnKTsKICAgICAgICAgICAgY29uc3QgaW5mb0JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lcC1tYXNQZXJpb2RpY28taW5mbycpOwogICAgICAgICAgICBpZiAodW5hdmFpbGFibGVBcmVhKSB7CiAgICAgICAgICAgICAgICB1bmF2YWlsYWJsZUFyZWEuY2xhc3NMaXN0LnJlbW92ZSgnY2xvc2VkJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGluZm9Cb3gpIHsKICAgICAgICAgICAgICAgIGluZm9Cb3gucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpbmZvQm94KTsKICAgICAgICAgICAgfQogICAgICAgIH0sIDEwMDApOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbigndGVjaGluYXNpYS5jb20nKSkgewogICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGF5d2FsbC1jb250ZW50Jyk7CiAgICAgICAgaWYgKHBheXdhbGwpIHsKICAgICAgICAgICAgcGF5d2FsbC5jbGFzc0xpc3QucmVtb3ZlKCdwYXl3YWxsLWNvbnRlbnQnKTsKICAgICAgICB9CiAgICAgICAgY29uc3Qgc3BsYXNoU3Vic2NyaWJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNwbGFzaC1zdWJzY3JpYmUnKTsKICAgICAgICBjb25zdCBwYXl3YWxsSGFyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYXl3YWxsLWhhcmQnKTsKICAgICAgICByZW1vdmVET01FbGVtZW50KHNwbGFzaFN1YnNjcmliZSwgcGF5d2FsbEhhcmQpOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbigndGhld3JhcC5jb20nKSkgewogICAgICAgIGNvbnN0IGVtYmVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVtYmVkJyk7CiAgICAgICAgaWYgKGVtYmVkKSB7CiAgICAgICAgICAgIC8vIERpc3BsYXkgZmVhdHVyZSB2aWRlbwogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmVhdHVyZWQtaW1hZ2UtY29udGFpbmVyJyk7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQoY29udGFpbmVyKTsKICAgICAgICAgICAgZW1iZWQuY2xhc3NMaXN0LnJlbW92ZSgnZC1ub25lJyk7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignaGJyLm9yZycpKSB7CiAgICAgICAgY29uc3QgYmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlcnNpc3RlbnQtYmFubmVyJyk7CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChiYW5uZXIpOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignc3BlY3RhdG9yLmNvLnVrJykpIHsKICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuSGFyZFBheVdhbGxDb250YWluZXItbW9kdWxlX19vdmVybGF5Jyk7CiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAoY29udGFpbmVyICYmIHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCcvd3d3LnNwZWN0YXRvci5jby51ay8nKSkgewogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZiArICcvYW1wJzsKICAgICAgICAgICAgfQogICAgICAgIH0sIDUwMCk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdiYXJyb25zLmNvbScpKSB7CiAgICAgICAgY29uc3QgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgaWYgKCF1cmwuaW5jbHVkZXMoJ2JhcnJvbnMuY29tL2FtcC8nKSkgewogICAgICAgICAgICBjb25zdCBib2R5Q29udGludW91cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHkuaXMtY29udGludW91cycpOwogICAgICAgICAgICBjb25zdCBzbmlwcGV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtjb250ZW50PSJzbmlwcGV0Il0nKTsKICAgICAgICAgICAgaWYgKGJvZHlDb250aW51b3VzICYmIHNuaXBwZXQpIHsKICAgICAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQoc25pcHBldCk7CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHVybC5yZXBsYWNlKCdiYXJyb25zLmNvbScsICdiYXJyb25zLmNvbS9hbXAnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBzaWduaW5MaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EucHJpbWFyeS1idXR0b24tLWxpbmtbaHJlZio9InRhcmdldD0iXScpOwogICAgICAgICAgICBmb3IgKGNvbnN0IHNpZ25pbkxpbmsgb2Ygc2lnbmluTGlua3MpIHsKICAgICAgICAgICAgICAgIHNpZ25pbkxpbmsuaHJlZiA9IGRlY29kZVVSSUNvbXBvbmVudChzaWduaW5MaW5rLmhyZWYuc3BsaXQoJ3RhcmdldD0nKVsxXSkuc3BsaXQoJz8nKVswXTsKICAgICAgICAgICAgICAgIHNpZ25pbkxpbmsudGV4dCA9ICdDbGljayc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgYmFycm9uc0FkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5iYXJyb25zLWJvZHktYWQtcGxhY2VtZW50Jyk7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQoLi4uYmFycm9uc0Fkcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgcHJldmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3NlY3Rpb25bc3Vic2NyaXB0aW9ucy1zZWN0aW9uPSJjb250ZW50LW5vdC1ncmFudGVkIl0nKTsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwcmV2aWV3KTsKICAgICAgICAgICAgY29uc3Qgc3Vic2NyU2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3NlY3Rpb25bc3Vic2NyaXB0aW9ucy1zZWN0aW9uPSJjb250ZW50Il0nKTsKICAgICAgICAgICAgaWYgKHN1YnNjclNlY3Rpb24pIHsKICAgICAgICAgICAgICAgIHN1YnNjclNlY3Rpb24ucmVtb3ZlQXR0cmlidXRlKCdzdWJzY3JpcHRpb25zLXNlY3Rpb24nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZW1vdmVET01FbGVtZW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5sb2dpbi1zZWN0aW9uLWNvbnRhaW5lcicpKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ256ei5jaCcpKSB7CiAgICAgICAgY29uc3QgcGF5d2FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5keW5hbWljLXJlZ3dhbGwnKTsKICAgICAgICByZW1vdmVET01FbGVtZW50KHBheXdhbGwpOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignaXJpc2h0aW1lcy5jb20nKSkgewogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHN0dWJBcnRpY2xlTXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LnN0dWItYXJ0aWNsZS1tc2cnKTsKICAgICAgICAgICAgY29uc3QgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJ21vZGU9c2FtcGxlJykgfHwgc3R1YkFydGljbGVNc2cpIHsgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBuZXcgVVJMKHVybCkucGF0aG5hbWUgKyAnP21vZGU9YW1wJzsgfQogICAgICAgIH0pOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbigndGhlc2F0dXJkYXlwYXBlci5jb20uYXUnKSkgewogICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYucGF5d2FsbC1oYXJkLWFsd2F5cy1zaG93Jyk7CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsKTsKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2xlc2VjaG9zLmZyJykgJiYgd2luZG93LmxvY2F0aW9uLmhyZWYubWF0Y2goLy1cZHs2LH0vKSkgewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29uc3QgYWJvQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2NsYXNzXj0icGd4ZjNiIl0nKTsKICAgICAgICAgICAgY29uc3QgYWRCbG9ja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbY2xhc3MqPSJqenh2a2QiJyk7CiAgICAgICAgICAgIGZvciAoY29uc3QgYWRCbG9jayBvZiBhZEJsb2NrcykgeyBhZEJsb2NrLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpub25lJyk7IH0KICAgICAgICAgICAgaWYgKGFib0Jhbm5lcikgewogICAgICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChhYm9CYW5uZXIpOwogICAgICAgICAgICAgICAgY29uc3QgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgICAgICBjb25zdCBodG1sID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm91dGVySFRNTDsKICAgICAgICAgICAgICAgIGxldCBzdGF0ZTsKICAgICAgICAgICAgICAgIGNvbnN0IHNwbGl0MSA9IGh0bWwuc3BsaXQoJ3dpbmRvdy5fX1BSRUxPQURFRF9TVEFURV9fPScpWzFdOwogICAgICAgICAgICAgICAgY29uc3Qgc3BsaXQyID0gc3BsaXQxLnNwbGl0KCc8L3NjcmlwdD4nKVswXS50cmltKCk7CiAgICAgICAgICAgICAgICBpZiAoc3BsaXQyLmluY2x1ZGVzKCc7IHdpbmRvdy5fX0RBVEFfXz0nKSkgeyBzdGF0ZSA9IHNwbGl0Mi5zcGxpdCgnOyB3aW5kb3cuX19EQVRBX189JylbMF0udHJpbSgpOyB9IGVsc2UgeyBzdGF0ZSA9IHNwbGl0Mi5zdWJzdHIoMCwgc3BsaXQyLmxlbmd0aCAtIDEpOyB9CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHN0YXRlKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBhcnRpY2xlID0gZGF0YS5hcnRpY2xlLmRhdGEuc3RyaXBlc1swXS5tYWluQ29udGVudFswXS5kYXRhLmRlc2NyaXB0aW9uOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHVybExvYWRlZCA9IGRhdGEuYXJ0aWNsZS5kYXRhLnBhdGg7CiAgICAgICAgICAgICAgICAgICAgaWYgKCF1cmwuaW5jbHVkZXModXJsTG9hZGVkKSkgeyB3aW5kb3cubG9jYXRpb24ucmVsb2FkKHRydWUpOyB9CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF5d2FsbE5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9zdC1wYXl3YWxsJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHBheXdhbGxOb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnROb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXJ0aWNsZUh0bWwgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKCc8ZGl2PicgKyBhcnRpY2xlICsgJzwvZGl2PicsICd0ZXh0L2h0bWwnKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXJ0aWNsZVBhciA9IGFydGljbGVIdG1sLnF1ZXJ5U2VsZWN0b3IoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJ0aWNsZVBhcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudE5vZGUuYXBwZW5kQ2hpbGQoYXJ0aWNsZVBhcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50Tm9kZS5jbGFzc05hbWUgPSBwYXl3YWxsTm9kZS5jbGFzc05hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXl3YWxsTm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjb250ZW50Tm9kZSwgcGF5d2FsbE5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsTm9kZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXl3YWxsTGFzdENoaWxkTm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3N0LXBheXdhbGwgID4gOmxhc3QtY2hpbGQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXl3YWxsTGFzdENoaWxkTm9kZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheXdhbGxMYXN0Q2hpbGROb2RlLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnaGVpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7IG92ZXJmbG93OiBoaWRkZW4gIWltcG9ydGFudDsgbWF4LWhlaWdodDogbm9uZSAhaW1wb3J0YW50OycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0eWxlRWxlbSA9IGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKSk7CiAgICAgICAgICAgICAgICAgICAgc3R5bGVFbGVtLmlubmVySFRNTCA9ICcucG9zdC1wYXl3YWxsOjphZnRlciB7aGVpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7fSc7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKHRydWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwgNTAwKTsgLy8gRGVsYXkgKGluIG1pbGxpc2Vjb25kcykKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ3N0YXJ0cmlidW5lLmNvbScpKSB7CiAgICAgICAgLy8gcmVtb3ZlIGFjdGl2ZSBjbGFzcyBmcm9tIGFsbCBlbGVtZW50cwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Rpdi5SZWFjdE1vZGFsUG9ydGFsJykuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChlbCk7CiAgICAgICAgfSk7CiAgICAgICAgLy8gRW5hYmxlIFNjcm9sbC4gUmV2ZWFsIEhpZGRsZW4gUGFyYWdyYXBoCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXS5yZW1vdmVBdHRyaWJ1dGUoJ2NsYXNzJyk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdzZWF0dGxldGltZXMuY29tJykpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIC8vIHJlbW92ZSBtb2RhbCBjbGFzcyBmcm9tIGFsbCBlbGVtZW50cwogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdkaXYubW9kYWwnKS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChlbCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvLyBSZW1vdmUgQmx1cnJlZCBTdHlsZSBmcm9tIGFsbCBtYXRjaGluZyBEaXZzCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250YWluZXInKS5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2RpdltzdHlsZX49ImZpbHRlciJdJykuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvY3VtZW50CiAgICAgICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbCgnZGl2W2NsYXNzfj0iTmV3c2xldHRlclNpZ251cFNwbGFzaCJdJykKICAgICAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgIH0sIDEwMDApOyAvLyBEZWxheSAoaW4gbWlsbGlzZWNvbmRzKQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbigndGhlYXRsYW50aWMuY29tJykpIHsKICAgICAgICAvLyBSZW1vdmUgYWxsIG51ZGdlIGVsZW1lbnRzCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZGl2W2NsYXNzKj0iYy1udWRnZSJdJykuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChlbCk7CiAgICAgICAgfSk7CiAgICAgICAgLy8gUmVtb3ZlIGFsbCBGYW5jeUJveCBhZHMKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdkaXZbY2xhc3MqPSJmYW5jeWJveCJdJykuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChlbCk7CiAgICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKFsndGhlYXRobGV0aWMuY29tJywgJ3RoZWF0aGxldGljLmNvLnVrJ10pKSB7CiAgICAgICAgaWYgKCF3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygnP2FtcCcpKSB7CiAgICAgICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdkaXYjcGF5d2FsbC1jb250YWluZXIsIGRpdltzdWJzY3JpcHRpb25zLWFjdGlvbj0ic3Vic2NyaWJlIl0sIGEuaGVhZGxpbmUtcGF5d2FsbCcpOwogICAgICAgICAgICBjb25zdCBhbXBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbGlua1tyZWw9ImFtcGh0bWwiXScpOwogICAgICAgICAgICBpZiAocGF5d2FsbC5sZW5ndGggJiYgYW1waHRtbCkgewogICAgICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudCguLi5wYXl3YWxsKTsKICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGFtcGh0bWwuaHJlZjsKICAgICAgICAgICAgICAgIH0sIDUwMCk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbXBVbmhpZGVTdWJzY3JpcHRpb25zU2VjdGlvbigpOwogICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25zQWN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tzdWJzY3JpcHRpb25zLWFjdGlvbnNdJyk7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQoLi4uc3Vic2NyaXB0aW9uc0FjdGlvbnMpOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ25ld3lvcmtlci5jb20nKSkgewogICAgICAgIGJsb2NrRWxlbWVudCgnLnBheXdhbGwtYmFyJywgdHJ1ZSk7CiAgICAgICAgYmxvY2tFbGVtZW50KCcucGF5d2FsbC1tb2RhbCcpOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbigndmFuaXR5ZmFpci5jb20nKSkgewogICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGF5d2FsbC1iYXInKTsKICAgICAgICByZW1vdmVET01FbGVtZW50KHBheXdhbGwpOwogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbihbJ3Bvc3RpbWVlcy5lZScsICdlbHUyNC5lZSddKSkgewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyBSZW1vdmUgJ2FkYmxvY2tlci1kZXRlY3RlZCcgZm9vdGVyIG5vdGlmaWNhdGlvbgogICAgICAgICAgICBjb25zdCBhZGJsb2NrTm90aWYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWQtYmxvY2stbm90aWZpY2F0aW9uLW92ZXJsYXknKTsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChhZGJsb2NrTm90aWYpOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKICAgICAgICB9LCA4MDApOyAvLyBEZWxheSAoaW4gbWlsbGlzZWNvbmRzKQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbigndGhlb2xpdmVwcmVzcy5lcycpKSB7CiAgICAgICAgY29uc3QgbW9kYWxCYWNrZHJvcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1iYWNrZHJvcCcpOwogICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXYtb3Blbi1tb2RhbC1wYXl3YWxsLVJFUVVJUkVfTE9HSU5fV0lUSF9FTlRJVExFTUVOVCcpOwogICAgICAgIHJlbW92ZURPTUVsZW1lbnQobW9kYWxCYWNrZHJvcCwgcGF5d2FsbCk7CgogICAgICAgIGZvciAoY29uc3QgY2xhenogb2YgWydldi1tb2RhbHMnLCAnbW9kYWwtb3BlbiddKSB7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShjbGF6eik7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbigndGhlbWFya2VyLmNvbScpKSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0PSJib3R0b21TdHJpcCJdJyk7CiAgICAgICAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHdTdWJzY3JpYmVQb3B1cCcpOwogICAgICAgICAgICBjb25zdCBiYW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGhlbWFya2VyXFwuY29tXFwuYmlsbGJvYXJkXFwuZGVza3RvcCcpOwogICAgICAgICAgICBjb25zdCBuZXdzQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RoZW1hcmtlclxcLmNvbVxcLm5ld3NcXC5iYW5uZXInKTsKICAgICAgICAgICAgY29uc3QgbWlkQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RoZW1hcmtlclxcLmNvbS5oZWFkbGluZVxcLmJhbm5lclxcLmRlc2t0b3AnKTsKICAgICAgICAgICAgY29uc3QgZmluYW5jZUJhbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0aGVtYXJrZXJcXC5jb21cXC5maW5hbmNlXFwuYmFubmVyJyk7CiAgICAgICAgICAgIGNvbnN0IHRvcFN0cmlwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdD0idG9wU3RyaXAiXScpOwogICAgICAgICAgICBjb25zdCBvdGhlckJhbm5lcnMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWF1ZHRhcmdldF0nKSk7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQocGF5d2FsbCwgbm90aWZpY2F0aW9ucywgYmFubmVyLCB0b3BTdHJpcCwgbWlkQmFubmVyLCBuZXdzQmFubmVyLCBmaW5hbmNlQmFubmVyLCAuLi5vdGhlckJhbm5lcnMpOwogICAgICAgIH0sIDUwMCk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdoYWFyZXR6LmNvLmlsJykpIHsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwd1N1YnNjcmliZVBvcHVwJyk7CiAgICAgICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0PSJib3R0b21TdHJpcCJdJyk7CiAgICAgICAgICAgIGNvbnN0IGJhbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNoYWFyZXR6XFwuY29cXC5pbFxcLmJpbGxib2FyZFxcLmRlc2t0b3AnKTsKICAgICAgICAgICAgY29uc3QgZWRpdG9yc0Jhbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNoYWFyZXR6XFwuY29cXC5pbFxcLmVkaXRvcnNcXC5iYW5uZXInKTsKICAgICAgICAgICAgY29uc3QgaGVhZGxpbmVzQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2hhYXJldHpcXC5jb1xcLmlsXFwuaGVhZGxpbmVcXC5ib3hcXC5kZXNrdG9wJyk7CiAgICAgICAgICAgIGNvbnN0IHRvcFN0cmlwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdD0idG9wU3RyaXAiXScpOwogICAgICAgICAgICBjb25zdCBvdGhlckJhbm5lcnMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWF1ZHRhcmdldF0nKSk7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQocGF5d2FsbCwgbm90aWZpY2F0aW9ucywgYmFubmVyLCBlZGl0b3JzQmFubmVyLCB0b3BTdHJpcCwgaGVhZGxpbmVzQmFubmVyLCAuLi5vdGhlckJhbm5lcnMpOwogICAgICAgIH0sIDUwMCk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdzdWVkZGV1dHNjaGUuZGUnKSkgewogICAgICAgIGNvbnN0IHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmOwogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IG9mZmVyUGFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5vZmZlci1wYWdlJyk7CiAgICAgICAgICAgIGlmICh1cmwuc3RhcnRzV2l0aCgnaHR0cHM6Ly93d3cuc3VlZGRldXRzY2hlLmRlJykgJiYgKHVybC5pbmNsdWRlcygncmVkdWNlZD10cnVlJykgfHwgb2ZmZXJQYWdlKSkgeyB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHVybC5zcGxpdCgnPycpWzBdLnJlcGxhY2UoJ3d3dy4nLCAnYW1waHRtbC4nKTsgfSBlbHNlIGlmICh1cmwuc3RhcnRzV2l0aCgnaHR0cHM6Ly9zei1tYWdhemluLnN1ZWRkZXV0c2NoZS5kZScpKSB7CiAgICAgICAgICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCdyZWR1Y2VkPXRydWUnKSB8fCBvZmZlclBhZ2UpIHsgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBuZXcgVVJMKHVybCkucGF0aG5hbWUgKyAnIWFtcCc7IH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnIWFtcCcpKSB7CiAgICAgICAgICAgICAgICBjb25zdCBwYXJhZ3JhcGhSZWR1Y2VkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhcmFncmFwaC0tcmVkdWNlZCcpOwogICAgICAgICAgICAgICAgaWYgKHBhcmFncmFwaFJlZHVjZWQpIHsgcGFyYWdyYXBoUmVkdWNlZC5jbGFzc0xpc3QucmVtb3ZlKCdwYXJhZ3JhcGgtLXJlZHVjZWQnKTsgfQogICAgICAgICAgICAgICAgY29uc3QgcGFyYWdyYXBoSGlkZGVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBhcmFncmFwaC0taGlkZGVuJyk7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhckhpZGRlbiBvZiBwYXJhZ3JhcGhIaWRkZW4pIHsgcGFySGlkZGVuLmNsYXNzTGlzdC5yZW1vdmUoJ3BhcmFncmFwaC0taGlkZGVuJyk7IH0KICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFncmFwaER5bmFtaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGFyYWdyYXBoLS1keW5hbWljJyk7CiAgICAgICAgICAgICAgICBpZiAocGFyYWdyYXBoRHluYW1pYykgeyBwYXJhZ3JhcGhEeW5hbWljLmNsYXNzTGlzdC5yZW1vdmUoJ3BhcmFncmFwaC0tZHluYW1pYycpOyB9CiAgICAgICAgICAgICAgICBjb25zdCBhbXBPZmZlcnBhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYW1wLW9mZmVycGFnZScpOwogICAgICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChhbXBPZmZlcnBhZ2UpOwogICAgICAgICAgICB9CiAgICAgICAgfSwgNTAwKTsgLy8gRGVsYXkgKGluIG1pbGxpc2Vjb25kcykKICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2Fkd2Vlay5jb20nKSkgewogICAgICAgIGNvbnN0IGJvZHlTaW5nbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5LnNpbmdsZScpOwogICAgICAgIGNvbnN0IGFtcEh0bWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdsaW5rW3JlbD0iYW1waHRtbCJdJyk7CiAgICAgICAgaWYgKGJvZHlTaW5nbGUgJiYgYW1wSHRtbCkgewogICAgICAgICAgICBib2R5U2luZ2xlLmNsYXNzTGlzdC5yZW1vdmUoJ3NpbmdsZScpOwogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGFtcEh0bWwuaHJlZjsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdnZWxvY2FsLml0JykpIHsKICAgICAgICBpZiAoIXdpbmRvdy5sb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCcvYW1wLycpKSB7CiAgICAgICAgICAgIGNvbnN0IHBheXdhbGxBZGFnaW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGF5d2FsbC1hZGFnaW8nKTsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsQWRhZ2lvKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBwYXl3YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2FtcC1hY2Nlc3M9InNob3dDb250ZW50Il0nKTsKICAgICAgICAgICAgaWYgKHBheXdhbGwpIHsgcGF5d2FsbC5yZW1vdmVBdHRyaWJ1dGUoJ2FtcC1hY2Nlc3MtaGlkZScpOyB9CiAgICAgICAgICAgIGNvbnN0IGFtcEFkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2FtcC1hZCcpOwogICAgICAgICAgICByZW1vdmVET01FbGVtZW50KC4uLmFtcEFkcyk7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignZWxtdW5kby5lcycpKSB7CiAgICAgICAgY29uc3QgcHJlbWl1bSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy51ZS1jLWFydGljbGVfX3ByZW1pdW0nKTsKICAgICAgICBjb25zdCB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsKICAgICAgICBpZiAoIXVybC5pbmNsdWRlcygnL2FtcC4nICsgJ2VsbXVuZG8uZXMnICsgJy8nKSkgewogICAgICAgICAgICBpZiAocHJlbWl1bSkgewogICAgICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwcmVtaXVtKTsKICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWYucmVwbGFjZSgnL3d3dy4nLCAnL2FtcC4nKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXZbYW1wLWFjY2Vzcz0iYXV0aG9yaXplZCE9dHJ1ZSJdJyk7CiAgICAgICAgICAgIGlmIChwYXl3YWxsKSB7CiAgICAgICAgICAgICAgICByZW1vdmVET01FbGVtZW50KHBheXdhbGwpOwogICAgICAgICAgICAgICAgY29uc3QgZGl2SGlkZGVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2FtcC1hY2Nlc3M9ImF1dGhvcml6ZWQ9dHJ1ZSJdJyk7CiAgICAgICAgICAgICAgICBpZiAoZGl2SGlkZGVuKSB7CiAgICAgICAgICAgICAgICAgICAgZGl2SGlkZGVuLnJlbW92ZUF0dHJpYnV0ZSgnYW1wLWFjY2Vzcy1oaWRlJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgYWR2ZXJ0aXNpbmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWR2ZXJ0aXNpbmcsIGFtcC1lbWJlZCcpOwogICAgICAgICAgICByZW1vdmVET01FbGVtZW50KC4uLmFkdmVydGlzaW5nKTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdzcGVsZC5ubCcpKSB7CiAgICAgICAgY29uc3QgcGF5d2FsbFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmMtcGF5d2FsbC1ub3RpY2UnKTsKICAgICAgICByZW1vdmVET01FbGVtZW50KHBheXdhbGxQb3B1cCk7CiAgICB9IGVsc2UgaWYgKG1hdGNoRG9tYWluKCdsYXN0YW1wYS5pdCcpKSB7CiAgICAgICAgY29uc3QgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgaWYgKCF1cmwuaW5jbHVkZXMoJy9hbXAvJykpIHsKICAgICAgICAgICAgY29uc3QgcHJlbWl1bSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYXl3YWxsLWFkYWdpbycpOwogICAgICAgICAgICByZW1vdmVET01FbGVtZW50KHByZW1pdW0pOwogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAocHJlbWl1bSkgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdXJsLnNwbGl0KCc/JylbMF0gKyAnL2FtcC8nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgYXJ0aWNsZUJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYjYXJ0aWNsZS1ib2R5W3N0eWxlXScpOwogICAgICAgICAgICAgICAgaWYgKGFydGljbGVCb2R5KSB7CiAgICAgICAgICAgICAgICAgICAgYXJ0aWNsZUJvZHkucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCA1MDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXZbaWRePSJwYXl3YWxsLWJhbm5lciJdJyk7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQocGF5d2FsbCk7CiAgICAgICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvblNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbc3Vic2NyaXB0aW9ucy1zZWN0aW9uPSJjb250ZW50Il0nKTsKICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvblNlY3Rpb24pIHsKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvblNlY3Rpb24ucmVtb3ZlQXR0cmlidXRlKCdzdWJzY3JpcHRpb25zLXNlY3Rpb24nKTsKICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXZbc3Vic2NyaXB0aW9ucy1zZWN0aW9uPSJjb250ZW50LW5vdC1ncmFudGVkIl0nKTsKICAgICAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQocHJldmlldyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgYW1wQWRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYW1wLWFkLCBhbXAtZW1iZWQnKTsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudCguLi5hbXBBZHMpOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ3RpbWUuY29tJykpIHsKICAgICAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpOwogICAgICAgIGlmIChib2R5KSB7CiAgICAgICAgICAgIGJvZHkuc2V0QXR0cmlidXRlKCdzdHlsZScsICdwb3NpdGlvbjpyZWxhdGl2ZSAhaW1wb3J0YW50OycpOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2V4cGFuc2lvbi5jb20nKSkgewogICAgICAgIGNvbnN0IHByZW1pdW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudWUtYy1hcnRpY2xlX19wcmVtaXVtJyk7CiAgICAgICAgY29uc3QgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CiAgICAgICAgaWYgKCF1cmwuaW5jbHVkZXMoJy9hbXAuJyArICdleHBhbnNpb24uY29tJyArICcvJykpIHsKICAgICAgICAgICAgaWYgKHByZW1pdW0pIHsKICAgICAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQocHJlbWl1bSk7CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnJlcGxhY2UoJy93d3cuJywgJy9hbXAuJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBwYXl3YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2FtcC1hY2Nlc3M9ImF1dGhvcml6ZWQhPXRydWUiXScpOwogICAgICAgICAgICBpZiAocGF5d2FsbCkgewogICAgICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsKTsKICAgICAgICAgICAgICAgIGNvbnN0IGRpdkhpZGRlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2RpdlthbXAtYWNjZXNzPSJhdXRob3JpemVkPXRydWUiXScpOwogICAgICAgICAgICAgICAgaWYgKGRpdkhpZGRlbikgewogICAgICAgICAgICAgICAgICAgIGRpdkhpZGRlbi5yZW1vdmVBdHRyaWJ1dGUoJ2FtcC1hY2Nlc3MtaGlkZScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IGFkdmVydGlzaW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFkdmVydGlzaW5nLCBhbXAtZW1iZWQnKTsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudCguLi5hZHZlcnRpc2luZyk7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignY2hpY2Fnb2J1c2luZXNzLmNvbScpKSB7CiAgICAgICAgY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHlbY2xhc3NdJyk7CiAgICAgICAgaWYgKGJvZHkpIHsKICAgICAgICAgICAgYm9keS5yZW1vdmVBdHRyaWJ1dGUoJ2NsYXNzJyk7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignbGF0aW1lcy5jb20nKSkgewogICAgICAgIGNvbnN0IHBheXdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRlcmluZy1tb2RhbCcpOwogICAgICAgIGNvbnN0IGluY29nbml0b1dhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRlcmluZy10b3BwYW5lbCcpOwogICAgICAgIGlmIChwYXl3YWxsKSB7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQocGF5d2FsbCk7CiAgICAgICAgfSBlbHNlIGlmIChpbmNvZ25pdG9XYWxsKSB7CiAgICAgICAgICAgIHJlbW92ZURPTUVsZW1lbnQoaW5jb2duaXRvV2FsbCk7CiAgICAgICAgfQogICAgICAgIGlmIChwYXl3YWxsIHx8IGluY29nbml0b1dhbGwpIHsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChtYXRjaERvbWFpbignZm9yZWlnbnBvbGljeS5jb20nKSkgewogICAgICAgIGNvbnN0IGNvbnRlbnRVbmdhdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LmNvbnRlbnQtdW5nYXRlZCcpOwogICAgICAgIHJlbW92ZURPTUVsZW1lbnQoY29udGVudFVuZ2F0ZWQpOwogICAgICAgIGNvbnN0IGNvbnRlbnRHYXRlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5jb250ZW50LWdhdGVkJyk7CiAgICAgICAgaWYgKGNvbnRlbnRHYXRlZCkgewogICAgICAgICAgICBjb250ZW50R2F0ZWQuY2xhc3NMaXN0LnJlbW92ZSgnY29udGVudC1nYXRlZCcpOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ2Jvc3Rvbmdsb2JlLmNvbScpKSB7CiAgICAgICAgLy8gUmVtb3ZlIHRoZSBwb3J0aW9uIGNvdmVyaW5nIHRoZSBwYXl3YWxsCiAgICAgICAgY29uc3QgcGF5d2FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5tZXRlci1wYXl3YWxsJyk7CiAgICAgICAgaWYgKHBheXdhbGwpIHsKICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChwYXl3YWxsKTsKICAgICAgICB9CiAgICAgICAgLy8gUmUtZW5hYmxlIHNjcm9sbGluZwogICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7CiAgICAgICAgaWYgKGJvZHkpIHsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7CiAgICAgICAgfQogICAgICAgIC8vIENsaWNrIHRoZSBidXR0b24gdG8gcmV2ZWFsIHRoZSByZXN0IG9mIHRoZSBhcnRpY2xlCiAgICAgICAgY29uc3QgYnV0dG9uRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2lkPSJjb250aW51ZV9idXR0b24iXScpOwogICAgICAgIGlmIChidXR0b25EaXYpIHsKICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gYnV0dG9uRGl2LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpOwogICAgICAgICAgICBpZiAoYnV0dG9uKSB7CiAgICAgICAgICAgICAgICBidXR0b24uY2xpY2soKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAobWF0Y2hEb21haW4oJ25hdGlvbmFsZ2VvZ3JhcGhpYy5jb20nKSkgewogICAgICAgIC8vIHByZXZlbnQgbW9kYWwgZnJvbSBzaG93aW5nIHVwLCB0aGVuIHJlbW92ZSBzY3JvbGwtbG9ja2luZywgYW5kIGFydGljbGUgYmx1cgogICAgICAgIG5ldyB3aW5kb3cuTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zKSB7CiAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgbXV0YXRpb24uYWRkZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2Ygd2luZG93LkhUTUxFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm1hdGNoZXMoJyNmaXR0UG9ydGFsXzAnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRE9NRWxlbWVudChub2RlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keS5yZW1vdmVBdHRyaWJ1dGUoJ2NsYXNzJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5LnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHkucmVtb3ZlQXR0cmlidXRlKCdvdmVyZmxvdycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmx1ciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYXRnZW8tdGVtcGxhdGUxLWZyYW1lLTEtbW9kdWxlLTEgPiBkaXYgPiBkaXYgPiBzZWN0aW9uID4gYXJ0aWNsZSA+IHNlY3Rpb24gPiBkaXYuQXJ0aWNsZV9fQ29udGVudF9fT3ZlcmxheS0tZ2F0ZWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibHVyKSByZW1vdmVET01FbGVtZW50KGJsdXIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdCgpOyAvLyBTdG9wIHdhdGNoaW5nIGZvciBlbGVtZW50IGJlaW5nIGFkZGVkIGFmdGVyIG9uZSByZW1vdmFsCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KS5vYnNlcnZlKGRvY3VtZW50LCB7IHN1YnRyZWU6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBtYXRjaERvbWFpbihkb21haW5zKSB7CiAgICAgICAgY29uc3QgaG9zdG5hbWUgPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU7CiAgICAgICAgaWYgKHR5cGVvZiBkb21haW5zID09PSAnc3RyaW5nJykgeyBkb21haW5zID0gW2RvbWFpbnNdOyB9CiAgICAgICAgcmV0dXJuIGRvbWFpbnMuc29tZShkb21haW4gPT4gaG9zdG5hbWUgPT09IGRvbWFpbiB8fCBob3N0bmFtZS5lbmRzV2l0aCgnLicgKyBkb21haW4pKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3YWl0RE9NRWxlbWVudChzZWxlY3RvciwgdGFnTmFtZSA9ICcnLCBjYWxsYmFjaywgbXVsdGlwbGUgPSBmYWxzZSkgewogICAgICAgIG5ldyB3aW5kb3cuTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zKSB7CiAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgbXV0YXRpb24uYWRkZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgIGlmICghdGFnTmFtZSB8fCAobm9kZS50YWdOYW1lID09PSB0YWdOYW1lKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5tYXRjaGVzKHNlbGVjdG9yKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobm9kZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW11bHRpcGxlKSB7IHRoaXMuZGlzY29ubmVjdCgpOyB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KS5vYnNlcnZlKGRvY3VtZW50LCB7CiAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsCiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZQogICAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlbW92ZURPTUVsZW1lbnQoLi4uZWxlbWVudHMpIHsKICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudHMpIHsKICAgICAgICAgICAgaWYgKGVsZW1lbnQpIHsgZWxlbWVudC5yZW1vdmUoKTsgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiByZW1vdmVDbGFzc2VzQnlQcmVmaXgoZWwsIHByZWZpeCkgewogICAgICAgIGZvciAoY29uc3QgY2xhenogb2YgZWwuY2xhc3NMaXN0KSB7CiAgICAgICAgICAgIGlmIChjbGF6ei5zdGFydHNXaXRoKHByZWZpeCkpIHsKICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoY2xhenopOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vIFByZXZlbnQgZWxlbWVudCBmcm9tIGJlaW5nIGFkZGVkIHRoZSBmaXJzdCB0aW1lIHRvIHRoZSBET00KICAgIGZ1bmN0aW9uIGJsb2NrRWxlbWVudChzZWxlY3RvciwgYmxvY2tBbHdheXMgPSBmYWxzZSkgewogICAgICAgIG5ldyB3aW5kb3cuTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zKSB7CiAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgbXV0YXRpb24uYWRkZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2Ygd2luZG93LkhUTUxFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm1hdGNoZXMoc2VsZWN0b3IpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVET01FbGVtZW50KG5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFibG9ja0Fsd2F5cykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdCgpOyAvLyBTdG9wIHdhdGNoaW5nIGZvciBlbGVtZW50IGJlaW5nIGFkZGVkIGFmdGVyIG9uZSByZW1vdmFsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KS5vYnNlcnZlKGRvY3VtZW50LCB7IHN1YnRyZWU6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBhbXBVbmhpZGVTdWJzY3JpcHRpb25zU2VjdGlvbihhbXBBZHNTZWwgPSAnYW1wLWFkLCAuYWQnKSB7CiAgICAgICAgY29uc3QgcHJldmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tzdWJzY3JpcHRpb25zLXNlY3Rpb249ImNvbnRlbnQtbm90LWdyYW50ZWQiXScpOwogICAgICAgIHJlbW92ZURPTUVsZW1lbnQocHJldmlldyk7CiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uc1NlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbc3Vic2NyaXB0aW9ucy1zZWN0aW9uPSJjb250ZW50Il0nKTsKICAgICAgICBmb3IgKGNvbnN0IGVsZW0gb2Ygc3Vic2NyaXB0aW9uc1NlY3Rpb24pIHsKICAgICAgICAgICAgZWxlbS5yZW1vdmVBdHRyaWJ1dGUoJ3N1YnNjcmlwdGlvbnMtc2VjdGlvbicpOwogICAgICAgIH0KICAgICAgICBjb25zdCBhbXBBZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGFtcEFkc1NlbCk7CiAgICAgICAgcmVtb3ZlRE9NRWxlbWVudCguLi5hbXBBZHMpOwogICAgfQoKICAgICd1c2Ugc3RyaWN0JzsKCiAgICBjb25zdCByZXN0cmljdGlvbnMgPSB7CiAgICAgICAgJ2Fkd2Vlay5jb20nOiAvXigoPyFcLmFkd2Vla1wuY29tXC8oLitcLyk/KGFtcHxhZ2VuY3lzcHl8dHZuZXdzZXJ8dHZzcHkpXC8pLikqJC8sCiAgICAgICAgJ2JhcnJvbnMuY29tJzogLy4rXC5iYXJyb25zXC5jb21cLyhhbXBcLyk/YXJ0aWNsZShzKT9cLy4rLywKICAgICAgICAnZWNvbm9taXN0LmNvbSc6IC8uK2Vjb25vbWlzdFwuY29tXC8uK1wvXGR7MSw0fVwvXGR7MSwyfVwvXGR7Mn1cLy4rLywKICAgICAgICAnc2Vla2luZ2FscGhhLmNvbSc6IC8uK3NlZWtpbmdhbHBoYVwuY29tXC9hcnRpY2xlXC8uKy8sCiAgICAgICAgJ3RlY2hpbmFzaWEuY29tJzogL1wudGVjaGluYXNpYVwuY29tXC8uKy8sCiAgICAgICAgJ2Z0LmNvbSc6IC8uK1wuZnQuY29tXC9jb250ZW50XC8vCiAgICB9OwoKICAgIC8vIERvbid0IHJlbW92ZSBjb29raWVzIGJlZm9yZSBwYWdlIGxvYWQKICAgIGNvbnN0IGFsbG93Q29va2llcyA9IFsKICAgICAgICAnYWQubmwnLAogICAgICAgICdiZC5ubCcsCiAgICAgICAgJ2JuZGVzdGVtLm5sJywKICAgICAgICAnYnJpc2JhbmV0aW1lcy5jb20uYXUnLAogICAgICAgICdjYW5iZXJyYXRpbWVzLmNvbS5hdScsCiAgICAgICAgJ2Nlbi5hY3Mub3JnJywKICAgICAgICAnZGVtb3JnZW4uYmUnLAogICAgICAgICdkZW52ZXJwb3N0LmNvbScsCiAgICAgICAgJ2Rlc3RlbnRvci5ubCcsCiAgICAgICAgJ2VkLm5sJywKICAgICAgICAnZXhhbWluZXIuY29tLmF1JywKICAgICAgICAnZ2Vsb2NhbC5pdCcsCiAgICAgICAgJ2dlbGRlcmxhbmRlci5ubCcsCiAgICAgICAgJ2dydWJzdHJlZXQuY29tJywKICAgICAgICAnaGFycGVycy5vcmcnLAogICAgICAgICdoYnIub3JnJywKICAgICAgICAnaHVtby5iZScsCiAgICAgICAgJ2xlc2VjaG9zLmZyJywKICAgICAgICAnbHJiLmNvLnVrJywKICAgICAgICAnbWVkaXVtLmNvbScsCiAgICAgICAgJ21lcmN1cnluZXdzLmNvbScsCiAgICAgICAgJ25ld3N0YXRlc21hbi5jb20nLAogICAgICAgICducmMubmwnLAogICAgICAgICdueW1hZy5jb20nLAogICAgICAgICdvY3JlZ2lzdGVyLmNvbScsCiAgICAgICAgJ3Bhcm9vbC5ubCcsCiAgICAgICAgJ3B6Yy5ubCcsCiAgICAgICAgJ3F6LmNvbScsCiAgICAgICAgJ3NjaWVudGlmaWNhbWVyaWNhbi5jb20nLAogICAgICAgICdzZWF0dGxldGltZXMuY29tJywKICAgICAgICAnc2Vla2luZ2FscGhhLmNvbScsCiAgICAgICAgJ3NvZnJlcC5jb20nLAogICAgICAgICdzcGVjdGF0b3IuY28udWsnLAogICAgICAgICdzcGVsZC5ubCcsCiAgICAgICAgJ3R1YmFudGlhLm5sJywKICAgICAgICAndGVjaGluYXNpYS5jb20nLAogICAgICAgICd0ZWxlZ3JhYWYubmwnLAogICAgICAgICd0aGUtYW1lcmljYW4taW50ZXJlc3QuY29tJywKICAgICAgICAndGhlYWR2b2NhdGUuY29tLmF1JywKICAgICAgICAndGhlYWdlLmNvbS5hdScsCiAgICAgICAgJ3RoZWF0bGFudGljLmNvbScsCiAgICAgICAgJ3RoZWF1c3RyYWxpYW4uY29tLmF1JywKICAgICAgICAndGhlY3V0LmNvbScsCiAgICAgICAgJ3RoZWRpcGxvbWF0LmNvbScsCiAgICAgICAgJ3RoZW1lcmN1cnkuY29tLmF1JywKICAgICAgICAndG93YXJkc2RhdGFzY2llbmNlLmNvbScsCiAgICAgICAgJ3Ryb3V3Lm5sJywKICAgICAgICAndm4ubmwnLAogICAgICAgICd2b2xrc2tyYW50Lm5sJywKICAgICAgICAndnVsdHVyZS5jb20nLAogICAgICAgICduenouY2gnLAogICAgICAgICdoYW5kZWxzYmxhdHQuY29tJywKICAgICAgICAndGhlaGluZHUuY29tJywKICAgICAgICAnZmluYW5jaWFscG9zdC5jb20nLAogICAgICAgICdoYWFyZXR6LmNvLmlsJywKICAgICAgICAnaGFhcmV0ei5jb20nLAogICAgICAgICd0aGVtYXJrZXIuY29tJywKICAgICAgICAnc3VlZGRldXRzY2hlLmRlJywKICAgICAgICAnZ2Vsb2NhbC5pdCcsCiAgICAgICAgJ2VsbXVuZG8uZXMnLAogICAgICAgICd0aW1lLmNvbScsCiAgICAgICAgJ3plaXQuZGUnLAogICAgICAgICdleHBhbnNpb24uY29tJywKICAgICAgICAnZGFpbHl0ZWxlZ3JhcGguY29tLmF1JywKICAgICAgICAnd2FzaGluZ3RvbnBvc3QuY29tJwogICAgXTsKCiAgICAvLyBSZW1vdmVzIGNvb2tpZXMgYWZ0ZXIgcGFnZSBsb2FkCiAgICBjb25zdCByZW1vdmVDb29raWVzID0gWwogICAgICAgICdhZC5ubCcsCiAgICAgICAgJ2JkLm5sJywKICAgICAgICAnYmxvb21iZXJnLmNvbScsCiAgICAgICAgJ2Jsb29tYmVyZ3F1aW50LmNvbScsCiAgICAgICAgJ2JuZGVzdGVtLm5sJywKICAgICAgICAnYnJpc2JhbmV0aW1lcy5jb20uYXUnLAogICAgICAgICdjYW5iZXJyYXRpbWVzLmNvbS5hdScsCiAgICAgICAgJ2Nlbi5hY3Mub3JnJywKICAgICAgICAnZGVtb3JnZW4uYmUnLAogICAgICAgICdkZW52ZXJwb3N0LmNvbScsCiAgICAgICAgJ2Rlc3RlbnRvci5ubCcsCiAgICAgICAgJ2VkLm5sJywKICAgICAgICAnZXhhbWluZXIuY29tLmF1JywKICAgICAgICAnZ2VsZGVybGFuZGVyLm5sJywKICAgICAgICAnZ2xvYmVzLmNvLmlsJywKICAgICAgICAnZ3J1YnN0cmVldC5jb20nLAogICAgICAgICdoYXJwZXJzLm9yZycsCiAgICAgICAgJ2hici5vcmcnLAogICAgICAgICdodW1vLmJlJywKICAgICAgICAnbGVzZWNob3MuZnInLAogICAgICAgICdtZXJjdXJ5bmV3cy5jb20nLAogICAgICAgICduZXdzdGF0ZXNtYW4uY29tJywKICAgICAgICAnbnJjLm5sJywKICAgICAgICAnbnltYWcuY29tJywKICAgICAgICAnb2NyZWdpc3Rlci5jb20nLAogICAgICAgICdwemMubmwnLAogICAgICAgICdxei5jb20nLAogICAgICAgICdzY2llbnRpZmljYW1lcmljYW4uY29tJywKICAgICAgICAnc2VhdHRsZXRpbWVzLmNvbScsCiAgICAgICAgJ3NvZnJlcC5jb20nLAogICAgICAgICdzcGVjdGF0b3IuY28udWsnLAogICAgICAgICdzcGVsZC5ubCcsCiAgICAgICAgJ3RlbGVncmFhZi5ubCcsCiAgICAgICAgJ3RoZWFkdm9jYXRlLmNvbS5hdScsCiAgICAgICAgJ3RoZWFnZS5jb20uYXUnLAogICAgICAgICd0aGVhdGxhbnRpYy5jb20nLAogICAgICAgICd0aGVjdXQuY29tJywKICAgICAgICAndGhlZGlwbG9tYXQuY29tJywKICAgICAgICAndG93YXJkc2RhdGFzY2llbmNlLmNvbScsCiAgICAgICAgJ3R1YmFudGlhLm5sJywKICAgICAgICAndm4ubmwnLAogICAgICAgICd2dWx0dXJlLmNvbScsCiAgICAgICAgJ3dzai5jb20nLAogICAgICAgICdtZWRpdW0uY29tJywKICAgICAgICAnd2FzaGluZ3RvbnBvc3QuY29tJwogICAgXTsKCiAgICAvLyBDb250YWlucyByZW1vdmUgY29va2llIHNpdGVzIGFib3ZlIHBsdXMgYW55IGN1c3RvbSBzaXRlcwogICAgbGV0IF9yZW1vdmVDb29raWVzID0gcmVtb3ZlQ29va2llczsKCiAgICAvLyBzZWxlY3Qgc3BlY2lmaWMgY29va2llKHMpIHRvIGhvbGQgZnJvbSByZW1vdmVDb29raWVzIGRvbWFpbnMKICAgIGNvbnN0IHJlbW92ZUNvb2tpZXNTZWxlY3RIb2xkID0gewogICAgICAgICdxei5jb20nOiBbJ2dkcHInXSwKICAgICAgICAnd3NqLmNvbSc6IFsnd3NqcmVnaW9uJ10sCiAgICAgICAgJ3NlYXR0bGV0aW1lcy5jb20nOiBbJ3N0X25ld3NsZXR0ZXJfc3BsYXNoX3NlZW4nXQogICAgfTsKCiAgICAvLyBzZWxlY3Qgb25seSBzcGVjaWZpYyBjb29raWUocykgdG8gZHJvcCBmcm9tIHJlbW92ZUNvb2tpZXMgZG9tYWlucwogICAgY29uc3QgcmVtb3ZlQ29va2llc1NlbGVjdERyb3AgPSB7CiAgICAgICAgJ2FkLm5sJzogWyd0ZW1wdGF0aW9uVHJhY2tpbmdJZCddLAogICAgICAgICdhbWJpdG8uY29tJzogWydURE5vdGVzUmVhZCddLAogICAgICAgICdiZC5ubCc6IFsndGVtcHRhdGlvblRyYWNraW5nSWQnXSwKICAgICAgICAnYm5kZXN0ZW0ubmwnOiBbJ3RlbXB0YXRpb25UcmFja2luZ0lkJ10sCiAgICAgICAgJ2RlbW9yZ2VuLmJlJzogWydUSURfSUQnXSwKICAgICAgICAnZGVzdGVudG9yLm5sJzogWyd0ZW1wdGF0aW9uVHJhY2tpbmdJZCddLAogICAgICAgICdlZC5ubCc6IFsndGVtcHRhdGlvblRyYWNraW5nSWQnXSwKICAgICAgICAnZmQubmwnOiBbJ3NvY2lhbHJlYWQnXSwKICAgICAgICAnZ2VsZGVybGFuZGVyLm5sJzogWyd0ZW1wdGF0aW9uVHJhY2tpbmdJZCddLAogICAgICAgICdodW1vLmJlJzogWydUSURfSUQnXSwKICAgICAgICAnbnJjLm5sJzogWydjb3VudGVyJ10sCiAgICAgICAgJ3B6Yy5ubCc6IFsndGVtcHRhdGlvblRyYWNraW5nSWQnXSwKICAgICAgICAndHViYW50aWEubmwnOiBbJ3RlbXB0YXRpb25UcmFja2luZ0lkJ10sCiAgICAgICAgJ3NwZWxkLm5sJzogWydzcGVsZC1wYXl3YWxsJ10KICAgIH07CgogICAgLy8gT3ZlcnJpZGUgVXNlci1BZ2VudCB3aXRoIEdvb2dsZWJvdAogICAgY29uc3QgdXNlR29vZ2xlQm90U2l0ZXMgPSBbCiAgICAgICAgJ2FkZWxhaWRlbm93LmNvbS5hdScsCiAgICAgICAgJ2JhcnJvbnMuY29tJywKICAgICAgICAnY291cmllcm1haWwuY29tLmF1JywKICAgICAgICAnZmQubmwnLAogICAgICAgICdnZW5vbWV3ZWIuY29tJywKICAgICAgICAnaGVyYWxkc3VuLmNvbS5hdScsCiAgICAgICAgJ2xhdm9peGR1bm9yZC5mcicsCiAgICAgICAgJ250bmV3cy5jb20uYXUnLAogICAgICAgICdxdW9yYS5jb20nLAogICAgICAgICdzZWVraW5nYWxwaGEuY29tJywKICAgICAgICAndGVsZWdyYXBoLmNvLnVrJywKICAgICAgICAndGhlYXVzdHJhbGlhbi5jb20uYXUnLAogICAgICAgICd0aGVtZXJjdXJ5LmNvbS5hdScsCiAgICAgICAgJ3RoZW5hdGlvbmFsLnNjb3QnLAogICAgICAgICd3c2ouY29tJywKICAgICAgICAna2Fuc2FzY2l0eS5jb20nLAogICAgICAgICdyZXB1YmxpYy5ydScsCiAgICAgICAgJ256ei5jaCcsCiAgICAgICAgJ2hhbmRlbHNibGF0dC5jb20nLAogICAgICAgICdkZi5jbCcsCiAgICAgICAgJ2Z0LmNvbScsCiAgICAgICAgJ3dpcmVkLmNvbScsCiAgICAgICAgJ3plaXQuZGUnCiAgICBdOwoKICAgIC8vIE92ZXJyaWRlIFVzZXItQWdlbnQgd2l0aCBCaW5nYm90CiAgICBjb25zdCB1c2VCaW5nQm90ID0gWwogICAgICAgICdoYWFyZXR6LmNvLmlsJywKICAgICAgICAnaGFhcmV0ei5jb20nLAogICAgICAgICd0aGVtYXJrZXIuY29tJwogICAgXTsKCiAgICAvLyBDb250YWlucyBnb29nbGUgYm90IHNpdGVzIGFib3ZlIHBsdXMgYW55IGN1c3RvbSBzaXRlcwogICAgbGV0IF91c2VHb29nbGVCb3RTaXRlcyA9IHVzZUdvb2dsZUJvdFNpdGVzOwoKICAgIGZ1bmN0aW9uIHNldERlZmF1bHRPcHRpb25zKCkgewogICAgICAgIGV4dGVuc2lvbkFwaS5zdG9yYWdlLnN5bmMuc2V0KHsKICAgICAgICAgICAgc2l0ZXM6IGRlZmF1bHRTaXRlcwogICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgZXh0ZW5zaW9uQXBpLnJ1bnRpbWUub3Blbk9wdGlvbnNQYWdlKCk7CiAgICAgICAgfSk7CiAgICB9CgogICAgLy8gQmxvY2sgZXh0ZXJuYWwgc2NyaXB0cwogICAgY29uc3QgYmxvY2tlZFJlZ2V4ZXMgPSB7CiAgICAgICAgJ2Fkd2Vlay5jb20nOiAvLitcLmxpZ2h0Ym94Y2RuXC5jb21cLy4rLywKICAgICAgICAnYWZyLmNvbSc6IC9hZnJcLmNvbVwvYXNzZXRzXC92ZW5kb3JzUmVhY3RSZWR1eF9jbGllbnQuK1wuanMvLAogICAgICAgICdidXNpbmVzc2luc2lkZXIuY29tJzogLyguK1wudGlueXBhc3NcLmNvbVwvLit8Y2RuXC5vbmVzaWduYWxcLmNvbVwvc2Rrc1wvLitcLmpzKS8sCiAgICAgICAgJ2NoaWNhZ290cmlidW5lLmNvbSc6IC8uKzpcL1wvLitcLnRyaWJkc3NcLmNvbVwvLywKICAgICAgICAnZWNvbm9taXN0LmNvbSc6IC8oLitcLnRpbnlwYXNzXC5jb21cLy4rfGVjb25vbWlzdFwuY29tXC9lbmdhc3NldHNcL19uZXh0XC9zdGF0aWNcL2NodW5rc1wvZnJhbWV3b3JrLitcLmpzKS8sCiAgICAgICAgJ2VkaXRvcmlhbGVkb21hbmkuaXQnOiAvKGpzXC5wZWxjcm9cLmNvbVwvLit8ZWRpdG9yaWFsZWRvbWFuaS5pdFwvcGVsY3JvXC5qcykvLAogICAgICAgICdmb3JlaWducG9saWN5LmNvbSc6IC8oY2RuXC5jeGVuc2VcLmNvbVwvfFwudGlueXBhc3NcLmNvbVwvKS8sCiAgICAgICAgJ2ZvcnR1bmUuY29tJzogLy4rXC50aW55cGFzc1wuY29tXC8uKy8sCiAgICAgICAgJ2hhYXJldHouY28uaWwnOiAvaGFhcmV0elwuY29cLmlsXC9odHpcL2pzXC9pbnRlclwuanMvLAogICAgICAgICdoYWFyZXR6LmNvbSc6IC9oYWFyZXR6XC5jb21cL2hkY1wvd2ViXC9qc1wvbWluaWZpZWRcL2hlYWRlci1zY3JpcHRzLWludC5qcy4rLywKICAgICAgICAnaW5xdWlyZXIuY29tJzogLy4rXC50aW55cGFzc1wuY29tXC8uKy8sCiAgICAgICAgJ2xhc3RhbXBhLml0JzogLy4rXC5yZXBzdGF0aWNcLml0XC9taW5pZnlcL3NpdGVzXC9sYXN0YW1wYVwvLitcL2NvbmZpZ1wuY2FjaGVcLnBocFw/bmFtZT1zb2NpYWxfanMvLAogICAgICAgICdscmIuY28udWsnOiAvLitcLnRpbnlwYXNzXC5jb21cLy4rLywKICAgICAgICAnbWVkc2NhcGUuY29tJzogLy4rXC5tZWRzY2FwZXN0YXRpY1wuY29tXC8uKm1lZHNjYXBlLWxpYnJhcnlcLmpzLywKICAgICAgICAnaW50ZXJlc3QuY28ubnonOiAvKC4rXC5wcmVzc3BhdHJvblwuY29tLit8LitpbnRlcmVzdFwuY29cLm56LitwcC1hYmxvY2stYmFubmVyXC5qcykvLAogICAgICAgICdyZXB1YmJsaWNhLml0JzogL3NjcmlwdHNcLnJlcHViYmxpY2FcLml0XC9wd1wvcHdcLmpzLisvLAogICAgICAgICdzcGVjdGF0b3IuY28udWsnOiAvLitcLnRpbnlwYXNzXC5jb21cLy4rLywKICAgICAgICAnc3BlY3RhdG9yLmNvbS5hdSc6IC8uK1wudGlueXBhc3NcLmNvbVwvLisvLAogICAgICAgICd0ZWxlZ3JhcGguY28udWsnOiAvLit0ZWxlZ3JhcGhcLmNvXC51ay4rbWFydGVjaC4rLywKICAgICAgICAndGhlY291cmllci5jb20uYXUnOiAvLitjZG4tYXVcLnBpYW5vXC5pb1wvYXBpXC90aW55cGFzcy4rXC5qcy8sCiAgICAgICAgJ3RoZW5hdGlvbi5jb20nOiAvdGhlbmF0aW9uXC5jb21cLy4rXC9wYXl3YWxsLXNjcmlwdFwucGhwLywKICAgICAgICAndGhlbmF0aW9uYWwuc2NvdCc6IC8oLitcLnRpbnlwYXNzXC5jb21cLy4rfC4rdGhlbmF0aW9uYWxcLnNjb3QuK29tbml0dXJlXC5qc3wuK3RoZW5hdGlvbmFsXC5zY290LityZXNwb25zaXZlLXN5bmMuKykvLAogICAgICAgICd0aGV3cmFwLmNvbSc6IC90aGV3cmFwXC5jb21cLy4rXC93YWxsa2l0XC5qcy8sCiAgICAgICAgJ3dzai5jb20nOiAvY2RuXC5hbXBwcm9qZWN0XC5vcmdcL3ZcZFwvYW1wLWFjY2Vzcy0uK1wuanMvLAogICAgICAgICdoaXN0b3J5ZXh0cmEuY29tJzogLy4rXC5ldm9sb2tcLm5ldFwvLitcL2F1dGhvcml6ZVwvLisvLAogICAgICAgICdiYXJyb25zLmNvbSc6IC9jZG5cLmFtcHByb2plY3RcLm9yZ1wvdlxkXC9hbXAtYWNjZXNzLS4rXC5qcy8sCiAgICAgICAgJ2lyaXNodGltZXMuY29tJzogL2NkblwuYW1wcHJvamVjdFwub3JnXC92XGRcL2FtcC1hY2Nlc3MtLitcLmpzLywKICAgICAgICAnZWxtZXJjdXJpby5jb20nOiAvKG1lcnJlYWRlclwuZW1vbFwuY2xcL2Fzc2V0c1wvanNcL21lclByYW1WMi5qc3xzdGF0aWNtZXJcLmVtb2xcLmNsXC9qc1wvaW52ZXJzaW9uZXNcL1ByYW1Nb2RhbC4rXC5qcykvLAogICAgICAgICdzbG9hbnJldmlldy5taXQuZWR1JzogLyguK1wudGlueXBhc3NcLmNvbVwvLit8LitcLm5ldGRuYS1zc2xcLmNvbVwvd3AtY29udGVudFwvdGhlbWVzXC9zbXJcL2Fzc2V0c1wvanNcL2xpYnNcL3dlbGNvbWUtYWRcLmpzKS8sCiAgICAgICAgJ2xhdGVyY2VyYS5jb20nOiAvLitcLmN4ZW5zZVwuY29tXC8rLywKICAgICAgICAnbGVzZWNob3MuZnInOiAvLitcLnRpbnlwYXNzXC5jb21cLy4rLywKICAgICAgICAndGhlaGluZHUuY29tJzogL2FqYXhcLmNsb3VkZmxhcmVcLmNvbVwvY2RuLWNnaVwvc2NyaXB0c1wvLitcL2Nsb3VkZmxhcmUtc3RhdGljXC9yb2NrZXQtbG9hZGVyXC5taW5cLmpzLywKICAgICAgICAndGVjaG5vbG9neXJldmlldy5jb20nOiAvLitcLmJsdWVjb25pY1wubmV0XC8uKy8sCiAgICAgICAgJ3NwZWN0YXRvci51cyc6IC8oY2RuXC5jeGVuc2VcLmNvbVwvLit8XC50aW55cGFzc1wuY29tXC8uKykvLAogICAgICAgICdnZWxvY2FsLml0JzogLyhcLnJlcHN0YXRpY1wuaXRcL21pbmlmeVwvc2l0ZXNcL2dlbG9jYWxcLy4rXC9jb25maWdcLmNhY2hlKF9cZCk/XC5waHB8Y2RuXC5hbXBwcm9qZWN0XC5vcmdcL3ZcZFwvYW1wLShhY2Nlc3N8YWQpLS4rXC5qcykvLAogICAgICAgICdlbG11bmRvLmVzJzogL2NkblwuYW1wcHJvamVjdFwub3JnXC92XGRcL2FtcC0oYWNjZXNzfGFkfGNvbnNlbnQpLS4rXC5qcy8sCiAgICAgICAgJ3RpbWUuY29tJzogL1wvdGltZVwuY29tXC9kaXN0XC9tZXRlci13YWxsLWNsaWVudC1qc1wuLitcLmpzLywKICAgICAgICAndGhlc3Rhci5jb20nOiAvXC5jb21cL2FwaVwvb3ZlcmxheWRhdGEvLAogICAgICAgICdlbHBhaXMuY29tJzogLyhcLmVwaW1nXC5uZXRcL2pzXC8uK1wvKG5vdGljaWF8dXNlcilcLm1pblwuanN8XC9lbHBhaXNcLmNvbVwvYXJjXC9zdWJzXC9wXC5taW5cLmpzfGNkblwuYW1wcHJvamVjdFwub3JnXC92XGRcL2FtcC0oYWNjZXNzfChzdGlja3ktKT9hZHxjb25zZW50KS0uK1wuanMpLywKICAgICAgICAnZXhwYW5zaW9uLmNvbSc6IC9jZG5cLmFtcHByb2plY3RcLm9yZ1wvdlxkXC9hbXAtKGFjY2Vzc3xhZHxjb25zZW50KS0uK1wuanMvLAogICAgICAgICdjaGljYWdvYnVzaW5lc3MuY29tJzogLyhcLnRpbnlwYXNzXC5jb21cL3xcLmNoaWNhZ29idXNpbmVzc1wuY29tXC8uK1wvanNcL2pzXy4rXC5qcykvLAogICAgICAgICdkYWlseXRlbGVncmFwaC5jb20uYXUnOiAvY2RuXC5hbXBwcm9qZWN0XC5vcmdcL3ZcZFwvYW1wLShhY2Nlc3N8YWR8Y29uc2VudCktLitcLmpzLywKICAgICAgICAndGhlZ2xvYmVhbmRtYWlsLmNvbSc6IC8oXC50aGVnbG9iZWFuZG1haWxcLmNvbVwvcGZcL2Rpc3RcL2VuZ2luZVwvcmVhY3RcLmpzfHNtYXJ0d2FsbFwudGhlZ2xvYmVhbmRtYWlsXC5jb21cLykvCiAgICB9OwoKICAgIGNvbnN0IHVzZXJBZ2VudERlc2t0b3AgPSAnTW96aWxsYS81LjAgKGNvbXBhdGlibGU7IEdvb2dsZWJvdC8yLjE7ICtodHRwOi8vd3d3Lmdvb2dsZS5jb20vYm90Lmh0bWwpJzsKICAgIGNvbnN0IHVzZXJBZ2VudE1vYmlsZSA9ICdDaHJvbWUvNDEuMC4yMjcyLjk2IE1vYmlsZSBTYWZhcmkvNTM3LjM2IChjb21wYXRpYmxlIDsgR29vZ2xlYm90LzIuMSA7ICtodHRwOi8vd3d3Lmdvb2dsZS5jb20vYm90Lmh0bWwpJzsKICAgIGNvbnN0IHVzZXJBZ2VudERlc2t0b3BCaW5nQm90ID0gJ01vemlsbGEvNS4wIChjb21wYXRpYmxlOyBiaW5nYm90LzIuMDsgK2h0dHA6Ly93d3cuYmluZy5jb20vYmluZ2JvdC5odG0pJzsKICAgIGNvbnN0IHVzZXJBZ2VudE1vYmlsZUJpbmdCb3QgPSAnQ2hyb21lLzgwLjAuMzk4Ny45MiBNb2JpbGUgU2FmYXJpLzUzNy4zNiAoY29tcGF0aWJsZTsgYmluZ2JvdC8yLjA7ICtodHRwOi8vd3d3LmJpbmcuY29tL2Jpbmdib3QuaHRtKSc7CgogICAgbGV0IGVuYWJsZWRTaXRlcyA9IFtdOwoKICAgIC8vIEdldCB0aGUgZW5hYmxlZCBzaXRlcwogICAgZXh0ZW5zaW9uQXBpLnN0b3JhZ2Uuc3luYy5nZXQoewogICAgICAgIHNpdGVzOiB7fSwKICAgICAgICBjdXN0b21TaXRlczogW10KICAgIH0sIGZ1bmN0aW9uIChpdGVtcykgewogICAgICAgIGVuYWJsZWRTaXRlcyA9IE9iamVjdC52YWx1ZXMoaXRlbXMuc2l0ZXMpLmNvbmNhdChpdGVtcy5jdXN0b21TaXRlcyk7CgogICAgICAgIC8vIFVzZSBnb29nbGVib3QgVUEgZm9yIGN1c3RvbSBzaXRlcwogICAgICAgIF91c2VHb29nbGVCb3RTaXRlcyA9IHVzZUdvb2dsZUJvdFNpdGVzLmNvbmNhdChpdGVtcy5jdXN0b21TaXRlcyk7CgogICAgICAgIC8vIFJlbW92ZSBjb29raWVzIGZvciBjdXN0b20gc2l0ZXMKICAgICAgICBfcmVtb3ZlQ29va2llcyA9IHJlbW92ZUNvb2tpZXMuY29uY2F0KGl0ZW1zLmN1c3RvbVNpdGVzKTsKCiAgICAgICAgaWYgKGV4dGVuc2lvbkFwaSA9PT0gY2hyb21lKSB7CiAgICAgICAgICAgIGluaXRHQSgpOwogICAgICAgIH0KICAgIH0pOwoKICAgIC8vIExpc3RlbiBmb3IgY2hhbmdlcyB0byBvcHRpb25zCiAgICBleHRlbnNpb25BcGkuc3RvcmFnZS5vbkNoYW5nZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKGNoYW5nZXMsIG5hbWVzcGFjZSkgewogICAgICAgIGlmIChjaGFuZ2VzLnNpdGVzICYmIGNoYW5nZXMuc2l0ZXMubmV3VmFsdWUpIHsKICAgICAgICAgICAgY29uc3Qgc2l0ZXMgPSBjaGFuZ2VzLnNpdGVzLm5ld1ZhbHVlOwogICAgICAgICAgICBlbmFibGVkU2l0ZXMgPSBPYmplY3QudmFsdWVzKHNpdGVzKTsKICAgICAgICB9CiAgICB9KTsKCiAgICAvLyBTZXQgYW5kIHNob3cgZGVmYXVsdCBvcHRpb25zIG9uIGluc3RhbGwKICAgIGV4dGVuc2lvbkFwaS5ydW50aW1lLm9uSW5zdGFsbGVkLmFkZExpc3RlbmVyKGZ1bmN0aW9uIChkZXRhaWxzKSB7CiAgICAgICAgaWYgKGRldGFpbHMucmVhc29uID09PSAnaW5zdGFsbCcpIHsKICAgICAgICAgICAgc2V0RGVmYXVsdE9wdGlvbnMoKTsKICAgICAgICB9IGVsc2UgaWYgKGRldGFpbHMucmVhc29uID09PSAndXBkYXRlJykgewogICAgICAgICAgICAvLyBVc2VyIHVwZGF0ZWQgZXh0ZW5zaW9uCiAgICAgICAgfQogICAgfSk7CgogICAgZXh0ZW5zaW9uQXBpLnRhYnMub25VcGRhdGVkLmFkZExpc3RlbmVyKGZ1bmN0aW9uICh0YWJJZCwgaW5mbywgdGFiKSB7CiAgICAgICAgdXBkYXRlQmFkZ2UodGFiKTsKICAgIH0pOwogICAgZXh0ZW5zaW9uQXBpLnRhYnMub25BY3RpdmF0ZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKGFjdGl2ZUluZm8pIHsKICAgICAgICBleHRlbnNpb25BcGkudGFicy5nZXQoYWN0aXZlSW5mby50YWJJZCwgdXBkYXRlQmFkZ2UpOwogICAgfSk7CgogICAgZnVuY3Rpb24gdXBkYXRlQmFkZ2UoYWN0aXZlVGFiKSB7CiAgICAgICAgaWYgKGV4dGVuc2lvbkFwaS5ydW50aW1lLmxhc3RFcnJvciB8fCAhYWN0aXZlVGFiKSB7IHJldHVybjsgfQogICAgICAgIGNvbnN0IGJhZGdlVGV4dCA9IGdldEJhZGdlVGV4dChhY3RpdmVUYWIudXJsKTsKICAgICAgICBleHRlbnNpb25BcGkuYnJvd3NlckFjdGlvbi5zZXRCYWRnZUJhY2tncm91bmRDb2xvcih7IGNvbG9yOiAnYmx1ZScgfSk7CiAgICAgICAgZXh0ZW5zaW9uQXBpLmJyb3dzZXJBY3Rpb24uc2V0QmFkZ2VUZXh0KHsgdGV4dDogYmFkZ2VUZXh0IH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldEJhZGdlVGV4dChjdXJyZW50VXJsKSB7CiAgICAgICAgcmV0dXJuIGN1cnJlbnRVcmwgJiYgaXNTaXRlRW5hYmxlZCh7IHVybDogY3VycmVudFVybCB9KSA/ICdPTicgOiAnJzsKICAgIH0KCiAgICAvLyBBTVAgcmVkaXJlY3QgZm9yIGRhaWx5dGVsZWdyYXBoLmNvbS5hdQogICAgZXh0ZW5zaW9uQXBpLndlYlJlcXVlc3Qub25CZWZvcmVSZXF1ZXN0LmFkZExpc3RlbmVyKGZ1bmN0aW9uIChkZXRhaWxzKSB7CiAgICAgICAgaWYgKCFpc1NpdGVFbmFibGVkKGRldGFpbHMpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgdXBkYXRlZFVybCA9IGRlY29kZVVSSUNvbXBvbmVudChkZXRhaWxzLnVybC5zcGxpdCgnJmRlc3Q9JylbMV0uc3BsaXQoJyYnKVswXSkucmVwbGFjZSgnd3d3LicsICdhbXAuJyk7CiAgICAgICAgcmV0dXJuIHsgcmVkaXJlY3RVcmw6IHVwZGF0ZWRVcmwgfTsKICAgIH0sCiAgICAgICAgeyB1cmxzOiBbJyo6Ly93d3cuZGFpbHl0ZWxlZ3JhcGguY29tLmF1L3N1YnNjcmliZS8qJ10sIHR5cGVzOiBbJ21haW5fZnJhbWUnXSB9LAogICAgICAgIFsnYmxvY2tpbmcnXQogICAgKTsKCiAgICAvLyBEaXNhYmxlIGphdmFzY3JpcHQgZm9yIHRoZXNlIHNpdGVzCiAgICBleHRlbnNpb25BcGkud2ViUmVxdWVzdC5vbkJlZm9yZVJlcXVlc3QuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKGRldGFpbHMpIHsKICAgICAgICBpZiAoIWlzU2l0ZUVuYWJsZWQoZGV0YWlscykgJiYgIWVuYWJsZWRTaXRlcy5pbmNsdWRlcygnZ2VuZXJhbHBheXdhbGxieXBhc3MnKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHJldHVybiB7IGNhbmNlbDogdHJ1ZSB9OwogICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIHVybHM6IFsKICAgICAgICAgICAgICAgICcqOi8vKi5uZXdzdGF0ZXNtYW4uY29tLyonLAogICAgICAgICAgICAgICAgJyo6Ly8qLm91dGJyYWluLmNvbS8qJywKICAgICAgICAgICAgICAgICcqOi8vKi5waWFuby5pby8qJywKICAgICAgICAgICAgICAgICcqOi8vKi5wb29vbC5mci8qJywKICAgICAgICAgICAgICAgICcqOi8vKi5xaW90YS5jb20vKicsCiAgICAgICAgICAgICAgICAnKjovLyoudGlueXBhc3MuY29tLyonCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIHR5cGVzOiBbJ3NjcmlwdCddCiAgICAgICAgfSwKICAgICAgICBbJ2Jsb2NraW5nJ10KICAgICk7CgogICAgY29uc3QgZXh0cmFJbmZvU3BlYyA9IFsnYmxvY2tpbmcnLCAncmVxdWVzdEhlYWRlcnMnXTsKICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXh0ZW5zaW9uQXBpLndlYlJlcXVlc3QuT25CZWZvcmVTZW5kSGVhZGVyc09wdGlvbnMsICdFWFRSQV9IRUFERVJTJykpIHsKICAgICAgICBleHRyYUluZm9TcGVjLnB1c2goJ2V4dHJhSGVhZGVycycpOwogICAgfQoKICAgIGV4dGVuc2lvbkFwaS53ZWJSZXF1ZXN0Lm9uQmVmb3JlU2VuZEhlYWRlcnMuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKGRldGFpbHMpIHsKICAgICAgICBsZXQgcmVxdWVzdEhlYWRlcnMgPSBkZXRhaWxzLnJlcXVlc3RIZWFkZXJzOwoKICAgICAgICBsZXQgaGVhZGVyUmVmZXJlciA9ICcnOwogICAgICAgIGZvciAoY29uc3QgbiBpbiByZXF1ZXN0SGVhZGVycykgewogICAgICAgICAgICBpZiAocmVxdWVzdEhlYWRlcnNbbl0ubmFtZS50b0xvd2VyQ2FzZSgpID09PSAncmVmZXJlcicpIHsKICAgICAgICAgICAgICAgIGhlYWRlclJlZmVyZXIgPSByZXF1ZXN0SGVhZGVyc1tuXS52YWx1ZTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBjaGVjayBmb3IgYmxvY2tlZCByZWd1bGFyIGV4cHJlc3Npb246IGRvbWFpbiBlbmFibGVkLCBtYXRjaCByZWdleCwgYmxvY2sgb24gYW4gaW50ZXJuYWwgb3IgZXh0ZXJuYWwgcmVnZXgKICAgICAgICBjb25zdCBibG9ja2VkRG9tYWlucyA9IE9iamVjdC5rZXlzKGJsb2NrZWRSZWdleGVzKTsKICAgICAgICBjb25zdCBkb21haW4gPSBtYXRjaFVybERvbWFpbihibG9ja2VkRG9tYWlucywgaGVhZGVyUmVmZXJlcik7CiAgICAgICAgaWYgKGRvbWFpbiAmJiBkZXRhaWxzLnVybC5tYXRjaChibG9ja2VkUmVnZXhlc1tkb21haW5dKSAmJiBpc1NpdGVFbmFibGVkKHsgdXJsOiBoZWFkZXJSZWZlcmVyIH0pKSB7CiAgICAgICAgICAgIHJldHVybiB7IGNhbmNlbDogdHJ1ZSB9OwogICAgICAgIH0KCiAgICAgICAgaWYgKCFpc1NpdGVFbmFibGVkKGRldGFpbHMpICYmICFtYXRjaFVybERvbWFpbignY2RuLmFtcHByb2plY3Qub3JnJywgZGV0YWlscy51cmwpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHRhYklkID0gZGV0YWlscy50YWJJZDsKICAgICAgICBsZXQgdXNlVXNlckFnZW50TW9iaWxlID0gZmFsc2U7CiAgICAgICAgbGV0IHNldFJlZmVyZXIgPSBmYWxzZTsKCiAgICAgICAgLy8gaWYgcmVmZXJlciBleGlzdHMsIHNldCBpdCB0byBnb29nbGUKICAgICAgICByZXF1ZXN0SGVhZGVycyA9IHJlcXVlc3RIZWFkZXJzLm1hcChmdW5jdGlvbiAocmVxdWVzdEhlYWRlcikgewogICAgICAgICAgICBpZiAocmVxdWVzdEhlYWRlci5uYW1lID09PSAnUmVmZXJlcicpIHsKICAgICAgICAgICAgICAgIGlmIChkZXRhaWxzLnVybC5pbmNsdWRlcygnY29va2luZy5ueXRpbWVzLmNvbS9hcGkvdjEvdXNlcnMvYm9vdHN0cmFwJykpIHsKICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGZpeGVzIGltYWdlcyBub3QgYmVpbmcgbG9hZGVkIG9uIGNvb2tpbmcubnl0aW1lcy5jb20gbWFpbiBwYWdlCiAgICAgICAgICAgICAgICAgICAgLy8gcmVmZXJyZXIgaGFzIHRvIGJlICpueXRpbWVzLmNvbSBvdGhlcndpc2UgcmV0dXJucyA0MDMKICAgICAgICAgICAgICAgICAgICByZXF1ZXN0SGVhZGVyLnZhbHVlID0gJ2h0dHBzOi8vY29va2luZy5ueXRpbWVzLmNvbSc7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoVXJsRG9tYWluKCdmZC5ubCcsIGRldGFpbHMudXJsKSkgewogICAgICAgICAgICAgICAgICAgIHJlcXVlc3RIZWFkZXIudmFsdWUgPSAnaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tLyc7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoVXJsRG9tYWluKCdtZWRpdW0uY29tJywgZGV0YWlscy51cmwpKSB7CiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEhlYWRlci52YWx1ZSA9ICdodHRwczovL3QuY28veD9hbXA9MSc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJlcXVlc3RIZWFkZXIudmFsdWUgPSAnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2V0UmVmZXJlciA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJlcXVlc3RIZWFkZXIubmFtZSA9PT0gJ1VzZXItQWdlbnQnKSB7CiAgICAgICAgICAgICAgICB1c2VVc2VyQWdlbnRNb2JpbGUgPSByZXF1ZXN0SGVhZGVyLnZhbHVlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ21vYmlsZScpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVxdWVzdEhlYWRlcjsKICAgICAgICB9KTsKCiAgICAgICAgLy8gb3RoZXJ3aXNlIGFkZCBpdAogICAgICAgIGlmICghc2V0UmVmZXJlcikgewogICAgICAgICAgICBpZiAobWF0Y2hVcmxEb21haW4oJ2ZkLm5sJywgZGV0YWlscy51cmwpKSB7CiAgICAgICAgICAgICAgICByZXF1ZXN0SGVhZGVycy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiAnUmVmZXJlcicsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICdodHRwczovL3d3dy5mYWNlYm9vay5jb20vJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2hVcmxEb21haW4oJ21lZGl1bS5jb20nLCBkZXRhaWxzLnVybCkpIHsKICAgICAgICAgICAgICAgIHJlcXVlc3RIZWFkZXJzLnB1c2goewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdSZWZlcmVyJywKICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJ2h0dHBzOi8vdC5jby94P2FtcD0xJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXF1ZXN0SGVhZGVycy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiAnUmVmZXJlcicsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICdodHRwczovL3d3dy5nb29nbGUuY29tLycKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBvdmVycmlkZSBVc2VyLUFnZW50IHRvIHVzZSBHb29nbGVib3QKICAgICAgICBjb25zdCB1c2VHb29nbGVCb3QgPSBfdXNlR29vZ2xlQm90U2l0ZXMuc29tZShmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gdHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnICYmIG1hdGNoVXJsRG9tYWluKGl0ZW0sIGRldGFpbHMudXJsKTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKHVzZUdvb2dsZUJvdCkgewogICAgICAgICAgICByZXF1ZXN0SGVhZGVycy5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6ICdVc2VyLUFnZW50JywKICAgICAgICAgICAgICAgIHZhbHVlOiB1c2VVc2VyQWdlbnRNb2JpbGUgPyB1c2VyQWdlbnRNb2JpbGUgOiB1c2VyQWdlbnREZXNrdG9wCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXF1ZXN0SGVhZGVycy5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6ICdYLUZvcndhcmRlZC1Gb3InLAogICAgICAgICAgICAgICAgdmFsdWU6ICc2Ni4yNDkuNjYuMScKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICAvLyBvdmVycmlkZSBVc2VyLUFnZW50IHRvIHVzZSBCaW5nYm90CiAgICAgICAgaWYgKG1hdGNoVXJsRG9tYWluKHVzZUJpbmdCb3QsIGRldGFpbHMudXJsKSkgewogICAgICAgICAgICByZXF1ZXN0SGVhZGVycy5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6ICdVc2VyLUFnZW50JywKICAgICAgICAgICAgICAgIHZhbHVlOiB1c2VVc2VyQWdlbnRNb2JpbGUgPyB1c2VyQWdlbnRNb2JpbGVCaW5nQm90IDogdXNlckFnZW50RGVza3RvcEJpbmdCb3QKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICAvLyByZW1vdmUgY29va2llcyBiZWZvcmUgcGFnZSBsb2FkCiAgICAgICAgY29uc3QgZW5hYmxlZENvb2tpZXMgPSBhbGxvd0Nvb2tpZXMuc29tZShmdW5jdGlvbiAoc2l0ZSkgewogICAgICAgICAgICByZXR1cm4gbWF0Y2hVcmxEb21haW4oc2l0ZSwgZGV0YWlscy51cmwpOwogICAgICAgIH0pOwogICAgICAgIGlmICghZW5hYmxlZENvb2tpZXMpIHsKICAgICAgICAgICAgcmVxdWVzdEhlYWRlcnMgPSByZXF1ZXN0SGVhZGVycy5tYXAoZnVuY3Rpb24gKHJlcXVlc3RIZWFkZXIpIHsKICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0SGVhZGVyLm5hbWUgPT09ICdDb29raWUnKSB7CiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEhlYWRlci52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3RIZWFkZXI7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRhYklkICE9PSAtMSkgewogICAgICAgICAgICBleHRlbnNpb25BcGkudGFicy5nZXQodGFiSWQsIGZ1bmN0aW9uIChjdXJyZW50VGFiKSB7CiAgICAgICAgICAgICAgICAvLyBWYWxpZGF0ZSB1cmwgb2YgY3VycmVudCB0YWIgdG8gYXZvaWQgaW5qZWN0aW5nIHNjcmlwdCB0byB1bnJlbGF0ZWQgc2l0ZXMKICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VGFiICYmIGN1cnJlbnRUYWIudXJsICYmIGlzU2l0ZUVuYWJsZWQoY3VycmVudFRhYikpIHsKICAgICAgICAgICAgICAgICAgICAvLyBydW4gY29udGVudFNjcmlwdCBpbnNpZGUgdGFiCiAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uQXBpLnRhYnMuZXhlY3V0ZVNjcmlwdCh0YWJJZCwgewogICAgICAgICAgICAgICAgICAgICAgICBmaWxlOiAnc3JjL2pzL2NvbnRlbnRTY3JpcHQuanMnLAogICAgICAgICAgICAgICAgICAgICAgICBydW5BdDogJ2RvY3VtZW50X3N0YXJ0JwogICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbkFwaS5ydW50aW1lLmxhc3RFcnJvciB8fCByZXNbMF0pIHsKCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4geyByZXF1ZXN0SGVhZGVyczogcmVxdWVzdEhlYWRlcnMgfTsKICAgIH0sIHsKICAgICAgICB1cmxzOiBbJzxhbGxfdXJscz4nXQogICAgfSwgZXh0cmFJbmZvU3BlYyk7CgogICAgLy8gcmVtb3ZlIGNvb2tpZXMgYWZ0ZXIgcGFnZSBsb2FkCiAgICBleHRlbnNpb25BcGkud2ViUmVxdWVzdC5vbkNvbXBsZXRlZC5hZGRMaXN0ZW5lcihmdW5jdGlvbiAoZGV0YWlscykgewogICAgICAgIGxldCBkb21haW5Ub1JlbW92ZTsKICAgICAgICBmb3IgKGNvbnN0IGRvbWFpbiBvZiBfcmVtb3ZlQ29va2llcykgewogICAgICAgICAgICBpZiAoZW5hYmxlZFNpdGVzLmluY2x1ZGVzKGRvbWFpbikgJiYgbWF0Y2hVcmxEb21haW4oZG9tYWluLCBkZXRhaWxzLnVybCkpIHsKICAgICAgICAgICAgICAgIGRvbWFpblRvUmVtb3ZlID0gZG9tYWluOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGRvbWFpblRvUmVtb3ZlKSB7CiAgICAgICAgICAgIGV4dGVuc2lvbkFwaS5jb29raWVzLmdldEFsbCh7IGRvbWFpbjogZG9tYWluVG9SZW1vdmUgfSwgZnVuY3Rpb24gKGNvb2tpZXMpIHsKICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2sgb2YgY29va2llcykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvb2tpZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAoY2suc2VjdXJlID8gJ2h0dHBzOi8vJyA6ICdodHRwOi8vJykgKyBjay5kb21haW4gKyBjay5wYXRoLAogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBjay5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBzdG9yZUlkOiBjay5zdG9yZUlkCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAvLyAuZmlyc3RQYXJ0eURvbWFpbiA9IHVuZGVmaW5lZCBvbiBDaHJvbWUgKGRvZXNuJ3Qgc3VwcG9ydCBpdCkKICAgICAgICAgICAgICAgICAgICBpZiAoY2suZmlyc3RQYXJ0eURvbWFpbiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZS5maXJzdFBhcnR5RG9tYWluID0gY2suZmlyc3RQYXJ0eURvbWFpbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29va2llRG9tYWluID0gY2suZG9tYWluOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJjRG9tYWluID0gY29va2llRG9tYWluLnJlcGxhY2UoL14oXC4/d3d3XC58XC4pLywgJycpOwogICAgICAgICAgICAgICAgICAgIC8vIGhvbGQgc3BlY2lmaWMgY29va2llKHMpIGZyb20gcmVtb3ZlQ29va2llcyBkb21haW5zCiAgICAgICAgICAgICAgICAgICAgaWYgKChyY0RvbWFpbiBpbiByZW1vdmVDb29raWVzU2VsZWN0SG9sZCkgJiYgcmVtb3ZlQ29va2llc1NlbGVjdEhvbGRbcmNEb21haW5dLmluY2x1ZGVzKGNrLm5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBkb24ndCByZW1vdmUgc3BlY2lmaWMgY29va2llCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIGRyb3Agb25seSBzcGVjaWZpYyBjb29raWUocykgZnJvbSByZW1vdmVDb29raWVzIGRvbWFpbnMKICAgICAgICAgICAgICAgICAgICBpZiAoKHJjRG9tYWluIGluIHJlbW92ZUNvb2tpZXNTZWxlY3REcm9wKSAmJiAhKHJlbW92ZUNvb2tpZXNTZWxlY3REcm9wW3JjRG9tYWluXS5pbmNsdWRlcyhjay5uYW1lKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIG9ubHkgcmVtb3ZlIHNwZWNpZmljIGNvb2tpZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBleHRlbnNpb25BcGkuY29va2llcy5yZW1vdmUoY29va2llKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfSwgewogICAgICAgIHVybHM6IFsnPGFsbF91cmxzPiddCiAgICB9KTsKCiAgICAvLyBHb29nbGUgQW5hbHl0aWNzIHRvIGFub255bW91c2x5IHRyYWNrIERBVSAoQ2hyb21lIG9ubHkpCiAgICBmdW5jdGlvbiBpbml0R0EoKSB7CiAgICAgICAgKGZ1bmN0aW9uIChpLCBzLCBvLCBnLCByLCBhLCBtKSB7CiAgICAgICAgICAgIGkuR29vZ2xlQW5hbHl0aWNzT2JqZWN0ID0gcjsKICAgICAgICAgICAgaVtyXSA9IGlbcl0gfHwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgKGlbcl0ucSA9IGlbcl0ucSB8fCBbXSkucHVzaChhcmd1bWVudHMpOwogICAgICAgICAgICB9LCBpW3JdLmwgPSAxICogbmV3IERhdGUoKTsKICAgICAgICAgICAgYSA9IHMuY3JlYXRlRWxlbWVudChvKSwgbSA9IHMuZ2V0RWxlbWVudHNCeVRhZ05hbWUobylbMF07CiAgICAgICAgICAgIGEuYXN5bmMgPSAxOwogICAgICAgICAgICBhLnNyYyA9IGc7CiAgICAgICAgICAgIG0ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSwgbSk7CiAgICAgICAgfSkod2luZG93LCBkb2N1bWVudCwgJ3NjcmlwdCcsICdodHRwczovL3d3dy5nb29nbGUtYW5hbHl0aWNzLmNvbS9hbmFseXRpY3MuanMnLCAnZ2EnKTsKICAgICAgICBnYSgnY3JlYXRlJywgJ1VBLTY5ODI0MTY5LTInLCAnYXV0bycpOwogICAgICAgIGdhKCdzZXQnLCAnY2hlY2tQcm90b2NvbFRhc2snLCBudWxsKTsKICAgICAgICBnYSgnc2V0JywgJ2Fub255bWl6ZUlwJywgdHJ1ZSk7CiAgICAgICAgZ2EoJ3NlbmQnLCAncGFnZXZpZXcnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBpc1NpdGVFbmFibGVkKGRldGFpbHMpIHsKICAgICAgICBjb25zdCBlbmFibGVkU2l0ZSA9IG1hdGNoVXJsRG9tYWluKGVuYWJsZWRTaXRlcywgZGV0YWlscy51cmwpOwogICAgICAgIGlmIChlbmFibGVkU2l0ZSBpbiByZXN0cmljdGlvbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHJlc3RyaWN0aW9uc1tlbmFibGVkU2l0ZV0udGVzdChkZXRhaWxzLnVybCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAhIWVuYWJsZWRTaXRlOwogICAgfQoKICAgIGZ1bmN0aW9uIG1hdGNoVXJsRG9tYWluKGRvbWFpbnMsIHVybCkgewogICAgICAgIGxldCBtYXRjaGVkRG9tYWluID0gZmFsc2U7CiAgICAgICAgbGV0IHVybF9ob3N0ID0gdXJsSG9zdCh1cmwpOwogICAgICAgIGlmICghdXJsX2hvc3QpIHsgdXJsX2hvc3QgPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU7IH0KICAgICAgICBpZiAodHlwZW9mIGRvbWFpbnMgPT09ICdzdHJpbmcnKSB7IGRvbWFpbnMgPSBbZG9tYWluc107IH0KICAgICAgICBkb21haW5zLnNvbWUoZG9tYWluID0+ICh1cmxfaG9zdCA9PT0gZG9tYWluIHx8IHVybF9ob3N0LmVuZHNXaXRoKCcuJyArIGRvbWFpbikpICYmIChtYXRjaGVkRG9tYWluID0gZG9tYWluKSk7CiAgICAgICAgcmV0dXJuIG1hdGNoZWREb21haW47CiAgICB9CgogICAgZnVuY3Rpb24gdXJsSG9zdCh1cmwpIHsKICAgICAgICBpZiAodXJsICYmIHVybC5zdGFydHNXaXRoKCdodHRwJykpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVVJMKHVybCkuaG9zdG5hbWU7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGB1cmwgbm90IHZhbGlkOiAke3VybH0gZXJyb3I6ICR7ZX1gKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdXJsOwogICAgfQoKfSkoKTsK"},{"name":"YouTube Animated Thumbnails & Preview Videos","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":["http://*youtube.com/my_videos_edit*","http://*youtube.com/my_subscribers*","https://*youtube.com/my_videos_edit*","https://*youtube.com/my_subscribers*"],"orig_includes":["http://*.youtube.com/*","http://youtube.com/*","https://*.youtube.com/*","https://youtube.com/*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":["i.ytimg.com"],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685023546523,"data":{}},"enabled":true,"position":14,"file_url":"https://greasyfork.org/scripts/2818-youtube-animated-thumbnails-preview-videos/code/YouTube%20Animated%20Thumbnails%20%20Preview%20Videos.user.js","uuid":"ba21f0f1-8bdf-436a-aafd-c356ef81e8f3","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgWW91VHViZSBBbmltYXRlZCBUaHVtYm5haWxzICYgUHJldmlldyBWaWRlb3MKLy8gQG5hbWVzcGFjZSAgICAgaHR0cDovL3VzZXJzY3JpcHRzLm9yZy91c2Vycy8yMzY1MgovLyBAZGVzY3JpcHRpb24gICBPbiBob3ZlciwgZWFjaCB0aHVtYm5haWwgY3ljbGVzIHRob3VnaCBpdHMgMyB0aHVtYm5haWxzLiBBZGRpdGlvbmFsIGZlYXR1cmUgdG8gdmlldyB0aG9zZSAzIHRodW1ibmFpbHMgYWxsIGF0IG9uY2UgKG5vbi1hbmltYXRlZCkKLy8gQGluY2x1ZGUgICAgICAgaHR0cDovLyoueW91dHViZS5jb20vKgovLyBAaW5jbHVkZSAgICAgICBodHRwOi8veW91dHViZS5jb20vKgovLyBAaW5jbHVkZSAgICAgICBodHRwczovLyoueW91dHViZS5jb20vKgovLyBAaW5jbHVkZSAgICAgICBodHRwczovL3lvdXR1YmUuY29tLyoKLy8gQGV4Y2x1ZGUgICAgICAgaHR0cDovLyp5b3V0dWJlLmNvbS9teV92aWRlb3NfZWRpdCoKLy8gQGV4Y2x1ZGUgICAgICAgaHR0cDovLyp5b3V0dWJlLmNvbS9teV9zdWJzY3JpYmVycyoKLy8gQGV4Y2x1ZGUgICAgICAgaHR0cHM6Ly8qeW91dHViZS5jb20vbXlfdmlkZW9zX2VkaXQqCi8vIEBleGNsdWRlICAgICAgIGh0dHBzOi8vKnlvdXR1YmUuY29tL215X3N1YnNjcmliZXJzKgovLyBAY29weXJpZ2h0ICAgICBKb2VTaW1tb25zCi8vIEB2ZXJzaW9uICAgICAgIDEuMS4wCi8vIEBsaWNlbnNlICAgICAgIEdQTCB2ZXJzaW9uIDMgb3IgYW55IGxhdGVyIHZlcnNpb247IGh0dHA6Ly93d3cuZ251Lm9yZy9jb3B5bGVmdC9ncGwuaHRtbAovLyBAcmVxdWlyZSAgICAgICBodHRwczovL2dyZWFzeWZvcmsub3JnL3NjcmlwdHMvMTg4NC1nbS1jb25maWcvY29kZS9HTV9jb25maWcuanM/dmVyc2lvbj00ODM2Ci8vIEByZXF1aXJlICAgICAgIGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy8xODg1LWpvZXNpbW1vbnMtbGlicmFyeS9jb2RlL0pvZVNpbW1vbnMnJTIwTGlicmFyeS5qcz92ZXJzaW9uPTQ4MzgKLy8gQHJlcXVpcmUgICAgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzI4MTctanNsLWFqYXgtcGx1Z2luL2NvZGUvSlNMJTIwLSUyMEFKQVglMjBwbHVnaW4uanM/dmVyc2lvbj03OTExCi8vIEBncmFudCAgICAgICAgIEdNX2dldFZhbHVlCi8vIEBncmFudCAgICAgICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQKLy8gQGdyYW50ICAgICAgICAgR01fc2V0VmFsdWUKLy8gQGdyYW50ICAgICAgICAgR01feG1saHR0cFJlcXVlc3QKLy8gPT0vVXNlclNjcmlwdD09CgoKLyogQ0hBTkdFTE9HIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCjEuMS4wICg0LzgvMjAxNCkKICAgIC0gZml4ZWQgdGh1bWJuYWlsIHByZXZpZXdzIHNvbWV0aW1lcyBub3QgZGlzcGxheWluZyB0aGUgcmlnaHQgdmlkZW8ncyB0aHVtYm5haWwKCjEuMC45NCAoMi8yNS8yMDE0KQogICAgLSBmaXhlZCBwcm9ibGVtIHdpdGggdGh1bWJuYWlscyBhcHBlYXJpbmcgdW5kZXIgdGhlIG1hc3RoZWFkCgoxLjAuOTMgKDExLzE4LzIwMTMpCiAgICAtIHJlbW92ZWQgZmFkaW5nLCB0b28gaW5jb25zaXN0ZW50ICYgbGFnZ3kKCjEuMC45MiAoMTAvOC8yMDEzKQogICAgLSByZS13cml0ZSBvZiB0aGUgZW50aXJlIHNjcmlwdCBmb3IgcmVhZGFiaWxpdHkgYW5kIGVmZmljaWVuY3kKICAgIC0gYWRkZWQgc29tZSBtaW5vciBmYWRlIGVmZmVjdHMKICAgIC0gaW5zdGVhZCBvZiBtYWtpbmcgdGhlIHZpZGVvIGJsYWNrIHdoZW4gaG92ZXJpbmcgb3ZlciBhIHRodW1ibmFpbCwKICAgICAgICB0aGUgc2NyaXB0IHdpbGwgbm93IGtlZXAgc2hvd2luZyB0aGUgdmlkZW8KICAgIC0gcHJldmlld3Mgb3BlbiBpbiB0aGUgb3Bwb3NpdGUgY29ybmVyIG9mIHdoZXJlIHlvdXIgbW91c2UgaXMKICAgIC0gbW9yZSByZWxpYWJsZSBIUSBpbWFnZSBnZXR0aW5nCiAgICAtIG9ubHkgdGhlIGhvdmVyZWQgb3ZlciB0aHVtYm5haWwgaXMgYW5pbWF0ZWQsIG5vdCBhbGwgdGhlIGltYWdlcyBub3cKCjEuMC45MQogICAgLSBBZGRlZCBhIG5ldyBvcHRpb24gdGhhdCBhbGxvd3MgYW5pbWF0ZWQgdGh1bWJuYWlscyBvbmx5IG9uIGhvdmVyZWQgaW1hZ2VzCgoxLjAuOTAKICAgIC0gTW92ZWQgdGhlIG9wdGlvbnMgYnV0dG9uIHRvIGluc2lkZSB0aGUgWW91VHViZSBkcm9wZG93biBtZW51CgoxLjAuODkKICAgIC0gQWRkZWQgY29tcGF0aWJpbGl0eSBmb3IgT3BlcmEgJiBDaHJvbWUKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCihmdW5jdGlvbiAoKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgdmFyIHJWaSA9IC9bYS16MC05LV0rXC55dGltZ1wuY29tXC92aVwvKFteXC9dKylcLy9pLAogICAgICAgIHJZdGltZ1VybCA9IC9bYS16MC05LV0rXC55dGltZ1wuY29tXC92aVwvL2ksCiAgICAgICAgcldoaWNoSW1hZ2UgPSAvKHZpXC9bYS16MC05LV9dK1wvKSgxfDN8bXFkZWZhdWx0KShcLmpwZykvaSwKICAgICAgICB4ID0gMCwgeSA9IDAsCiAgICAgICAgaXNIb3ZlckVuYWJsZWQsIHRodW1iU2l6ZSwgaXNBbmltYXRpb25FbmFibGVkLCBhbmltYXRpb25TcGVlZCwKICAgICAgICBtZW51bGlzdCwgX19wcmV2aWV3X3RpbWVvdXQsIF9fYW5pbWF0aW9uX2ludGVydmFsLCBzdGlsbE9uVGh1bWI7CgogICAgdmFyIHByZXZpZXcgPSB7CiAgICAgICAgLy8gY2xlYXJzIHRoZSB0aW1lb3V0IGFuZCBoaWRlcyB0aGUgaG92ZXIgcHJldmlldwogICAgICAgIGhpZGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKF9fcHJldmlld190aW1lb3V0KTsKICAgICAgICAgICAgSlNMKCcjaG92ZXJfaW1nJykuaGlkZSgpLmZpbmQoJ2ltZycpLmF0dHJpYnV0ZSgnc3JjJywgJycpOwogICAgICAgIH0sCiAgICAgICAgc2hvdyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8gc2V0cyB0aGUgdGltZW91dCB0byBzaG93IHRoZSBob3ZlciBwcmV2aWV3CiAgICAgICAgICAgIF9fcHJldmlld190aW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgSlNMKCcjaG92ZXJfaW1nJykuc2hvdygnYmxvY2snKTsKICAgICAgICAgICAgfSwgNDAwKTsKICAgICAgICB9CiAgICB9OwoKICAgIGZ1bmN0aW9uIGdldE5leHRJbWFnZShjdXJyZW50SW1hZ2UpIHsKICAgICAgICB2YXIgaW1hZ2VzSW5PcmRlciA9IFsnMScsICdtcWRlZmF1bHQnLCAnMyddLAogICAgICAgICAgICBpbmRleE9mTmV4dEltYWdlID0gaW1hZ2VzSW5PcmRlci5pbmRleE9mKGN1cnJlbnRJbWFnZSkgKyAxOwoKICAgICAgICBpZiAoIGluZGV4T2ZOZXh0SW1hZ2UgPiAoaW1hZ2VzSW5PcmRlci5sZW5ndGggLSAxKSApIHsKICAgICAgICAgICAgLy8gaWYgaXQncyBvbiB0aGUgbGFzdCBvbmUsIGdvIGJhY2sgdG8gdGhlIGZpcnN0CiAgICAgICAgICAgIHJldHVybiBpbWFnZXNJbk9yZGVyWzBdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGlmIGl0J3Mgbm90IG9uIHRoZSBsYXN0IG9uZSwgc2hvdyB0aGUgbmV4dCBvbmUKICAgICAgICAgICAgcmV0dXJuIGltYWdlc0luT3JkZXJbaW5kZXhPZk5leHRJbWFnZV07CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGhhbmRsZUhvdmVyTG9naWModXJsSWRQcmVmaXgpIHsKICAgICAgICB2YXIgYm94ID0gSlNMKCcjaG92ZXJfaW1nJyksCiAgICAgICAgICAgIGhvcmksIHZlcnQ7CgogICAgICAgIHByZXZpZXcuaGlkZSgpOwoKICAgICAgICAvLyBzZXQgdGhlIHByZXZpZXdzIGZvciB0aGlzIHRodW1ibmFpbAogICAgICAgIEpTTCgnI2hvdmVyX2ltZ18xJykuYXR0cmlidXRlKCdzcmMnLCB1cmxJZFByZWZpeCArICcxLmpwZycpOwogICAgICAgIEpTTCgnI2hvdmVyX2ltZ18yJykuYXR0cmlidXRlKCdzcmMnLCB1cmxJZFByZWZpeCArICdtcWRlZmF1bHQuanBnJyk7CiAgICAgICAgSlNMKCcjaG92ZXJfaW1nXzMnKS5hdHRyaWJ1dGUoJ3NyYycsIHVybElkUHJlZml4ICsgJzMuanBnJyk7CgogICAgICAgIC8vIGNoZWNrIGZvciBhIGhpZ2hlciBxdWFsaXR5IHByZXZpZXcgd2hpbGUgd2UKICAgICAgICAvLyB3YWl0IGZvciB0aGUgaW1hZ2UgdG8gZGlzcGxheQogICAgICAgIEpTTC5hamF4KFsKICAgICAgICAgICAgdXJsSWRQcmVmaXggKyAnbWF4cmVzZGVmYXVsdC5qcGcnLAogICAgICAgICAgICB1cmxJZFByZWZpeCArICdocWRlZmF1bHQuanBnJwogICAgICAgIF0sIHsKICAgICAgICAgICAgbWV0aG9kIDogJ0hFQUQnLAogICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgICAgICAgdmFyIGltZzIgPSBKU0woJyNob3Zlcl9pbWdfMicpOwoKICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZvciBhIDIwMCAoT0spIHN0YXR1cwogICAgICAgICAgICAgICAgLy8gJiB0aGF0IHdlJ3JlIHNob3dpbmcgdGhlIGNvcnJlY3QgdGh1bWJuYWlsCiAgICAgICAgICAgICAgICBpZiAoIHJlc3Auc3RhdHVzID09PSAyMDAgJiYgcmVzcC51cmwuZ2V0TWF0Y2goclZpLCAxKSA9PT0gaW1nMi5hdHRyaWJ1dGUoJ3NyYycpLmdldE1hdGNoKHJWaSwgMSkgKSB7CiAgICAgICAgICAgICAgICAgICAgaW1nMi5hdHRyaWJ1dGUoJ3NyYycsIHJlc3AudXJsKTsKICAgICAgICAgICAgICAgICAgICBKU0wuYWpheENsZWFyKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgdmVydCA9ICEoeSA8ICh3aW5kb3cuaW5uZXJIZWlnaHQgLyAyKSApID8gJ3RvcCcgOiAnYm90dG9tJzsgLy8gc2hvdWxkIHRoZSBwcmV2aWV3IGJlIG9uIHRoZSB0b3Agb3IgYm90dG9tCiAgICAgICAgaG9yaSA9ICEoeCA8ICggKHdpbmRvdy5pbm5lcldpZHRoIC0gMTUpIC8gMikgKSA/ICdsZWZ0JyA6ICdyaWdodCc7IC8vIHNob3VsZCB0aGUgcHJldmlldyBiZSBvbiB0aGUgbGVmdCBvciByaWdodAoKICAgICAgICAvLyBzZXQgdGhlIHZlcnRpY2FsIGFsaWduIHN0eWxlIHByb3BlcnR5IG9mIGVhY2ggb2YgdGhlIDMgcHJldmlldyBpbWFnZXMKICAgICAgICBKU0woJyNob3Zlcl9pbWcgaW1nJykuY3NzKCd2ZXJ0aWNhbC1hbGlnbicsIHZlcnQpOwoKICAgICAgICAvLyByZXNldCB0aGUgcG9zaXRpb24gb2YgdGhlIGhvdmVyIGJveAogICAgICAgIGJveC5jc3MoJ3RvcCcsICdhdXRvJykuY3NzKCdyaWdodCcsICdhdXRvJykuY3NzKCdib3R0b20nLCAnYXV0bycpLmNzcygnbGVmdCcsICdhdXRvJyk7CgogICAgICAgIC8vIHNldCB0aGUgY29ybmVyIGl0IHdpbGwgYXBwZWFyIGluCiAgICAgICAgYm94LmNzcyh2ZXJ0LCAnMCcpLmNzcyhob3JpLCAnMCcpOwoKICAgICAgICAvLyBzZXQgYSBkZWxheSBmb3IgdGhlIHByZXZpZXdzIHRvIHNob3cKICAgICAgICBwcmV2aWV3LnNob3coKTsKICAgIH0KCiAgICBmdW5jdGlvbiBoYW5kbGVBbmltYXRpb25Mb2dpYyhlbGVtKSB7CiAgICAgICAgX19hbmltYXRpb25faW50ZXJ2YWwgPSBKU0wuc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgY3VycmVudEltYWdlID0gZWxlbS5hdHRyaWJ1dGUoJ3NyYycpLmdldE1hdGNoKHJXaGljaEltYWdlLCAyKSwKICAgICAgICAgICAgICAgIG5leHRJbWFnZSA9IGdldE5leHRJbWFnZShjdXJyZW50SW1hZ2UpOwoKICAgICAgICAgICAgZWxlbS5hdHRyaWJ1dGUoICdzcmMnLCBlbGVtLmF0dHJpYnV0ZSgnc3JjJykucmVwbGFjZShyV2hpY2hJbWFnZSwgJyQxJyArIG5leHRJbWFnZSArICckMycpICk7CiAgICAgICAgfSwgYW5pbWF0aW9uU3BlZWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNob3coZXZlbnQpIHsKICAgICAgICB2YXIgZWxlbSA9IEpTTChldmVudC50YXJnZXQpLAogICAgICAgICAgICBpZCA9IGVsZW0uYXR0cmlidXRlKCdzcmMnKS5nZXRNYXRjaChyVmksIDEpLAogICAgICAgICAgICB1cmxJZFByZWZpeCA9ICdodHRwOi8vJyArIGVsZW0uYXR0cmlidXRlKCdzcmMnKS5nZXRNYXRjaChyWXRpbWdVcmwpICsgaWQgKyAnLyc7CgogICAgICAgIC8vIGZpbHRlciBvdXQgbm9uLXRodW1ibmFpbHMKICAgICAgICBpZiAoIGVsZW0uaXMoJ2ltZycpICYmIGVsZW0uaXNudCgnI2hvdmVyX2ltZywgaW1nW2lkXj0iaG92ZXJfaW1nXyJdJykgJiYgdXJsSWRQcmVmaXguZ2V0TWF0Y2goclZpKSApIHsKICAgICAgICAgICAgaWYgKGlzSG92ZXJFbmFibGVkKSB7CiAgICAgICAgICAgICAgICBoYW5kbGVIb3ZlckxvZ2ljKHVybElkUHJlZml4KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGlzQW5pbWF0aW9uRW5hYmxlZCkgewogICAgICAgICAgICAgICAgaGFuZGxlQW5pbWF0aW9uTG9naWMoZWxlbSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gaGlkZShldmVudCkgewogICAgICAgIHZhciBlbGVtID0gSlNMKGV2ZW50LnRhcmdldCksCiAgICAgICAgICAgIGlkID0gZWxlbS5hdHRyaWJ1dGUoJ3NyYycpLmdldE1hdGNoKHJWaSwgMSksCiAgICAgICAgICAgIHVybElkUHJlZml4ID0gJ2h0dHA6Ly8nICsgZWxlbS5hdHRyaWJ1dGUoJ3NyYycpLmdldE1hdGNoKHJZdGltZ1VybCkgKyBpZCArICcvJzsKCiAgICAgICAgLy8gY2xlYXIgdGhlIGxhc3QgSFEgdGh1bWJuYWlsIHJlcXVlc3QKICAgICAgICBKU0wuYWpheENsZWFyKCk7CgogICAgICAgIC8vIGRvbid0IGhpZGUgdGhlIHByZXZpZXcgaWYgdGhlIG1vdXNlIGdvZXMgb3ZlciBpdAogICAgICAgIGlmICggZWxlbS5pc250KCcjaG92ZXJfaW1nLCBpbWdbaWRePSJob3Zlcl9pbWdfIl0nKSApIHsKICAgICAgICAgICAgcHJldmlldy5oaWRlKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBzdG9wIGFuaW1hdGluZyB0aGUgY3VycmVudCB0aHVtYm5haWwKICAgICAgICBpZiAoIGVsZW0uaXMoJ2ltZycpICYmIGVsZW0uaXNudCgnI2hvdmVyX2ltZywgaW1nW2lkXj0iaG92ZXJfaW1nXyJdJykgJiYgZWxlbS5hdHRyaWJ1dGUoJ3NyYycpLmdldE1hdGNoKHJXaGljaEltYWdlKSApIHsKICAgICAgICAgICAgSlNMLmNsZWFySW50ZXJ2YWwoX19hbmltYXRpb25faW50ZXJ2YWwpOyAvLyBzdG9wIHRoZSBhbmltYXRpb24KICAgICAgICAgICAgZWxlbS5hdHRyaWJ1dGUoICdzcmMnLCBlbGVtLmF0dHJpYnV0ZSgnc3JjJykucmVwbGFjZShyV2hpY2hJbWFnZSwgJyQxbXFkZWZhdWx0JDMnKSApOyAvLyByZXNldCB0aGUgdGh1bWJuYWlsCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRyYWNrTW91c2UoZXZlbnQpIHsKICAgICAgICB4ID0gZXZlbnQucGFnZVggLSB3aW5kb3cucGFnZVhPZmZzZXQ7CiAgICAgICAgeSA9IGV2ZW50LnBhZ2VZIC0gd2luZG93LnBhZ2VZT2Zmc2V0OwogICAgfQoKICAgIGZ1bmN0aW9uIEdNX2NvbmZpZ19vcGVuKCkgewogICAgICAgIEdNX2NvbmZpZy5vcGVuKCk7CiAgICB9CgogICAgLy8gTWFrZSBzdXJlIHRoZSBwYWdlIGlzIG5vdCBpbiBhIGZyYW1lCiAgICBpZiAod2luZG93LnNlbGYgIT09IHdpbmRvdy50b3ApIHsgcmV0dXJuOyB9CgogICAgLy8gU3RyaW5nLnByb3RvdHlwZS5nZXRNYXRjaCBieSBKb2VTaW1tb25zCiAgICAvLyBlLmcuLCAnZm9vYmFyJy5nZXRNYXRjaCgvZm9vKGJhcikvLCAxKSA9PT4gJ2JhcicKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnZ2V0TWF0Y2gnLCB7CiAgICAgICAgdmFsdWUgOiBmdW5jdGlvbiAocmVnZXgsIGluZGV4KSB7CiAgICAgICAgICAgIHZhciBtYXRjaCA9IHRoaXMubWF0Y2gocmVnZXgpIHx8IFsnJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJycsICcnLCAnJ107CgogICAgICAgICAgICBpZiAodHlwZW9mIGluZGV4ID09PSAnbnVtYmVyJyAmJiBpbmRleCA+IC0xKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hbaW5kZXhdOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbWF0Y2hbMF07CiAgICAgICAgfQogICAgfSk7CgogICAgR01fY29uZmlnLmluaXQoJ1lvdVR1YmUgQW5pbWF0ZWQgVGh1bWJuYWlscyBPcHRpb25zJywgewogICAgICAgIGhvdmVyaW1hZ2VzIDogewogICAgICAgICAgICBzZWN0aW9uIDogWydIb3ZlciBPcHRpb25zJ10sCiAgICAgICAgICAgIGxhYmVsIDogJ0VuYWJsZSBIb3ZlciBJbWFnZXM/JywKICAgICAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgICAgICdkZWZhdWx0JyA6IHRydWUsCiAgICAgICAgICAgIHRpdGxlIDogJ0hvdmVyaW5nIG92ZXIgYSB0aHVtYm5haWwgc2hvd3MgMyBwcmV2aWV3IGltYWdlcy4nCiAgICAgICAgfSwKICAgICAgICB0aHVtYlNpemUgOiB7CiAgICAgICAgICAgIGxhYmVsIDogJ0hvdmVyIFRodW1ibmFpbCBTaXplJywKICAgICAgICAgICAgdHlwZSA6ICdzZWxlY3QnLAogICAgICAgICAgICBvcHRpb25zIDogewogICAgICAgICAgICAgICAgJzkwJyA6ICdTbWFsbCcsCiAgICAgICAgICAgICAgICAnMjE2JyA6ICdNZWRpdW0nLAogICAgICAgICAgICAgICAgJzQzMicgOiAnTGFyZ2UnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdkZWZhdWx0JyA6ICc0MzInLAogICAgICAgICAgICAndGl0bGUnIDogJ0Nob29zZSB0aGUgc2l6ZSBvZiB0aGUgaG92ZXJpbmcgdGh1bWJuYWlscycKICAgICAgICB9LAogICAgICAgIGFuaW1hdGVkdGh1bWJuYWlscyA6IHsKICAgICAgICAgICAgc2VjdGlvbiA6IFsnQW5pbWF0ZWQgVGh1bWJzIE9wdGlvbnMnXSwKICAgICAgICAgICAgbGFiZWwgOiAnRW5hYmxlIEFuaW1hdGVkIFRodW1ibmFpbHM/JywKICAgICAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgICAgICdkZWZhdWx0JyA6IHRydWUsCiAgICAgICAgICAgIHRpdGxlIDogJ1RodW1ibmFpbHMgY3ljbGUgdGhyb3VnaCB0aGUgMyBpbWFnZXMgd2hpbGUgaG92ZXJpbmcuJwogICAgICAgIH0sCiAgICAgICAgYW5pbWF0aW9uc3BlZWQgOiB7CiAgICAgICAgICAgIGxhYmVsIDogJ0FuaW1hdGlvbiAoQ3ljbGUpIFNwZWVkJywKICAgICAgICAgICAgdHlwZSA6ICdzZWxlY3QnLAogICAgICAgICAgICBvcHRpb25zIDogewogICAgICAgICAgICAgICAgJzEyMDAnIDogJ1N1cGVyIFNsb3cnLAogICAgICAgICAgICAgICAgJzgwMCcgOiAnU2xvdycsCiAgICAgICAgICAgICAgICAnNjAwJyA6ICdNZWRpdW0nLAogICAgICAgICAgICAgICAgJzQwMCcgOiAnRmFzdCcsCiAgICAgICAgICAgICAgICAnMjAwJyA6ICdTdXBlciBGYXN0JwogICAgICAgICAgICB9LAogICAgICAgICAgICAnZGVmYXVsdCcgOiAnNjAwJywKICAgICAgICAgICAgdGl0bGUgOiAnU2V0IHRoZSBzcGVlZCBvZiB0aGUgY3ljbGVkIGltYWdlcycKICAgICAgICB9CiAgICB9KTsKCiAgICBKU0wucnVuQXQoJ2ludGVyYWN0aXZlJywgZnVuY3Rpb24gKCkgewogICAgICAgIGlzSG92ZXJFbmFibGVkID0gR01fY29uZmlnLmdldCgnaG92ZXJpbWFnZXMnKSA9PT0gdHJ1ZTsKICAgICAgICB0aHVtYlNpemUgPSBHTV9jb25maWcuZ2V0KCd0aHVtYlNpemUnKTsKICAgICAgICBpc0FuaW1hdGlvbkVuYWJsZWQgPSBHTV9jb25maWcuZ2V0KCdhbmltYXRlZHRodW1ibmFpbHMnKSA9PT0gdHJ1ZTsKICAgICAgICBhbmltYXRpb25TcGVlZCA9IHBhcnNlSW50KEdNX2NvbmZpZy5nZXQoJ2FuaW1hdGlvbnNwZWVkJyksIDEwKTsKCiAgICAgICAgSlNMLmFkZFN0eWxlKCcnICsKICAgICAgICAgICAgJyNob3Zlcl9pbWcgeyAnICsKICAgICAgICAgICAgICAgICdwb3NpdGlvbjogZml4ZWQ7ICcgKwogICAgICAgICAgICAgICAgJ3otaW5kZXg6IDk5OTk5OTk5OTk5OTsgJyArCiAgICAgICAgICAgICAgICAnYmFja2dyb3VuZDogIzAwMDAwMDsgJyArCiAgICAgICAgICAgICAgICAnYm9yZGVyOiAxcHggc29saWQgIzAwMDAwMDsgJyArCiAgICAgICAgICAgICAgICAnb3V0bGluZTogMXB4IHNvbGlkICNDQ0NDQ0M7ICcgKwogICAgICAgICAgICAnfScgKwogICAgICAgICAgICAnI2hvdmVyX2ltZyBpbWcgeyAnICsKICAgICAgICAgICAgICAgICdtYXgtaGVpZ2h0OiAnICsgdGh1bWJTaXplICsgJ3B4OyAnICsKICAgICAgICAgICAgJ30nICsKCiAgICAgICAgICAgIC8vIGZpeCBmb3IgaW1hZ2VzIHNob3dpbmcgdW5kZXIgdGhlIHlvdXR1YmUgcGxheWVyCiAgICAgICAgICAgICcjaG92ZXJfaW1nIGltZyB7ICcgKwogICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtY29sb3I6ICMwMDAwMDA7ICcgKwogICAgICAgICAgICAnfScgKwogICAgICAgICAgICAnI3l0X2F0X29wcyB7ICcgKwogICAgICAgICAgICAgICAgJ2Rpc3BsYXk6IGlubGluZS1ibG9jazsgJyArCiAgICAgICAgICAgICAgICAncGFkZGluZzogNnB4OyAnICsKICAgICAgICAgICAgJ30nICsKICAgICAgICAgICAgJyNHTV9jb25maWcgeyAnICsKICAgICAgICAgICAgICAgICd6LWluZGV4OiA5OTk5OTk5OTk5OTkgIWltcG9ydGFudDsgJyArIC8vIDk5OSw5OTksOTk5LDk5OQogICAgICAgICAgICAnfScgKwogICAgICAgICcnKTsKCiAgICAgICAgSlNMKGRvY3VtZW50LmJvZHkpLmFwcGVuZCgnJyArCiAgICAgICAgICAgICc8ZGl2IGlkPSJob3Zlcl9pbWciIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+JyArCiAgICAgICAgICAgICAgICAnPGltZyBzcmM9IiIgYWx0PSIiIGlkPSJob3Zlcl9pbWdfMSIgLz4nICsKICAgICAgICAgICAgICAgICc8aW1nIHNyYz0iIiBhbHQ9IiIgaWQ9ImhvdmVyX2ltZ18yIiAvPicgKwogICAgICAgICAgICAgICAgJzxpbWcgc3JjPSIiIGFsdD0iIiBpZD0iaG92ZXJfaW1nXzMiIC8+JyArCiAgICAgICAgICAgICc8L2Rpdj4nICsKICAgICAgICAnJyk7CiAgICAgICAgCiAgICAgICAgLy8gQWRkIGEgdXNlciBzY3JpcHQgY29tbWFuZCBmb3IgdGhlIG9wdGlvbnMgbWVudQogICAgICAgIGlmICh0eXBlb2YgR01fcmVnaXN0ZXJNZW51Q29tbWFuZCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kKCdZb3VUdWJlIEFuaW1hdGVkIFRodW1ibmFpbHMgT3B0aW9ucycsIEdNX2NvbmZpZy5vcGVuKTsKICAgICAgICB9CgogICAgICAgIC8vIEFkZCBhbiBvcHRpb25zIGJ1dHRvbiB0byB0aGUgcGFnZQogICAgICAgIEpTTCgnI21hc3RoZWFkLWV4cGFuZGVkLW1lbnUtbGlzdCwgI2Zvb3Rlci1tYWluJykuYXBwZW5kKCcnICsKICAgICAgICAgICAgJzxsaSBpZD0ieXRfYXRfb3BzIiBjbGFzcz0ibWFzdGhlYWQtZXhwYW5kZWQtbWVudS1pdGVtIj4nICsKICAgICAgICAgICAgICAgICc8YSBocmVmPSJqYXZhc2NyaXB0OiB2b2lkKDApOyIgY2xhc3M9Inl0LXVpeC1zZXNzaW9ubGluayI+QW5pbWF0ZWQgVGh1bWJuYWlscyBPcHRpb25zPC9hPicgKwogICAgICAgICAgICAnPC9saT4nICsKICAgICAgICAnJyk7CiAgICAgICAgSlNMKCcjeXRfYXRfb3BzIGEnKS5hZGRFdmVudCgnY2xpY2snLCBHTV9jb25maWcub3Blbik7CgogICAgICAgIGlmIChpc0hvdmVyRW5hYmxlZCkgewogICAgICAgICAgICBKU0wuYWRkRXZlbnQod2luZG93LCAnbW91c2Vtb3ZlJywgdHJhY2tNb3VzZSk7CiAgICAgICAgICAgIEpTTC5hZGRFdmVudCh3aW5kb3csICdjbGljaycsIHByZXZpZXcuaGlkZSk7CiAgICAgICAgfQogICAgICAgIEpTTC5hZGRFdmVudCh3aW5kb3csICdtb3VzZW92ZXInLCBzaG93KTsKICAgICAgICBKU0wuYWRkRXZlbnQod2luZG93LCAnbW91c2VvdXQnLCBoaWRlKTsKICAgIH0pOwoKfSkoKTs=","requires":[{"meta":{"name":"GM_config.js","url":"https://greasyfork.org/scripts/1884-gm-config/code/GM_config.js?version=4836","ts":1685023546879,"mimetype":"text/javascript"},"source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgIEdNX2NvbmZpZwovLyBAbmFtZXNwYWNlICAgICAgaHR0cDovL3VzZXJzY3JpcHRzLm9yZy91c2Vycy8yMzY1MgovLyBAZGVzY3JpcHRpb24gICAgR3JlYXNlTW9ua2V5IFNjcmlwdCBDb25maWd1cmF0b3IKLy8gQGluY2x1ZGUgICAgICAgIGh0dHA6Ly8qCi8vIEBpbmNsdWRlICAgICAgICBodHRwczovLyoKLy8gQGluY2x1ZGUgICAgICAgIGZpbGU6KgovLyBAY29weXJpZ2h0ICAgICAgSm9lU2ltbW9ucyAmIFNpenpsZW1jdHdpenpsZSAmIEl6enlTb2Z0Ci8vIEB2ZXJzaW9uICAgICAgICAxLjIuNTcKLy8gQGxpY2Vuc2UgICAgICAgIExHUEwgdmVyc2lvbiAzIG9yIGFueSBsYXRlciB2ZXJzaW9uOyBodHRwOi8vd3d3LmdudS5vcmcvY29weWxlZnQvbGdwbC5odG1sCi8vID09L1VzZXJTY3JpcHQ9PQoKLyogSW5zdHJ1Y3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKR01fY29uZmlnIGlzIGNyb3NzLWJyb3dzZXIgY29tcGF0aWJsZS4KClRvIHVzZSBpdCBpbiBhIEdyZWFzZW1vbmtleS9UYW1wZXJtb25rZXkvVmlvbGVudG1vbmtleSBzY3JpcHQsIHlvdSBjYW4ganVzdCBAcmVxdWlyZSBpdC4KCklmIHlvdSBjYW4ndCBAcmVxdWlyZSBpdCwgeW91IHdpbGwgbmVlZCB0byBtYW51YWxseSBpbmNsdWRlIHRoZSBjb2RlIGF0IHRoZSBiZWdpbm5pbmcgb2YgeW91ciB1c2VyIHNjcmlwdC4KCkluIG5vbi1HcmVhc2Vtb25rZXksIHN0b3JlZCBzZXR0aW5ncyB3aWxsIG9ubHkgYmUgYWNjZXNzaWJsZSBvbiB0aGUgc2FtZSBkb21haW4gaW4gd2hpY2ggdGhleSB3ZXJlIHNhdmVkLgoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCgovKiBDSEFOR0VMT0cgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCjEuMi41NwoJLSBGaXhlZCBUeXBlRXJyb3Igd2l0aCB0aGUgIm9wdGlvbnMiIHNldHRpbmcgb2YgYSAic2VsZWN0IiBmaWVsZAoJCQlUaGUgIm9wdGlvbnMiIHNldHRpbmcgbmVlZHMgdG8gYmUgYSBKU09OIG9iamVjdCwgbm90IGFuIGFycmF5CgoxLjIuNTYKCS0gc3RhcnRlZCBrZWVwaW5nIGNoYW5nZWxvZyBpbiBzb3VyY2UKCS0gYWRkZWQgdHlwZSAicGFzc3dvcmQiCgktIGZpeGVkIGVycm9yIHdoZW4gdXNlciBkb2Vzbid0IGRlZmluZSBhbnkgc2VjdGlvbnMKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCgoKdmFyIEdNX2NvbmZpZyA9IHsKIHN0b3JhZ2U6ICdHTV9jb25maWcnLAogaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgICAgLy8gbG9vcCB0aHJvdWdoIEdNX2NvbmZpZy5pbml0KCkgYXJndW1lbnRzCglmb3IodmFyIGk9MCxsPWFyZ3VtZW50cy5sZW5ndGgsYXJnOyBpPGw7ICsraSkgewoJCWFyZz1hcmd1bWVudHNbaV07CgkJc3dpdGNoKHR5cGVvZiBhcmcpIHsKICAgICAgICAgICAgY2FzZSAnb2JqZWN0JzogZm9yKHZhciBqIGluIGFyZykgeyAvLyBjb3VsZCBiZSBhIGNhbGxiYWNrIGZ1bmN0aW9ucyBvciBzZXR0aW5ncyBvYmplY3QKCQkJCQkJCXN3aXRjaChqKSB7CgkJCQkJCQljYXNlICJvcGVuIjogR01fY29uZmlnLm9uT3Blbj1hcmdbal07IGRlbGV0ZSBhcmdbal07IGJyZWFrOyAvLyBjYWxsZWQgd2hlbiBmcmFtZSBpcyBnb25lCgkJCQkJCQljYXNlICJjbG9zZSI6IEdNX2NvbmZpZy5vbkNsb3NlPWFyZ1tqXTsgZGVsZXRlIGFyZ1tqXTsgYnJlYWs7IC8vIGNhbGxlZCB3aGVuIHNldHRpbmdzIGhhdmUgYmVlbiBzYXZlZAoJCQkJCQkJY2FzZSAic2F2ZSI6IEdNX2NvbmZpZy5vblNhdmU9YXJnW2pdOyBkZWxldGUgYXJnW2pdOyBicmVhazsgLy8gc3RvcmUgdGhlIHNldHRpbmdzIG9iamVjdHMKCQkJCQkJCWRlZmF1bHQ6IHZhciBzZXR0aW5ncyA9IGFyZzsKCQkJCQkJCX0KCQkJfSBicmVhazsKICAgICAgICAgICAgY2FzZSAnZnVuY3Rpb24nOiBHTV9jb25maWcub25PcGVuID0gYXJnOyBicmVhazsgLy8gcGFzc2luZyBhIGJhcmUgZnVuY3Rpb24gaXMgc2V0IHRvIG9wZW4KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY291bGQgYmUgY3VzdG9tIENTUyBvciB0aGUgdGl0bGUgc3RyaW5nCgkJCWNhc2UgJ3N0cmluZyc6IGlmKGFyZy5pbmRleE9mKCd7JykgIT09IC0xICYmIGFyZy5pbmRleE9mKCd9JykgIT09IC0xKSB2YXIgY3NzID0gYXJnOwoJCQkJZWxzZSBHTV9jb25maWcudGl0bGUgPSBhcmc7CgkJCQlicmVhazsKCQl9Cgl9CglpZighR01fY29uZmlnLnRpdGxlKSBHTV9jb25maWcudGl0bGUgPSAnU2V0dGluZ3MgLSBBbm9ueW1vdXMgU2NyaXB0JzsgLy8gaWYgdGl0bGUgd2Fzbid0IHBhc3NlZCB0aHJvdWdoIGluaXQoKQoKCS8vIGdpdmUgdGhlIHNjcmlwdCBhIHVuaXF1ZSBzYXZpbmcgSUQgZm9yIG5vbi1maXJlZm94IGJyb3dzZXJzCglHTV9jb25maWcuc3RvcmFnZSA9IEdNX2NvbmZpZy50aXRsZS5yZXBsYWNlKC9cVysvZywgIiIpLnRvTG93ZXJDYXNlKCk7CgoJdmFyIHN0b3JlZCA9IEdNX2NvbmZpZy5yZWFkKCk7IC8vIHJlYWQgdGhlIHN0b3JlZCBzZXR0aW5ncwoJR01fY29uZmlnLnBhc3NlZF92YWx1ZXMgPSB7fTsKCWZvcih2YXIgaSBpbiBzZXR0aW5ncykgewoJCUdNX2NvbmZpZy5kb1NldHRpbmdWYWx1ZShzZXR0aW5ncywgc3RvcmVkLCBpLCBudWxsLCBmYWxzZSk7CgkJaWYoc2V0dGluZ3NbaV0ua2lkcykgZm9yKHZhciBraWQgaW4gc2V0dGluZ3NbaV0ua2lkcykgR01fY29uZmlnLmRvU2V0dGluZ1ZhbHVlKHNldHRpbmdzLCBzdG9yZWQsIGtpZCwgaSwgdHJ1ZSk7Cgl9CglHTV9jb25maWcudmFsdWVzID0gR01fY29uZmlnLnBhc3NlZF92YWx1ZXM7CglHTV9jb25maWcuc2V0dGluZ3MgPSBzZXR0aW5nczsKCWlmIChjc3MpIEdNX2NvbmZpZy5jc3Muc3R5bGlzaCA9IGNzczsKIH0sCiBvcGVuOiBmdW5jdGlvbigpIHsKIGlmKGRvY3VtZW50LmV2YWx1YXRlKCIvL2lmcmFtZVtAaWQ9J0dNX2NvbmZpZyddIixkb2N1bWVudCxudWxsLDksbnVsbCkuc2luZ2xlTm9kZVZhbHVlKSByZXR1cm47CgkvLyBDcmVhdGUgZnJhbWUKCWRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoKEdNX2NvbmZpZy5mcmFtZT1HTV9jb25maWcuY3JlYXRlKCdpZnJhbWUnLHtpZDonR01fY29uZmlnJywgc3R5bGU6J3Bvc2l0aW9uOiBmaXhlZDsgdG9wOiAwOyBsZWZ0OiAwOyBvcGFjaXR5OiAwOyBkaXNwbGF5OiBub25lOyB6LWluZGV4OiA5OTk5OTk7IHdpZHRoOiA3NSU7IGhlaWdodDogNzUlOyBtYXgtaGVpZ2h0OiA5NSU7IG1heC13aWR0aDogOTUlOyBib3JkZXI6M3B4IHJpZGdlICMwMDAwMDA7IG92ZXJmbG93OiBhdXRvOyd9KSkpOwogICAgICAgIEdNX2NvbmZpZy5mcmFtZS5zcmMgPSAnYWJvdXQ6YmxhbmsnOyAvLyBJbiBXZWJLaXQgc3JjIGNhbnQgYmUgc2V0IHVudGlsIGl0IGlzIGFkZGVkIHRvIHRoZSBwYWdlCglHTV9jb25maWcuZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkgewoJCXZhciBvYmogPSBHTV9jb25maWcsIGRvYyA9IHRoaXMuY29udGVudERvY3VtZW50LCBmcmFtZUJvZHkgPSBkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXSwgY3JlYXRlPW9iai5jcmVhdGUsIHNldHRpbmdzPW9iai5zZXR0aW5ncywgYW5jaCwgc2VjTm87CgkJb2JqLmZyYW1lLmNvbnRlbnREb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdLmFwcGVuZENoaWxkKGNyZWF0ZSgnc3R5bGUnLHt0eXBlOid0ZXh0L2NzcycsdGV4dENvbnRlbnQ6b2JqLmNzcy5iYXNpYyArICJcblxuIiArIG9iai5jc3Muc3R5bGlzaH0pKTsKCgkJLy8gQWRkIGhlYWRlciBhbmQgdGl0bGUKCQlmcmFtZUJvZHkuYXBwZW5kQ2hpbGQoY3JlYXRlKCdkaXYnLCB7aWQ6J2hlYWRlcicsY2xhc3NOYW1lOidjb25maWdfaGVhZGVyIGJsb2NrIGNlbnRlcicsIGlubmVySFRNTDpvYmoudGl0bGV9KSk7CgoJCS8vIEFwcGVuZCBlbGVtZW50cwoJCWFuY2ggPSBmcmFtZUJvZHk7IC8vIGRlZmluZSBmcmFtZSBib2R5CgkJc2VjTm8gPSAwOyAvLyBhbmNob3IgdG8gYXBwZW5kIGVsZW1lbnRzCgkJZm9yKHZhciBpIGluIHNldHRpbmdzKSB7CgkJCXZhciB0eXBlLCBmaWVsZCA9IHNldHRpbmdzW2ldLCB2YWx1ZSA9IG9iai52YWx1ZXNbaV0sIHNlY3Rpb24gPSAoZmllbGQuc2VjdGlvbiA/IGZpZWxkLnNlY3Rpb24gOiBbIk1haW4gT3B0aW9ucyJdKSwKCQkJCWhlYWRlckV4aXN0cyA9IGRvYy5ldmFsdWF0ZSgiLi8vZGl2W0BjbGFzcz0nc2VjdGlvbl9oZWFkZXJfaG9sZGVyJyBhbmQgc3RhcnRzLXdpdGgoQGlkLCAnc2VjdGlvbl8nKV0iLCBmcmFtZUJvZHksIG51bGwsIDksIG51bGwpLnNpbmdsZU5vZGVWYWx1ZTsKCgkJCWlmKHR5cGVvZiBmaWVsZC5zZWN0aW9uICE9PSAidW5kZWZpbmVkIiB8fCBoZWFkZXJFeGlzdHMgPT09IG51bGwpIHsKCQkJCWFuY2ggPSBmcmFtZUJvZHkuYXBwZW5kQ2hpbGQoY3JlYXRlKCdkaXYnLCB7Y2xhc3NOYW1lOidzZWN0aW9uX2hlYWRlcl9ob2xkZXInLCBpZDonc2VjdGlvbl8nK3NlY05vLCBraWRzOm5ldyBBcnJheSgKCQkJCSAgY3JlYXRlKCdhJywge2NsYXNzTmFtZTonc2VjdGlvbl9oZWFkZXIgY2VudGVyJywgaHJlZjoiamF2YXNjcmlwdDp2b2lkKDApOyIsIGlkOidjX3NlY3Rpb25fa2lkc18nK3NlY05vLCB0ZXh0Q29udGVudDpzZWN0aW9uWzBdLCBvbmNsaWNrOmZ1bmN0aW9uKCl7R01fY29uZmlnLnRvZ2dsZSh0aGlzLmlkLnN1YnN0cmluZygyKSk7fX0pLAoJCQkJICBjcmVhdGUoJ2RpdicsIHtpZDonc2VjdGlvbl9raWRzXycrc2VjTm8sIGNsYXNzTmFtZTonc2VjdGlvbl9raWRzJywgc3R5bGU6b2JqLmdldFZhbHVlKCdzZWN0aW9uX2tpZHNfJytzZWNObywgIiIpPT0iIj8iIjoiZGlzcGxheTogbm9uZTsifSkKCQkJCSl9KSk7CgkJCQlpZihzZWN0aW9uWzFdKSBhbmNoLmFwcGVuZENoaWxkKGNyZWF0ZSgncCcsIHtjbGFzc05hbWU6J3NlY3Rpb25fZGVzYyBjZW50ZXInLGlubmVySFRNTDpzZWN0aW9uWzFdfSkpOwoJCQkJc2VjTm8rKzsKCQkJfQoJCQlhbmNoLmNoaWxkTm9kZXNbMV0uYXBwZW5kQ2hpbGQoR01fY29uZmlnLmFkZFRvRnJhbWUoZmllbGQsIGksIGZhbHNlKSk7CgkJfQoKCQkvLyBBZGQgc2F2ZSBhbmQgY2xvc2UgYnV0dG9ucwoJCWZyYW1lQm9keS5hcHBlbmRDaGlsZChvYmouY3JlYXRlKCdkaXYnLCB7aWQ6J2J1dHRvbnNfaG9sZGVyJywga2lkczpuZXcgQXJyYXkoCgkJCW9iai5jcmVhdGUoJ2J1dHRvbicse2lkOidzYXZlQnRuJyx0ZXh0Q29udGVudDonU2F2ZScsdGl0bGU6J1NhdmUgb3B0aW9ucyBhbmQgY2xvc2Ugd2luZG93JyxjbGFzc05hbWU6J3NhdmVjbG9zZV9idXR0b25zJyxvbmNsaWNrOmZ1bmN0aW9uKCl7R01fY29uZmlnLmNsb3NlKHRydWUpfX0pLAoJCQlvYmouY3JlYXRlKCdidXR0b24nLHtpZDonY2FuY2VsQnRuJywgdGV4dENvbnRlbnQ6J0NhbmNlbCcsdGl0bGU6J0Nsb3NlIHdpbmRvdycsY2xhc3NOYW1lOidzYXZlY2xvc2VfYnV0dG9ucycsb25jbGljazpmdW5jdGlvbigpe0dNX2NvbmZpZy5jbG9zZShmYWxzZSl9fSksCgkJCW9iai5jcmVhdGUoJ2RpdicsIHtjbGFzc05hbWU6J3Jlc2V0X2hvbGRlciBibG9jaycsIGtpZHM6bmV3IEFycmF5KAoJCQkJb2JqLmNyZWF0ZSgnYScse2lkOidyZXNldExpbmsnLHRleHRDb250ZW50OidSZXN0b3JlIHRvIGRlZmF1bHQnLGhyZWY6JyMnLHRpdGxlOidSZXN0b3JlIHNldHRpbmdzIHRvIGRlZmF1bHQgY29uZmlndXJhdGlvbicsY2xhc3NOYW1lOidyZXNldCcsb25jbGljazpvYmoucmVzZXR9KQoJCSl9KSl9KSk7CgoJCW9iai5jZW50ZXIoKTsgLy8gU2hvdyBhbmQgY2VudGVyIGl0CgkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIG9iai5jZW50ZXIsIGZhbHNlKTsgLy8gQ2VudGVyIGl0IG9uIHJlc2l6ZQoJCWlmIChvYmoub25PcGVuKSBvYmoub25PcGVuKCk7IC8vIENhbGwgdGhlIG9wZW4oKSBjYWxsYmFjayBmdW5jdGlvbgoJCQoJCS8vIENsb3NlIGZyYW1lIG9uIHdpbmRvdyBjbG9zZQoJCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBmdW5jdGlvbigpe0dNX2NvbmZpZy5yZW1vdmUodGhpcyk7fSwgZmFsc2UpOwoJfSwgZmFsc2UpOwogfSwKIGNsb3NlOiBmdW5jdGlvbihzYXZlKSB7CglpZihzYXZlKSB7CgkJdmFyIHR5cGUsIGZpZWxkcyA9IEdNX2NvbmZpZy5zZXR0aW5ncywgdHlwZXdoaXRlPS9yYWRpb3x0ZXh0fGhpZGRlbnxwYXNzd29yZHxjaGVja2JveC87CgkJZm9yKGYgaW4gZmllbGRzKSB7CgkJCXZhciBmaWVsZCA9IEdNX2NvbmZpZy5mcmFtZS5jb250ZW50RG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpZWxkXycrZiksIGtpZHM9ZmllbGRzW2ZdLmtpZHM7CgkJCWlmKHR5cGV3aGl0ZS50ZXN0KGZpZWxkLnR5cGUpKSB0eXBlPWZpZWxkLnR5cGU7CgkJCQllbHNlIHR5cGU9ZmllbGQudGFnTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQlHTV9jb25maWcuZG9TYXZlKGYsIGZpZWxkLCB0eXBlKTsKCQkJaWYoa2lkcykgZm9yKHZhciBraWQgaW4ga2lkcykgewoJCQl2YXIgZmllbGQgPSBHTV9jb25maWcuZnJhbWUuY29udGVudERvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWVsZF8nK2tpZCk7CgkJCWlmKHR5cGV3aGl0ZS50ZXN0KGZpZWxkLnR5cGUpKSB0eXBlPWZpZWxkLnR5cGU7CgkJCQllbHNlIHR5cGU9ZmllbGQudGFnTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQlHTV9jb25maWcuZG9TYXZlKGtpZCwgZmllbGQsIHR5cGUsIGYpOwoJCQl9CgkJfQogICAgICAgICAgICAgICAgaWYoR01fY29uZmlnLm9uU2F2ZSkgR01fY29uZmlnLm9uU2F2ZSgpOyAvLyBDYWxsIHRoZSBzYXZlKCkgY2FsbGJhY2sgZnVuY3Rpb24KICAgICAgICAgICAgICAgIEdNX2NvbmZpZy5zYXZlKCk7Cgl9CglpZihHTV9jb25maWcuZnJhbWUpIEdNX2NvbmZpZy5yZW1vdmUoR01fY29uZmlnLmZyYW1lKTsKCWRlbGV0ZSBHTV9jb25maWcuZnJhbWU7CiAgICAgICAgaWYoR01fY29uZmlnLm9uQ2xvc2UpIEdNX2NvbmZpZy5vbkNsb3NlKCk7IC8vICBDYWxsIHRoZSBjbG9zZSgpIGNhbGxiYWNrIGZ1bmN0aW9uCiB9LAogc2V0OiBmdW5jdGlvbihuYW1lLHZhbCkgewoJR01fY29uZmlnLnZhbHVlc1tuYW1lXSA9IHZhbDsKIH0sCiBnZXQ6IGZ1bmN0aW9uKG5hbWUpIHsKCXJldHVybiBHTV9jb25maWcudmFsdWVzW25hbWVdOwogfSwKIGlzR006ICh0eXBlb2Ygd2luZG93Lm9wZXJhID09PSAidW5kZWZpbmVkIiAmJiB0eXBlb2Ygd2luZG93LmNocm9tZSA9PT0gInVuZGVmaW5lZCIgJiYgdHlwZW9mIEdNX2luZm8gPT09ICJvYmplY3QiICYmIHR5cGVvZiBHTV9yZWdpc3Rlck1lbnVDb21tYW5kID09PSAiZnVuY3Rpb24iKSwKIGxvZzogZnVuY3Rpb24oc3RyKSB7CgoJaWYodGhpcy5pc0dNKSByZXR1cm4gR01fbG9nKHN0cik7CgkJZWxzZSBpZih3aW5kb3cub3BlcmEpIHJldHVybiB3aW5kb3cub3BlcmEucG9zdEVycm9yKHN0cik7CgkJZWxzZSByZXR1cm4gY29uc29sZS5sb2coc3RyKTsKCiB9LAogZ2V0VmFsdWUgOiBmdW5jdGlvbihuYW1lLCBkKSB7Cgl2YXIgciwgZGVmID0gKHR5cGVvZiBkICE9PSAidW5kZWZpbmVkIiA/IGQgOiAiIik7Cglzd2l0Y2godGhpcy5pc0dNID09PSB0cnVlKSB7CgkJY2FzZSB0cnVlOiByID0gR01fZ2V0VmFsdWUobmFtZSwgZGVmKTsgYnJlYWs7CgkJY2FzZSBmYWxzZTogciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKG5hbWUpIHx8IGRlZjsgYnJlYWs7Cgl9CglyZXR1cm4gcjsKfSwKIHNldFZhbHVlIDogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHsKCXN3aXRjaCh0aGlzLmlzR00gPT09IHRydWUpIHsKCQljYXNlIHRydWU6IEdNX3NldFZhbHVlKG5hbWUsIHZhbHVlKTsgYnJlYWs7CgkJY2FzZSBmYWxzZTogbG9jYWxTdG9yYWdlLnNldEl0ZW0obmFtZSwgdmFsdWUpOyBicmVhazsKCX0KIH0sCiAgZGVsZXRlVmFsdWUgOiBmdW5jdGlvbihuYW1lKSB7Cglzd2l0Y2godGhpcy5pc0dNID09PSB0cnVlKSB7CgkJY2FzZSB0cnVlOiBHTV9kZWxldGVWYWx1ZShuYW1lKTsgYnJlYWs7CgkJY2FzZSBmYWxzZTogbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0obmFtZSk7IGJyZWFrOwoJfQp9LAogc2F2ZTogZnVuY3Rpb24oc3RvcmUsIG9iaikgewogICAgdHJ5IHsKCQl2YXIgdmFsID0gSlNPTi5zdHJpbmdpZnkob2JqIHx8IEdNX2NvbmZpZy52YWx1ZXMpOwoJCUdNX2NvbmZpZy5zZXRWYWx1ZSgoc3RvcmV8fEdNX2NvbmZpZy5zdG9yYWdlKSx2YWwpOwogICAgfSBjYXRjaChlKSB7CgkJR01fY29uZmlnLmxvZygiR01fY29uZmlnIGZhaWxlZCB0byBzYXZlIHNldHRpbmdzIVxuIiArIGUpOwogICAgfQogfSwKIHJlYWQ6IGZ1bmN0aW9uKHN0b3JlKSB7Cgl2YXIgdmFsID0gR01fY29uZmlnLmdldFZhbHVlKChzdG9yZSB8fCBHTV9jb25maWcuc3RvcmFnZSksICd7fScpOwoJc3dpdGNoKHR5cGVvZiB2YWwpIHsKCQljYXNlICJzdHJpbmciOiB2YXIgcnZhbCA9IEpTT04ucGFyc2UodmFsKTsgYnJlYWs7CgkJY2FzZSAib2JqZWN0IjogdmFyIHJ2YWwgPSB2YWw7IGJyZWFrOwoJCWRlZmF1bHQ6IHZhciBydmFsID0ge307Cgl9CiAgICByZXR1cm4gcnZhbDsKIH0sCiByZXNldDogZnVuY3Rpb24oZSkgewoJZS5wcmV2ZW50RGVmYXVsdCgpOwoJdmFyIHR5cGUsIG9iaiA9IEdNX2NvbmZpZywgZmllbGRzID0gb2JqLnNldHRpbmdzOwoJZm9yKGYgaW4gZmllbGRzKSB7CgkJdmFyIGZpZWxkID0gb2JqLmZyYW1lLmNvbnRlbnREb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmllbGRfJytmKSwga2lkcz1maWVsZHNbZl0ua2lkczsKCQlpZihmaWVsZC50eXBlPT0ncmFkaW8nfHxmaWVsZC50eXBlPT0ndGV4dCd8fGZpZWxkLnR5cGU9PSdjaGVja2JveCcpIHR5cGU9ZmllbGQudHlwZTsKCQllbHNlIHR5cGU9ZmllbGQudGFnTmFtZS50b0xvd2VyQ2FzZSgpOwoJCUdNX2NvbmZpZy5kb1Jlc2V0KGZpZWxkLCB0eXBlLCBudWxsLCBmLCBudWxsLCBmYWxzZSk7CgkJaWYoa2lkcykgZm9yKHZhciBraWQgaW4ga2lkcykgewoJCQl2YXIgZmllbGQgPSBHTV9jb25maWcuZnJhbWUuY29udGVudERvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWVsZF8nK2tpZCk7CgkJCWlmKGZpZWxkLnR5cGU9PSdyYWRpbyd8fGZpZWxkLnR5cGU9PSd0ZXh0J3x8ZmllbGQudHlwZT09J2NoZWNrYm94JykgdHlwZT1maWVsZC50eXBlOwoJCQkJZWxzZSB0eXBlPWZpZWxkLnRhZ05hbWUudG9Mb3dlckNhc2UoKTsKCQkJR01fY29uZmlnLmRvUmVzZXQoZmllbGQsIHR5cGUsIGYsIGtpZCwgdHJ1ZSk7CgkJfQoJfQogfSwKIGFkZFRvRnJhbWUgOiBmdW5jdGlvbihmaWVsZCwgaSwgaykgewoJdmFyIGVsZW0sIG9iaiA9IHRoaXMsIGFuY2ggPSB0aGlzLmZyYW1lLCB2YWx1ZSA9IG9iai52YWx1ZXNbaV0sIE9wdGlvbnMgPSBmaWVsZC5vcHRpb25zLCBsYWJlbCA9IGZpZWxkLmxhYmVsLCBjcmVhdGU9b2JqLmNyZWF0ZSwgaXNLaWQgPSAoayAhPT0gbnVsbCAmJiBrID09PSB0cnVlKTsKCQlzd2l0Y2goZmllbGQudHlwZSkgewoJCQkJY2FzZSAndGV4dGFyZWEnOgoJCQkJCWVsZW0gPSBjcmVhdGUoaXNLaWQgPyAic3BhbiIgOiAiZGl2Iiwge3RpdGxlOmZpZWxkLnRpdGxlfHwnJywga2lkczpuZXcgQXJyYXkoCgkJCQkJCWNyZWF0ZSgnc3BhbicsIHt0ZXh0Q29udGVudDpsYWJlbCwgY2xhc3NOYW1lOidmaWVsZF9sYWJlbCd9KSwKCQkJCQkJY3JlYXRlKCd0ZXh0YXJlYScsIHtpZDonZmllbGRfJytpLGlubmVySFRNTDp2YWx1ZSwgY29sczooZmllbGQuY29scz9maWVsZC5jb2xzOjIwKSwgcm93czooZmllbGQucm93cz9maWVsZC5yb3dzOjIpfSkKCQkJCQkpLCBjbGFzc05hbWU6ICdjb25maWdfdmFyJ30pOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAncmFkaW8nOgoJCQkJCXZhciBib3hlcyA9IG5ldyBBcnJheSgpOwoJCQkJCWZvciAodmFyIGogPSAwLGxlbiA9IE9wdGlvbnMubGVuZ3RoOyBqPGxlbjsgaisrKSB7CgkJCQkJCWJveGVzLnB1c2goY3JlYXRlKCdzcGFuJywge3RleHRDb250ZW50Ok9wdGlvbnNbal19KSk7CgkJCQkJCWJveGVzLnB1c2goY3JlYXRlKCdpbnB1dCcsIHt2YWx1ZTpPcHRpb25zW2pdLCB0eXBlOidyYWRpbycsIG5hbWU6aSwgY2hlY2tlZDpPcHRpb25zW2pdPT12YWx1ZT90cnVlOmZhbHNlfSkpOwoJCQkJCX0KCQkJCQllbGVtID0gY3JlYXRlKGlzS2lkID8gInNwYW4iIDogImRpdiIsIHt0aXRsZTpmaWVsZC50aXRsZXx8JycsIGtpZHM6bmV3IEFycmF5KAoJCQkJCQljcmVhdGUoJ3NwYW4nLCB7dGV4dENvbnRlbnQ6bGFiZWwsIGNsYXNzTmFtZTonZmllbGRfbGFiZWwnfSksCgkJCQkJCWNyZWF0ZSgnc3BhbicsIHtpZDonZmllbGRfJytpLCBraWRzOmJveGVzfSkKCQkJCQkpLCBjbGFzc05hbWU6ICdjb25maWdfdmFyJ30pOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAnc2VsZWN0JzoKCQkJCQl2YXIgb3B0aW9ucyA9IFtdOwoJCQkJCWlmKHR5cGVvZiBPcHRpb25zID09PSAib2JqZWN0IiAmJiB0eXBlb2YgT3B0aW9ucy5wdXNoICE9PSAiZnVuY3Rpb24iKSBmb3IodmFyIGogaW4gT3B0aW9ucykgb3B0aW9ucy5wdXNoKGNyZWF0ZSgnb3B0aW9uJyx7dGV4dENvbnRlbnQ6T3B0aW9uc1tqXSx2YWx1ZTpqLHNlbGVjdGVkOihqPT12YWx1ZSl9KSk7CgkJCQkJCWVsc2Ugb3B0aW9ucy5wdXNoKGNyZWF0ZSgib3B0aW9uIiwge3RleHRDb250ZW50OiJFcnJvciAtIFwib3B0aW9uc1wiIG5lZWRzIHRvIGJlIGEgSlNPTiBvYmplY3QuIiwgdmFsdWU6ImVycm9yIiwgc2VsZWN0ZWQ6InNlbGVjdGVkIn0pKTsKCQkJCQllbGVtID0gY3JlYXRlKGlzS2lkID8gInNwYW4iIDogImRpdiIsIHt0aXRsZTpmaWVsZC50aXRsZXx8JycsIGtpZHM6bmV3IEFycmF5KAoJCQkJCQljcmVhdGUoJ3NwYW4nLCB7dGV4dENvbnRlbnQ6bGFiZWwsIGNsYXNzTmFtZTonZmllbGRfbGFiZWwnfSksCgkJCQkJCWNyZWF0ZSgnc2VsZWN0Jyx7aWQ6J2ZpZWxkXycraSwga2lkczpvcHRpb25zfSkKCQkJCQkpLCBjbGFzc05hbWU6ICdjb25maWdfdmFyJ30pOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAnY2hlY2tib3gnOgoJCQkJCWVsZW0gPSBjcmVhdGUoaXNLaWQgPyAic3BhbiIgOiAiZGl2Iiwge3RpdGxlOmZpZWxkLnRpdGxlfHwnJywga2lkczpuZXcgQXJyYXkoCgkJCQkJCWNyZWF0ZSgnbGFiZWwnLCB7dGV4dENvbnRlbnQ6bGFiZWwsIGNsYXNzTmFtZTonZmllbGRfbGFiZWwnLCAiZm9yIjonZmllbGRfJytpfSksCgkJCQkJCWNyZWF0ZSgnaW5wdXQnLCB7aWQ6J2ZpZWxkXycraSwgdHlwZTonY2hlY2tib3gnLCB2YWx1ZTp2YWx1ZSwgY2hlY2tlZDp2YWx1ZX0pCgkJCQkJKSwgY2xhc3NOYW1lOiAnY29uZmlnX3Zhcid9KTsKCQkJCQlicmVhazsKCQkJCWNhc2UgJ2J1dHRvbic6CgkJCQl2YXIgdG1wOwoJCQkJCWVsZW0gPSBjcmVhdGUoaXNLaWQgPyAic3BhbiIgOiAiZGl2Iiwge2tpZHM6bmV3IEFycmF5KAoJCQkJCQkodG1wPWNyZWF0ZSgnaW5wdXQnLCB7aWQ6J2ZpZWxkXycraSwgdHlwZTonYnV0dG9uJywgdmFsdWU6bGFiZWwsIHNpemU6KGZpZWxkLnNpemU/ZmllbGQuc2l6ZToyNSksIHRpdGxlOmZpZWxkLnRpdGxlfHwnJ30pKQoJCQkJCSksIGNsYXNzTmFtZTogJ2NvbmZpZ192YXInfSk7CgkJCQkJaWYoZmllbGQuc2NyaXB0KSBvYmouYWRkRXZlbnQodG1wLCAnY2xpY2snLCBmaWVsZC5zY3JpcHQpOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAnaGlkZGVuJzoKCQkJCQllbGVtID0gY3JlYXRlKGlzS2lkID8gInNwYW4iIDogImRpdiIsIHt0aXRsZTpmaWVsZC50aXRsZXx8JycsIGtpZHM6bmV3IEFycmF5KAoJCQkJCQljcmVhdGUoJ2lucHV0Jywge2lkOidmaWVsZF8nK2ksIHR5cGU6J2hpZGRlbicsIHZhbHVlOnZhbHVlfSkKCQkJCQkpLCBjbGFzc05hbWU6ICdjb25maWdfdmFyJ30pOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAncGFzc3dvcmQnOgoJCQkJCWVsZW0gPSBjcmVhdGUoaXNLaWQgPyAic3BhbiIgOiAiZGl2Iiwge3RpdGxlOmZpZWxkLnRpdGxlfHwnJywga2lkczpuZXcgQXJyYXkoCgkJCQkJCWNyZWF0ZSgnc3BhbicsIHt0ZXh0Q29udGVudDpsYWJlbCwgY2xhc3NOYW1lOidmaWVsZF9sYWJlbCd9KSwKCQkJCQkJY3JlYXRlKCdpbnB1dCcsIHtpZDonZmllbGRfJytpLCB0eXBlOidwYXNzd29yZCcsIHZhbHVlOnZhbHVlLCBzaXplOihmaWVsZC5zaXplP2ZpZWxkLnNpemU6MjUpfSkKCQkJCQkpLCBjbGFzc05hbWU6ICdjb25maWdfdmFyJ30pOwoJCQkJCWJyZWFrOwoJCQkJZGVmYXVsdDoKCQkJCQllbGVtID0gY3JlYXRlKGlzS2lkID8gInNwYW4iIDogImRpdiIsIHt0aXRsZTpmaWVsZC50aXRsZXx8JycsIGtpZHM6bmV3IEFycmF5KAoJCQkJCQljcmVhdGUoJ3NwYW4nLCB7dGV4dENvbnRlbnQ6bGFiZWwsIGNsYXNzTmFtZTonZmllbGRfbGFiZWwnfSksCgkJCQkJCWNyZWF0ZSgnaW5wdXQnLCB7aWQ6J2ZpZWxkXycraSwgdHlwZTondGV4dCcsIHZhbHVlOnZhbHVlLCBzaXplOihmaWVsZC5zaXplP2ZpZWxkLnNpemU6MjUpfSkKCQkJCQkpLCBjbGFzc05hbWU6ICdjb25maWdfdmFyJ30pOwoJCQl9CglpZihmaWVsZC5raWRzKSB7CgkJdmFyIGtpZHM9ZmllbGQua2lkczsKCQlmb3IodmFyIGtpZCBpbiBraWRzKSBlbGVtLmFwcGVuZENoaWxkKG9iai5hZGRUb0ZyYW1lKGtpZHNba2lkXSwga2lkLCB0cnVlKSk7Cgl9CnJldHVybiBlbGVtOwp9LAogZG9TYXZlIDogZnVuY3Rpb24oZiwgZmllbGQsIHR5cGUsIG9sZGYpIHsKIHZhciBpc051bT0vXltcZFwuXSskLywgc2V0ID0gb2xkZiA/IEdNX2NvbmZpZy5zZXR0aW5nc1tvbGRmXVsia2lkcyJdIDogR01fY29uZmlnLnNldHRpbmdzOwogc3dpdGNoKHR5cGUpIHsKCQkJCWNhc2UgJ3RleHQnOgoJCQkJCUdNX2NvbmZpZy52YWx1ZXNbZl0gPSAoKHNldFtmXS50eXBlPT0ndGV4dCcpID8gZmllbGQudmFsdWUgOiAoKGlzTnVtLnRlc3QoZmllbGQudmFsdWUpICYmICIsaW50LGZsb2F0Ii5pbmRleE9mKCIsIitzZXRbZl0udHlwZSkhPS0xKSA/IHBhcnNlRmxvYXQoZmllbGQudmFsdWUpIDogZmFsc2UpKTsKCQkJCQlpZihzZXRbZl09PT1mYWxzZSkgewoJCQkJCQlhbGVydCgnSW52YWxpZCB0eXBlIGZvciBmaWVsZDogJytmKydcblBsZWFzZSB1c2UgdHlwZTogJytzZXRbZl0udHlwZSk7CgkJCQkJCXJldHVybjsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlICdoaWRkZW4nOiBjYXNlICdwYXNzd29yZCc6CgkJCQkJR01fY29uZmlnLnZhbHVlc1tmXSA9IGZpZWxkLnZhbHVlLnRvU3RyaW5nKCk7CgkJCQkJYnJlYWs7CgkJCQljYXNlICd0ZXh0YXJlYSc6CgkJCQkJR01fY29uZmlnLnZhbHVlc1tmXSA9IGZpZWxkLnZhbHVlOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAnY2hlY2tib3gnOgoJCQkJCUdNX2NvbmZpZy52YWx1ZXNbZl0gPSBmaWVsZC5jaGVja2VkOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAnc2VsZWN0JzoKCQkJCQlHTV9jb25maWcudmFsdWVzW2ZdID0gZmllbGQub3B0aW9uc1tmaWVsZC5zZWxlY3RlZEluZGV4XS52YWx1ZTsKCQkJCQlicmVhazsKCQkJCWNhc2UgJ3NwYW4nOgoJCQkJCXZhciByYWRpb3MgPSBmaWVsZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKTsKCQkJCQlpZihyYWRpb3MubGVuZ3RoPjApIGZvcih2YXIgaT1yYWRpb3MubGVuZ3RoLTE7IGk+PTA7IGktLSkgewoJCQkJCQlpZihyYWRpb3NbaV0uY2hlY2tlZCkgR01fY29uZmlnLnZhbHVlc1tmXSA9IHJhZGlvc1tpXS52YWx1ZTsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCX0KIH0sCiBkb1NldHRpbmdWYWx1ZSA6IGZ1bmN0aW9uKHNldHRpbmdzLCBzdG9yZWQsIGksIG9sZGksIGspIHsKCQl2YXIgc2V0ID0gayE9bnVsbCAmJiBrPT10cnVlICYmIG9sZGkhPW51bGwgPyBzZXR0aW5nc1tvbGRpXVsia2lkcyJdW2ldIDogc2V0dGluZ3NbaV07CgkJCWlmKCIsc2F2ZSxvcGVuLGNsb3NlIi5pbmRleE9mKCIsIitpKSA9PSAtMSkgewogICAgICAgICAgICAvLyBUaGUgY29kZSBiZWxvdyB0cmFuc2xhdGVzIHRvOgogICAgICAgICAgICAvLyBpZiBhIHNldHRpbmcgd2FzIHBhc3NlZCB0byBpbml0IGJ1dCB3YXNuJ3Qgc3RvcmVkIHRoZW4gCiAgICAgICAgICAgIC8vICAgICAgaWYgYSBkZWZhdWx0IHZhbHVlIHdhc24ndCBwYXNzZWQgdGhyb3VnaCBpbml0KCkgdGhlbiB1c2UgbnVsbAogICAgICAgICAgICAvLyAgICAgIGVsc2UgdXNlIHRoZSBkZWZhdWx0IHZhbHVlIHBhc3NlZCB0aHJvdWdoIGluaXQoKQogICAgICAgICAgICAvLyAJCWVsc2UgdXNlIHRoZSBzdG9yZWQgdmFsdWUKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgdmFyIHZhbHVlID0gKHN0b3JlZFtpXT09dW5kZWZpbmVkID8gKHNldFsiZGVmYXVsdCJdPT11bmRlZmluZWQgPyBudWxsIDogc2V0WyJkZWZhdWx0Il0pIDogc3RvcmVkW2ldKTsKCQkJfSBjYXRjaChlKSB7CgkJCXZhciB2YWx1ZSA9IChzdG9yZWRbaV09PSJ1bmRlZmluZWQiID8gKHNldFsiZGVmYXVsdCJdPT0idW5kZWZpbmVkIiA/IG51bGwgOiBzZXRbImRlZmF1bHQiXSkgOiBzdG9yZWRbaV0pOwoJCQl9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBJZiB0aGUgdmFsdWUgaXNuJ3Qgc3RvcmVkIGFuZCBubyBkZWZhdWx0IHdhcyBwYXNzZWQgdGhyb3VnaCBpbml0KCkKICAgICAgICAgICAgLy8gdHJ5IHRvIHByZWRpY3QgYSBkZWZhdWx0IHZhbHVlIGJhc2VkIG9uIHRoZSB0eXBlCiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgc3dpdGNoKHNldFsidHlwZSJdKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAncmFkaW8nOiBjYXNlICdzZWxlY3QnOgogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHNldC5vcHRpb25zWzBdOyBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICdjaGVja2JveCc6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZmFsc2U7IGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2ludCc6IGNhc2UgJ2Zsb2F0JzoKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAwOyBicmVhazsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJCQkJCXZhbHVlID0gKHR5cGVvZiBzdG9yZWRbaV09PSJmdW5jdGlvbiIpID8gc3RvcmVkW2ldIDogIiI7CiAgICAgICAgICAgICAgICB9CgkJCX0KCQkJCgkJCX0KCUdNX2NvbmZpZy5wYXNzZWRfdmFsdWVzW2ldID0gdmFsdWU7CiB9LAogZG9SZXNldCA6IGZ1bmN0aW9uKGZpZWxkLCB0eXBlLCBvbGRmLCBmLCBrKSB7CiB2YXIgaXNLaWQgPSBrIT1udWxsICYmIGs9PXRydWUsIG9iaj1HTV9jb25maWcsCgkgc2V0ID0gaXNLaWQgPyBvYmouc2V0dGluZ3Nbb2xkZl1bImtpZHMiXVtmXSA6IG9iai5zZXR0aW5nc1tmXTsKIHN3aXRjaCh0eXBlKSB7CgkJCWNhc2UgJ3RleHQnOgoJCQkJZmllbGQudmFsdWUgPSBzZXRbJ2RlZmF1bHQnXSB8fCAnJzsKCQkJCWJyZWFrOwoJCQljYXNlICdoaWRkZW4nOiBjYXNlICdwYXNzd29yZCc6CgkJCQlmaWVsZC52YWx1ZSA9IHNldFsnZGVmYXVsdCddIHx8ICcnOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ3RleHRhcmVhJzoKCQkJCWZpZWxkLnZhbHVlID0gc2V0WydkZWZhdWx0J10gfHwgJyc7CgkJCQlicmVhazsKCQkJY2FzZSAnY2hlY2tib3gnOgoJCQkJZmllbGQuY2hlY2tlZCA9IHNldFsnZGVmYXVsdCddIHx8IGZhbHNlOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ3NlbGVjdCc6CgkJCQlpZihzZXRbJ2RlZmF1bHQnXSkgewoJCQkJCWZvcih2YXIgaT1maWVsZC5vcHRpb25zLmxlbmd0aC0xOyBpPj0wOyBpLS0pCgkJCQkJaWYoZmllbGQub3B0aW9uc1tpXS52YWx1ZT09c2V0WydkZWZhdWx0J10pIGZpZWxkLnNlbGVjdGVkSW5kZXg9aTsKCQkJCX0KCQkJCWVsc2UgZmllbGQuc2VsZWN0ZWRJbmRleD0wOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ3NwYW4nOgoJCQkJdmFyIHJhZGlvcyA9IGZpZWxkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpOwoJCQkJaWYocmFkaW9zLmxlbmd0aD4wKSBmb3IodmFyIGk9cmFkaW9zLmxlbmd0aC0xOyBpPj0wOyBpLS0pIHsKCQkJCQlpZihyYWRpb3NbaV0udmFsdWU9PXNldFsnZGVmYXVsdCddKSB7CgkJCQkJCXJhZGlvc1tpXS5jaGVja2VkPXRydWU7CgkJCQkJfQoJCQkJfQoJCQkJYnJlYWs7CgkJfQogfSwKIHZhbHVlczoge30sCiBzZXR0aW5nczoge30sCiBjc3M6IHsKCSBiYXNpYzogJ2JvZHkge2JhY2tncm91bmQ6I0ZGRkZGRjt9XG4nICsKCSAnLmluZGVudDQwIHttYXJnaW4tbGVmdDo0MCU7fVxuJyArCgkgJyoge2ZvbnQtZmFtaWx5OiBhcmlhbCwgdGFob21hLCBzYW5zLXNlcmlmLCBteXJpYWQgcHJvO31cbicgKwoJICcuZmllbGRfbGFiZWwge2ZvbnQtd2VpZ2h0OmJvbGQ7IGZvbnQtc2l6ZToxMnB4OyBtYXJnaW4tcmlnaHQ6NnB4O31cbicgKwoJICcuYmxvY2sge2Rpc3BsYXk6YmxvY2s7fVxuJyArCgkgJy5zYXZlY2xvc2VfYnV0dG9ucyB7XG4nICsKCSAnbWFyZ2luOjE2cHggMTBweCAxMHB4IDEwcHg7XG4nICsKCSAncGFkZGluZzoycHggMTJweCAycHggMTJweDtcbicgKwoJICd9XG4nICsKCSAnLnJlc2V0LCAjYnV0dG9uc19ob2xkZXIsIC5yZXNldCBhIHt0ZXh0LWFsaWduOnJpZ2h0OyBjb2xvcjojMDAwMDAwO31cbicgKwoJICcuY29uZmlnX2hlYWRlciB7Zm9udC1zaXplOjIwcHQ7IG1hcmdpbjowO31cbicgKwoJICcuY29uZmlnX2Rlc2MsIC5zZWN0aW9uX2Rlc2MsIC5yZXNldCB7Zm9udC1zaXplOjlwdDt9XG4nICsKCSAnLmNlbnRlciB7dGV4dC1hbGlnbjpjZW50ZXI7fVxuJyArCgkgJy5zZWN0aW9uX2hlYWRlcl9ob2xkZXIge21hcmdpbi10b3A6OHB4O31cbicgKwoJICcuY29uZmlnX3ZhciB7bWFyZ2luOjAgMCA0cHggMDsgZGlzcGxheTpibG9jazt9XG4nICsKCSAnLmNvbmZpZ192YXIge2ZvbnQtc2l6ZTogMTNweCAhaW1wb3J0YW50O31cbicgKwoJICcuc2VjdGlvbl9oZWFkZXIge2ZvbnQtc2l6ZToxM3B0OyBiYWNrZ3JvdW5kOiM0MTQxNDE7IGNvbG9yOiNGRkZGRkY7IGJvcmRlcjoxcHggc29saWQgIzAwMDAwMDsgbWFyZ2luOjA7fVxuJyArCgkgJy5zZWN0aW9uX2Rlc2Mge2ZvbnQtc2l6ZTo5cHQ7IGJhY2tncm91bmQ6I0VGRUZFRjsgY29sb3I6IzU3NTc1NzsgYm9yZGVyOjFweCBzb2xpZCAjQ0NDQ0NDOyBtYXJnaW46MCAwIDZweCAwO31cbicgKwoJICdpbnB1dFt0eXBlPSJyYWRpbyJdIHttYXJnaW4tcmlnaHQ6OHB4O30nLAoJIHN0eWxpc2g6ICcnCiB9LAogY3JlYXRlOiBmdW5jdGlvbihhLGIpIHsKCXZhciByZXQ9d2luZG93LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYSk7CglpZihiKSBmb3IodmFyIHByb3AgaW4gYikgewoJCWlmKHByb3AuaW5kZXhPZignb24nKT09MCkgcmV0LmFkZEV2ZW50TGlzdGVuZXIocHJvcC5zdWJzdHJpbmcoMiksYltwcm9wXSxmYWxzZSk7CgkJZWxzZSBpZihwcm9wPT0ia2lkcyIgJiYgKHByb3A9Yltwcm9wXSkpIGZvcih2YXIgaT0wOyBpPHByb3AubGVuZ3RoOyBpKyspIHJldC5hcHBlbmRDaGlsZChwcm9wW2ldKTsKCQllbHNlIGlmKCIsc3R5bGUsYWNjZXNza2V5LGlkLG5hbWUsc3JjLGhyZWYsZm9yIi5pbmRleE9mKCIsIitwcm9wLnRvTG93ZXJDYXNlKCkpIT0tMSkgcmV0LnNldEF0dHJpYnV0ZShwcm9wLCBiW3Byb3BdKTsKCQllbHNlIHJldFtwcm9wXT1iW3Byb3BdOwoJfQoJcmV0dXJuIHJldDsKIH0sCiBjZW50ZXI6IGZ1bmN0aW9uKCkgewoJdmFyIG5vZGUgPSBHTV9jb25maWcuZnJhbWUsIHN0eWxlID0gbm9kZS5zdHlsZSwgYmVmb3JlT3BhY2l0eSA9IHN0eWxlLm9wYWNpdHk7CglpZihzdHlsZS5kaXNwbGF5PT0nbm9uZScpIHN0eWxlLm9wYWNpdHk9JzAnOwoJc3R5bGUuZGlzcGxheSA9ICcnOwoJc3R5bGUudG9wID0gTWF0aC5mbG9vcigod2luZG93LmlubmVySGVpZ2h0LzIpLShub2RlLm9mZnNldEhlaWdodC8yKSkgKyAncHgnOwoJc3R5bGUubGVmdCA9IE1hdGguZmxvb3IoKHdpbmRvdy5pbm5lcldpZHRoLzIpLShub2RlLm9mZnNldFdpZHRoLzIpKSArICdweCc7CglzdHlsZS5vcGFjaXR5ID0gJzEnOwogfSwKIHJ1bjogZnVuY3Rpb24oKSB7CiAgICB2YXIgc2NyaXB0PUdNX2NvbmZpZy5nZXRBdHRyaWJ1dGUoJ3NjcmlwdCcpOwogICAgaWYoc2NyaXB0ICYmIHR5cGVvZiBzY3JpcHQ9PSdzdHJpbmcnICYmIHNjcmlwdCE9JycpIHsKICAgICAgZnVuYyA9IG5ldyBGdW5jdGlvbihzY3JpcHQpOwogICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jLCAwKTsKICAgIH0KIH0sCiBhZGRFdmVudDogZnVuY3Rpb24oZWwsIGV2LCBzY3IpIHsKCWlmKGVsKSBlbC5hZGRFdmVudExpc3RlbmVyKGV2LCBmdW5jdGlvbigpIHsKCQl0eXBlb2Ygc2NyID09PSAnZnVuY3Rpb24nID8gd2luZG93LnNldFRpbWVvdXQoc2NyLCAwKSA6IGV2YWwoc2NyKQoJfSwgZmFsc2UpOwp9LAogcmVtb3ZlOiBmdW5jdGlvbihlbCkgewoJaWYoZWwgJiYgZWwucGFyZW50Tm9kZSkgZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbCk7Cn0sCiB0b2dnbGUgOiBmdW5jdGlvbihlKSB7Cgl2YXIgbm9kZT1HTV9jb25maWcuZnJhbWUuY29udGVudERvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpOwoJbm9kZS5zdHlsZS5kaXNwbGF5PShub2RlLnN0eWxlLmRpc3BsYXkhPSdub25lJyk/J25vbmUnOicnOwoJR01fY29uZmlnLnNldFZhbHVlKGUsIG5vZGUuc3R5bGUuZGlzcGxheSk7CiB9LAp9OwoKCi8qIEVYQU1QTEUgQ09ERSBCRUxPVyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKR01fY29uZmlnLmluaXQoIlRlc3QiLCB7Cgkib25lIiA6IHsKCQkibGFiZWwiIDogIk9wdGlvbiBPbmUiLAoJCSJ0eXBlIiA6ICJjaGVja2JveCIsCgkJImRlZmF1bHQiIDogZmFsc2UKCX0sCgkidHdvIiA6IHsKCQkibGFiZWwiIDogIk9wdGlvbiBUd28iLAoJCSJ0eXBlIiA6ICJjaGVja2JveCIsCgkJImRlZmF1bHQiIDogZmFsc2UKCX0sCgkidGhyZWUiIDogewoJCSJsYWJlbCIgOiAiT3B0aW9uIFRocmVlIiwKCQkidHlwZSIgOiAicGFzc3dvcmQiCgl9LAoJICJmb3VyIiA6IHsKCQkibGFiZWwiIDogIk9wdGlvbiBGb3VyIiwKCQkidHlwZSIgOiAic2VsZWN0IiwKCQkib3B0aW9ucyIgOiB7CgkJCSJvbmUiIDogIk9uZSIsCgkJCSJ0d28iIDogIlR3byIKCQl9Cgl9Cn0pOwoKR01fY29uZmlnLm9wZW4oKTsKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8="},{"meta":{"name":"JoeSimmons'%20Library.js","url":"https://greasyfork.org/scripts/1885-joesimmons-library/code/JoeSimmons'%20Library.js?version=4838","ts":1685023546964,"mimetype":"text/javascript"},"source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgSm9lU2ltbW9ucycgTGlicmFyeQovLyBAbmFtZXNwYWNlICAgICBodHRwOi8vdXNlcnNjcmlwdHMub3JnL3VzZXJzLzIzNjUyCi8vIEBkZXNjcmlwdGlvbiAgIEEgSmF2YVNjcmlwdCBsaWJyYXJ5IHVzZWQgYnkgSm9lU2ltbW9ucwovLyBAaW5jbHVkZSAgICAgICAqCi8vIEBjb3B5cmlnaHQgICAgIEpvZVNpbW1vbnMKLy8gQGF1dGhvciAgICAgICAgSm9lU2ltbW9ucwovLyBAdmVyc2lvbiAgICAgICAxLjMuMQovLyBAbGljZW5zZSAgICAgICBMR1BMIHZlcnNpb24gMyBvciBhbnkgbGF0ZXIgdmVyc2lvbjsgaHR0cDovL3d3dy5nbnUub3JnL2NvcHlsZWZ0L2xncGwuaHRtbAovLyBAZ3JhbnQgICAgICAgICBHTV9hZGRTdHlsZQovLyA9PS9Vc2VyU2NyaXB0PT0KCi8qKgogICAgV0lLSSA9PT4gaHR0cHM6Ly9naXRodWIuY29tL2pvZXNpbW1vbnMvanNsL3dpa2kvCioqLwoKKGZ1bmN0aW9uICh3aW5kb3csIHVuZGVmaW5lZCkgewoKICAgICd1c2Ugc3RyaWN0JzsgLy8gdXNlIHN0cmljdCBtb2RlIGluIEVDTUFTY3JpcHQtNQoKICAgIHZhciB2ZXJzaW9uID0gJzEuMy4xJzsgLy8gdGhpcyB3aWxsIGJlIHVzZWQgZm9yIEpTTC5wcm90b3R5cGUudmVyc2lvbgogICAgdmFyIGludGVydmFscyA9IFtdOyAvLyBmb3IgdGhlIHNldEludGVydmFsL2NsZWFySW50ZXJ2YWwgbWV0aG9kcwoKICAgIC8vIHJlZ3VsYXIgZXhwcmVzc2lvbnMKICAgIHZhciByU2VsZWN0b3IgPSAvXlwqfF5cLlthLXpdW1x3XGQtXSp8XiNbXiBdK3xeW2Etel0rfF5cW2Etel0rL2k7IC8vIG1hdGNoZXMgYSBDU1Mgc2VsZWN0b3IKICAgIHZhciByWHBhdGggPSAvXihcLipcL3sxLDJ9KStbYS16QS1aXCpdKy87ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1hdGNoZXMgYW4gWFBhdGggcXVlcnkKICAgIHZhciBySFRNTCA9IC88W14+XSs+LzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1hdGNoZXMgYSBzdHJpbmcgb2YgSFRNTAogICAgdmFyIHJIeXBoZW5hdGVkID0gLy0oW2EtekEtWl0pL2c7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWF0Y2hlcyBhbHBoYWJldGljLCBoeXBoZW5hdGVkIHN0cmluZ3MKICAgIHZhciByRWxlbWVudE9iamVjdCA9IC9eXFtvYmplY3QgSFRNTChbYS16QS1aXSspP0VsZW1lbnRcXSQvOyAgICAgIC8vIG1hdGNoZXMgdGhlIHRvU3RyaW5nIHZhbHVlIG9mIGFuIGVsZW1lbnQKICAgIHZhciByV2luZG93T2JqZWN0ID0gL15cW29iamVjdCBXaW5kb3dcXSQvOyAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1hdGNoZXMgdGhlIHRvU3RyaW5nIHZhbHVlIG9mIGEgd2luZG93IG9iamVjdAogICAgdmFyIHJWYWxpZFZhcm5hbWUgPSAvXlthLXpBLVokX11bYS16QS1aMC05JF9dKiQvOyAgICAgICAgICAgICAgICAgLy8gbWF0Y2hlcyBhIHZhbGlkIHZhcmlhYmxlIG5hbWUKCiAgICAvLyBjb21wYXRpYmlsaXR5IG1ldGhvZHMgZm9yIGJyb3dzZXJzIHRoYXQgZG9uJ3Qgc3VwcG9ydCBFQ01BU2NyaXB0LTUgY29tcGxldGVseQogICAgdmFyIGNvbXBhdCA9IHsKICAgICAgICAnYXJyX2luZGV4T2YnIDogZnVuY3Rpb24gKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkgewogICAgICAgICAgICB2YXIgaW5kZXggPSBwYXJzZUludChmcm9tSW5kZXggfHwgMCwgMTApLCBsZW4gPSB0aGlzLmxlbmd0aDsKICAgICAgICAgICAgICAgIGluZGV4ID0gaW5kZXggPCAwID8gbGVuICsgaW5kZXggOiBpbmRleDsgLy8gaGFuZGxlIG5lZ2F0aXZlIGZyb21JbmRleAogICAgICAgICAgICAgICAgaW5kZXggPSAhKGluZGV4ID4gMCkgPyAwIDogaW5kZXg7IC8vIGhhbmRsZSBvdXQgb2YgcmFuZ2UgYW5kL29yIE5hTiBmcm9tSW5kZXgKCiAgICAgICAgICAgIHdoaWxlIChpbmRleCA8IGxlbiAmJiBpbmRleCA+PSAwKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpc1tpbmRleF0gPT09IHNlYXJjaEVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXg7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpbmRleCArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfSwKICAgICAgICAvKgogICAgICAgICdmaWx0ZXInIDogZnVuY3Rpb24gKGZuLCBvVGhpcykgewogICAgICAgICAgICB2YXIgaW5kZXgsIHZhbHVlLCBsZW4gPSB0aGlzLmxlbmd0aCwgcmV0ID0gW107CgogICAgICAgICAgICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBsZW47IGluZGV4ICs9IDEpIHsKICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpc1tpbmRleF07CiAgICAgICAgICAgICAgICBpZiAoIGZuLmNhbGwob1RoaXMsIHZhbHVlLCBpbmRleCwgdGhpcykgKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2godmFsdWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgIH0sCiAgICAgICAgKi8KICAgICAgICAnZm9yRWFjaCcgOiBmdW5jdGlvbiAoZm4sIG9UaGlzKSB7CiAgICAgICAgICAgIHZhciBpbmRleCwgbGVuOwoKICAgICAgICAgICAgZm9yIChpbmRleCA9IDAsIGxlbiA9IHRoaXMubGVuZ3RoOyBpbmRleCA8IGxlbjsgaW5kZXggKz0gMSkgewogICAgICAgICAgICAgICAgZm4uY2FsbChvVGhpcywgdGhpc1tpbmRleF0sIGluZGV4LCB0aGlzKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgJ21hcCcgOiBmdW5jdGlvbiAoZm4sIG9UaGlzKSB7CiAgICAgICAgICAgIHZhciBpbmRleCwgbmV3QXJyID0gW10sIGxlbjsKCiAgICAgICAgICAgIGZvciAoaW5kZXggPSAwLCBsZW4gPSB0aGlzLmxlbmd0aDsgaW5kZXggPCBsZW47IGluZGV4ICs9IDEpIHsKICAgICAgICAgICAgICAgIG5ld0FycltpbmRleF0gPSBmbi5jYWxsKG9UaGlzLCB0aGlzW2luZGV4XSwgaW5kZXgsIHRoaXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbmV3QXJyOwogICAgICAgIH0sCiAgICAgICAgJ3JlZHVjZScgOiBmdW5jdGlvbiAoZm4sIGluaXRpYWxWYWx1ZSkgewogICAgICAgICAgICB2YXIgaW5kZXgsIGxlbiwgdmFsdWUsIGlzVmFsdWVTZXQgPSBmYWxzZTsKCiAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgICAgdmFsdWUgPSBpbml0aWFsVmFsdWU7CiAgICAgICAgICAgICAgICBpc1ZhbHVlU2V0ID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm9yIChpbmRleCA9IDAsIGxlbiA9IHRoaXMubGVuZ3RoOyBpbmRleCA8IGxlbjsgaW5kZXggKz0gMSkgewogICAgICAgICAgICAgICAgaWYgKGlzVmFsdWVTZXQpIHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGZuKHZhbHVlLCB0aGlzW2luZGV4XSwgaW5kZXgsIHRoaXMpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXNbaW5kZXhdOwogICAgICAgICAgICAgICAgICAgIGlzVmFsdWVTZXQgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgfTsKCiAgICAvLyBnZXRzIGEgbWV0aG9kIGZyb20gYW4gb2JqZWN0J3MgcHJvdG90eXBlLiByZXR1cm5zIHVuZGVmaW5lZCBpZiBub3QgZm91bmQKICAgIHZhciBnZXRNZXRob2QgPSBmdW5jdGlvbiAob2JqLCBtZXRob2QpIHsKICAgICAgICBpZiAodHlwZW9mIFhQQ05hdGl2ZVdyYXBwZXIgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIFhQQ05hdGl2ZVdyYXBwZXIudW53cmFwID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIG9iaiA9IFhQQ05hdGl2ZVdyYXBwZXIudW53cmFwKG9iaik7CiAgICAgICAgfSBlbHNlIGlmIChvYmoud3JhcHBlZEpTT2JqZWN0KSB7CiAgICAgICAgICAgIG9iaiA9IG9iai53cmFwcGVkSlNPYmplY3Q7CiAgICAgICAgfQoKICAgICAgICBpZiAob2JqLnByb3RvdHlwZSAmJiB0eXBlb2Ygb2JqLnByb3RvdHlwZVttZXRob2RdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIHJldHVybiBvYmoucHJvdG90eXBlW21ldGhvZF07CiAgICAgICAgfQogICAgfTsKCiAgICAvLyBvcmlnaW5hbCBtZXRob2RzIGZvciBzb21lIGNvbW1vbiB1c2VzCiAgICB2YXIgY29yZSA9IHsKICAgICAgICAvLyBhcnJheQogICAgICAgICdhcnJfaW5kZXhPZicgOiBnZXRNZXRob2QoQXJyYXksICdpbmRleE9mJykgfHwgY29tcGF0LmFycl9pbmRleE9mLAogICAgICAgICdjb25jYXQnIDogZ2V0TWV0aG9kKEFycmF5LCAnY29uY2F0JyksCiAgICAgICAgJ2ZpbHRlcicgOiBnZXRNZXRob2QoQXJyYXksICdmaWx0ZXInKSB8fCBjb21wYXQuZmlsdGVyLAogICAgICAgICdmb3JFYWNoJyA6IGdldE1ldGhvZChBcnJheSwgJ2ZvckVhY2gnKSB8fCBjb21wYXQuZm9yRWFjaCwKICAgICAgICAnbWFwJyA6IGdldE1ldGhvZChBcnJheSwgJ21hcCcpIHx8IGNvbXBhdC5tYXAsCiAgICAgICAgJ3JlZHVjZScgOiBnZXRNZXRob2QoQXJyYXksICdyZWR1Y2UnKSB8fCBjb21wYXQucmVkdWNlLAogICAgICAgICdzbGljZScgOiBnZXRNZXRob2QoQXJyYXksICdzbGljZScpLAoKICAgICAgICAvLyBvYmplY3QKICAgICAgICAnaGFzT3duUHJvcGVydHknIDogZ2V0TWV0aG9kKE9iamVjdCwgJ2hhc093blByb3BlcnR5JyksCiAgICAgICAgJ3RvU3RyaW5nJyA6IGdldE1ldGhvZChPYmplY3QsICd0b1N0cmluZycpLAogICAgfTsKCiAgICB2YXIgSlNMID0gZnVuY3Rpb24gSlNMKHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgICAgICAgcmV0dXJuIG5ldyBKU0wuZm4uaW5pdChzZWxlY3RvciwgY29udGV4dCk7CiAgICB9OwoKICAgIC8vIGEgc2ltcGxlIGNsYXNzIGZvciBkZWFsaW5nIHdpdGggZXZlbnQgbGlzdGVuZXIgaGFuZGxlcnMKICAgIHZhciBoYW5kbGVycyA9IHsKICAgICAgICBzdGFjayA6IFtdLAoKICAgICAgICBhZGQgOiBmdW5jdGlvbiAodGhpc0VsZW1lbnQsIHR5cGUsIGZuKSB7CiAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaCh7CiAgICAgICAgICAgICAgICBlbGVtZW50IDogdGhpc0VsZW1lbnQsCiAgICAgICAgICAgICAgICB0eXBlIDogdHlwZSwKICAgICAgICAgICAgICAgIGZuIDogZm4KICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgZ2V0IDogZnVuY3Rpb24gKHRoaXNFbGVtZW50LCB0eXBlKSB7CiAgICAgICAgICAgIHZhciBldmVudHMgPSBbXTsKICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlb2YgdHlwZSA9PT0gJ3N0cmluZycgPyB0eXBlIDogJyonOwoKICAgICAgICAgICAgSlNMLmVhY2godGhpcy5zdGFjaywgZnVuY3Rpb24gKHRoaXNFdmVudE9iaikgewogICAgICAgICAgICAgICAgaWYgKHRoaXNFbGVtZW50ID09PSB0aGlzRXZlbnRPYmouZWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnKicgfHwgdGhpc0V2ZW50T2JqLnR5cGUgPT09IHR5cGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzLnB1c2godGhpc0V2ZW50T2JqKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGV2ZW50czsKICAgICAgICB9LAoKICAgICAgICByZW1vdmUgOiBmdW5jdGlvbiAodGhpc0VsZW1lbnQsIHR5cGUpIHsKICAgICAgICAgICAgdmFyIGhhbmRsZXJJbmRpY2VzID0gW10sIHRoYXQgPSB0aGlzOwoKICAgICAgICAgICAgLy8gZmluZCBhbGwgdGhlIGluZGljZXMgb2Ygd2hhdCB3ZSBuZWVkIHRvIHJlbW92ZQogICAgICAgICAgICBKU0wuZWFjaChoYW5kbGVycy5nZXQodGhpc0VsZW1lbnQsIHR5cGUpLCBmdW5jdGlvbiAodGhpc0V2ZW50T2JqLCBpbmRleCwgYXJyYXkpIHsKICAgICAgICAgICAgICAgIGhhbmRsZXJJbmRpY2VzLnB1c2goCiAgICAgICAgICAgICAgICAgICAgY29yZS5hcnJfaW5kZXhPZi5jYWxsKHRoYXQuc3RhY2ssIHRoaXNFdmVudE9iaikKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCB0aGUgaW5kaWNlcyBoZXJlLCB1c2luZyBhIHNlcGFyYXRlIGFycmF5IG9mIGluZGljZXMKICAgICAgICAgICAgLy8gd2UgY2FuJ3QgZG8gdGhpcyBhcyB3ZSBsb29wIG92ZXIgdGhlIChzdGFjaykgYXJyYXkgaXRzZWxmLCBiZWNhdXNlCiAgICAgICAgICAgIC8vIHdlIHdvdWxkIGJlIHJlbW92aW5nIHZhbHVlcyBhcyB0aGV5IGFyZSBiZWluZyBpdGVyYXRlZCB0aHJvdWdoCiAgICAgICAgICAgIEpTTC5lYWNoKGhhbmRsZXJJbmRpY2VzLCBmdW5jdGlvbiAodGhpc0luZGV4KSB7CiAgICAgICAgICAgICAgICB0aGF0LnN0YWNrLnNwbGljZSh0aGlzSW5kZXgsIDEpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9OwoKICAgIC8vIE5vZGUucHJvdG90eXBlLm1hdGNoZXNTZWxlY3RvciBjb21wYXQgZm9yIHZlbmRvciBwcmVmaXhlcwogICAgZnVuY3Rpb24gbWF0Y2hlc1NlbGVjdG9yKGVsZW1lbnQsIHNlbGVjdG9yKSB7CiAgICAgICAgaWYgKGVsZW1lbnQgJiYgdHlwZW9mIHNlbGVjdG9yID09PSAnc3RyaW5nJykgewogICAgICAgICAgICBpZiAodHlwZW9mIGVsZW1lbnQubW96TWF0Y2hlc1NlbGVjdG9yID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICAvLyBNb3ppbGxhCiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5tb3pNYXRjaGVzU2VsZWN0b3Ioc2VsZWN0b3IpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbGVtZW50LndlYmtpdE1hdGNoZXNTZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgLy8gV2Via2l0CiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC53ZWJraXRNYXRjaGVzU2VsZWN0b3Ioc2VsZWN0b3IpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbGVtZW50Lm9NYXRjaGVzU2VsZWN0b3IgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgIC8vIE9wZXJhCiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5vTWF0Y2hlc1NlbGVjdG9yKHNlbGVjdG9yKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZWxlbWVudC5tc01hdGNoZXNTZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgLy8gSUUKICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50Lm1zTWF0Y2hlc1NlbGVjdG9yKHNlbGVjdG9yKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vIGNhbGxzICd0aGlzJyB3aXRoIHRoZSBmaXJzdCBwYXJhbWV0ZXIgYXMgdGhlIGZpcnN0IGFyZ3VtZW50IAogICAgZnVuY3Rpb24gY2FsbChhKSB7CiAgICAgICAgcmV0dXJuIHRoaXMoYSk7CiAgICB9CgogICAgZnVuY3Rpb24gdG9DYW1lbENhc2Uoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKHJIeXBoZW5hdGVkLCBmdW5jdGlvbiAoZnVsbE1hdGNoLCBmaXJzdEdyb3VwKSB7CiAgICAgICAgICAgIHJldHVybiBmaXJzdEdyb3VwLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgfSk7CiAgICB9CgogICAgLy8gd2Fsa1RoZURvbSBieSBEb3VnbGFzIENyb2NrZm9yZAogICAgZnVuY3Rpb24gd2Fsa1RoZURvbShub2RlLCBmdW5jKSB7CiAgICAgICAgZnVuYyhub2RlKTsKICAgICAgICBub2RlID0gbm9kZS5maXJzdENoaWxkOwoKICAgICAgICB3aGlsZSAobm9kZSkgewogICAgICAgICAgICB3YWxrVGhlRG9tKG5vZGUsIGZ1bmMpOwogICAgICAgICAgICBub2RlID0gbm9kZS5uZXh0U2libGluZzsKICAgICAgICB9CiAgICB9CgogICAgLy8gY2FuIHBsdWNrIGEga2V5IG91dCBvZiBhbiBvYmplY3QKICAgIGZ1bmN0aW9uIHBsdWNrKG9iaikgewogICAgICAgIHZhciBzdWJzID0gdGhpcy5zcGxpdCgnLicpLAogICAgICAgICAgICByZXQgPSBvYmosIGk7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBzdWJzLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgICAgICAgIHJldCA9IHJldFsgc3Vic1tpXSBdOwogICAgICAgICAgICBpZiAocmV0ID09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJldDsKICAgIH0KCiAgICBmdW5jdGlvbiBzdW0oY3VyVmFsdWUsIG5leHRWYWx1ZSkgewogICAgICAgIHJldHVybiBjdXJWYWx1ZSArIG5leHRWYWx1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzdW1JbnQoY3VyVmFsdWUsIG5leHRWYWx1ZSkgewogICAgICAgIHJldHVybiBwYXJzZUludChjdXJWYWx1ZSwgMTApICsgcGFyc2VJbnQobmV4dFZhbHVlLCAxMCk7CiAgICB9CgogICAgLy8gaW50ZXJuYWwgZnVuY3Rpb24gZm9yIHRocm93aW5nIGVycm9ycywgc28gdGhlIHVzZXIgZ2V0cwogICAgLy8gc29tZSBzb3J0IG9mIGhpbnQgYXMgdG8gd2h5IHRoZWlyIG9wZXJhdGlvbiBmYWlsZWQKICAgIGZ1bmN0aW9uIGVycm9yKGVycm9yU3RyaW5nKSB7CiAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5lcnJvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yU3RyaW5nKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBudWxsOyAvLyBhbHdheXMgcmV0dXJuIG51bGwKICAgIH0KCiAgICAvLyB3aWxsIGNvcHkgYW4gZWxlbWVudCBhbmQgcmV0dXJuIGEgbmV3IGNvcHkgd2l0aCB0aGUgc2FtZSBldmVudCBsaXN0ZW5lcnMKICAgIGZ1bmN0aW9uIGNsb25lRWxlbWVudCh0aGlzRWxlbWVudCkgewogICAgICAgIHZhciBuZXdFbGVtZW50ID0gdGhpc0VsZW1lbnQuY2xvbmVOb2RlKHRydWUpOwoKICAgICAgICAvLyBjbG9uZSBldmVudCBsaXN0ZW5lcnMgb2YgZWxlbWVudAogICAgICAgIEpTTC5lYWNoKGhhbmRsZXJzLmdldCh0aGlzRWxlbWVudCksIGZ1bmN0aW9uICh0aGlzRXZlbnRPYmopIHsKICAgICAgICAgICAgSlNMLmFkZEV2ZW50KG5ld0VsZW1lbnQsIHRoaXNFdmVudE9iai50eXBlLCB0aGlzRXZlbnRPYmouZm4pOwogICAgICAgIH0pOwoKICAgICAgICByZXR1cm4gbmV3RWxlbWVudDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRFYWNoRWxlbWVudHMoYXJyYXksIHNlbGVjdG9yLCBrZXksIHR5cGUpIHsKICAgICAgICB2YXIgbmV3RWxlbWVudHNBcnJheSA9IFtdLAogICAgICAgICAgICBpc1ZhbGlkU2VsZWN0b3IgPSB0eXBlb2Ygc2VsZWN0b3IgPT09ICdzdHJpbmcnICYmIHNlbGVjdG9yLnRyaW0oKSAhPT0gJyc7CgogICAgICAgIEpTTC5lYWNoKGFycmF5LCBmdW5jdGlvbiAoY3VycmVudEVsZW1lbnQpIHsKICAgICAgICAgICAgd2hpbGUgKCBjdXJyZW50RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50W2tleV0gKSB7IC8vIG5vdGU6IGludGVudGlvbmFsIGFzc2lnbm1lbnQKICAgICAgICAgICAgICAgIGlmICh0eXBlID4gMCA/IGN1cnJlbnRFbGVtZW50Lm5vZGVUeXBlID09PSB0eXBlIDogdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgIGlmICggaXNWYWxpZFNlbGVjdG9yID09PSBmYWxzZSB8fCBKU0woY3VycmVudEVsZW1lbnQpLmZpbHRlcihzZWxlY3RvcikuZXhpc3RzICkgewogICAgICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50c0FycmF5LnB1c2goY3VycmVudEVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiBuZXdFbGVtZW50c0FycmF5OwogICAgfQoKICAgIC8vIHRoaXMgd2lsbCB0YWtlIAogICAgZnVuY3Rpb24gZG9FbGVtZW50T3BlcmF0aW9uT25FYWNoKGFyZ3MsIG9wKSB7CiAgICAgICAgdmFyIG5ld0VsZW1lbnRzQXJyYXkgPSBbXSwgbmV3RWxlbWVudCwKICAgICAgICAgICAgcGFzc2VkRWxlbWVudHMgPSBKU0wuY3JlYXRlLmFwcGx5KEpTTCwgYXJncyk7CgogICAgICAgIGlmICh0aGlzLmV4aXN0cykgewogICAgICAgICAgICBpZiAoSlNMLnR5cGVPZihwYXNzZWRFbGVtZW50cykgPT09ICdhcnJheScpIHsKICAgICAgICAgICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAodGhpc0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICBKU0wuZWFjaChwYXNzZWRFbGVtZW50cywgZnVuY3Rpb24gKHBhc3NlZEVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xvbmUgdGhlIGVsZW1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0VsZW1lbnQgPSBjbG9uZUVsZW1lbnQocGFzc2VkRWxlbWVudCk7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGQgdGhlIG5ldyBlbGVtZW50cyB0byBhbiBhcnJheQogICAgICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50c0FycmF5LnB1c2gobmV3RWxlbWVudCk7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBwZXJmb3JtIHRoZSBwYXNzZWQgb3BlcmF0aW9uIG9uIHRoZSBlbGVtZW50CiAgICAgICAgICAgICAgICAgICAgICAgIG9wKHRoaXNFbGVtZW50LCBuZXdFbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uICh0aGlzRWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgIC8vIGNsb25lIHRoZSBlbGVtZW50CiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0VsZW1lbnQgPSBjbG9uZUVsZW1lbnQocGFzc2VkRWxlbWVudHMpOwoKICAgICAgICAgICAgICAgICAgICAvLyBhZGQgdGhlIG5ldyBlbGVtZW50cyB0byBhbiBhcnJheQogICAgICAgICAgICAgICAgICAgIG5ld0VsZW1lbnRzQXJyYXkucHVzaChuZXdFbGVtZW50KTsKCiAgICAgICAgICAgICAgICAgICAgLy8gcGVyZm9ybSB0aGUgcGFzc2VkIG9wZXJhdGlvbiBvbiB0aGUgZWxlbWVudAogICAgICAgICAgICAgICAgICAgIG9wKHRoaXNFbGVtZW50LCBuZXdFbGVtZW50KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3RWxlbWVudHNBcnJheTsKICAgIH0KCiAgICAvLyBkZWZpbmUgSlNMJ3MgcHJvdG90eXBlLCBha2EgSlNMLmZuCiAgICBKU0wuZm4gPSBKU0wucHJvdG90eXBlID0gewogICAgICAgIGlzSlNMIDogdHJ1ZSwKICAgICAgICBjb25zdHJ1Y3RvciA6IEpTTCwKICAgICAgICBsZW5ndGggOiAwLAogICAgICAgIHZlcnNpb24gOiB2ZXJzaW9uLAoKICAgICAgICAvLyBzaW1pbGFyIHRvIGpRdWVyeS4gSlNMIGlzIGp1c3QgdGhlIGluaXQgY29uc3RydWN0b3IKICAgICAgICBpbml0IDogZnVuY3Rpb24gKHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgICAgICAgICAgIHZhciBzZWxlY3RvclN0cmluZ1ZhbHVlID0gY29yZS50b1N0cmluZy5jYWxsKHNlbGVjdG9yKSwKICAgICAgICAgICAgICAgIHRoYXQgPSB0aGlzLAogICAgICAgICAgICAgICAgZWxlbXMgPSBbXTsKCiAgICAgICAgICAgIHN3aXRjaCAodHlwZW9mIHNlbGVjdG9yKSB7CiAgICAgICAgICAgICAgICBjYXNlICdzdHJpbmcnOiB7ICAvLyAtLSBTVFJJTkcgLS0KICAgICAgICAgICAgICAgICAgICBpZiAoIHNlbGVjdG9yLm1hdGNoKHJYcGF0aCkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBhbiBYUGF0aCBleHByZXNzaW9uCiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1zID0gSlNMLnhwYXRoKHtleHByZXNzaW9uIDogc2VsZWN0b3IsIHR5cGUgOiA3LCBjb250ZXh0IDogY29udGV4dH0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHNlbGVjdG9yLm1hdGNoKHJIVE1MKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVzZXJ2ZWQgZm9yIGh0bWwgY29kZSBjcmVhdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAvLyBub3Qgc3VyZSBpZiBJIHdhbnQgdG8gaW1wbGVtZW50IGl0CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggc2VsZWN0b3IubWF0Y2goclNlbGVjdG9yKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEpTTC50eXBlT2YoY29udGV4dCkgPT09ICdhcnJheScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBhbiBhcnJheSBiZWluZyBwYXNzZWQgYXMgdGhlIGNvbnRleHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGF0LmZpbmQuY2FsbChjb250ZXh0LCBzZWxlY3Rvcik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbnRleHQgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgYSBzZWxlY3RvciBiZWluZyBwYXNzc2VkIGFzIHRoZSBjb250ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0ID0gSlNMKGNvbnRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRleHQuZXhpc3RzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTTChzZWxlY3RvciwgY29udGV4dFswXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGV4dCAhPSBudWxsICYmIGNvbnRleHQuaXNKU0wgPT09IHRydWUgJiYgY29udGV4dC5leGlzdHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBhIEpTTCBvYmplY3QgYmVpbmcgcGFzc3NlZCBhcyB0aGUgY29udGV4dAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTTCggc2VsZWN0b3IsIGNvbnRleHRbMF0gKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBhIHJlZ3VsYXIgZWxlbWVudCBiZWluZyBwYXNzZWQgYXMgdGhlIGNvbnRleHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQgPSBjb250ZXh0ICE9IG51bGwgJiYgY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsID8gY29udGV4dCA6IGRvY3VtZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbXMgPSBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICAgICBjYXNlICdvYmplY3QnOiB7ICAvLyAtLSBPQkpFQ1QgLS0KICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0b3IgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0b3IuaXNKU0wgPT09IHRydWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBhIEpTTCBvYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3RvcjsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggY29yZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNlbGVjdG9yLCAnbGVuZ3RoJykgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgYW4gYXJyYXktbGlrZSBvYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1zID0gc2VsZWN0b3I7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHNlbGVjdG9yU3RyaW5nVmFsdWUubWF0Y2gockVsZW1lbnRPYmplY3QpIHx8IHNlbGVjdG9yU3RyaW5nVmFsdWUubWF0Y2gocldpbmRvd09iamVjdCkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgYSBzaW5nbGUgZWxlbWVudAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbXMgPSBbc2VsZWN0b3JdOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICAgICBkZWZhdWx0OiB7ICAgICAgICAvLyAtLSBVTktOT1dOIC0tCiAgICAgICAgICAgICAgICAgICAgaWYgKCBzZWxlY3RvclN0cmluZ1ZhbHVlLm1hdGNoKHJFbGVtZW50T2JqZWN0KSB8fCBzZWxlY3RvclN0cmluZ1ZhbHVlLm1hdGNoKHJXaW5kb3dPYmplY3QpICkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgZWxlbWVudHMgdGhhdCBhcmUgdHlwZW9mID09PSAnZnVuY3Rpb24nCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGUuZy4sIG9iamVjdCwgYXBwbGV0LCBlbWJlZAogICAgICAgICAgICAgICAgICAgICAgICBlbGVtcyA9IFtzZWxlY3Rvcl07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBkZWZpbmUgdGhlIGxlbmd0aCBwcm9wZXJ0eSBvZiBvdXIgb2JqZWN0IHdyYXBwZXIKICAgICAgICAgICAgdGhhdC5sZW5ndGggPSBlbGVtcy5sZW5ndGg7CgogICAgICAgICAgICAvLyBiaW5kIHRoZSBlbGVtZW50cyB0byBhcnJheS1saWtlIGtleTp2YWx1ZSBwYWlycyBpbiBvdXIgd3JhcHBlcgogICAgICAgICAgICAvLyBlLmcuLCB0aGlzWzBdID09PiBlbGVtZW50CiAgICAgICAgICAgIEpTTC5lYWNoKGVsZW1zLCBmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7CiAgICAgICAgICAgICAgICB0aGF0W2luZGV4XSA9IHZhbHVlOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHJldHVybiB0aGF0OwogICAgICAgIH0sCgogICAgICAgIC8vIC0tLSBTVEFSVElORyBMSU5FIEZPUiBUSEUgSlNMIFdSQVBQRVIgTUVUSE9EUwogICAgICAgIGFkZCA6IGZ1bmN0aW9uIChzZWxlY3RvciwgY29udGV4dCkgewogICAgICAgICAgICB2YXIgbmV3RWxlbWVudHMgPSBKU0woc2VsZWN0b3IsIGNvbnRleHQpLnJhdygpLAogICAgICAgICAgICAgICAgYWxsRWxlbWVudHMgPSBjb3JlLmNvbmNhdC5jYWxsKHRoaXMucmF3KCksIG5ld0VsZW1lbnRzKTsKICAgICAgICAgICAgcmV0dXJuIEpTTChhbGxFbGVtZW50cyk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkRXZlbnQgOiBmdW5jdGlvbiAodHlwZSwgZm4pIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAodGhpc0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgIEpTTC5hZGRFdmVudCh0aGlzRWxlbWVudCwgdHlwZSwgZm4pOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBhZnRlciA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIG5ld0VsZW1lbnRzQXJyYXkgPSBkb0VsZW1lbnRPcGVyYXRpb25PbkVhY2guY2FsbCh0aGlzLCBKU0wudG9BcnJheShhcmd1bWVudHMpLCBmdW5jdGlvbiAoYmFzZUVsZW1lbnQsIG5ld0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBiYXNlRWxlbWVudC5wYXJlbnROb2RlLAogICAgICAgICAgICAgICAgICAgIG5leHQgPSBiYXNlRWxlbWVudC5uZXh0U2libGluZzsKCiAgICAgICAgICAgICAgICBpZiAocGFyZW50KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHRoZSBuZXdFbGVtZW50IGFmdGVyIHRoZSBjdXJyZW50IGVsZW1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShuZXdFbGVtZW50LCBuZXh0KTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBuZXh0U2libGluZyBkaWRuJ3QgZXhpc3QuIGp1c3QgYXBwZW5kIHRvIGl0cyBwYXJlbnQKICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKG5ld0VsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gSlNMKG5ld0VsZW1lbnRzQXJyYXkpOwogICAgICAgIH0sCgogICAgICAgIGFwcGVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIG5ld0VsZW1lbnRzQXJyYXkgPSBkb0VsZW1lbnRPcGVyYXRpb25PbkVhY2guY2FsbCh0aGlzLCBKU0wudG9BcnJheShhcmd1bWVudHMpLCBmdW5jdGlvbiAoYmFzZUVsZW1lbnQsIG5ld0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgIGJhc2VFbGVtZW50LmFwcGVuZENoaWxkKG5ld0VsZW1lbnQpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHJldHVybiBKU0wobmV3RWxlbWVudHNBcnJheSk7CiAgICAgICAgfSwKCiAgICAgICAgYXR0cmlidXRlIDogZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgICAgIHZhciByZXQgPSAnJywgdmFsdWVJc1ZhbGlkID0gdmFsdWUgIT0gbnVsbDsKCiAgICAgICAgICAgIGlmICggdHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnICYmIHRoaXMuZXhpc3RzICkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoZWxlbSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVJc1ZhbGlkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQgKz0gZWxlbS5nZXRBdHRyaWJ1dGUobmFtZSkgfHwgJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHZhbHVlSXNWYWxpZCA/IHRoaXMgOiByZXQ7CiAgICAgICAgfSwKCiAgICAgICAgYmVmb3JlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgbmV3RWxlbWVudHNBcnJheSA9IGRvRWxlbWVudE9wZXJhdGlvbk9uRWFjaC5jYWxsKHRoaXMsIEpTTC50b0FycmF5KGFyZ3VtZW50cyksIGZ1bmN0aW9uIChiYXNlRWxlbWVudCwgbmV3RWxlbWVudCkgewogICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IGJhc2VFbGVtZW50LnBhcmVudE5vZGU7CgogICAgICAgICAgICAgICAgLy8gYWRkIHRoZSBuZXdFbGVtZW50IGJlZm9yZSB0aGUgY3VycmVudCBlbGVtZW50CiAgICAgICAgICAgICAgICBpZiAocGFyZW50KSB7CiAgICAgICAgICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShuZXdFbGVtZW50LCBiYXNlRWxlbWVudCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIEpTTChuZXdFbGVtZW50c0FycmF5KTsKICAgICAgICB9LAoKICAgICAgICBjZW50ZXIgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKHRoaXNFbGVtZW50KSB7CiAgICAgICAgICAgICAgICB0aGlzRWxlbWVudCA9IEpTTCh0aGlzRWxlbWVudCk7CiAgICAgICAgICAgICAgICB0aGlzRWxlbWVudC5jc3MoJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7CiAgICAgICAgICAgICAgICB0aGlzRWxlbWVudC5jc3MoJ3RvcCcsIE1hdGguZmxvb3IoICh3aW5kb3cuaW5uZXJIZWlnaHQgLSB0aGlzRWxlbWVudC5oZWlnaHQpIC8gMiApICsgJ3B4Jyk7CiAgICAgICAgICAgICAgICB0aGlzRWxlbWVudC5jc3MoJ2xlZnQnLCBNYXRoLmZsb29yKCAod2luZG93LmlubmVyV2lkdGggLSB0aGlzRWxlbWVudC53aWR0aCkgLyAyICkgKyAncHgnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgY2xvbmUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBjbG9uZWRFbGVtZW50cyA9IGNvcmUubWFwLmNhbGwodGhpcywgY2xvbmVFbGVtZW50KTsgLy8gdmFyaWFibGUgZm9yIGNsYXJpdHkKICAgICAgICAgICAgcmV0dXJuIEpTTChjbG9uZWRFbGVtZW50cyk7CiAgICAgICAgfSwKCiAgICAgICAgY3NzIDogZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgIC8vIGNvbnZlcnQgdGhlIGh5cGhlbmF0ZWQgc3RyaW5nIHRvIGNhbWVsLWNhc2UKICAgICAgICAgICAgICAgIG5hbWUgPSB0b0NhbWVsQ2FzZShuYW1lKTsKCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKHRoaXNFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lIGluIHRoaXNFbGVtZW50LnN0eWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzRWxlbWVudC5zdHlsZVtuYW1lXSA9IHZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIGNvcmUubWFwLmNhbGwodGhpcywgcGx1Y2ssICdzdHlsZS4nICsgbmFtZSkuam9pbignJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3IoJy5jc3MoKSB3YXMgbm90IHBhc3NlZCBhIHN0cmluZyBmb3IgdGhlIGZpcnN0IGFyZ3VtZW50LicpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZWFjaCA6IGZ1bmN0aW9uIChmbiwgb1RoaXMpIHsKICAgICAgICAgICAgaWYgKHRoaXMuZXhpc3RzKSB7CiAgICAgICAgICAgICAgICBKU0wuZWFjaCh0aGlzLCBmbiwgb1RoaXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9LAoKICAgICAgICBnZXQgZXhpc3RzKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5sZW5ndGggPiAwICYmIHRoaXNbMF0gIT0gbnVsbDsKICAgICAgICB9LAoKICAgICAgICBmaWx0ZXIgOiBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgICAgICAgICAgdmFyIG5ld0VsZW1lbnRzQXJyYXkgPSBbXTsKCiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24gKHRoaXNFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCBtYXRjaGVzU2VsZWN0b3IodGhpc0VsZW1lbnQsIHNlbGVjdG9yKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgbmV3RWxlbWVudHNBcnJheS5wdXNoKHRoaXNFbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gcmV0dXJucyBhbiBlbXB0eSBKU0wgb2JqZWN0IGlmIG5vIGVsZW1lbnRzIGFyZSBtYXRjaGVkCiAgICAgICAgICAgIHJldHVybiBKU0wobmV3RWxlbWVudHNBcnJheSk7CiAgICAgICAgfSwKCiAgICAgICAgZmluZCA6IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgICAgICAgICB2YXIgYXJyYXlPZk1hdGNoZXNBcnJheXMgPSBjb3JlLm1hcC5jYWxsKHRoaXMsIGZ1bmN0aW9uICh0aGlzRWxlbWVudCkgewogICAgICAgICAgICAgICAgdmFyIG1hdGNoZXMgPSB0aGlzRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTsKICAgICAgICAgICAgICAgIHJldHVybiBKU0wudG9BcnJheShtYXRjaGVzKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHZhciBzaW5nbGVBcnJheU9mTWF0Y2hlcyA9IGFycmF5T2ZNYXRjaGVzQXJyYXlzLmxlbmd0aCA+IDAgPwogICAgICAgICAgICAgICAgY29yZS5yZWR1Y2UuY2FsbChhcnJheU9mTWF0Y2hlc0FycmF5cywgZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29yZS5jb25jYXQuY2FsbChhLCBiKTsKICAgICAgICAgICAgfSkgOiBbXTsKCiAgICAgICAgICAgIHJldHVybiBKU0woc2luZ2xlQXJyYXlPZk1hdGNoZXMpOwogICAgICAgIH0sCgogICAgICAgIGZpcnN0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoMCk7CiAgICAgICAgfSwKCiAgICAgICAgZm9jdXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBmaXJzdEVsZW1lbnQ7CgogICAgICAgICAgICBpZiAodGhpcy5leGlzdHMpIHsKICAgICAgICAgICAgICAgIGZpcnN0RWxlbWVudCA9IHRoaXNbMF07CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZpcnN0RWxlbWVudC5mb2N1cyA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgICAgIGZpcnN0RWxlbWVudC5mb2N1cygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZ2V0IDogZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgICAgIGluZGV4ID0gaW5kZXggPT09ICdmaXJzdCcgPyAwIDogaW5kZXggPT09ICdsYXN0JyA/IC0xIDogcGFyc2VJbnQoaW5kZXgsIDEwKTsKCiAgICAgICAgICAgIGlmICggIWlzTmFOKGluZGV4KSApIHsKICAgICAgICAgICAgICAgIHJldHVybiBKU0woIGluZGV4IDwgMCA/IHRoaXNbdGhpcy5sZW5ndGggKyBpbmRleF0gOiB0aGlzW2luZGV4XSApOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gSlNMLnRvQXJyYXkodGhpcyk7CiAgICAgICAgfSwKCiAgICAgICAgZ2V0IGhlaWdodCgpIHsKICAgICAgICAgICAgdmFyIGFycmF5T2ZFbGVtSGVpZ2h0cyA9IGNvcmUubWFwLmNhbGwodGhpcywgcGx1Y2ssICdvZmZzZXRIZWlnaHQnKTsKICAgICAgICAgICAgcmV0dXJuIGNvcmUucmVkdWNlLmNhbGwoYXJyYXlPZkVsZW1IZWlnaHRzLCBzdW0pOwogICAgICAgIH0sCgogICAgICAgIGhhcyA6IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgICAgICAgICB2YXIgbmV3RWxlbWVudHNBcnJheSA9IFtdOwoKICAgICAgICAgICAgaWYgKCB0eXBlb2Ygc2VsZWN0b3IgPT09ICdzdHJpbmcnICYmIHNlbGVjdG9yLm1hdGNoKHJTZWxlY3RvcikgKSB7CiAgICAgICAgICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24gKHRoaXNFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCBKU0woc2VsZWN0b3IsIHRoaXNFbGVtZW50KS5leGlzdHMgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0VsZW1lbnRzQXJyYXkucHVzaCh0aGlzRWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBKU0wobmV3RWxlbWVudHNBcnJheSk7CiAgICAgICAgfSwKCiAgICAgICAgaGlkZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTsKICAgICAgICB9LAoKICAgICAgICAvKgogICAgICAgIGdldCBpblZpZXcocGFzc2VkQ29udGFpbmVyKSB7CiAgICAgICAgICAgIHZhciBpc0luVmlldyA9IGZhbHNlOwogICAgICAgICAgICAKICAgICAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uICh0aGlzRWxlbWVudCkgewogICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IHBhc3NlZENvbnRhaW5lciB8fCB0aGlzRWxlbWVudC5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgdmFyIHZpc2libGUgPSAhISggKGNvbnRhaW5lci5zY3JvbGxUb3AgKyBjb250YWluZXIub2Zmc2V0SGVpZ2h0KSA+PSB0aGlzRWxlbWVudC5vZmZzZXRUb3AgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNvbnRhaW5lci5zY3JvbGxUb3AgLSB0aGlzRWxlbWVudC5vZmZzZXRIZWlnaHQpIDw9IHRoaXNFbGVtZW50Lm9mZnNldFRvcCApOwoKICAgICAgICAgICAgICAgIGlmICh2aXNpYmxlKSB7CiAgICAgICAgICAgICAgICAgICAgaXNJblZpZXcgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAnc3RvcCc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIGlzSW5WaWV3OwogICAgICAgIH0sCiAgICAgICAgKi8KCiAgICAgICAgaXMgOiBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgICAgICAgICAgICBpZiAoIG1hdGNoZXNTZWxlY3Rvcih0aGlzW2ldLCBzZWxlY3RvcikgKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9LAogICAgICAgIAogICAgICAgIGlzbnQgOiBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgICAgICAgICAgcmV0dXJuICF0aGlzLmlzKHNlbGVjdG9yKTsKICAgICAgICB9LAoKICAgICAgICBsYXN0IDogZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldCgtMSk7CiAgICAgICAgfSwKCiAgICAgICAgbmV4dCA6IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgICAgICAgICByZXR1cm4gSlNMKCBnZXRFYWNoRWxlbWVudHModGhpcywgc2VsZWN0b3IsICduZXh0U2libGluZycsIDEpICk7CiAgICAgICAgfSwKCiAgICAgICAgbm90IDogZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICAgICAgICAgIHZhciBuZXdFbGVtZW50c0FycmF5ID0gW107CgogICAgICAgICAgICBpZiAoIHR5cGVvZiBzZWxlY3RvciA9PT0gJ3N0cmluZycgJiYgc2VsZWN0b3IubWF0Y2goclNlbGVjdG9yKSApIHsKICAgICAgICAgICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAodGhpc0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIEpTTCh0aGlzRWxlbWVudCkuaXNudChzZWxlY3RvcikgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0VsZW1lbnRzQXJyYXkucHVzaCh0aGlzRWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBKU0wobmV3RWxlbWVudHNBcnJheSk7CiAgICAgICAgfSwKCiAgICAgICAgcGFyZW50IDogZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICAgICAgICAgIHJldHVybiBKU0woIGdldEVhY2hFbGVtZW50cyh0aGlzLCBzZWxlY3RvciwgJ3BhcmVudE5vZGUnLCAxKSApOwogICAgICAgIH0sCgogICAgICAgIHByZXBlbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBuZXdFbGVtZW50c0FycmF5ID0gZG9FbGVtZW50T3BlcmF0aW9uT25FYWNoLmNhbGwodGhpcywgSlNMLnRvQXJyYXkoYXJndW1lbnRzKSwgZnVuY3Rpb24gKGJhc2VFbGVtZW50LCBuZXdFbGVtZW50KSB7CiAgICAgICAgICAgICAgICB2YXIgZmlyc3RDaGlsZCA9IGJhc2VFbGVtZW50LmZpcnN0Q2hpbGQ7CgogICAgICAgICAgICAgICAgaWYgKGZpcnN0Q2hpbGQpIHsKICAgICAgICAgICAgICAgICAgICBiYXNlRWxlbWVudC5pbnNlcnRCZWZvcmUobmV3RWxlbWVudCwgZmlyc3RDaGlsZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIEpTTChuZXdFbGVtZW50c0FycmF5KTsKICAgICAgICB9LAoKICAgICAgICBwcmV2IDogZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICAgICAgICAgIHJldHVybiBKU0woIGdldEVhY2hFbGVtZW50cyh0aGlzLCBzZWxlY3RvciwgJ3ByZXZpb3VzU2libGluZycsIDEpICk7CiAgICAgICAgfSwKCiAgICAgICAgcHJvcCA6IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkgewogICAgICAgICAgICB2YXIgdmFsdWVJc1ZhbGlkID0gdmFsdWUgIT0gbnVsbCwgcmV0OwoKICAgICAgICAgICAgaWYgKHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJyAmJiB0aGlzLmV4aXN0cykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAodGhpc0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlSXNWYWxpZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0VsZW1lbnRbbmFtZV0gPSB2YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmV0ID09PSAndW5kZWZpbmVkJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IHRoaXNFbGVtZW50W25hbWVdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQgKz0gdGhpc0VsZW1lbnRbbmFtZV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHZhbHVlSXNWYWxpZCA/IHRoaXMgOiByZXQ7CiAgICAgICAgfSwKCiAgICAgICAgcmF3IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gY29yZS5zbGljZS5jYWxsKHRoaXMsIDApOwogICAgICAgIH0sCgogICAgICAgIHJlbW92ZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTsKCiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCAmJiBwYXJlbnQpIHsKICAgICAgICAgICAgICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIHJlbW92ZUF0dHJpYnV0ZSA6IGZ1bmN0aW9uIChhdHRyaWJ1dGVOYW1lKSB7CiAgICAgICAgICAgIGlmICh0eXBlb2YgYXR0cmlidXRlTmFtZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKHRoaXNFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgdGhpc0VsZW1lbnQucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3IoJy5yZW1vdmVBdHRyaWJ1dGUoKSB3YXMgbm90IHBhc3NlZCBhIHN0cmluZy4nKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIHJlbW92ZUV2ZW50IDogZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAodGhpc0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICBKU0wucmVtb3ZlRXZlbnQodGhpc0VsZW1lbnQsIHR5cGUpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3IoJy5yZW1vdmVFdmVudCgpIHdhcyBub3QgcGFzc2VkIGEgc3RyaW5nLicpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgcmVwbGFjZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIG5ld0VsZW1lbnRzQXJyYXkgPSBkb0VsZW1lbnRPcGVyYXRpb25PbkVhY2guY2FsbCh0aGlzLCBKU0wudG9BcnJheShhcmd1bWVudHMpLCBmdW5jdGlvbiAoYmFzZUVsZW1lbnQsIG5ld0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBiYXNlRWxlbWVudC5wYXJlbnROb2RlOwoKICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHsKICAgICAgICAgICAgICAgICAgICBwYXJlbnQucmVwbGFjZUNoaWxkKG5ld0VsZW1lbnQsIGJhc2VFbGVtZW50KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gSlNMKG5ld0VsZW1lbnRzQXJyYXkpOwogICAgICAgIH0sCgogICAgICAgIHNob3cgOiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgdmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gdmFsdWUgOiAnaW5saW5lJzsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3NzKCdkaXNwbGF5JywgdmFsdWUpOwogICAgICAgIH0sCiAgICAgICAgCiAgICAgICAgdGV4dCA6IGZ1bmN0aW9uIChwYXNzZWRUZXh0LCBhcHBlbmQpIHsKICAgICAgICAgICAgLy8gY29udmVydCBhIG51bWJlciB0byBhIHN0cmluZwogICAgICAgICAgICBpZiAoIHR5cGVvZiBwYXNzZWRUZXh0ID09PSAnbnVtYmVyJyAmJiAhaXNOYU4ocGFzc2VkVGV4dCkgJiYgaXNGaW5pdGUocGFzc2VkVGV4dCkgKSB7CiAgICAgICAgICAgICAgICBwYXNzZWRUZXh0ICs9ICcnOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBoYW5kbGUgc2V0dGluZyB0ZXh0CiAgICAgICAgICAgIGlmICh0eXBlb2YgcGFzc2VkVGV4dCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgIGlmIChhcHBlbmQgIT09IHRydWUpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24gKHRoaXNFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEpTTCgnLi8vdGV4dCgpJywgdGhpc0VsZW1lbnQpLmVhY2goZnVuY3Rpb24gKHRleHROb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZS5kYXRhID0gJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kKCd0ZXh0JywgcGFzc2VkVGV4dCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gaGFuZGxlIGdldHRpbmcgdGV4dAogICAgICAgICAgICByZXR1cm4gY29yZS5yZWR1Y2UuY2FsbCh0aGlzLCBmdW5jdGlvbiAoY3VyVmFsdWUsIG5leHRFbGVtZW50KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY3VyVmFsdWUgKyBuZXh0RWxlbWVudC50ZXh0Q29udGVudDsKICAgICAgICAgICAgfSwgJycpOwogICAgICAgIH0sCgogICAgICAgIHRvZ2dsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAodGhpc0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgIHRoaXNFbGVtZW50ID0gSlNMKHRoaXNFbGVtZW50KTsKCiAgICAgICAgICAgICAgICBpZiAodGhpc0VsZW1lbnQudmlzaWJsZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXNFbGVtZW50LmhpZGUoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpc0VsZW1lbnQuc2hvdygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICB2YWx1ZSA6IGZ1bmN0aW9uIChwYXNzZWRWYWx1ZSkgewogICAgICAgICAgICB2YXIgZWxlbSA9IHRoaXNbMF0sCiAgICAgICAgICAgICAgICB0YWdOYW1lID0gZWxlbSAmJiBlbGVtLnRhZ05hbWUgfHwgJycsCiAgICAgICAgICAgICAgICBzZWxlY3RlZE9wdGlvbnMgPSBbXSwKICAgICAgICAgICAgICAgIHJJbnB1dFR5cGVCbGFja2xpc3QgPSAvYnV0dG9ufGNoZWNrYm94fGZpbGV8aW1hZ2V8cmFkaW98cmVzZXR8c3VibWl0LywKICAgICAgICAgICAgICAgIHBhc3NlZFZhbHVlVHlwZSA9IEpTTC50eXBlT2YocGFzc2VkVmFsdWUpOwoKICAgICAgICAgICAgaWYgKHBhc3NlZFZhbHVlID09IG51bGwpIHsKICAgICAgICAgICAgICAgIC8vIG5vIGFyZ3VtZW50cyB3ZXJlIHBhc3NlZCwgcmV0dXJuIGEgdmFsdWUKICAgICAgICAgICAgICAgICAgICBpZiAodGFnTmFtZSA9PT0gJ1NFTEVDVCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBlbGVtLmhhc0F0dHJpYnV0ZSgnbXVsdGlwbGUnKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpTTC5lYWNoKGVsZW0ub3B0aW9ucywgZnVuY3Rpb24gKHRoaXNPcHRpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc09wdGlvbi5zZWxlY3RlZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZE9wdGlvbnMucHVzaCh0aGlzT3B0aW9uLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRPcHRpb25zOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW0ub3B0aW9uc1tlbGVtLnNlbGVjdGVkSW5kZXhdLnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggdGFnTmFtZSA9PT0gJ0lOUFVUJyAmJiAhZWxlbS50eXBlLm1hdGNoKHJJbnB1dFR5cGVCbGFja2xpc3QpICkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKHRhZ05hbWUgPT09ICdURVhUQVJFQScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW0udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gYW4gYXJndW1lbnQgd2FzIHBhc3NlZCwgc2V0IHRoZSB2YWx1ZSBvbiBlYWNoIGVsZW1lbnQKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKHRoaXNFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhZ05hbWUgPSB0aGlzRWxlbWVudC50YWdOYW1lOwoKICAgICAgICAgICAgICAgICAgICBpZiAodGFnTmFtZSA9PT0gJ1NFTEVDVCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNFbGVtZW50Lmhhc0F0dHJpYnV0ZSgnbXVsdGlwbGUnKSAmJiBwYXNzZWRWYWx1ZVR5cGUgPT09ICdhcnJheScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKU0wuZWFjaCh0aGlzRWxlbWVudC5vcHRpb25zLCBmdW5jdGlvbiAodGhpc09wdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKU0wuZWFjaChwYXNzZWRWYWx1ZSwgZnVuY3Rpb24gKHRoaXNQYXNzZWRWYWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNPcHRpb24udmFsdWUgPT0gdGhpc1Bhc3NlZFZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc09wdGlvbi5zZWxlY3RlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdzdG9wJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc09wdGlvbi5zZWxlY3RlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpTTC5lYWNoKHRoaXNFbGVtZW50Lm9wdGlvbnMsIGZ1bmN0aW9uICh0aGlzT3B0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc09wdGlvbi5zZWxlY3RlZCA9IHRoaXNPcHRpb24udmFsdWUgPT0gcGFzc2VkVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFnTmFtZSA9PT0gJ0lOUFVUJykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICF0aGlzRWxlbWVudC50eXBlLm1hdGNoKHJJbnB1dFR5cGVCbGFja2xpc3QpICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0VsZW1lbnQudmFsdWUgPSBwYXNzZWRWYWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzRWxlbWVudC50eXBlID09PSAnY2hlY2tib3gnIHx8IHRoaXNFbGVtZW50LnR5cGUgPT09ICdyYWRpbycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXNzZWRWYWx1ZVR5cGUgPT09ICdhcnJheScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKU0wuZWFjaChwYXNzZWRWYWx1ZSwgZnVuY3Rpb24gKHRoaXNQYXNzZWRWYWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0VsZW1lbnQudmFsdWUgPT0gdGhpc1Bhc3NlZFZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzRWxlbWVudC5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnc3RvcCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzRWxlbWVudC5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpc0VsZW1lbnQudmFsdWUgPT0gcGFzc2VkVmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0VsZW1lbnQuY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRhZ05hbWUgPT09ICdURVhUQVJFQScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpc0VsZW1lbnQudmFsdWUgPSBwYXNzZWRWYWx1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSwKCiAgICAgICAgZ2V0IHZpc2libGUoKSB7CiAgICAgICAgICAgIHJldHVybiBNYXRoLm1heCh0aGlzLndpZHRoLCB0aGlzLmhlaWdodCkgPiAwOwogICAgICAgIH0sCgogICAgICAgIGdldCB3aWR0aCgpIHsKICAgICAgICAgICAgdmFyIGFycmF5T2ZFbGVtSGVpZ2h0cyA9IGNvcmUubWFwLmNhbGwodGhpcywgcGx1Y2ssICdvZmZzZXRXaWR0aCcpOwogICAgICAgICAgICByZXR1cm4gY29yZS5yZWR1Y2UuY2FsbChhcnJheU9mRWxlbUhlaWdodHMsIHN1bSk7CiAgICAgICAgfSwKICAgIH07CgogICAgLy8gZ2l2ZSB0aGUgaW5pdCBmdW5jdGlvbiB0aGUgSlNMIHByb3RvdHlwZSBmb3IgbGF0ZXIgaW5zdGFudGlhdGlvbgogICAgSlNMLmZuLmluaXQucHJvdG90eXBlID0gSlNMLmZuOwoKICAgIC8vIGV4dGVuZCBtZXRob2QuIGNhbiBleHRlbmQgYW55IG9iamVjdCBpdCdzIHJ1biB1cG9uCiAgICBKU0wuZm4uZXh0ZW5kID0gSlNMLmV4dGVuZCA9IGZ1bmN0aW9uIChvYmopIHsKICAgICAgICB2YXIgbmFtZSwgY29weTsKCiAgICAgICAgZm9yIChuYW1lIGluIG9iaikgewogICAgICAgICAgICBjb3B5ID0gb2JqW25hbWVdOwoKICAgICAgICAgICAgaWYgKCAhY29yZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMsIG5hbWUpICYmIHR5cGVvZiBjb3B5ICE9PSAndW5kZWZpbmVkJyApIHsKICAgICAgICAgICAgICAgIHRoaXNbbmFtZV0gPSBjb3B5OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKCiAgICAvLyAtLS0gU1RBUlRMSU5HIExJTkUgRk9SIFRIRSBESVJFQ1QgSlNMIE1FVEhPRFMKICAgIEpTTC5leHRlbmQoewogICAgICAgIGFkZEV2ZW50IDogZnVuY3Rpb24gYWRkRXZlbnQodGhpc0VsZW1lbnQsIHR5cGUsIGZuKSB7CiAgICAgICAgICAgIGlmICh0aGlzRWxlbWVudCAhPSBudWxsICYmIHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJyAmJiB0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpc0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgICAgIHRoaXNFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXNFbGVtZW50LmF0dGFjaEV2ZW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICdvbicgKyB0eXBlOwogICAgICAgICAgICAgICAgICAgIHRoaXNFbGVtZW50LmF0dGFjaEV2ZW50KHR5cGUsIGZuKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGhhbmRsZXJzLmFkZCh0aGlzRWxlbWVudCwgdHlwZSwgZm4pOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgYWRkU2NyaXB0IDogZnVuY3Rpb24gYWRkU2NyaXB0KGNvbnRlbnRzLCBpZCwgbm9kZSkgewogICAgICAgICAgICB2YXIgbmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwogICAgICAgICAgICBuZXdFbGVtZW50LmlkID0gaWQgfHwgKCAnanNsLXNjcmlwdC0nICsgSlNMLnJhbmRvbSg5OTkpICk7CiAgICAgICAgICAgIG5ld0VsZW1lbnQuaW5uZXJIVE1MID0gY29udGVudHM7CgogICAgICAgICAgICBub2RlID0gbm9kZSB8fCBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwgPiBoZWFkJyk7CiAgICAgICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQobmV3RWxlbWVudCk7CgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgcmVtb3ZlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIG5vZGUucmVtb3ZlQ2hpbGQobmV3RWxlbWVudCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfSwKCiAgICAgICAgYWRkU3R5bGUgOiBmdW5jdGlvbiBhZGRTdHlsZShjc3MsIGlkLCBub2RlKSB7CiAgICAgICAgICAgIGlkID0gaWQgfHwgKCAnanNsLXN0eWxlLScgKyBKU0wucmFuZG9tKDk5OSkgKTsKICAgICAgICAgICAgbm9kZSA9IG5vZGUgfHwgZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sID4gaGVhZCcpOwogICAgICAgICAgICBpZiAobm9kZSkgewogICAgICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZCgKICAgICAgICAgICAgICAgICAgICBKU0wuY3JlYXRlKCdzdHlsZScsIHtpZCA6IGlkLCB0eXBlIDogJ3RleHQvY3NzJ30sIFsgSlNMLmNyZWF0ZSgndGV4dCcsIGNzcykgXSApCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgYWxpYXMgOiBmdW5jdGlvbiBhbGlhcyhuZXdBbGlhcykgewogICAgICAgICAgICBpZiAodHlwZW9mIG5ld0FsaWFzID09PSAnc3RyaW5nJyAmJiBuZXdBbGlhcy5tYXRjaChyVmFsaWRWYXJuYW1lKSAmJiB0eXBlb2Ygd2luZG93W25ld0FsaWFzXSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgICAgIHdpbmRvd1tuZXdBbGlhc10gPSBKU0w7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBjbGVhckludGVydmFsIDogZnVuY3Rpb24gY2xlYXJJbnRlcnZhbChpbmRleCkgewogICAgICAgICAgICBpZiAodHlwZW9mIGluZGV4ID09PSAnbnVtYmVyJyAmJiBpbmRleCA8IGludGVydmFscy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoIGludGVydmFsc1tpbmRleF0gKTsKICAgICAgICAgICAgICAgIGludGVydmFsc1tpbmRleF0gPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgY3JlYXRlIDogZnVuY3Rpb24gY3JlYXRlKGVsZW1lbnROYW1lLCBkZXNjT2JqLCBraWRzQXJyYXkpIHsKICAgICAgICAgICAgdmFyIGFyZ3NMZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoLAogICAgICAgICAgICAgICAgdHlwZVZhbHVlLCBwcm9wLCB2YWwsIEhUTUxob2xkZXIsIHJldCwgaTsKCiAgICAgICAgICAgIGlmIChhcmdzTGVuZ3RoID09PSAyICYmIGVsZW1lbnROYW1lID09PSAndGV4dCcgJiYgdHlwZW9mIGRlc2NPYmogPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGV4dCBub2RlIGNyZWF0aW9uCiAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGVzY09iaik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGFyZ3NMZW5ndGggPT09IDEgJiYgdHlwZW9mIGVsZW1lbnROYW1lID09PSAnc3RyaW5nJyAmJiBlbGVtZW50TmFtZS5tYXRjaChySFRNTCkgKSB7CiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgSFRNTCBzdHJpbmdzCgogICAgICAgICAgICAgICAgLy8gdGFrZSB0aGUgSFRNTCBzdHJpbmcgYW5kIHB1dCBpdCBpbnNpZGUgYSBkaXYKICAgICAgICAgICAgICAgIEhUTUxob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIEhUTUxob2xkZXIuaW5uZXJIVE1MID0gZWxlbWVudE5hbWU7CgogICAgICAgICAgICAgICAgLy8gYWRkIGVhY2ggY2hpbGROb2RlIHRvIGFuIGFycmF5IHRvIHJldHVybgogICAgICAgICAgICAgICAgcmV0ID0gW107CiAgICAgICAgICAgICAgICByZXQucHVzaC5hcHBseShyZXQsIEhUTUxob2xkZXIuY2hpbGROb2Rlcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmV0Lmxlbmd0aCA+IDAgPyAocmV0Lmxlbmd0aCA9PT0gMSA/IHJldFswXSA6IHJldCkgOiBudWxsOwogICAgICAgICAgICB9IGVsc2UgaWYgKGFyZ3NMZW5ndGggPiAxICYmIHR5cGVvZiBlbGVtZW50TmFtZSA9PT0gJ3N0cmluZycgJiYgdHlwZW9mIGRlc2NPYmogPT09ICdvYmplY3QnKSB7CiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIG5vcm1hbCBlbGVtZW50IG5hbWUgYW5kIGRlc2NyaXB0b3Igb2JqZWN0CiAgICAgICAgICAgICAgICByZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGVsZW1lbnROYW1lICsgJycpOwoKICAgICAgICAgICAgICAgIGZvciAocHJvcCBpbiBkZXNjT2JqKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCBjb3JlLmhhc093blByb3BlcnR5LmNhbGwoZGVzY09iaiwgcHJvcCkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IGRlc2NPYmpbcHJvcF07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9wLmluZGV4T2YoJ29uJykgPT09IDAgJiYgdHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgSlNMLmFkZEV2ZW50KHJldCwgcHJvcC5zdWJzdHJpbmcoMiksIHZhbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHByb3AgIT09ICdzdHlsZScgJiYgcHJvcCAhPT0gJ2NsYXNzJyAmJiBwcm9wIGluIHJldCAmJiB0eXBlb2YgcmV0W3Byb3BdICE9PSAndW5kZWZpbmVkJyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldFtwcm9wXSA9IHZhbDsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldC5zZXRBdHRyaWJ1dGUocHJvcCwgdmFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoSlNMLnR5cGVPZihraWRzQXJyYXkpID09PSAnYXJyYXknKSB7CiAgICAgICAgICAgICAgICAgICAgSlNMLmVhY2goa2lkc0FycmF5LCBmdW5jdGlvbiAoa2lkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWwsIGl0ZW0sIGk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGtpZCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IEpTTC5jcmVhdGUoa2lkKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChKU0wudHlwZU9mKHZhbCkgPT09ICdhcnJheScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmFsLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldC5hcHBlbmRDaGlsZCggdmFsW2ldICk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChKU0wudHlwZU9mKGtpZCkgPT09ICdlbGVtZW50JykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldC5hcHBlbmRDaGlsZChraWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEpTTC50eXBlT2Yoa2lkKSA9PT0gJ2VsZW1lbnQnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQuYXBwZW5kQ2hpbGQoa2lkKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiByZXQ7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJnc0xlbmd0aCA9PT0gMSAmJiBKU0wudHlwZU9mKGVsZW1lbnROYW1lKSA9PT0gJ2VsZW1lbnQnKSB7CiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgYW4gZWxlbWVudAogICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnROYW1lOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZWFjaCA6IGZ1bmN0aW9uIGVhY2gocGFzc2VkQXJyYXksIGZuLCBvVGhpcykgewogICAgICAgICAgICB2YXIgaXNPdGhpc1VuZGVmaW5lZCA9IHR5cGVvZiBvVGhpcyAhPT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICAgICAgICBpbmRleCwgbGVuLCBvdGhlclRoaXMsIHZhbHVlOwoKICAgICAgICAgICAgZm9yIChpbmRleCA9IDA7IGluZGV4IDwgcGFzc2VkQXJyYXkubGVuZ3RoOyBpbmRleCArPSAxKSB7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHBhc3NlZEFycmF5W2luZGV4XTsKICAgICAgICAgICAgICAgIG90aGVyVGhpcyA9IGlzT3RoaXNVbmRlZmluZWQgPyBvVGhpcyA6IHZhbHVlOwogICAgICAgICAgICAgICAgaWYgKGZuLmNhbGwob3RoZXJUaGlzLCB2YWx1ZSwgaW5kZXgsIHBhc3NlZEFycmF5KSA9PT0gJ3N0b3AnKSB7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBsb29wIDogZnVuY3Rpb24gbG9vcChtYXhJdGVyYXRpb25zLCBmbikgewogICAgICAgICAgICB2YXIgYXJncyA9IEpTTC50b0FycmF5KGFyZ3VtZW50cyksIGk7CgogICAgICAgICAgICBpZiAodHlwZW9mIG1heEl0ZXJhdGlvbnMgPT09ICdudW1iZXInICYmIG1heEl0ZXJhdGlvbnMgPiAwICYmIHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgYXJncyA9IGFyZ3Muc2xpY2UoMik7CiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbWF4SXRlcmF0aW9uczsgaSArPSAxKSB7CiAgICAgICAgICAgICAgICAgICAgZm4uYXBwbHkobnVsbCwgYXJncyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICByYW5kb20gOiBmdW5jdGlvbiByYW5kb20obWF4SW50ZWdlciwgbWluSW50ZWdlcikgewogICAgICAgICAgICB2YXIgcmFuZCA9IC0xOwoKICAgICAgICAgICAgd2hpbGUgKHJhbmQgPCAwIHx8IHJhbmQgPiBtYXhJbnRlZ2VyIHx8IHJhbmQgPCBtaW5JbnRlZ2VyKSB7CiAgICAgICAgICAgICAgICByYW5kID0gTWF0aC5mbG9vciggTWF0aC5yYW5kb20oKSAqIG1heEludGVnZXIgKSArIE1hdGgucm91bmQoIE1hdGgucmFuZG9tKCkgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHJhbmQ7CiAgICAgICAgfSwKCiAgICAgICAgcmVtb3ZlRXZlbnQgOiBmdW5jdGlvbiByZW1vdmVFdmVudCh0aGlzRWxlbWVudCwgdHlwZSkgewogICAgICAgICAgICBKU0wuZWFjaChoYW5kbGVycy5nZXQodGhpc0VsZW1lbnQsIHR5cGUpLCBmdW5jdGlvbiAodGhpc0V2ZW50T2JqKSB7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXNFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzRXZlbnRPYmouZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXNFdmVudE9iai50eXBlLCB0aGlzRXZlbnRPYmouZm4sIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXNFbGVtZW50LmRldGFjaEV2ZW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICdvbicgKyB0eXBlOwogICAgICAgICAgICAgICAgICAgIHRoaXNFdmVudE9iai5lbGVtZW50LmRldGFjaEV2ZW50KHRoaXNFdmVudE9iai50eXBlLCB0aGlzRXZlbnRPYmouZm4pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGhhbmRsZXJzLnJlbW92ZSh0aGlzRWxlbWVudCwgdHlwZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIHJ1bkF0IDogZnVuY3Rpb24gcnVuQXQoc3RhdGUsIGZ1bmMsIG9UaGlzKSB7CiAgICAgICAgICAgIHZhciBhcmdzID0gSlNMLnRvQXJyYXkoYXJndW1lbnRzKSwgaW50diwKCiAgICAgICAgICAgICAgICAvLyBjb21wb3NlIGEgbGlzdCBvZiB0aGUgNCBzdGF0ZXMsIHRvIHVzZSAuaW5kZXhPZigpIHVwb24gbGF0ZXIKICAgICAgICAgICAgICAgIHN0YXRlcyA9IFsndW5pbml0aWFsaXplZCcsICdsb2FkaW5nJywgJ2ludGVyYWN0aXZlJywgJ2NvbXBsZXRlJ10sCgogICAgICAgICAgICAgICAgLy8gaW4tY2FzZSB0aGV5IHBhc3MgW3N0YXJ0L2VuZF0gaW5zdGVhZCBvZiBbbG9hZGluZy9jb21wbGV0ZV0KICAgICAgICAgICAgICAgIHN0YXRlID0gc3RhdGUucmVwbGFjZSgnc3RhcnQnLCAnbG9hZGluZycpLnJlcGxhY2UoJ2VuZCcsICdjb21wbGV0ZScpOwoKICAgICAgICAgICAgLy8gdGhpcyB3aWxsIHJ1biB0aGVpciBmdW5jdGlvbiB3aXRoIHRoZSBzcGVjaWZpZWQgYXJndW1lbnRzLCBpZiBhbnksCiAgICAgICAgICAgIC8vIGFuZCBhIGN1c3RvbSAndGhpcycgdmFsdWUsIGlmIHNwZWNpZmllZAogICAgICAgICAgICBmdW5jdGlvbiBydW5GdW5jKCkgewogICAgICAgICAgICAgICAgZnVuYy5hcHBseSggb1RoaXMsIGFyZ3Muc2xpY2UoMykgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdGhpcyB3aWxsIHJ1biBvbiBlYWNoIHN0YXRlIGNoYW5nZSBpZiB0aGUgc3BlY2lmaWVkIHN0YXRlIGlzCiAgICAgICAgICAgIC8vIG5vdCBhY2hpZXZlZCB5ZXQuIGl0IHdpbGwgcnVuIHRoZWlyIGZ1bmN0aW9uIHdoZW4gaXQgaXMgYWNoaWV2ZWQKICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tTdGF0ZSgpIHsKICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSBzdGF0ZSkgewogICAgICAgICAgICAgICAgICAgIHJ1bkZ1bmMoKTsKICAgICAgICAgICAgICAgICAgICBKU0wuY2xlYXJJbnRlcnZhbChpbnR2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCBjb3JlLmFycl9pbmRleE9mLmNhbGwoc3RhdGVzLCBzdGF0ZSkgPD0gY29yZS5hcnJfaW5kZXhPZi5jYWxsKHN0YXRlcywgZG9jdW1lbnQucmVhZHlTdGF0ZSkgKSB7CiAgICAgICAgICAgICAgICAvLyB3ZSBhcmUgYXQsIG9yIGhhdmUgbWlzc2VkLCBvdXIgZGVzaXJlZCBzdGF0ZQogICAgICAgICAgICAgICAgLy8gcnVuIHRoZSBzcGVjaWZpZWQgZnVuY3Rpb24KICAgICAgICAgICAgICAgIHJ1bkZ1bmMoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGludHYgPSBKU0wuc2V0SW50ZXJ2YWwoY2hlY2tTdGF0ZSwgMjAwKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIHNldEludGVydmFsIDogZnVuY3Rpb24gc2V0SW50ZXJ2YWwoZnVuYywgZGVsYXkpIHsKICAgICAgICAgICAgdmFyIGluZGV4ID0gaW50ZXJ2YWxzLmxlbmd0aCwKICAgICAgICAgICAgICAgIGRlbGF5X29yaWcgPSBkZWxheSwKICAgICAgICAgICAgICAgIGNvdW50ID0gMSwgc3RhcnRUaW1lOwoKICAgICAgICAgICAgZnVuY3Rpb24gZG9SZShmdW5jLCBkZWxheSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAvLyBkcmlmdCBhY2NvbW9kYXRpb24KICAgICAgICAgICAgICAgICAgICB2YXIgZGlmZmVyZW5jZSA9ICggbmV3IERhdGUoKS5nZXRUaW1lKCkgKSAtIHN0YXJ0VGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgY29ycmVjdFRpbWUgPSBkZWxheV9vcmlnICogY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgIGRyaWZ0ID0gZGlmZmVyZW5jZSAtIGNvcnJlY3RUaW1lOwoKICAgICAgICAgICAgICAgICAgICAvLyBleGVjdXRlIHRoZSBmdW5jdGlvbiBiZWZvcmUgc2V0dGluZyBhIG5ldyB0aW1lb3V0CiAgICAgICAgICAgICAgICAgICAgZnVuYy5jYWxsKG51bGwpOwoKICAgICAgICAgICAgICAgICAgICAvLyBmaXggZm9yIHdoZW4gYSB0aW1lb3V0IHRha2VzIGxvbmdlciB0aGFuIGRvdWJsZSB0aGUgb3JpZ2luYWwgZGVsYXkgdGltZSB0byBleGVjdXRlCiAgICAgICAgICAgICAgICAgICAgaWYgKGRyaWZ0ID4gZGVsYXlfb3JpZykgewogICAgICAgICAgICAgICAgICAgICAgICBkcmlmdCA9IGRlbGF5X29yaWc7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAvLyBzYXZlIHRoZSByZWZlcmVuY2Ugb2YgdGhlIG5ldyB0aW1lb3V0IGluIG91ciAnaW50ZXJ2YWxzJyBzdGFjawogICAgICAgICAgICAgICAgICAgIGlmIChpbnRlcnZhbHNbaW5kZXhdICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmFsc1tpbmRleF0gPSBkb1JlKGZ1bmMsIGRlbGF5X29yaWcgLSBkcmlmdCk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgICAgICAgICAgfSwgZGVsYXkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzdGFydFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgICAgICAgaW50ZXJ2YWxzW2luZGV4XSA9IGRvUmUoZnVuYywgZGVsYXlfb3JpZyk7CgogICAgICAgICAgICByZXR1cm4gaW5kZXg7CiAgICAgICAgfSwKCiAgICAgICAgdG9BcnJheSA6IGZ1bmN0aW9uIHRvQXJyYXkoYXJyKSB7CiAgICAgICAgICAgIHZhciBuZXdBcnIgPSBbXSwgLy8gbmV3IGFycmF5IHRvIHN0b3JlIHRoZSB2YWx1ZXMgaW50bwogICAgICAgICAgICAgICAgbGVuID0gYXJyLmxlbmd0aCB8fCBhcnIuc25hcHNob3RMZW5ndGgsCiAgICAgICAgICAgICAgICBpdGVtLCBpOwoKICAgICAgICAgICAgaWYgKHR5cGVvZiBsZW4gPT09ICdudW1iZXInICYmIGxlbiA+IDApIHsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXJyLnNuYXBzaG90SXRlbSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7ICggaXRlbSA9IGFyci5zbmFwc2hvdEl0ZW0oaSkgKTsgaSArPSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0Fyci5wdXNoKGl0ZW0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIHNwZWNpZmllZCAnbGlzdCcgaXMgYXJyYXktbGlrZSwgdXNlIHNsaWNlIG9uIGl0CiAgICAgICAgICAgICAgICAgICAgLy8gdG8gY29udmVydCBpdCB0byBhbiBhcnJheQogICAgICAgICAgICAgICAgICAgIG5ld0FyciA9IGNvcmUuc2xpY2UuY2FsbChhcnIsIDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbmV3QXJyOwogICAgICAgIH0sCgogICAgICAgIHRvU3RyaW5nIDogZnVuY3Rpb24gdG9TdHJpbmcoaXRlbSkgewogICAgICAgICAgICB2YXIga2V5LCB2YWx1ZSwgdmFsdWVzID0gW107CgogICAgICAgICAgICBmdW5jdGlvbiBzdHJpbmdpZnlWYWx1ZSh2YWwpIHsKICAgICAgICAgICAgICAgIHZhciB0eXBlT2ZWYWwgPSBKU0wudHlwZU9mKHZhbCksCiAgICAgICAgICAgICAgICAgICAgdG9TdHJpbmdWYWx1ZSA9IGNvcmUudG9TdHJpbmcuY2FsbCh2YWwpOwoKICAgICAgICAgICAgICAgIGlmICh0eXBlT2ZWYWwgPT09ICdudWxsJyB8fCB0eXBlT2ZWYWwgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICAgICAgICAgICAgdmFsID0gdHlwZU9mVmFsOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgICAgIGlmICh2YWwubGVuZ3RoID4gMTUpIHsgLy8gdHJ1bmNhdGUgc3RyaW5ncyBsb25nZXIgdGhhbiAxNSBjaGFyYWN0ZXJzCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9ICciJyArIHZhbC5zdWJzdHJpbmcoMCwgMTIpICsgJyIuLi4nOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9ICciJyArIHZhbCArICciJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVPZlZhbCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgICAgIHZhbCA9IHZhbC50b1N0cmluZygpLnN1YnN0cmluZygwLCAyMCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVPZlZhbCAhPT0gJ251bWJlcicgJiYgdHlwZU9mVmFsICE9PSAnYm9vbGVhbicpIHsKICAgICAgICAgICAgICAgICAgICB2YWwgPSB0b1N0cmluZ1ZhbHVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN3aXRjaCggSlNMLnR5cGVPZihpdGVtKSApIHsKICAgICAgICAgICAgICAgIGNhc2UgJ29iamVjdCc6IHsKICAgICAgICAgICAgICAgICAgICBmb3IgKGtleSBpbiBpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggaXRlbS5oYXNPd25Qcm9wZXJ0eShrZXkpICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzdHJpbmdpZnlWYWx1ZSggaXRlbVtrZXldICk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaCggJyInICsga2V5ICsgJyIgOiAnICsgdmFsdWUgKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3tcbiAgICAnICsgdmFsdWVzLmpvaW4oJyxcbiAgICAnKSArICdcbn0nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgICAgIGNhc2UgJ2FycmF5JzogewogICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBjb3JlLm1hcC5jYWxsKGl0ZW0sIGZ1bmN0aW9uICh0aGlzVmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZ2lmeVZhbHVlKHRoaXNWYWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdbXG4gICAgJyArIGl0ZW0uam9pbignLFxuICAgICcpICsgJ1xuXSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICAgICAgY2FzZSAnc3RyaW5nJzogewogICAgICAgICAgICAgICAgICAgIHJldHVybiAnIicgKyBpdGVtICsgJyInOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlcic6IHsKICAgICAgICAgICAgICAgICAgICBpdGVtID0gcGFyc2VJbnQoaXRlbSwgMTApOwogICAgICAgICAgICAgICAgICAgIGlmICggaXNOYU4oaXRlbSkgKSB7IC8vIG5vIHRlcm5hcnkgb3BlcmF0b3IsIGZvciBjbGFyaXR5CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnTmFOJzsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS50b1N0cmluZygpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICAgICBjYXNlICdyZWdleHAnOiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0udG9TdHJpbmcoKS5sZW5ndGggPD0gMjApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS50b1N0cmluZygpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnW29iamVjdCBSZWdFeHBdJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICAgICAgY2FzZSAnZnVuY3Rpb24nOiBjYXNlICdib29sZWFuJzogewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICAgICAgY2FzZSAnbnVsbCc6IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ251bGwnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgICAgIGNhc2UgJ3VuZGVmaW5lZCc6IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3VuZGVmaW5lZCc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICAgICAgZGVmYXVsdDogewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb3JlLnRvU3RyaW5nLmNhbGwoaXRlbSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICAvLyB0eXBlT2YgYnkgRG91Z2xhcyBDcm9ja2ZvcmQuIG1vZGlmaWVkIGJ5IEpvZVNpbW1vbnMKICAgICAgICB0eXBlT2YgOiBmdW5jdGlvbiB0eXBlT2YodmFsdWUpIHsKICAgICAgICAgICAgdmFyIHMgPSB0eXBlb2YgdmFsdWUsCiAgICAgICAgICAgICAgICBvc3RyID0gY29yZS50b1N0cmluZy5jYWxsKHZhbHVlKTsKCiAgICAgICAgICAgIGlmIChzID09PSAnb2JqZWN0JyB8fCBzID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAob3N0ciA9PT0gJ1tvYmplY3QgQXJyYXldJykgewogICAgICAgICAgICAgICAgICAgICAgICBzID0gJ2FycmF5JzsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBvc3RyID09PSAnW29iamVjdCBUZXh0XScgfHwgb3N0ci5tYXRjaChyRWxlbWVudE9iamVjdCkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSAnZWxlbWVudCc7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvc3RyID09PSAnW29iamVjdCBIVE1MQ29sbGVjdGlvbl0nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSAnY29sbGVjdGlvbic7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvc3RyID09PSAnW29iamVjdCBOb2RlTGlzdF0nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSAnbm9kZWxpc3QnOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3N0ciA9PT0gJ1tvYmplY3QgQXJndW1lbnRzXScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcyA9ICdhcmd1bWVudHMnOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3N0ciA9PT0gJ1tvYmplY3QgUmVnRXhwXScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcyA9ICdyZWdleHAnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcyA9ICdudWxsJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gczsKICAgICAgICB9LAoKICAgICAgICB3YWl0Rm9yIDogZnVuY3Rpb24gd2FpdEZvcihpbmZvKSB7CiAgICAgICAgICAgIHZhciB2ZXJpZmllciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH0sCiAgICAgICAgICAgICAgICBkb25lID0gaW5mbyA/IGluZm8uZG9uZSA6IG51bGwsCiAgICAgICAgICAgICAgICBpLCBzZWxlY3RvciwgY29udGV4dCwgd2FpdEZvckludGVydmFsOwoKICAgICAgICAgICAgaWYgKGluZm8gPT0gbnVsbCB8fCB0eXBlb2YgZG9uZSAhPT0gJ2Z1bmN0aW9uJykgeyByZXR1cm47IH0KCiAgICAgICAgICAgIHN3aXRjaCAoIEpTTC50eXBlT2YoaW5mby5zZWxlY3RvcikgKSB7CiAgICAgICAgICAgICAgICBjYXNlICdzdHJpbmcnOiBjYXNlICdlbGVtZW50JzogY2FzZSAnYXJyYXknOiB7CiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3IgPSBpbmZvLnNlbGVjdG9yOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZGVmYXVsdDogewogICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJvcignSW52YWxpZCBzZWxlY3RvciBwYXNzZWQgdG8gSlNMLndhaXRGb3IoKScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBzd2l0Y2ggKCBKU0wudHlwZU9mKGluZm8uY29udGV4dCkgKSB7CiAgICAgICAgICAgICAgICBjYXNlICdzdHJpbmcnOiBjYXNlICdlbGVtZW50JzogY2FzZSAnYXJyYXknOiB7CiAgICAgICAgICAgICAgICAgICAgY29udGV4dCA9IGluZm8uY29udGV4dDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHR5cGVvZiBpbmZvLnZlcmlmaWVyID09PSAnZnVuY3Rpb24nICYmIGluZm8udmVyaWZpZXIudG9TdHJpbmcoKS5pbmRleE9mKCdyZXR1cm4gJykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICB2ZXJpZmllciA9IGluZm8udmVyaWZpZXI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIGNsZWFyKCkgewogICAgICAgICAgICAgICAgSlNMLmNsZWFySW50ZXJ2YWwod2FpdEZvckludGVydmFsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2soKSB7CiAgICAgICAgICAgICAgICB2YXIgZWxlbSA9IEpTTChzZWxlY3RvciwgY29udGV4dCk7CgogICAgICAgICAgICAgICAgaWYgKGVsZW0uZXhpc3RzICYmIHZlcmlmaWVyKGVsZW0pID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgZG9uZShlbGVtKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xlYXIoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoaSA+PSAxNTApIHsgLy8gY2hlY2sgZm9yIDMwIHNlY29uZHMgbWF4CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNsZWFyKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICB3YWl0Rm9ySW50ZXJ2YWwgPSBKU0wuc2V0SW50ZXJ2YWwoY2hlY2ssIDIwMCk7CiAgICAgICAgfSwKCiAgICAgICAgeHBhdGggOiBmdW5jdGlvbiB4cGF0aChvYmopIHsKICAgICAgICAgICAgdmFyIHR5cGUgPSBvYmoudHlwZSB8fCA3LAogICAgICAgICAgICAgICAgdHlwZXMgPSB7CiAgICAgICAgICAgICAgICAgICAgJzEnIDogJ251bWJlclZhbHVlJywKICAgICAgICAgICAgICAgICAgICAnMicgOiAnc3RyaW5nVmFsdWUnLAogICAgICAgICAgICAgICAgICAgICczJyA6ICdib29sZWFuVmFsdWUnLAogICAgICAgICAgICAgICAgICAgICc4JyA6ICdzaW5nbGVOb2RlVmFsdWUnLAogICAgICAgICAgICAgICAgICAgICc5JyA6ICdzaW5nbGVOb2RlVmFsdWUnCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZXhwcmVzc2lvbiA9IG9iai5leHByZXNzaW9uLAogICAgICAgICAgICAgICAgY29udGV4dCA9IG9iai5jb250ZXh0IHx8IGRvY3VtZW50LAogICAgICAgICAgICAgICAgZG9jID0gZG9jdW1lbnQsIHhwOwoKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29udGV4dC5ldmFsdWF0ZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgICAgIGRvYyA9IGNvbnRleHQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb250ZXh0Lm93bmVyRG9jdW1lbnQuZXZhbHVhdGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgICAgICBkb2MgPSBjb250ZXh0Lm93bmVyRG9jdW1lbnQ7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgeHAgPSBkb2MuZXZhbHVhdGUoZXhwcmVzc2lvbiwgY29udGV4dCwgbnVsbCwgdHlwZSwgbnVsbCk7CgogICAgICAgICAgICBpZiAoIWV4cHJlc3Npb24pIHsKICAgICAgICAgICAgICAgIGVycm9yKCdBbiBleHByZXNzaW9uIG11c3QgYmUgc3VwcGxpZWQgZm9yIEpTTC54cGF0aCgpJyk7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCB0eXBlc1t0eXBlXSApIHsKICAgICAgICAgICAgICAgIHJldHVybiB4cFsgdHlwZXNbIHR5cGUgXSBdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIEpTTC50b0FycmF5KHhwKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwoKICAgIC8vIGFzc2lnbiBKU0wgdG8gdGhlIHdpbmRvdyBvYmplY3QKICAgIGlmICh0eXBlb2Ygd2luZG93LkpTTCAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgIC8vIGlmIGl0IGRvZXNuJ3QgZXhpc3QsIGp1c3QgYWRkIGl0CiAgICAgICAgd2luZG93LkpTTCA9IEpTTDsKICAgICAgICB3aW5kb3cuX0ogPSBKU0w7CiAgICB9IGVsc2UgaWYgKHdpbmRvdy5KU0wuZm4gJiYgd2luZG93LkpTTC5mbi52ZXJzaW9uKSB7CiAgICAgICAgLy8gaWYgaXQgYWxyZWFkeSBleGlzdHMsIG9ubHkgcmVwbGFjZSBpdCB3aXRoIGEgbmV3ZXIsIHlldAogICAgICAgIC8vIGJhY2t3YXJkcyBjb21wYXRpYmxlIHZlcnNpb24gKGNoZWNrIGZvciBzYW1lIG1ham9yIHZlcnNpb24pCiAgICAgICAgaWYgKCB3aW5kb3cuSlNMLmZuLnZlcnNpb24uc3Vic3RyaW5nKCAwLCB3aW5kb3cuSlNMLmZuLnZlcnNpb24uaW5kZXhPZignLicpICkKICAgICAgICAgICAgPT09IHZlcnNpb24uc3Vic3RyaW5nKCAwLCB2ZXJzaW9uLmluZGV4T2YoJy4nKSApICkgewogICAgICAgICAgICB3aW5kb3cuSlNMID0gSlNMOwogICAgICAgICAgICB3aW5kb3cuX0ogPSBKU0w7CiAgICAgICAgfQogICAgfQoKICAgIC8vIGp1c3QgZm9yIHRlc3RpbmcgcHVycG9zZXMKICAgIC8vIHVuc2FmZVdpbmRvdy5KU0wgPSB1bnNhZmVXaW5kb3cuX0ogPSBKU0w7Cgp9KHdpbmRvdykpOwoKCgovLyBKU0wgdGVzdCBidXR0b24KLy8gdXNlIGl0IHRvIHRlc3QgY29kZSBvbiB1c2VyIGNsaWNrIChub24tYXV0b21hdGljKQovKgooZnVuY3Rpb24gKCkgewogICAgdmFyIG1vID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykgewogICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChtdXRhdGlvbikgewogICAgICAgICAgICB2YXIgdGFyZ2V0ID0gbXV0YXRpb24udGFyZ2V0OwoKICAgICAgICAgICAgaWYgKG11dGF0aW9uLmF0dHJpYnV0ZU5hbWUgPT09ICd2YWx1ZScgJiYgdGFyZ2V0LnZhbHVlICE9PSAnUnVuIEpTTCB0ZXN0JykgewogICAgICAgICAgICAgICAgdGFyZ2V0LnZhbHVlID0gJ1J1biBKU0wgdGVzdCc7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0pOwoKICAgIEpTTChkb2N1bWVudC5ib2R5KS5hcHBlbmQoCiAgICAgICAgJ2lucHV0JywKICAgICAgICB7CiAgICAgICAgICAgIGlkIDogJ2pzbF91c2VyX3Rlc3QnLAogICAgICAgICAgICB0eXBlIDogJ2J1dHRvbicsCiAgICAgICAgICAgIHZhbHVlIDogJ1J1biBKU0wgdGVzdCcsCiAgICAgICAgICAgIHN0eWxlIDogJ2Rpc3BsYXk6IGJsb2NrOyBwb3NpdGlvbjogZml4ZWQ7IHRvcDogNHB4OyByaWdodDogNHB4OyB6LWluZGV4OiA5OTk5OTk7IHBhZGRpbmc6IDJweCAxNHB4OyBmb250LXNpemU6IDExcHQ7IGZvbnQtZmFtaWx5OiBBcmlhbCwgVmVyZGFuYTsnLAogICAgICAgICAgICBvbmNsaWNrIDogZnVuY3Rpb24gKCkgewoKICAgICAgICAgICAgLy8gLS0tLSBFTlRFUiBPTkNMSUNLIENPREUgSEVSRSAtLS0tCiAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgSlNMKGRvY3VtZW50LmJvZHkpLmFwcGVuZCgnPGRpdiBpZD0id2FpdEZvclRlc3QiPklcJ20gYSBKU0wud2FpdEZvcigpIHRlc3QgRElWITwvZGl2PicpOwogICAgICAgICAgICAgICAgfSwgMTUwMCk7CgogICAgICAgICAgICAgICAgSlNMLndhaXRGb3IoewogICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yIDogJyN3YWl0Rm9yVGVzdCcsCiAgICAgICAgICAgICAgICAgICAgZG9uZSA6IGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCcjd2FpdEZvclRlc3QgaXMgbG9hZGVkIScpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICk7CgogICAgbW8ub2JzZXJ2ZSggSlNMKCcjanNsX3VzZXJfdGVzdCcpWzBdLCB7IGF0dHJpYnV0ZXMgOiB0cnVlIH0gKTsKfSgpKTsKKi8KCg=="},{"meta":{"name":"JSL%20-%20AJAX%20plugin.js","url":"https://greasyfork.org/scripts/2817-jsl-ajax-plugin/code/JSL%20-%20AJAX%20plugin.js?version=7911","ts":1685023546975,"mimetype":"text/javascript"},"source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgSlNMIC0gQUpBWCBwbHVnaW4KLy8gQG5hbWVzcGFjZSAgICAgaHR0cDovL3VzZXJzY3JpcHRzLm9yZy91c2Vycy8yMzY1MgovLyBAZGVzY3JpcHRpb24gICBBbiBBSkFYIHBsdWdpbiBmb3IgSlNMCi8vIEBpbmNsdWRlICAgICAgICoKLy8gQHZlcnNpb24gICAgICAgMS4xLjAKLy8gQGdyYW50ICAgICAgICAgR01feG1saHR0cFJlcXVlc3QKLy8gPT0vVXNlclNjcmlwdD09CgovKiBDSEFOR0VMT0cKCjEuMS4wICgzLzI4LzIwMTQpCiAgICAtIGFkZGVkIEpTTC5hamF4Q2xlYXIoKSB0byBjbGVhciBhbGwgY3VycmVudCBhbmQgcGVuZGluZyByZXF1ZXN0cwoKMS4wLjIxICgxMC82LzIwMTMpCiAgICAtIGZpeGVkIGJ1ZyB3aXRoIC5jbGVhcigpCgoxLjAuMiAoMTAvNi8yMDEzKQogICAgLSBhZGRlZCBhIG5ldyBvcHRpb246IGFzeW5jCiAgICAgICAgZmFsc2UgKGRlZmF1bHQpID09PiBzeW5jaHJvbm91cywgYnV0IG5vbi1mcmVlemluZyByZXF1ZXN0cyAoc2VxdWVudGlhbCkKICAgICAgICAgICAgd2FpdHMgZm9yIHByZXZpb3VzIHJlcXVlc3QgdG8gZmluaXNoIGJlZm9yZSBzdGFydGluZyBhIG5ldyBvbmUKICAgICAgICB0cnVlID09PiBzZW5kcyBhbGwgcmVxdWVzdHMgaW1tZWRpYXRlbHkgd2hlbiB0aGV5IGFyZSBhZGRlZCB0byB0aGUgcXVldWUKICAgIC0gZml4ZWQgZGVsYXkgaXNzdWUuCiAgICAgICAgdGhlIG5leHQgcmVxdWVzdCB3b3VsZCBnZXQgcnVuIG9uIHRoZSAnb25wcm9ncmVzcycgJiAnb25yZWFkeXN0YXRlY2hhbmdlJyBldmVudHMKICAgICAgICBpbnN0ZWFkIG9mIHdoZW4gdGhleSBhY3R1YWxseSBsb2FkIGZ1bGx5CiAgICAtIGFkZGVkIGEgLmNsZWFyKCkgbWV0aG9kCiAgICAgICAgaXQgbWF5IGJlIGNhbGxlZCBvbiBhbnkgYWpheCBpbnN0YW5jZSBsaWtlIEpTTC5hamF4KC4uLikuY2xlYXIoKQogICAgICAgIGl0IGNhbiBldmVuIHNpbXBseSBiZSBjYWxsZWQgYXMgSlNMLmFqYXgoKS5jbGVhcigpCiAgICAgICAgaXQgd2lsbCBjbGVhciBBTEwgcmVxdWVzdHMgYXQgdGhlIG1vbWVudAoKMS4wLjEgKDEwLzMvMjAxMykKICAgIC0gZml4ZWQgc21hbGwgYnVnIHdpdGggcGFzc2luZyBhIHVybCBhcnJheQogICAgLSBmaXhlZCBidWcgbm90IGFsbG93aW5nIEhFQUQgcmVxdWVzdHMgdG8gYmUgcmVjb2duaXplZAoKMS4wLjAgKDEwLzEvMjAxMykKICAgIC0gY3JlYXRlZAoKKi8KCihmdW5jdGlvbiAodW5kZWZpbmVkKSB7CgogICAgJ3VzZSBzdHJpY3QnOyAvLyB1c2Ugc3RyaWN0IG1vZGUgaW4gRUNNQVNjcmlwdC01CgogICAgdmFyIHF1ZXVlID0gW10sICAgICAgICAgICAgICAgLy8gdGhlIHJlcXVlc3QgcXVldWUKICAgICAgICBibGFuayA9IGZ1bmN0aW9uICgpIHt9LCAgIC8vIGJsYW5rIGZ1bmN0aW9uIHRvIHVzZSBhcyBkZWZhdWx0IGNhbGxiYWNrCiAgICAgICAgeGhySW5Qcm9ncmVzcyA9IGZhbHNlLCAgICAvLyBib29sZWFuIHRvIGtub3cgaWYgd2Ugc2hvdWxkIGxvYWQgdGhlIG5leHQgcmVxdWVzdAogICAgICAgIHhockNsZWFyZWQgPSBmYWxzZTsgICAgICAgLy8gYm9vbGVhbiB0byBrbm93IGlmIHRoZSB4aHIgaGFzIGJlZW4gY2xlYXJlZCBhbmQgaWYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB3ZSBzaG91bGQgZXhlY3V0ZSBhbnkgb2YgdGhlIGNhbGxiYWNrcwoKICAgIHZhciBjb3JlID0gewogICAgICAgIC8vIG9iamVjdAogICAgICAgICdoYXNPd25Qcm9wZXJ0eScgOiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5CiAgICB9OwoKICAgIGZ1bmN0aW9uIGNvcHlPYmplY3QobykgewogICAgICAgIHZhciBrZXksIHZhbHVlLCBuZXdPID0ge307CgogICAgICAgIGZvciAoa2V5IGluIG8pIHsKICAgICAgICAgICAgdmFsdWUgPSBvW2tleV07CgogICAgICAgICAgICBpZiAoY29yZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIGtleSkgJiYgdmFsdWUgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgbmV3T1trZXldID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBuZXdPOwogICAgfQoKICAgIGZ1bmN0aW9uIHRvRGF0YVN0cmluZyhvKSB7CiAgICAgICAgdmFyIGtleSwgdmFsdWUsIGRhdGFTdHJpbmcgPSAnJzsKCiAgICAgICAgZm9yIChrZXkgaW4gbykgewogICAgICAgICAgICB2YWx1ZSA9IG9ba2V5XTsKCiAgICAgICAgICAgIGlmIChjb3JlLmhhc093blByb3BlcnR5LmNhbGwobywga2V5KSAmJiB2YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBkYXRhU3RyaW5nICs9IGtleSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgKyAnJic7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBkYXRhU3RyaW5nLnNsaWNlKDAsIC0xKTsKICAgIH0KCiAgICBmdW5jdGlvbiB4aHIoKSB7CiAgICAgICAgdmFyIHJlcSA9IHF1ZXVlWzBdLCAvLyBnZXQgdGhlIG9iamVjdCB3aGljaCBpcyBmaXJzdCBpbiB0aGUgcXVldWUKICAgICAgICAgICAgeGhyT2JqID0ge30sIGtleTsKCiAgICAgICAgZnVuY3Rpb24gaGFuZGxlRXZlbnRzKHR5cGUsIHJlc3AsIGV2ZW50KSB7CiAgICAgICAgICAgIHZhciBldmVudCA9IGV2ZW50IHx8IHt9LCBuZXdSZXNwLCBjb250ZXh0OwogICAgICAgICAgICAgICAgcmVxLmRlbGF5ID0gcmVxLmRlbGF5ID4gMTUgPyByZXEuZGVsYXkgOiAxNTsgLy8gZG9uJ3Qgd2FudCB0byBtZXNzIHVwIGNhbGxiYWNrcwoKICAgICAgICAgICAgaWYgKHhockNsZWFyZWQgPT09IHRydWUpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHJlcVt0eXBlXSAhPT0gYmxhbmspIHsKICAgICAgICAgICAgICAgIC8vIGRlZmluZSBhIG5ldyByZXNwb25zZSBvYmplY3QgdG8gZ2l2ZSB0byB0aGUgdXNlcgogICAgICAgICAgICAgICAgbmV3UmVzcCA9IHsKICAgICAgICAgICAgICAgICAgICBsZW5ndGhDb21wdXRhYmxlIDogcmVzcC5sZW5ndGhDb21wdXRhYmxlIHx8IGV2ZW50Lmxlbmd0aENvbXB1dGFibGUgfHwgbnVsbCwKICAgICAgICAgICAgICAgICAgICBsb2FkZWQgOiByZXNwLmxvYWRlZCB8fCBldmVudC5sb2FkZWQgfHwgbnVsbCwKICAgICAgICAgICAgICAgICAgICByZWFkeVN0YXRlIDogcmVzcC5yZWFkeVN0YXRlLAogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlSGVhZGVycyA6IHJlc3AucmVzcG9uc2VIZWFkZXJzIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICggdHlwZW9mIHJlc3AuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzID09PSAnZnVuY3Rpb24nID8gcmVzcC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSA6IG51bGwpIHx8ICcnLAogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlVGV4dCA6IHJlc3AucmVzcG9uc2VUZXh0LAogICAgICAgICAgICAgICAgICAgIHN0YXR1cyA6IHJlc3Auc3RhdHVzLAogICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQgOiByZXNwLnN0YXR1c1RleHQsCiAgICAgICAgICAgICAgICAgICAgdG90YWwgOiByZXNwLnRvdGFsIHx8IGV2ZW50LnRvdGFsIHx8IG51bGwsCiAgICAgICAgICAgICAgICAgICAgdXJsIDogcmVzcC5maW5hbFVybCB8fCByZXEudXJsLAogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAvLyBhbGxvdyBuZXcgcmVxdWVzdHMgdG8gYmUgcnVuIGlmIG91ciByZXF1ZXN0IGlzIGRvbmUKICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnb25lcnJvcicgfHwgdHlwZSA9PT0gJ29ubG9hZCcpIHsKICAgICAgICAgICAgICAgICAgICB4aHJJblByb2dyZXNzID0gZmFsc2U7CgogICAgICAgICAgICAgICAgICAgIC8vIHJ1biB0aGUgbmV4dCBpbiBxdWV1ZSwgaWYgYW55CiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoeGhyLCByZXEuZGVsYXkpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIHJ1biB0aGUgY2FsbGJhY2sKICAgICAgICAgICAgICAgIGNvbnRleHQgPSByZXEuY29udGV4dCB8fCBuZXdSZXNwOwogICAgICAgICAgICAgICAgcmVxW3R5cGVdLmNhbGwoY29udGV4dCwgbmV3UmVzcCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICggcmVxICYmICh4aHJJblByb2dyZXNzID09PSBmYWxzZSB8fCByZXEuYXN5bmMgPT09IHRydWUpICYmIHF1ZXVlLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgLy8gbWFrZSBpdCBzbyBubyBvdGhlciByZXF1ZXN0cyBnZXQgcnVuIHdoaWxlIHdlCiAgICAgICAgICAgIC8vIHJ1biB0aGlzIG9uZSwgaWYgYXN5bmMgaXNuJ3QgZW5hYmxlZAogICAgICAgICAgICB4aHJJblByb2dyZXNzID0gdHJ1ZTsKCiAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgZmlyc3QgaXRlbSBpbiB0aGUgcXVldWUgaWYgaXQgaXMgZ29pbmcgdG8gYmUgcnVuCiAgICAgICAgICAgIHF1ZXVlLnNoaWZ0KCk7CgogICAgICAgICAgICBpZiAodHlwZW9mIEdNX3htbGh0dHBSZXF1ZXN0ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICBpZiAocmVxLm1ldGhvZC50b1VwcGVyQ2FzZSgpID09PSAnR0VUJyAmJiByZXEuZGF0YSAhPT0gJycpIHsKICAgICAgICAgICAgICAgICAgICByZXEudXJsICs9ICc/JyArIHJlcS5kYXRhOwogICAgICAgICAgICAgICAgICAgIHJlcS5kYXRhID0gJyc7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgR01feG1saHR0cFJlcXVlc3QoewogICAgICAgICAgICAgICAgICAgICdkYXRhJyA6IHJlcS5kYXRhLAogICAgICAgICAgICAgICAgICAgICdoZWFkZXJzJyA6IHJlcS5oZWFkZXJzLAogICAgICAgICAgICAgICAgICAgICdtZXRob2QnIDogcmVxLm1ldGhvZCwKICAgICAgICAgICAgICAgICAgICAnb25lcnJvcicgOiBmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVFdmVudHMoJ29uZXJyb3InLCByZXNwKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICdvbmxvYWQnIDogZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXZlbnRzKCdvbmxvYWQnLCByZXNwKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICdvbnJlYWR5c3RhdGVjaGFuZ2UnIDogZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXZlbnRzKCdvbnJlYWR5c3RhdGVjaGFuZ2UnLCByZXNwKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICdvbnByb2dyZXNzJyA6IGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUV2ZW50cygnb25wcm9ncmVzcycsIHJlc3ApOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgJ3VybCcgOiByZXEudXJsLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIFhNTEh0dHBSZXF1ZXN0ID09PSAnZnVuY3Rpb24nIHx8IHR5cGVvZiBBY3RpdmVYT2JqZWN0ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICB4aHJPYmogPSBYTUxIdHRwUmVxdWVzdCA/IG5ldyBYTUxIdHRwUmVxdWVzdCgpIDogbmV3IEFjdGl2ZVhPYmplY3QoJ01pY3Jvc29mdC5YTUxIVFRQJyk7CgogICAgICAgICAgICAgICAgLy8gc2V0IGV2ZW50cwogICAgICAgICAgICAgICAgeGhyT2JqLm9ubG9hZCA9IGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXZlbnRzKCdvbmxvYWQnLCB4aHJPYmopOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHhock9iai5vbmVycm9yID0gZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVFdmVudHMoJ29uZXJyb3InLCB4aHJPYmopOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHhock9iai5vbnByb2dyZXNzID0gZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVFdmVudHMoJ29ucHJvZ3Jlc3MnLCB4aHJPYmosIHJlc3ApOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBpZiAocmVxLm1pbWVUeXBlICE9PSAnJykgewogICAgICAgICAgICAgICAgICAgIHhock9iai5vdmVycmlkZU1pbWVUeXBlKHJlcS5taW1lVHlwZSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gYWRkIGhlYWRlcnMKICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIHJlcS5oZWFkZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgeGhyT2JqLnNldFJlcXVlc3RIZWFkZXIoIGtleSwgcmVxLmhlYWRlcnNba2V5XSApOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHhock9iai5vcGVuKHJlcS5tZXRob2QsIHJlcS51cmwsIHRydWUpOwogICAgICAgICAgICAgICAgeGhyT2JqLnNlbmQoIChyZXEuZGF0YSB8fCBudWxsKSApOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGluaXQodXJsLCBzZXR0aW5ncykgewogICAgICAgIHZhciB1cmxzID0gW10sCiAgICAgICAgICAgIHJlYWxTZXR0aW5ncyA9IHsgLy8gZGVmYXVsdHMKICAgICAgICAgICAgICAgIGFzeW5jIDogZmFsc2UsCiAgICAgICAgICAgICAgICBkYXRhIDogJycsCiAgICAgICAgICAgICAgICBoZWFkZXJzIDoge30sCiAgICAgICAgICAgICAgICBtZXRob2QgOiAnR0VUJywKICAgICAgICAgICAgICAgIG1pbWVUeXBlIDogJycsCiAgICAgICAgICAgICAgICBvbmxvYWQgOiBibGFuaywKICAgICAgICAgICAgICAgIG9uZXJyb3IgOiBibGFuaywKICAgICAgICAgICAgICAgIG9ucHJvZ3Jlc3MgOiBibGFuaywKICAgICAgICAgICAgICAgIG9ucmVhZHlzdGF0ZWNoYW5nZSA6IGJsYW5rLAogICAgICAgICAgICAgICAgZGVsYXkgOiAwCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGtleSwgdmFsdWU7CgogICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAnc3RyaW5nJykgewogICAgICAgICAgICB1cmxzLnB1c2godXJsKTsKICAgICAgICB9IGVsc2UgaWYgKEpTTC50eXBlT2YodXJsKSA9PT0gJ2FycmF5JykgewogICAgICAgICAgICB1cmxzID0gdXJscy5jb25jYXQodXJsKTsKICAgICAgICB9CgogICAgICAgIGlmIChKU0wudHlwZU9mKHNldHRpbmdzKSA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgZm9yIChrZXkgaW4gc2V0dGluZ3MpIHsKICAgICAgICAgICAgICAgIHZhbHVlID0gc2V0dGluZ3Nba2V5XTsKCiAgICAgICAgICAgICAgICBzd2l0Y2ggKGtleSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FzeW5jJzogewogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWxTZXR0aW5nc1trZXldID0gdmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NvbnRleHQnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFsU2V0dGluZ3Nba2V5XSA9IHZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlICdkYXRhJzogewogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbFNldHRpbmdzW2tleV0gPSB2YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChKU0wudHlwZU9mKHZhbHVlKSA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWxTZXR0aW5nc1trZXldID0gdG9EYXRhU3RyaW5nKHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGVsYXknOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIHZhbHVlID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbFNldHRpbmdzW2tleV0gPSB2YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaGVhZGVycyc6IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEpTTC50eXBlT2YodmFsdWUpID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbFNldHRpbmdzW2tleV0gPSB0b0RhdGFTdHJpbmcodmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlICdtZXRob2QnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiAvZ2V0fHBvc3R8aGVhZC9pLnRlc3QodmFsdWUpICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbFNldHRpbmdzW2tleV0gPSB2YWx1ZS50b1VwcGVyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlICdtaW1lVHlwZSc6IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWxTZXR0aW5nc1trZXldID0gdmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ29ubG9hZCc6IGNhc2UgJ29uZXJyb3InOiBjYXNlICdvbnJlYWR5c3RhdGVjaGFuZ2UnOiBjYXNlICdvbnByb2dyZXNzJzogewogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFsU2V0dGluZ3Nba2V5XSA9IHZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gYWRkIGFuIG9iamVjdCB0byB0aGUgcXVldWUgZm9yIGVhY2ggdXJsCiAgICAgICAgaWYgKHVybHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBKU0wuZWFjaCh1cmxzLCBmdW5jdGlvbiAodXJsKSB7CiAgICAgICAgICAgICAgICB2YXIgbmV3TyA9IGNvcHlPYmplY3QocmVhbFNldHRpbmdzKTsKICAgICAgICAgICAgICAgIG5ld08udXJsID0gdXJsOwogICAgICAgICAgICAgICAgcXVldWUucHVzaChuZXdPKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBlbmFibGUgYWpheCBpZiBpdCB3YXMgY2xlYXJlZCBlYXJsaWVyCiAgICAgICAgICAgIHhockNsZWFyZWQgPSBmYWxzZTsKCiAgICAgICAgICAgIC8vIHJ1biB0aGUgeGhyIGZ1bmN0aW9uCiAgICAgICAgICAgIC8vIGl0IHdpbGwgZGV0ZXJtaW5lIHdoZXRoZXIgb3Igbm90IGEgcmVxdWVzdCBuZWVkcyB0byBiZSBzZW50CiAgICAgICAgICAgIHhocigpOwogICAgICAgIH0KICAgIH0KCiAgICBpbml0LnByb3RvdHlwZSA9IHsKICAgICAgICBjb25zdHJ1Y3RvcjogaW5pdCwKCiAgICAgICAgY2xlYXIgOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcXVldWUubGVuZ3RoID0gMDsKICAgICAgICAgICAgeGhySW5Qcm9ncmVzcyA9IGZhbHNlOwogICAgICAgICAgICB4aHJDbGVhcmVkID0gdHJ1ZTsKICAgICAgICB9LAoKICAgICAgICBnZXQgbGVuZ3RoKCkgewogICAgICAgICAgICByZXR1cm4gcXVldWUubGVuZ3RoOwogICAgICAgIH0KICAgIH07CgogICAgSlNMLmV4dGVuZCh7CiAgICAgICAgYWpheCA6IGZ1bmN0aW9uICh1cmwsIHNldHRpbmdzKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgaW5pdCh1cmwsIHNldHRpbmdzKTsKICAgICAgICB9LAogICAgICAgIGFqYXhDbGVhciA6IGluaXQucHJvdG90eXBlLmNsZWFyCiAgICB9KTsKCn0oKSk7"}]},{"name":"SnowLord7's Quizlet Exploit","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["quizlet.com","*://quizlet.com","*://*.quizlet.com","*://quizlet.com/*/learn","*://quizlet.com/*/spell","*://quizlet.com/*/match","*://quizlet.com/*/write","*://quizlet.com/*/micromatch","*://quizlet.com/*/test","*://quizlet.com/*/flashcards","*://quizlet.com/*/gravity","*://quizlet.com/live"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685023838412,"data":{}},"enabled":true,"position":15,"file_url":"https://greasyfork.org/scripts/393970-snowlord7-s-quizlet-exploit/code/SnowLord7's%20Quizlet%20Exploit.user.js","uuid":"0436c074-8a0f-4cd2-a9f7-aa890cc279b4","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgIFNub3dMb3JkNydzIFF1aXpsZXQgRXhwbG9pdAovLyBAZGVzY3JpcHRpb24gICAgV29ya3Mgb24gYW55IFF1aXpsZXQgZ2FtZW1vZGUKLy8gQGF1dGhvciAgICAgICAgIERyZXdTbm93Ci8vIEBtYXRjaCAgICAgICAgICBxdWl6bGV0LmNvbQovLyBAbWF0Y2ggICAgICAgICAgKjovL3F1aXpsZXQuY29tCi8vIEBtYXRjaCAgICAgICAgICAqOi8vKi5xdWl6bGV0LmNvbQovLyBAbWF0Y2ggICAgICAgICAgKjovL3F1aXpsZXQuY29tLyovbGVhcm4KLy8gQG1hdGNoICAgICAgICAgICo6Ly9xdWl6bGV0LmNvbS8qL3NwZWxsCi8vIEBtYXRjaCAgICAgICAgICAqOi8vcXVpemxldC5jb20vKi9tYXRjaAovLyBAbWF0Y2ggICAgICAgICAgKjovL3F1aXpsZXQuY29tLyovd3JpdGUKLy8gQG1hdGNoICAgICAgICAgICo6Ly9xdWl6bGV0LmNvbS8qL21pY3JvbWF0Y2gKLy8gQG1hdGNoICAgICAgICAgICo6Ly9xdWl6bGV0LmNvbS8qL3Rlc3QKLy8gQG1hdGNoICAgICAgICAgICo6Ly9xdWl6bGV0LmNvbS8qL2ZsYXNoY2FyZHMKLy8gQG1hdGNoICAgICAgICAgICo6Ly9xdWl6bGV0LmNvbS8qL2dyYXZpdHkKLy8gQG1hdGNoICAgICAgICAgICo6Ly9xdWl6bGV0LmNvbS9saXZlCi8vIEB2ZXJzaW9uICAgICAgICAxLjAuNgovLyBAbmFtZXNwYWNlICAgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9lbi9zY3JpcHRzLzM5Mzk3MC1zbm93bG9yZDctcy1xdWl6bGV0LWV4cGxvaXQvY29kZQovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbigpIHsKICAgIGxldCBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICBlbGVtLnN0eWxlID0gYGNvbG9yOiAjMjVlMDAwOyBwb3NpdGlvbjogZml4ZWQ7IHotaW5kZXg6IDIxNDc0ODM2NDc7IHJpZ2h0OiAwOyBib3R0b206IDA7IHBhZGRpbmc6IDVweDsgY3Vyc29yOiBwb2ludGVyO2A7CiAgICBlbGVtLnRleHRDb250ZW50ID0gJ0luamVjdCc7CgogICAgZWxlbS5vbmNsaWNrID0gKCkgPT4gewogICAgICAgIGxldCB4ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgICAgeC5zcmMgPSAnaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL1Nub3dMb3JkNy9xdWl6bGV0QG1hc3Rlci9pbmRleC5qcyc7CiAgICAgICAgeC5vbmxvYWQgPSAoKSA9PiB7IHgucmVtb3ZlKCkgfTsKICAgICAgICAoZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmFwcGVuZENoaWxkKHgpOwoKICAgICAgICBlbGVtLnJlbW92ZSgpOwogICAgfQogICAgKGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5hcHBlbmRDaGlsZChlbGVtKTsKfSkoKTs="},{"name":"Quizlet gravity game cheat","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://quizlet.com/*/gravity"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685023916572,"data":{}},"enabled":true,"position":16,"file_url":"https://greasyfork.org/scripts/22815-quizlet-gravity-game-cheat/code/Quizlet%20gravity%20game%20cheat.user.js","uuid":"1b53c0a7-c6eb-482a-a2d0-c06a2202f3ac","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBRdWl6bGV0IGdyYXZpdHkgZ2FtZSBjaGVhdAovLyBAbmFtZXNwYWNlICAgIERhbmllbHYxMjMKLy8gQHZlcnNpb24gICAgICAyLjQKLy8gQGRlc2NyaXB0aW9uICBUaGUgY29ycmVjdCBhbnN3ZXIgcG9wcyB1cCBpbiB0aGUgYnJvd3NlciBjb25zb2xlIGFuZCB0aGUgcmVzdGFydCBidXR0b24gZG93biBsZWZ0Ci8vIEBhdXRob3IgICAgICAgWW91Ci8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly9xdWl6bGV0LmNvbS8qL2dyYXZpdHkKLy8gQGdyYW50ICAgICAgICBub25lCi8vID09L1VzZXJTY3JpcHQ9PQoKLy8gU2V0IHNldHRpbmdzIGFuZCBzdHVmZgppZighbG9jYWxTdG9yYWdlLmNoZWF0KXsKICAgIGxvY2FsU3RvcmFnZS5jaGVhdEF1dG9UeXBlID0gZmFsc2U7CiAgICBsb2NhbFN0b3JhZ2UuY2hlYXRBY3RpdmF0ZWQgPSAgdHJ1ZTsKfQoKLy8gc2VsZWN0b3JzLCBpZiBzb21ldGhpbmcgYnJlYWtzIHRoZXNlIHByb2JhYmx5IG5lZWRzIHVwZGF0aW5nCi8vIGdldCB3b3JkIGZyb20gYXN0ZXJvaWQKLy8gYnJva2VuIDE5LjA5LjE3IHNlbGVjdG9yID0gIiNHcmF2aXR5R2FtZVRhcmdldCA+IGRpdiA+IGRpdiA+IGRpdiA+IGRpdi5Nb2RlTGF5b3V0LWNvbnRlbnQgPiBkaXYgPiBkaXYuR3Jhdml0eUdhbWVwbGF5Vmlldy1pbm5lciA+IGRpdjpudGgtY2hpbGQoNSkgPiBkaXYgPiBkaXYgPiBkaXYgPiAuVGVybVRleHQgPiAuVGVybVRleHQiOwpzZWxlY3RvciA9ICJkaXYgPiBkaXYgPiBkaXYgPiAuVGVybVRleHQgPiAuVGVybVRleHQiOwoKLy8gb3V0cHV0U2VsZWN0b3IgPSAiI0dyYXZpdHlHYW1lVGFyZ2V0ID4gZGl2ID4gZGl2ID4gZGl2ID4gZGl2Lk1vZGVMYXlvdXQtY29udHJvbHMgPiBkaXYgPiBkaXYgPiBkaXYgPiBkaXYuTW9kZUNvbnRyb2xzLW1haW4gPiBkaXYuTW9kZUNvbnRyb2xzLWFjdGlvbnMgPiBkaXY6bnRoLWNoaWxkKDIpID4gZGl2ID4gYnV0dG9uID4gc3BhbiI7Cm91dHB1dFNlbGVjdG9yID0gIiNHcmF2aXR5TW9kZVRhcmdldCA+IGRpdiA+IGRpdiA+IGRpdiA+IGRpdi5Nb2RlTGF5b3V0LWNvbnRyb2xzID4gZGl2ID4gZGl2ID4gZGl2ID4gZGl2Lk1vZGVDb250cm9scy1tYWluID4gZGl2Lk1vZGVDb250cm9scy1hY3Rpb25zID4gZGl2Om50aC1jaGlsZCgyKSA+IGRpdiA+IGJ1dHRvbiA+IHNwYW4iOwoKaW5wdXRTZWxlY3RvciA9ICIjR3Jhdml0eUdhbWVUYXJnZXQgPiBkaXYgPiBkaXYgPiBkaXYgPiBkaXYuTW9kZUxheW91dC1jb250ZW50ID4gZGl2ID4gZGl2LkdyYXZpdHlHYW1lcGxheVZpZXctaW5uZXIgPiBkaXYuR3Jhdml0eUdhbWVwbGF5Vmlldy10eXBpbmdQcm9tcHQgPiBzcGFuID4gZGl2ID4gZGl2ID4gZGl2LkdyYXZpdHlUeXBpbmdQcm9tcHQtaW5wdXRXcmFwcGVyID4gdGV4dGFyZWEiOwoKaW5wdXRSZXBlYXRTZWxlY3RvciA9ICIjR3Jhdml0eUdhbWVUYXJnZXQgPiBkaXYgPiBkaXYgPiBkaXYgPiBkaXYuTW9kZUxheW91dC1jb250ZW50ID4gZGl2ID4gZGl2LkdyYXZpdHlHYW1lcGxheVZpZXctaW5uZXIgPiBkaXY6bnRoLWNoaWxkKDMpID4gZGl2ID4gZGl2ID4gZGl2ID4gZGl2LkdyYXZpdHlDb3B5VGVybVZpZXctaW5wdXRXcmFwcGVyID4gdGV4dGFyZWEiOwoKc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7CiAgICAvLyBjb25zb2xlLmxvZyh3b3Jkcyk7CiAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSAmJiBsb2NhbFN0b3JhZ2UuY2hlYXRBY3RpdmF0ZWQgPT0gInRydWUiKXsKICAgICAgICB0cmFuc2xhdGVkV29yZCA9IHdvcmRzW2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpLmlubmVySFRNTC5yZXBsYWNlKFJlZ0V4cCgKICAgICAgICAgICAgJzwhLS1bXFxzXFxTXSo/KD86LS0+KT8nCiAgICAgICAgICAgICsgJzwhLS0tKz4/JyAgLy8gQSBjb21tZW50IHdpdGggbm8gYm9keQogICAgICAgICAgICArICd8PCEoPyFbZERdW29PXVtjQ11bdFRdW3lZXVtwUF1bZUVdfFxcW0NEQVRBXFxbKVtePl0qPj8nCiAgICAgICAgICAgICsgJ3w8Wz9dW14+XSo+PycsICAvLyBBIHBzZXVkby1jb21tZW50CiAgICAgICAgICAgICdnJyksICIiKV07CiAgICAgICAgY29uc29sZS5sb2codHJhbnNsYXRlZFdvcmQpOwogICAgICAgIC8vIHVwZGF0ZSB0aGUgZmVlZGJhY2sgYnV0dG9uIHdpdGggb25lIG9mIG91ciB0cmFuc2xhdGVkIHdvcmRzCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvdXRwdXRTZWxlY3RvcikuaW5uZXJIVE1MID0gdHJhbnNsYXRlZFdvcmQ7CiAgICAgICAgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpbnB1dFNlbGVjdG9yKS52YWx1ZSA9PSAiIiAmJiBsb2NhbFN0b3JhZ2UuY2hlYXRBdXRvVHlwZSA9PSAidHJ1ZSIpewogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGlucHV0U2VsZWN0b3IpLnZhbHVlID0gdHJhbnNsYXRlZFdvcmQ7CiAgICAgICAgfQogICAgfQp9LCAxMDApOwoKLy8gUXVpemxldC5ncmF2aXR5TW9kZURhdGEudGVybXNbMF0uZGVmaW5pdGlvbiBnZXRzIGRhdGEgc3RyYWlnaHQgZnJvbSBxdWl6bGV0IDozCndvcmRzID0ge307CmZvcihpID0gMDsgaTxRdWl6bGV0LmdyYXZpdHlNb2RlRGF0YS50ZXJtcy5sZW5ndGg7IGkrKyl7CiAgICB3b3Jkc1tRdWl6bGV0LmdyYXZpdHlNb2RlRGF0YS50ZXJtc1tpXS53b3JkXSA9IFF1aXpsZXQuZ3Jhdml0eU1vZGVEYXRhLnRlcm1zW2ldLmRlZmluaXRpb247Cn0K"},{"name":"The Original Quizlet Breaker","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://quizlet.com/*/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685024777624,"data":{}},"enabled":true,"position":17,"file_url":"https://greasyfork.org/scripts/396071-the-original-quizlet-breaker/code/The%20Original%20Quizlet%20Breaker.user.js","uuid":"770a7794-478c-4f6a-980a-52e248c0e969","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBUaGUgT3JpZ2luYWwgUXVpemxldCBCcmVha2VyCi8vIEBuYW1lc3BhY2UgICAgVGhlTW9zdE9HTmFtZQovLyBAdmVyc2lvbiAgICAgIDEuMwovLyBAZGVzY3JpcHRpb24gIEhhY2sgUXVpemxldCBhbmQgZ2V0IG91dCBvZiB3b3JrISBRdWl6bGV0IHN0YW5kcyBubyBjaGFuY2UgYWdhaW5zdCB5b3UuIAovLyBAYXV0aG9yICAgICAgIFRoZU1vc3RPR05hbWUKLy8gQG1hdGNoICAgICAgICBodHRwczovL3F1aXpsZXQuY29tLyovKgovLyBAZ3JhbnQgICAgICAgIG5vbmUKLy8gQGxpY2Vuc2UgICAgICBBbGwgUmlnaHRzIFJlc2VydmVkCi8vID09L1VzZXJTY3JpcHQ9PQoKLy9JZ25vcmUgdGhlIHZhcmlhYmxlIGdyYXZpdHlTY29yZSBiZWNhdXNlIGl0IGRvZXNuJ3Qgd29yayBhbnkgbW9yZSwgYnV0IEkgZGVjaWRlZCB0byBrZWVwIHRoZSBjb2RlIGhlcmUKdmFyIGdyYXZpdHlTY29yZSwKCSBocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7CgkvLzxicj48YnI+PGJ1dHRvbiBjbGFzcz0iVUlCdXR0b24iIGlkPSJjdXN0b21XYWl0QnV0dG9uIiB0eXBlPSJidXR0b24iPjxzcGFuIGNsYXNzPSJVSUJ1dHRvbi13cmFwcGVyIj48c3Bhbj5JbmplY3Q8L3NwYW4+PC9zcGFuPjwvYnV0dG9uPgooZnVuY3Rpb24oKSB7Cglpbml0TG9hZCgpOwoJZnVuY3Rpb24gaW5pdExvYWQoKSB7CgkJaWYgKGhyZWYuaW5jbHVkZXMoInF1aXpsZXQuY29tIikpIHsKCQkJaWYgKGhyZWYuaW5jbHVkZXMoIi9sZWFybiIpKSB7CgkJCQljQWxlcnQoJzxoMj5HYW1lIE1vZGU6IExlYXJuPC9oMj5UaGFuayB5b3UgZm9yIHVzaW5nIFRoZU1vc3RPR05hbWUgUXVpemxldCBFeHBsb2l0PGJyPldpdGhvdXQgeW91LCB0aGlzIGV4cGxvaXQgd291bGRudCBiZSBwb3NzaWJsZS4gUGxlYXNlIG5vdGUgdGhhdCB0aGlzIGRvZXMgbm90IHdvcmsgYW55bW9yZS48YnI+PGg0Pkluc3RydWN0aW9uczo8L2g0Pkp1c3Qgd2FpdCBmb3IgdGhpcyBzY3JpcHQgdG8gZmluaXNoITxicj48YnI+PGJ1dHRvbiBjbGFzcz0iVUlCdXR0b24iIGlkPSJsZWFybkJ1dHRvbiIgdHlwZT0iYnV0dG9uIj48c3BhbiBjbGFzcz0iVUlCdXR0b24td3JhcHBlciI+PHNwYW4+SW5qZWN0PC9zcGFuPjwvc3Bhbj48L2J1dHRvbj4nKTsKCQkJCWdldElkKCJsZWFybkJ1dHRvbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oKSB7CgkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImN1c3RvbU1lc3NhZ2VDb250YWluZXIiKS5yZW1vdmUoKTsKCQkJCQlsZWFybigpOwoJCQkJfSk7CgoJCQl9IGVsc2UgaWYgKGhyZWYuaW5jbHVkZXMoIi9mbGFzaGNhcmRzIikpIHsKCQkJCWNBbGVydCgnPGgyPkdhbWUgTW9kZTogRmxhc2hjYXJkczwvaDI+VGhhbmsgeW91IGZvciB1c2luZyBUaGVNb3N0T0dOYW1lIFF1aXpsZXQgRXhwbG9pdDxicj5XaXRob3V0IHlvdSwgdGhpcyBleHBsb2l0IHdvdWxkbnQgYmUgcG9zc2libGUuPGJyPjxoND5DaGFuZ2Vsb2c6PC9oND4rIEFkZGVkIE1hdGNoIHRpbWUgZnJlZXplIGZvciByZWd1bGFyIG1hdGNoIGFuZCBkaWFncmFtczxicj4rIEFkZGVkIEdyYXZpdHkgc2NvcmUgZXhwbG9pdCB0byBnZXQgQU5ZIHNjb3JlIHlvdSB3YW50ITxicj4rIEFkZGVkIGN1c3RvbSBhbGVydCBib3g8YnI+KyBGaXhlZCBncmFwaGljczxicj4tIFJlbW92ZWQgdXNlbGVzcyBhbGVydCBib3hlcy48aDQ+SW5zdHJ1Y3Rpb25zOjwvaDQ+VW1tIHdoeSBhcmUgeW91IGhlcmU/IEdvIGNoZWF0IHNvbWV3aGVyZSBlbHNlLi4uPGJyPjxicj48YnV0dG9uIGNsYXNzPSJVSUJ1dHRvbiIgaWQ9ImZsYXNoY2FyZHNCdXR0b24iIHR5cGU9ImJ1dHRvbiI+PHNwYW4gY2xhc3M9IlVJQnV0dG9uLXdyYXBwZXIiPjxzcGFuPkluamVjdDwvc3Bhbj48L3NwYW4+PC9idXR0b24+Jyk7CgkJCQlnZXRJZCgiZmxhc2hjYXJkc0J1dHRvbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oKSB7CgkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImN1c3RvbU1lc3NhZ2VDb250YWluZXIiKS5yZW1vdmUoKTsKCQkJCX0pOwoJCQl9IGVsc2UgaWYgKGhyZWYuaW5jbHVkZXMoIi93cml0ZSIpKSB7CgkJCQljQWxlcnQoJzxoMj5HYW1lIE1vZGU6IFdyaXRlPC9oMj5UaGFuayB5b3UgZm9yIHVzaW5nIFRoZU1vc3RPR05hbWUgRXhwbG9pdDxicj5XaXRob3V0IHlvdSwgdGhpcyBleHBsb2l0IHdvdWxkbnQgYmUgcG9zc2libGUuPGJyPjxoND5JbnN0cnVjdGlvbnM6PC9oND5Zb3UgZG9udCBldmVuIGhhdmUgdG8gd2FpdCw8YnI+IHRoaXMgaXMgbXkgZmF2b3JpdGUgb25lIHRvIHdhdGNoITxicj48YnI+PGJ1dHRvbiBjbGFzcz0iVUlCdXR0b24iIGlkPSJ3cml0ZUJ1dHRvbiIgdHlwZT0iYnV0dG9uIj48c3BhbiBjbGFzcz0iVUlCdXR0b24td3JhcHBlciI+PHNwYW4+SW5qZWN0PC9zcGFuPjwvc3Bhbj48L2J1dHRvbj4nKTsKCQkJCWdldElkKCJ3cml0ZUJ1dHRvbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oKSB7CgkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImN1c3RvbU1lc3NhZ2VDb250YWluZXIiKS5yZW1vdmUoKTsKCQkJCQl3cml0ZSgpOwoJCQkJfSk7CgkJCX0gZWxzZSBpZiAoaHJlZi5pbmNsdWRlcygiL3NwZWxsIikpIHsKCQkJCWNBbGVydCgnPGgyPkdhbWUgTW9kZTogU3BlbGw8L2gyPlRoYW5rIHlvdSBmb3IgdXNpbmcgVGhlTW9zdE9HTmFtZSBRdWl6bGV0IEV4cGxvaXQ8YnI+V2l0aG91dCB5b3UsIHRoaXMgZXhwbG9pdCB3b3VsZG50IGJlIHBvc3NpYmxlLjxicj48aDQ+SW5zdHJ1Y3Rpb25zOjwvaDQ+SG9sZCBkb3duIGVudGVyIGFuZCB3YWl0Ljxicj48YnI+PGJ1dHRvbiBjbGFzcz0iVUlCdXR0b24iIGlkPSJzcGVsbEJ1dHRvbiIgdHlwZT0iYnV0dG9uIj48c3BhbiBjbGFzcz0iVUlCdXR0b24td3JhcHBlciI+PHNwYW4+SW5qZWN0PC9zcGFuPjwvc3Bhbj48L2J1dHRvbj4nKTsKCQkJCWdldElkKCJzcGVsbEJ1dHRvbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oKSB7CgkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImN1c3RvbU1lc3NhZ2VDb250YWluZXIiKS5yZW1vdmUoKTsKCQkJCQlzcGVsbCgpOwoJCQkJfSk7CgkJCX0gZWxzZSBpZiAoaHJlZi5pbmNsdWRlcygiL3Rlc3QiKSkgewoJCQkJY0FsZXJ0KCc8aDI+R2FtZSBNb2RlOiBUZXN0PC9oMj5UaGFuayB5b3UgZm9yIHVzaW5nIFRoZU1vc3RPR05hbWUgUXVpemxldCBFeHBsb2l0PGJyPldpdGhvdXQgeW91LCB0aGlzIGV4cGxvaXQgd291bGRudCBiZSBwb3NzaWJsZS48YnI+PGJyPjxoND5JbnN0cnVjdGlvbnM6PC9oND5SaWdodCBjbGljayB0byB0b2dnbGUgYW5zd2Vycy48YnI+KEJlIHN1YnRsZSB3aGVuIHVzaW5nKTxicj48YnI+PGJ1dHRvbiBjbGFzcz0iVUlCdXR0b24iIGlkPSJ0ZXN0QnV0dG9uIiB0eXBlPSJidXR0b24iPjxzcGFuIGNsYXNzPSJVSUJ1dHRvbi13cmFwcGVyIj48c3Bhbj5JbmplY3Q8L3NwYW4+PC9zcGFuPjwvYnV0dG9uPicpOwoJCQkJZ2V0SWQoInRlc3RCdXR0b24iKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKCkgewoJCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjdXN0b21NZXNzYWdlQ29udGFpbmVyIikucmVtb3ZlKCk7CgkJCQkJdGVzdE1vZGUoKTsKCQkJCX0pOwoJCQl9IGVsc2UgaWYgKGhyZWYuaW5jbHVkZXMoIi9taWNyb21hdGNoIikpIHsKCQkJCWNBbGVydCgnPGgyPkdhbWUgTW9kZTogTWljcm9tYXRjaDwvaDI+VGhhbmsgeW91IGZvciB1c2luZyBUaGVNb3N0T0dOYW1lIFF1aXpsZXQgRXhwbG9pdDxicj5XaXRob3V0IHlvdSwgdGhpcyBleHBsb2l0IHdvdWxkbnQgYmUgcG9zc2libGUuPGJyPjxoND5JbnN0cnVjdGlvbnM6PC9oND5UaGUgdGltZXIgd2lsbCBiZSBwYXVzZWQgd2hlbiBhdCBjaG9vc2VuIHRpbWUuPGJyPlRoZSBhbnN3ZXJzIHdpbGwgYWxzbyBiZSBoaWdobGlnaHRlZCBmb3IgeW91Ljxicj5BdCB5b3VyIGxlaXN1cmUsIHNvbHZlIHRoZSBxdWVzdGlvbnMuPGJyPjxoND5NYXRjaCBUaW1lOiA8L2g0PjxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0ibWF0Y2hUaW1lSW5wdXQiIHZhbHVlPSIwIj48L2lucHV0Pjxicj48YnI+PGJ1dHRvbiBjbGFzcz0iVUlCdXR0b24iIGlkPSJtaWNyb21hdGNoQnV0dG9uIiB0eXBlPSJidXR0b24iPjxzcGFuIGNsYXNzPSJVSUJ1dHRvbi13cmFwcGVyIj48c3Bhbj5JbmplY3Q8L3NwYW4+PC9zcGFuPjwvYnV0dG9uPicpOwoJCQkJZ2V0SWQoIm1pY3JvbWF0Y2hCdXR0b24iKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKCkgewoJCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjdXN0b21NZXNzYWdlQ29udGFpbmVyIikucmVtb3ZlKCk7CgkJCQkJbWljcm9tYXRjaCgpOwoJCQkJfSk7CgkJCX0gZWxzZSBpZiAoaHJlZi5pbmNsdWRlcygiL21hdGNoIikpIHsKCQkJCWNBbGVydCgnPGgyPkdhbWUgTW9kZTogTWF0Y2g8L2gyPlRoYW5rIHlvdSBmb3IgdXNpbmcgVGhlTW9zdE9HTmFtZSBRdWl6bGV0IEV4cGxvaXQ8YnI+V2l0aG91dCB5b3UsIHRoaXMgZXhwbG9pdCB3b3VsZG50IGJlIHBvc3NpYmxlLjxicj48aDQ+SW5zdHJ1Y3Rpb25zOjwvaDQ+VGhlIHRpbWVyIHdpbGwgYmUgcGF1c2VkIHdoZW4gYXQgY2hvb3NlbiB0aW1lLjxicj5UaGUgYW5zd2VycyB3aWxsIGFsc28gYmUgaGlnaGxpZ2h0ZWQgZm9yIHlvdS48YnI+QXQgeW91ciBsZWlzdXJlLCBzb2x2ZSB0aGUgcXVlc3Rpb25zLjxicj48aDQ+TWF0Y2ggVGltZTogPC9oND48aW5wdXQgdHlwZT0idGV4dCIgaWQ9Im1hdGNoVGltZUlucHV0IiB2YWx1ZT0iMCI+PC9pbnB1dD48YnI+PGJyPjxidXR0b24gY2xhc3M9IlVJQnV0dG9uIiBpZD0ibWF0Y2hCdXR0b24iIHR5cGU9ImJ1dHRvbiI+PHNwYW4gY2xhc3M9IlVJQnV0dG9uLXdyYXBwZXIiPjxzcGFuPkluamVjdDwvc3Bhbj48L3NwYW4+PC9idXR0b24+Jyk7CgkJCQlnZXRJZCgibWF0Y2hCdXR0b24iKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKCkgewoJCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjdXN0b21NZXNzYWdlQ29udGFpbmVyIikucmVtb3ZlKCk7CgkJCQkJbWF0Y2goKTsKCQkJCX0pOwoJCQl9IGVsc2UgaWYgKGhyZWYuaW5jbHVkZXMoIi9ncmF2aXR5IikpIHsKCQkJCXRyeSB7CgkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiVUlNb2RhbCBpcy13aGl0ZSBpcy1vcGVuIilbMF0uc3R5bGUuZGlzcGxheSA9ICJub25lIgoJCQkJfSBjYXRjaCAoZSkge30KCQkJCWNBbGVydCgnPGgyPkdhbWUgTW9kZTogR3Jhdml0eTwvaDI+VGhhbmsgeW91IGZvciB1c2luZyBUaGVNb3N0T0dOYW1lIFF1aXpsZXQgRXhwbG9pdDxicj5XaXRob3V0IHlvdSwgdGhpcyBleHBsb2l0IHdvdWxkbnQgYmUgcG9zc2libGUuIFBsZWFzZSBub3RlIHRoYXQgdGhpcyBzY3JpcHQgZG9lcyBub3Qgd29yayBhbnltb3JlLiA8YnI+IDxoND5XaGF0IHNjb3JlIHdvdWxkIHlvdSBsaWtlPzogPGlucHV0IHR5cGU9Im51bWJlciIgaWQ9ImdyYXZpdHlTY29yZUlucHV0IiB2YWx1ZT0iNDI5NDk2NzI5NSIgb25jaGFuZ2U9ImdyYXZpdHlTY29yZSA9IHBhcnNlSW50KHRoaXMudmFsdWUpOyI+PC9pbnB1dD48L2g0Pjxicj48YnI+PGJ1dHRvbiBjbGFzcz0iVUlCdXR0b24iIGlkPSJncmF2aXR5QnV0dG9uIiB0eXBlPSJidXR0b24iPjxzcGFuIGNsYXNzPSJVSUJ1dHRvbi13cmFwcGVyIj48c3Bhbj5JbmplY3Q8L3NwYW4+PC9zcGFuPjwvYnV0dG9uPicpOwoJCQkJZ2V0SWQoImdyYXZpdHlCdXR0b24iKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKCkgewoJCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjdXN0b21NZXNzYWdlQ29udGFpbmVyIikucmVtb3ZlKCk7CgkJCQkJZ3Jhdml0eSgpOwoJCQkJfSk7CgoJCQl9IGVsc2UgewoJCQl9CgkJfQoKCQlmdW5jdGlvbiB0ZXN0TW9kZSgpIHsKCQkJdmFyIHF1ZXN0aW9uID0gZ2V0Q2xhc3MoIlRlcm1UZXh0IG5vdHJhbnNsYXRlIGxhbmctZW4iKTsKCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBxdWVzdGlvbi5sZW5ndGg7IGkrKykgewoJCQkJcXVlc3Rpb25baV0uaW5uZXJIVE1MICs9ICc8YnI+PHNtYWxsIHN0eWxlPSJmb250LXdlaWdodDogYm9sZDsgZGlzcGxheTogYmxvY2s7IiBjbGFzcz0iYW5zd2VycyI+JyArIGZpbmRBbnN3ZXJHbG9iYWwocXVlc3Rpb25baV0uaW5uZXJIVE1MKSArICI8L3NtYWxsPiI7CgkJCX0KCQkJd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbihlKSB7CgkJCQllLnByZXZlbnREZWZhdWx0KCk7CgkJCQl2YXIgYW5zd2VyID0gZ2V0Q2xhc3MoImFuc3dlcnMiKTsKCQkJCWlmIChhbnN3ZXJbMF0uc3R5bGUuZGlzcGxheSA9PSAiYmxvY2siKSB7CgkJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBhbnN3ZXIubGVuZ3RoOyBpKyspIHsKCQkJCQkJYW5zd2VyW2ldLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQlmb3IgKHZhciBpID0gMDsgaSA8IGFuc3dlci5sZW5ndGg7IGkrKykgewoJCQkJCQlhbnN3ZXJbaV0uc3R5bGUuZGlzcGxheSA9ICJibG9jayIKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCWZ1bmN0aW9uIGdyYXZpdHkoKSB7CgkJCWlmIChncmF2aXR5U2NvcmUgPT09IHVuZGVmaW5lZCkgewoJCQkJZ3Jhdml0eVNjb3JlID0gcGFyc2VJbnQocHJvbXB0KCJFbnRlciBleGFjdCBzY29yZToiKSk7CgkJCX0KCgkJCXZhciB0ID0gd2luZG93LlFKUChbXSwgW10sIFsiaHllayJdKS5hLAoJCQluID0gdC5ncmFkZXIuZ3JhZGUuYmluZCh0LmdyYWRlcik7CgkJCXQuX3N0YXJ0R2FtZSgpLCB0LmRhdGFNYXAgPSB0LmRhdGFNYXAudXBkYXRlKCJwb2ludHMiLCBmdW5jdGlvbih0KSB7CgkJCQlyZXR1cm4gZ3Jhdml0eVNjb3JlOwoJCQl9KTsKCQkJZm9yICh2YXIgbyA9IDA7IG8gPCA5OTsgbysrKSB0Ll9hZHZhbmNlTGV2ZWwoKTsKCgkJCWZ1bmN0aW9uIHMoZSkgewoJCQkJdC5ncmFkZXIuZ3JhZGUgPSBmdW5jdGlvbihlLCB0LCBuKSB7CgkJCQkJcmV0dXJuICEwOwoJCQkJfSwgZSgpLCB0LmdyYWRlci5ncmFkZSA9IG4KCQkJfQoJCQlzKGZ1bmN0aW9uKCkgewoJCQkJY29uc29sZS5sb2cobnVsbCk7CgkJCX0pOwoJCQl2YXIgYSA9IHQuX3Byb21wdENvcHlBbnN3ZXIuYmluZCh0KTsKCQkJdC5fcHJvbXB0Q29weUFuc3dlciA9IGZ1bmN0aW9uKGUpIHsKCQkJCWEoZSksIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CgkJCQkJcyhmdW5jdGlvbigpIHsKCQkJCQkJdC5fY2hlY2tDb3BpZWRBbnN3ZXIoewoJCQkJCQkJbGl2ZVRlcm1JZDogZSwKCQkJCQkJCWFuc3dlcjogIiIKCQkJCQkJfSk7CgkJCQkJfSk7CgkJCQl9LCAwKTsKCQkJfTsKCQl9CgoJCWZ1bmN0aW9uIHdyaXRlKCkgewoJCQkvL1RoaXMgaXMgc2FkLi4uIGJ1dCB3b3JrcyBiZXR0ZXIuLi4KCQkJdmFyIHJlbWFpbmluZyA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIkxlYXJuTW9kZVByb2dyZXNzQmFyLXZhbHVlIilbMF0uaW5uZXJIVE1MKTsKCQkJZm9yICh2YXIgaSA9IDA7IGkgPCByZW1haW5pbmc7IGkrKykgewoJCQkJZ2V0SWQoInVzZXItYW5zd2VyIikudmFsdWUgPSBNYXRoLnJhbmRvbSgpOwoJCQkJZ2V0SWQoImpzLWxlYXJuTW9kZUFuc3dlckJ1dHRvbiIpLmNsaWNrKCk7CgkJCQlnZXRDbGFzcygianMtbGVhcm5Nb2RlT3ZlcnJpZGVJbmNvcnJlY3QiKVswXS5jbGljaygpOwoJCQl9CgkJCQoJCX0KCgkJZnVuY3Rpb24gc3BlbGwoKSB7CgkJCWlmIChnZXRDbGFzcygiU3BlbGxNb2RlQ29udHJvbHMtcHJvZ3Jlc3NWYWx1ZSIpWzBdLmlubmVySFRNTCA9PSAiMTAwJSIpIHsKCQkJCXJldHVybiAxOwoJCQl9CgkJCWlmIChnZXRJZCgianMtc3BlbGxJbnB1dCIpICE9PSBudWxsKSB7CgkJCQlnZXRJZCgianMtc3BlbGxJbnB1dCIpLnZhbHVlID0gZmluZEFuc3dlckdsb2JhbChnZXRDbGFzcygicURlZiBsYW5nLWVuIFRlcm1UZXh0IilbMF0uaW5uZXJIVE1MKTsKCQkJCXNldFRpbWVvdXQoc3BlbGwsIDEwKTsKCQkJfQoJCX0KCgkJZnVuY3Rpb24gbWF0Y2goKSB7CgkJCWJ1dHRvbiA9IGdldENsYXNzKCJVSUJ1dHRvbiBVSUJ1dHRvbi0taGVybyIpWzBdLCBidXR0b24gJiYgYnV0dG9uLmNsaWNrKCk7CgkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CgkJCQl2YXIgbWF0Y2hMb29wID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7CgkJCQkJd2FpdEZvck1hdGNoKCk7CgkJCQl9LCAwKTsKCgkJCQlmdW5jdGlvbiB3YWl0Rm9yTWF0Y2goKSB7CgkJCQkJaWYgKGdldENsYXNzKCJNYXRjaE1vZGVRdWVzdGlvblNjYXR0ZXJUaWxlIikgfHwgZ2V0Q2xhc3MoIk1hdGNoTW9kZVF1ZXN0aW9uR3JpZEJvYXJkLXRpbGUiKSkgewoJCQkJCQlmb3IgKHZhciBGID0gc2V0VGltZW91dCgiOyIpLCBpID0gMDsgaSA8IEY7IGkrKykgY2xlYXJUaW1lb3V0KGkpOwoJCQkJCQl2YXIgdGlsZXMgPSBnZXRDbGFzcygiTWF0Y2hNb2RlUXVlc3Rpb25TY2F0dGVyVGlsZSIpOwoJCQkJCQl2YXIgY29sb3JzID0gWyIjRkYwMDAwIiwgIiNGRjAwMDAiLCAiI0ZGNjYwMCIsICIjRkY2NjAwIiwgIiNGRkZGMDAiLCAiI0ZGRkYwMCIsICIjMDBGRjAwIiwgIiMwMEZGMDAiLCAiIzAwRkZGRiIsICIjMDBGRkZGIiwgIiMwMDMzRkYiLCAiIzAwMzNGRiIsICIjRkYwMEZGIiwgIiNGRjAwRkYiLCAiI0NDMDBGRiIsICIjQ0MwMEZGIiwgIiM2RTBERDAiLCAiIzZFMEREMCIsICIjQzBDMEMwIiwgIiNDMEMwQzAiLCAiI0ZGRkZGRiIsICIjRkZGRkZGIiwgIiNBNTJBMkEiLCAiI0E1MkEyQSIsICIjRjZDRkZGIiwgIiNGNkNGRkYiLCAiI0NGRDlGRiIsICIjQ0ZEOUZGIiwgIiNGQkZGQTMiLCAiI0ZCRkZBMyIsICIjRkZEMUEzIiwgIiNGRkQxQTMiLCAiIzcxMDAwMCIsICIjNzEwMDAwIl07CgkJCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgdGlsZXMubGVuZ3RoOyBpKyspIHsKCQkJCQkJCXRpbGVzW2ldLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yc1tpXTsKCQkJCQkJCWZvciAodmFyIGogPSAwOyBqIDwgdGlsZXMubGVuZ3RoOyBqKyspIHsKCQkJCQkJCQlpZiAodGlsZXNbal0uY2hpbGROb2Rlc1swXS5pbm5lckhUTUwgPT0gZmluZEFuc3dlckdsb2JhbCh0aWxlc1tqXS5jaGlsZE5vZGVzWzBdLmlubmVySFRNTCkpIHsKCQkJCQkJCQkJdGlsZXNbal0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3JzW2ldOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQljbGVhclRpbWVvdXQobWF0Y2hMb29wKTsKCQkJCQl9CgkJCQl9CgkJCX0sIDUwMCk7CgkJfQoKCQlmdW5jdGlvbiBtaWNyb21hdGNoKCkgewoJCQlidXR0b24gPSBnZXRDbGFzcygiVUlCdXR0b24gVUlCdXR0b24tLWhlcm8iKVswXSwgYnV0dG9uICYmIGJ1dHRvbi5jbGljaygpOwoJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewoJCQkJc2V0VGltZW91dChmdW5jdGlvbigpIHsKCQkJCQlmb3IgKHZhciBGID0gc2V0VGltZW91dCgiOyIpLCBvID0gMDsgbyA8IEY7IG8rKykgY2xlYXJUaW1lb3V0KG8pOwoJCQkJfSwgMCk7CgoJCQkJdmFyIHRpbGVzID0gZ2V0Q2xhc3MoIk1hdGNoTW9kZVF1ZXN0aW9uR3JpZFRpbGUtdGV4dCIpOyAvL1swXS5jaGlsZE5vZGVzWzBdLmlubmVySFRNTAoJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCB0aWxlcy5sZW5ndGg7IGkrKykgewoKCQkJCQlpZiAoZ2V0Q2xhc3MoIk1hdGNoTW9kZVF1ZXN0aW9uR3JpZFRpbGUiKVtpXS5jbGFzc0xpc3RbMV0gIT0gImlzLXNlbGVjdGVkIikgewoJCQkJCQljbGljayhnZXRDbGFzcygiTWF0Y2hNb2RlUXVlc3Rpb25HcmlkQm9hcmQtdGlsZSIpW2ldLmNoaWxkTm9kZXNbMF0sICJwb2ludGVyZG93biIpOwoJCQkJCX0KCQkJCQlmb3IgKHZhciBqID0gMDsgaiA8IHRpbGVzLmxlbmd0aDsgaisrKSB7CgkJCQkJCWlmICh0aWxlc1tqXS5jaGlsZE5vZGVzWzBdLmlubmVySFRNTCA9PSBmaW5kQW5zd2VyR2xvYmFsKHRpbGVzW2ldLmNoaWxkTm9kZXNbMF0uaW5uZXJIVE1MKSkgewoJCQkJCQkJaWYgKGdldENsYXNzKCJNYXRjaE1vZGVRdWVzdGlvbkdyaWRUaWxlIilbal0uY2xhc3NMaXN0WzFdICE9ICJpcy1zZWxlY3RlZCIpIHsKCQkJCQkJCQljbGljayhnZXRDbGFzcygiTWF0Y2hNb2RlUXVlc3Rpb25HcmlkQm9hcmQtdGlsZSIpW2pdLmNoaWxkTm9kZXNbMF0sICJwb2ludGVyZG93biIpOwoJCQkJCQkJCWogPSB0aWxlcy5sZW5ndGg7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQlmdW5jdGlvbiBjbGljayhlLCB0KSB7CgkJCQkJaWYgKGUuZmlyZUV2ZW50KSBlLmZpcmVFdmVudCgib24iICsgdCk7CgkJCQkJZWxzZSB7CgkJCQkJCXZhciBuID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoIkV2ZW50cyIpOwoJCQkJCQluLmluaXRFdmVudCh0LCAhMCwgITEpLCBlLmRpc3BhdGNoRXZlbnQobik7CgkJCQkJfQoJCQkJfQoJCQl9LCA1MDApOwoJCX0KCgkJZnVuY3Rpb24gbGVhcm4oKSB7CgkJCWlmIChnZXRDbGFzcygiUHJvZ3Jlc3NTZWdtZW50ZWRTZW1pY2lyY2xlLXBlcmNlbnQiKVswXS5pbm5lckhUTUwgPSAiMTAwJSIpIHsKCQkJCXJldHVybiAxOwoJCQl9CgkJCWNoZWNrQ2hlY2tib3goKTsKCQkJaWYgKGdldENsYXNzKCJBc3Npc3RhbnRNdWx0aXBsZUNob2ljZVF1ZXN0aW9uUHJvbXB0Vmlldy1pbm5lciIpWzBdICE9PSB1bmRlZmluZWQpIHsKCQkJCXZhciBhbnN3ZXIgPSBmaW5kQW5zd2VyR2xvYmFsKGdldENsYXNzKCJGb3JtYXR0ZWRUZXh0IG5vdHJhbnNsYXRlIFRlcm1UZXh0IGxhbmctZW4iKVswXS5pbm5lckhUTUwpOwoJCQkJdmFyIHExID0gZ2V0Q2xhc3MoIkZvcm1hdHRlZFRleHQgbm90cmFuc2xhdGUgVGVybVRleHQgbGFuZy1lbiIpWzFdOwoJCQkJdmFyIHEyID0gZ2V0Q2xhc3MoIkZvcm1hdHRlZFRleHQgbm90cmFuc2xhdGUgVGVybVRleHQgbGFuZy1lbiIpWzJdOwoJCQkJdmFyIHEzID0gZ2V0Q2xhc3MoIkZvcm1hdHRlZFRleHQgbm90cmFuc2xhdGUgVGVybVRleHQgbGFuZy1lbiIpWzNdOwoJCQkJdmFyIHE0ID0gZ2V0Q2xhc3MoIkZvcm1hdHRlZFRleHQgbm90cmFuc2xhdGUgVGVybVRleHQgbGFuZy1lbiIpWzRdOwoJCQkJaWYgKGFuc3dlciA9PSBxMS5pbm5lckhUTUwpIHsKCQkJCQlxMS5jbGljaygpOwoJCQkJfSBlbHNlIGlmIChhbnN3ZXIgPT0gcTIuaW5uZXJIVE1MKSB7CgkJCQkJcTIuY2xpY2soKTsKCQkJCX0gZWxzZSBpZiAoYW5zd2VyID09IHEzLmlubmVySFRNTCkgewoJCQkJCXEzLmNsaWNrKCk7CgkJCQl9IGVsc2UgaWYgKGFuc3dlciA9PSBxNC5pbm5lckhUTUwpIHsKCQkJCQlxNC5jbGljaygpOwoJCQkJfSBlbHNlIHsKCQkJCQljb25zb2xlLmVycm9yKCJFUlJPUjogVW5hYmxlIHRvIGZpbmQgLyBjbGljayBhbnN3ZXIiKTsKCQkJCQlyZXR1cm4gMDsKCQkJCX0KCQkJCWdldENsYXNzKCJVSUJ1dHRvbiIpWzRdLmNsaWNrKCk7CgkJCQlzZXRUaW1lb3V0KGxlYXJuLCAxMCk7CgkJCX0gZWxzZSB7CgkJCQlzZXRUaW1lb3V0KGxlYXJuLCAxMDApOwoJCQl9CgkJfQoKCQlmdW5jdGlvbiBjaGVja0NoZWNrYm94KCkgewoJCQlkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJVSUJ1dHRvbiBVSUJ1dHRvbi0td2hpdGVCb3JkZXIgVUlCdXR0b24tLWZpbGwiKVswXS5jbGljaygpOwoJCQlpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiVUlDaGVja2JveC1pbnB1dCIpWzNdLmNoZWNrZWQgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiVUlDaGVja2JveC1pbnB1dCIpWzJdLmNoZWNrZWQgIT09IHRydWUgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiVUlDaGVja2JveC1pbnB1dCIpWzRdLmNoZWNrZWQgIT09IHRydWUpIHsKCQkJCWRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIlVJQnV0dG9uIFVJQnV0dG9uLS1pbnZlcnRlZCIpWzBdLmNsaWNrKCk7CgkJCQlyZXR1cm4gMTsKCQkJfQoJCQlpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiVUlDaGVja2JveC1pbnB1dCIpWzRdLmNoZWNrZWQgPT09IHRydWUpIHsKCQkJCWRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIlVJQ2hlY2tib3gtaW5wdXQiKVs0XS5jbGljaygpOwoJCQl9CgkJCWlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJVSUNoZWNrYm94LWlucHV0IilbMl0uY2hlY2tlZCA9PT0gdHJ1ZSkgewoJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiVUlDaGVja2JveC1pbnB1dCIpWzJdLmNsaWNrKCk7CgkJCX0KCQkJaWYgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIlVJQ2hlY2tib3gtaW5wdXQiKVszXS5jaGVja2VkID09PSBmYWxzZSkgewoJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiVUlDaGVja2JveC1pbnB1dCIpWzNdLmNsaWNrKCk7CgkJCX0KCQkJZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiVUlCdXR0b24gVUlCdXR0b24tLWludmVydGVkIilbMF0uY2xpY2soKTsKCQl9CgoJCWZ1bmN0aW9uIGZpbmRBbnN3ZXJHbG9iYWwocXVlc3Rpb24pIHsKCQkJaWYgKFF1aXpsZXQuYXNzaXN0YW50TW9kZURhdGEgIT09IHVuZGVmaW5lZCkgeyAvL1F1aXpsZXQuYXNzaXN0YW50TW9kZURhdGEudGVybXMKCQkJCXJldHVybiBnZXRBbnN3ZXIoUXVpemxldC5hc3Npc3RhbnRNb2RlRGF0YS50ZXJtcywgcXVlc3Rpb24pOwoJCQl9IGVsc2UgaWYgKFF1aXpsZXQubGVhcm5HYW1lRGF0YSAhPT0gdW5kZWZpbmVkKSB7IC8vUXVpemxldC5sZWFybkdhbWVEYXRhLmFsbFRlcm1zCgkJCQlyZXR1cm4gZ2V0QW5zd2VyKFF1aXpsZXQubGVhcm5HYW1lRGF0YS5hbGxUZXJtcywgcXVlc3Rpb24pOwoJCQl9IGVsc2UgaWYgKFF1aXpsZXQudGVzdE1vZGVEYXRhICE9PSB1bmRlZmluZWQpIHsgLy9RdWl6bGV0LnRlc3RNb2RlRGF0YS50ZXJtcwoJCQkJcmV0dXJuIGdldEFuc3dlcihRdWl6bGV0LnRlc3RNb2RlRGF0YS50ZXJtcywgcXVlc3Rpb24pOwoJCQl9IGVsc2UgaWYgKFF1aXpsZXQuc3BlbGxNb2RlRGF0YSAhPT0gdW5kZWZpbmVkKSB7IC8vUXVpemxldC5zcGVsbE1vZGVEYXRhLnNwZWxsR2FtZURhdGEudGVybXNCeUlkCgkJCQlyZXR1cm4gZ2V0QW5zd2VyKFF1aXpsZXQuc3BlbGxNb2RlRGF0YS5zcGVsbEdhbWVEYXRhLnRlcm1zQnlJZCwgcXVlc3Rpb24pOwoJCQl9IGVsc2UgaWYgKFF1aXpsZXQubWF0Y2hNb2RlRGF0YSAhPT0gdW5kZWZpbmVkKSB7IC8vUXVpemxldC5tYXRjaE1vZGVEYXRhLnRlcm1zCgkJCQlyZXR1cm4gZ2V0QW5zd2VyKFF1aXpsZXQubWF0Y2hNb2RlRGF0YS50ZXJtcywgcXVlc3Rpb24pOwoJCQl9IGVsc2UgaWYgKFF1aXpsZXQuZ3Jhdml0eU1vZGVEYXRhICE9PSB1bmRlZmluZWQpIHsgLy9RdWl6bGV0LmdyYXZpdHlNb2RlRGF0YS50ZXJtcwoJCQkJcmV0dXJuIGdldEFuc3dlcihRdWl6bGV0LmdyYXZpdHlNb2RlRGF0YS50ZXJtcywgcXVlc3Rpb24pOwoJCQl9IGVsc2UgewoJCQkJcmV0dXJuIDA7CgkJCX0KCgkJCWZ1bmN0aW9uIGdldEFuc3dlcihzLCB0KSB7CgkJCQl2YXIgZSA9IHM7CgkJCQlpZiAodC5pbmRleE9mKCJfIikgIT0gIi0xIikgewoJCQkJCWlmICh0LnNsaWNlKC0xKSA9PSAiXyIpIHsgLy9VbmRlcnNjb3JlIGF0IGVuZAoJCQkJCQlmb3IgKHZhciBpPTA7IGk8ZS5sZW5ndGg7IGkrKykgewoJCQkJCQkJaWYgKGVbaV0uZGVmaW5pdGlvbi5pbmRleE9mKGdldENsYXNzKCJxRGVmIGxhbmctZW4gVGVybVRleHQiKVswXS5pbm5lckhUTUwuc3BsaXQoIl8iKVswXSkgIT0gIi0xIikgewoJCQkJCQkJCXJldHVybiBlW2ldLndvcmQ7CgkJCQkJCQl9IGVsc2UgaWYgKGVbaV0ud29yZC5pbmRleE9mKGdldENsYXNzKCJxRGVmIGxhbmctZW4gVGVybVRleHQiKVswXS5pbm5lckhUTUwuc3BsaXQoIl8iKVswXSkgIT0gIi0xIikgewoJCQkJCQkJCXJldHVybiBlW2ldLmRlZmluaXRpb247CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9IGVsc2UgaWYgKHRbMF0gPT0gIl8iKSB7CgkJCQkJCWZvciAodmFyIGk9MDsgaTxlLmxlbmd0aDsgaSsrKSB7IC8vVW5kZXJzY29yZSBhdCBzdGFydAoJCQkJCQkJaWYgKGVbaV0uZGVmaW5pdGlvbi5pbmRleE9mKGdldENsYXNzKCJxRGVmIGxhbmctZW4gVGVybVRleHQiKVswXS5pbm5lckhUTUwuc3BsaXQoIl8iKS5zbGljZSgtMSlbMF0pICE9ICItMSIpIHsKCQkJCQkJCQlyZXR1cm4gZVtpXS53b3JkOwoJCQkJCQkJfSBlbHNlIGlmIChlW2ldLndvcmQuaW5kZXhPZihnZXRDbGFzcygicURlZiBsYW5nLWVuIFRlcm1UZXh0IilbMF0uaW5uZXJIVE1MLnNwbGl0KCJfIikuc2xpY2UoLTEpWzBdKSAhPSAiLTEiKSB7CgkJCQkJCQkJcmV0dXJuIGVbaV0uZGVmaW5pdGlvbjsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0gZWxzZSB7CgkJCQkJCWZvciAodmFyIGk9MDsgaTxlLmxlbmd0aDsgaSsrKSB7IC8vVW5kZXJzY29yZSBpbiBtaWRkbGUKCQkJCQkJCWlmIChlW2ldLmRlZmluaXRpb24uaW5kZXhPZihnZXRDbGFzcygicURlZiBsYW5nLWVuIFRlcm1UZXh0IilbMF0uaW5uZXJIVE1MLnNwbGl0KCJfIikuc2xpY2UoLTEpWzBdKSAhPSAiLTEiICYmIGVbaV0uZGVmaW5pdGlvbi5pbmRleE9mKGdldENsYXNzKCJxRGVmIGxhbmctZW4gVGVybVRleHQiKVswXS5pbm5lckhUTUwuc3BsaXQoIl8iKVswXSkgIT0gIi0xIikgewoJCQkJCQkJCXJldHVybiBlW2ldLndvcmQ7CgkJCQkJCQl9IGVsc2UgaWYgKGVbaV0ud29yZC5pbmRleE9mKGdldENsYXNzKCJxRGVmIGxhbmctZW4gVGVybVRleHQiKVswXS5pbm5lckhUTUwuc3BsaXQoIl8iKS5zbGljZSgtMSlbMF0pICE9ICItMSIgJiYgZVtpXS53b3JkLmluZGV4T2YoZ2V0Q2xhc3MoInFEZWYgbGFuZy1lbiBUZXJtVGV4dCIpWzBdLmlubmVySFRNTC5zcGxpdCgiXyIpWzBdKSAhPSAiLTEiKSB7CgkJCQkJCQkJcmV0dXJuIGVbaV0uZGVmaW5pdGlvbjsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJCXZhciBhbnN3ZXJzID0gW107CgkJCQlmb3IgKHZhciBpPTA7IGk8ZS5sZW5ndGg7IGkrKykgewoJCQkJCWVbaV0uZGVmaW5pdGlvbiA9IGVbaV0uZGVmaW5pdGlvbi5yZXBsYWNlKCJcbiIsICI8YnI+Iik7CgkJCQkJZVtpXS53b3JkID0gZVtpXS53b3JkLnJlcGxhY2UoIlxuIiwgIjxicj4iKTsKCQkJCQlpZiAodCA9PSBlW2ldLndvcmQpIHsKCQkJCQkJYW5zd2Vycy5wdXNoKGVbaV0uZGVmaW5pdGlvbik7CgkJCQkJfSBlbHNlIGlmICh0ID09IGVbaV0uZGVmaW5pdGlvbikgewoJCQkJCQlhbnN3ZXJzLnB1c2goZVtpXS53b3JkKTsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gYW5zd2Vyc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhbnN3ZXJzLmxlbmd0aCldOwoJCQl9CgkJfQoJfQoKCWZ1bmN0aW9uIGNBbGVydChtZXNzYWdlKSB7CgkJdmFyIGh0bWwgPSAnPGRpdiBjbGFzcz0iVUlNb2RhbCBpcy13aGl0ZSBpcy1vcGVuIiBpZD0iY3VzdG9tTWVzc2FnZUNvbnRhaW5lciIgcm9sZT0iZG9jdW1lbnQiIHRhYmluZGV4PSItMSI+IDxkaXYgY2xhc3M9IlVJTW9kYWwtYm94Ij4gPGRpdiBjbGFzcz0iVUlNb2RhbEhlYWRlciI+IDxkaXYgY2xhc3M9IlVJTW9kYWxIZWFkZXItd3JhcHBlciI+IDxzcGFuIGNsYXNzPSJVSU1vZGFsSGVhZGVyLWNsb3NlIj4gPGRpdiBjbGFzcz0iVUlNb2RhbEhlYWRlci1jbG9zZUljb25CdXR0b24iPiA8c3BhbiBjbGFzcz0iVUlJY29uQnV0dG9uIj4gPGJ1dHRvbiBjbGFzcz0iVUlCdXR0b24gVUlCdXR0b24tLWludmVydGVkIiB0eXBlPSJidXR0b24iIGlkPSJjdXN0b21DbG9zZUJ1dHRvbiIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJnF1b3Q7Y3VzdG9tTWVzc2FnZUNvbnRhaW5lciZxdW90OykucmVtb3ZlKCk7Ij4gPHNwYW4gY2xhc3M9IlVJQnV0dG9uLXdyYXBwZXIiPiA8c3ZnIGNsYXNzPSJVSUljb24gVUlJY29uLS14LXRoaW4iPiA8bm9zY3JpcHQ+PC9ub3NjcmlwdD4gPHVzZSB4bGluazpocmVmPSIjeC10aGluIj48L3VzZT4gPG5vc2NyaXB0Pjwvbm9zY3JpcHQ+IDwvc3ZnPiA8L3NwYW4+IDwvYnV0dG9uPiA8L3NwYW4+IDwvZGl2PiA8L3NwYW4+IDxkaXYgY2xhc3M9IlVJTW9kYWxIZWFkZXItY2hpbGRyZW5XcmFwcGVyIj4gPGgzIGNsYXNzPSJVSUhlYWRpbmcgVUlIZWFkaW5nLS10aHJlZSI+PHNwYW4gaWQ9ImN1c3RvbVRpdGxlIj5UaGVNb3N0T0dOYW1lIFF1aXpsZXQgRXhwbG9pdDwvc3Bhbj48L2gzPiA8L2Rpdj4gPC9kaXY+IDwvZGl2PiA8ZGl2IGNsYXNzPSJVSU1vZGFsQm9keSI+IDxkaXYgY2xhc3M9IlVJRGl2IFNldFBhZ2VFbWJlZE1vZGFsLWNvbnRlbnQiPiA8ZGl2PiA8cCBjbGFzcz0iVUlQYXJhZ3JhcGgiPjxzcGFuIGlkPSJjdXN0b21NZXNzYWdlIj4nK21lc3NhZ2UrJzwvc3Bhbj48L3A+PC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+JzsKCQl2YXIgaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoJCWouaW5uZXJIVE1MID0gaHRtbDsKCQlkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGopOwoJfQp9KSgpOwoKZnVuY3Rpb24gZ2V0SWQoaWQpIHsKCXJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7Cn0KCmZ1bmN0aW9uIGdldENsYXNzKGlkKSB7CglyZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShpZCk7Cn0KCg=="},{"name":"Auto Typer for Nitro Type","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://www.nitrotype.com/race","https://www.nitrotype.com/race/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685032044258,"data":{}},"enabled":true,"position":18,"file_url":"https://greasyfork.org/scripts/454996-auto-typer-for-nitro-type/code/Auto%20Typer%20for%20Nitro%20Type.user.js","uuid":"d553abad-2fa6-40ce-b8b0-ad161ab2b8ac","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgQXV0byBUeXBlciBmb3IgTml0cm8gVHlwZQovLyBAbWF0Y2ggICAgICAgICAgICBodHRwczovL3d3dy5uaXRyb3R5cGUuY29tL3JhY2UKLy8gQG1hdGNoICAgICAgICAgICAgaHR0cHM6Ly93d3cubml0cm90eXBlLmNvbS9yYWNlLyoKLy8gQGF1dGhvciAgICAgICAgICAgU2luZyBEZXZlbG9wbWVudHMKLy8gQGdyYW50ICAgICAgICAgICAgbm9uZQovLyBAZGVzY3JpcHRpb24gICAgICBBdXRvIFR5cGVyIGZvciBOaXRybyBUeXBlIGJ5IFNpbmcgRGV2ZWxvcG1lbnRzLiBFbmpveSEKLy8gQGxpY2Vuc2UgTUlUCi8vIEB2ZXJzaW9uICAgICAgICAgIDMKLy8gQG5hbWVzcGFjZSBodHRwczovL3NpbmdkZXZlbG9wbWVudHNibG9nLndvcmRwcmVzcy5jb20vP3A9NDM1NAovLyBAaWNvbiAgICAgICAgIGh0dHBzOi8vc2luZ2RldmVsb3BtZW50c2Jsb2cuZmlsZXMud29yZHByZXNzLmNvbS8yMDIyLzExL25pdHJvdHlwZS1sb2dvLmpwZwovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbigpIHsKJ3VzZSBzdHJpY3QnOwpzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN0cnVjdHVyZS0tbml0cm90eXBlIC5yYWNlLWhvc3QtY29udHJvbHMgLmJ0bicpWzJdLmNsaWNrKCl9LDE1MDApOwoKY29uc3QgZmluZFJlYWN0ID0gKGRvbSwgdHJhdmVyc2VVcCA9IDApID0+IHsKY29uc3Qga2V5ID0gT2JqZWN0LmtleXMoZG9tKS5maW5kKChrZXkpID0+IGtleS5zdGFydHNXaXRoKCJfX3JlYWN0RmliZXIkIikpCmNvbnN0IGRvbUZpYmVyID0gZG9tW2tleV0KaWYgKGRvbUZpYmVyID09IG51bGwpIHJldHVybiBudWxsCmNvbnN0IGdldENvbXBGaWJlciA9IChmaWJlcikgPT4gewpsZXQgcGFyZW50RmliZXIgPSBmaWJlcj8ucmV0dXJuCndoaWxlICh0eXBlb2YgcGFyZW50RmliZXI/LnR5cGUgPT0gInN0cmluZyIpIHsKcGFyZW50RmliZXIgPSBwYXJlbnRGaWJlcj8ucmV0dXJuCn0KcmV0dXJuIHBhcmVudEZpYmVyCn0KbGV0IGNvbXBGaWJlciA9IGdldENvbXBGaWJlcihkb21GaWJlcikKZm9yIChsZXQgaSA9IDA7IGkgPiB0cmF2ZXJzZVVwICYmIGNvbXBGaWJlcjsgaSsrKSB7CmNvbXBGaWJlciA9IGdldENvbXBGaWJlcihjb21wRmliZXIpCn0KcmV0dXJuIGNvbXBGaWJlcj8uc3RhdGVOb2RlCn0KdmFyIHRva2VuID0gMAp2YXIgdCA9IDAKCgpzZXRJbnRlcnZhbChmdW5jdGlvbigpe2ZpbmRSZWFjdChyYWNlQ29udGFpbmVyKVsndHlwZWRTdGF0cyddWyd0eXBlZCddPTEwMDAwMDAwMDAwMDAwfSwxMDAwKTsKfSkoKTs="},{"name":"Better Google","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":["https://www.google.*","http://www.google.*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685466126666,"data":{}},"enabled":true,"position":19,"file_url":"https://greasyfork.org/scripts/12182-better-google/code/Better%20Google.user.js","uuid":"b7a2a4e8-0982-4266-909f-1a5d2f85da67","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIEJldHRlciBHb29nbGUKLy8gQG5hbWVzcGFjZSAgIGZlaWZlaWhhbmcuaW5mbwovLyBAZGVzY3JpcHRpb24gQWRkICdxdWljayBzZWFyY2gnIGlucHV0IGFuZCAnZ28gdG8gdG9wJyBidXR0b24gZm9yIEdvb2dsZS4gQWxzbyBoaWdobGlnaHQgc2VhcmNoIHRlcm1zLgovLyBAaW5jbHVkZSAgICAgaHR0cHM6Ly93d3cuZ29vZ2xlLioKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly93d3cuZ29vZ2xlLioKLy8gQHZlcnNpb24gICAgIDUuMS4zCi8vIEBncmFudCAgICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kCi8vID09L1VzZXJTY3JpcHQ9PQp2YXIgc2hvdWxkSGlnaGxpZ2h0ID0gdHJ1ZTsKdmFyIENPTE9SUyA9IFsKICAnI0ZGRkYwMCcsCiAgJyNDQ0NDRkYnLAogICcjMDBDQ0ZGJywKICAnIzMzQ0NDQycsCiAgJyNGRjgwODAnLAogICcjRkZDQzAwJywKICAnIzAwODAwMCcsCiAgJyNGRkZGOTknLAogICcjODA4MDAwJywKICAnI0ZGRkZDQycKXTsKLy8gaGlnaGxpZ2h0IHNlYXJjaCB0ZXJtcy4KdmFyIHVybEJ1ZmZlciwKcmVzdWx0QnVmZmVyOwpmdW5jdGlvbiBoaWdobGlnaHQoKSB7CiAgY29uc29sZS5sb2coJzEnKTsKICAvLyBmaXJzdCwgZmluZCBhbGwgJ2VtJ3MuCiAgdmFyIGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2VtJyk7CiAgLy8gaWYgdGhlcmUgaXMgbm8gJ2VtJ3MsIGRvIG5vdGhpbmcuCiAgaWYgKGVtcy5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgLy8gY29udmVydCBlbXMgaW50byBhbiBhcnJheS4KCiAgZW1zID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGVtcyk7CiAgdmFyIGNvdW50ZXIgPSAwOwogIHZhciBzdHlsZXMgPSB7CiAgfTsKICAvLyBpdGVyYXRlIHRocm91Z2ggYWxsIHRoZSBrZXl3b3JkcyBpbiBzZWFyY2ggcmVzdWx0LCAKICAvLyBhbmQgbWFwIHRoZSBwcmVkZWZpbmVkIGNvbG9yIHRvIHRoZW0uCiAgZW1zLmZvckVhY2goZnVuY3Rpb24gKGVtKSB7CiAgICB2YXIgdGV4dCA9IGVtLnRleHRDb250ZW50LnRvVXBwZXJDYXNlKCkudHJpbSgpOwogICAgdmFyIGJnID0gc3R5bGVzW3RleHRdOwogICAgaWYgKCFiZykgewogICAgICBiZyA9IHN0eWxlc1t0ZXh0XSA9IENPTE9SU1tjb3VudGVyKytdOwogICAgICBpZiAoY291bnRlciA9PT0gQ09MT1JTLmxlbmd0aCkgewogICAgICAgIGNvdW50ZXIgPSAwOwogICAgICB9CiAgICB9CiAgICBlbS5zdHlsZS5iYWNrZ3JvdW5kID0gYmc7CiAgICBlbS5zdHlsZS5jb2xvciA9ICcjMDAwJzsKICAgIGVtLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7CiAgfSk7Cn0KZnVuY3Rpb24gdG9nZ2xlSGlnaGxpZ2h0KCkgewogIGlmICghc2hvdWxkSGlnaGxpZ2h0KSB7CiAgICBzaG91bGRIaWdobGlnaHQgPSB0cnVlOwogICAgaGlnaGxpZ2h0KCk7CiAgfSAKICBlbHNlIHsKICAgIHNob3VsZEhpZ2hsaWdodCA9IGZhbHNlOwogICAgdmFyIGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2VtJyk7CiAgICBpZiAoZW1zLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBlbXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoZW1zKTsKICAgIGVtcy5tYXAoZnVuY3Rpb24gKGVtKSB7CiAgICAgIGVtLnN0eWxlLmJhY2tncm91bmQgPSAnI2ZmZic7CiAgICB9KTsKICB9Cn0KR01fcmVnaXN0ZXJNZW51Q29tbWFuZCgnVG9nZ2xlIEhpZ2hsaWdodCcsIHRvZ2dsZUhpZ2hsaWdodCk7CnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAvLyBpZiBpdCdzIG5vdCBnb29nbGUncyBsYW5kaW5nIHBhZ2UuCiAgaWYgKHVybEJ1ZmZlciAhPT0gd2luZG93LmxvY2F0aW9uLmhyZWYgJiYKICAhZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2hwbG9nbycpKSB7CiAgICB2YXIgcmVzdWx0Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlYXJjaCcpOwogICAgaWYgKHJlc3VsdENvbnRhaW5lciAmJiByZXN1bHRDb250YWluZXIudGV4dENvbnRlbnQgIT09IHJlc3VsdEJ1ZmZlcikgewogICAgICAvLyB1cGRhdGUgYnVmZmVyLgogICAgICByZXN1bHRCdWZmZXIgPSByZXN1bHRDb250YWluZXIudGV4dENvbnRlbnQ7CiAgICAgIGlmICghc2hvdWxkSGlnaGxpZ2h0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8vIGZpcnN0LCBmaW5kIGFsbCAnZW0ncy4KCiAgICAgIHZhciBlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdlbScpOwogICAgICAvLyBpZiB0aGVyZSBpcyBubyAnZW0ncywgZG8gbm90aGluZy4KICAgICAgaWYgKGVtcy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgLy8gY29udmVydCBlbXMgaW50byBhbiBhcnJheS4KCiAgICAgIGVtcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShlbXMpOwogICAgICB2YXIgY291bnRlciA9IDA7CiAgICAgIHZhciBzdHlsZXMgPSB7CiAgICAgIH07CiAgICAgIC8vIGl0ZXJhdGUgdGhyb3VnaCBhbGwgdGhlIGtleXdvcmRzIGluIHNlYXJjaCByZXN1bHQsIAogICAgICAvLyBhbmQgbWFwIHRoZSBwcmVkZWZpbmVkIGNvbG9yIHRvIHRoZW0uCiAgICAgIGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChlbSkgewogICAgICAgIHZhciB0ZXh0ID0gZW0udGV4dENvbnRlbnQudG9VcHBlckNhc2UoKS50cmltKCk7CiAgICAgICAgdmFyIGJnID0gc3R5bGVzW3RleHRdOwogICAgICAgIGlmICghYmcpIHsKICAgICAgICAgIGJnID0gc3R5bGVzW3RleHRdID0gQ09MT1JTW2NvdW50ZXIrK107CiAgICAgICAgICBpZiAoY291bnRlciA9PT0gQ09MT1JTLmxlbmd0aCkgewogICAgICAgICAgICBjb3VudGVyID0gMDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZW0uc3R5bGUuYmFja2dyb3VuZCA9IGJnOwogICAgICAgIGVtLnN0eWxlLmNvbG9yID0gJyMwMDAnOwogICAgICAgIGVtLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7CiAgICAgIH0pOwogICAgICB1cmxCdWZmZXIgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsKICAgIH0KICB9Cn0sIDIwMCk7CnZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKY29udGFpbmVyLnN0eWxlID0gJ2Rpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBmaXhlZDsgYm90dG9tOiAyMHB4OycgKwoncmlnaHQ6IDVweDsgdGV4dC1hbGlnbjogcmlnaHQ7JyArCid3aWR0aDogMjgwcHg7IGhlaWdodDogNjBweDsgei1pbmRleDogOTk5OTk5OTk5OycgKwonb3BhY2l0eTogMC44Oyc7CmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZnVuY3Rpb24gKCkgewogIHRoaXMuc3R5bGUub3BhY2l0eSA9ICcxJzsKfSwgdHJ1ZSk7CmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHsKICB0aGlzLnN0eWxlLm9wYWNpdHkgPSAnMC44JzsKfSwgdHJ1ZSk7Ci8vIGNyZWF0ZSBxdWljayBxdWVyeSBpbnB1dC4KdmFyIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKaW5wdXQudHlsZSA9ICd0ZXh0JzsKaW5wdXQudmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbHN0LWliJykudmFsdWU7CmlucHV0LnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLCAnU2VhcmNoLi4uJyk7CmlucHV0LnN0eWxlID0gJ2JvcmRlcjogbm9uZTsgYm9yZGVyLWxlZnQ6IHNvbGlkICNFQTQzMzUgNXB4OyBmbGV4OiAxOyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IG91dGxpbmU6IG5vbmU7IGhlaWdodDogNDBweDsnICsKJ2ZvbnQtc2l6ZTogMTVweDsgbWFyZ2luLXRvcDogMTBweDsgbWFyZ2luLWJvdHRvbTogMTBweDsgcGFkZGluZzogMDsgJyArCidwYWRkaW5nLWxlZnQ6IDEwcHg7IHBhZGRpbmctcmlnaHQ6IDEwcHg7IGJveC1zaGFkb3c6IDAgMXB4IDNweCAjOTk5OTk5Oyc7CmNvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dCk7Ci8vIGJpbmQga2V5cHJlc3MtZW50ZXIgZXZlbnQuCmlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgZnVuY3Rpb24gKGV2dCkgewogIGlmIChldnQua2V5Q29kZSA9PT0gMTMpIHsKICAgIHZhciB2YWx1ZSA9IGlucHV0LnZhbHVlLnRyaW0oKSB8fCAnJzsKICAgIGlmICh2YWx1ZSAhPT0gJycpIHsKICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xzdC1pYicpLnZhbHVlID0gdmFsdWU7CiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5sc2InKS5jbGljaygpOwogICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7CiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsc3QtaWInKS5mb2N1cygpOwogICAgfQogIH0KfSwgZmFsc2UpOwovLyBjcmVhdGUgdGhlIGdvdG8tdG9wIGJ1dHRvbi4KdmFyIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwpidG4uaWQgPSAnZ290by10b3AtYnRuJzsKYnRuLmlubmVySFRNTCA9ICdUT1AnOwpidG4ub25jbGljayA9IGdvdG9Ub3A7Ci8vIHNldCBidXR0b24gQ1NTIHN0eWxlLgpidG4uc3R5bGUgPSAnZGlzcGxheTogaW5saW5lLWJsb2NrOyBwb3NpdGlvbjogcmVsYXRpdmU7IGxlZnQ6IC03cHg7IGNvbG9yOiAjZmZmOyBsaW5lLWhlaWdodDogNjBweDsgdGV4dC1hbGlnbjogY2VudGVyOycgKwond2lkdGg6IDYwcHg7IGhlaWdodDogNjBweDsgYmFja2dyb3VuZDogIzQyODVGNDsgYm94LXNoYWRvdzogMCAycHggM3B4ICM5OTk5OTk7JyArCidjdXJzb3I6IHBvaW50ZXI7IGZvbnQtd2VpZ2h0OiBib2xkZXI7IGJvcmRlci1yYWRpdXM6IDEwMCU7JzsKLy8gYXBwZW5kIHRoZSBnby10by10b3AgdG8gc2VhcmNoIGZvcm0gdG8gc3VjY2Vzc2Z1bGx5IGF0dGFjaCB0byB0aGUgVUkuCmNvbnRhaW5lci5hcHBlbmRDaGlsZChidG4pOwp2YXIgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWFyY2hmb3JtJyk7CmZvcm0uYXBwZW5kQ2hpbGQoY29udGFpbmVyKTsKd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICB2YXIgZG9jID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwogIHZhciB0b3AgPSAod2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvYy5zY3JvbGxUb3ApIC0gKGRvYy5jbGllbnRUb3AgfHwgMCk7CiAgaWYgKHRvcCAhPT0gMCkgewogICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgfQp9Ci8vIGJpbmQgYnV0dG9uIGhpZGVuL3Nob3cgZXZlbnQuCgp3aW5kb3cub25zY3JvbGwgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIGRvYyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICB2YXIgdG9wID0gKHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2Muc2Nyb2xsVG9wKSAtIChkb2MuY2xpZW50VG9wIHx8IDApOwogIGlmICh0b3AgPT09IDApIHsKICAgIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogIH0gZWxzZSB7CiAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICB9Cn0KZnVuY3Rpb24gZ290b1RvcCgpIHsKICBnb3RvKE1hdGguZmxvb3Iod2luZG93LnBhZ2VZT2Zmc2V0IC8gNSkpOwp9CmZ1bmN0aW9uIGdvdG8oc3RlcCkgewogIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgd2luZG93LnNjcm9sbFRvKDAsIHdpbmRvdy5wYWdlWU9mZnNldCAtIHN0ZXApOwogICAgaWYgKHdpbmRvdy5wYWdlWU9mZnNldCA8PSAwKSByZXR1cm47CiAgICBnb3RvKHN0ZXApOwogIH0sIDEwMCk7Cn0K"},{"name":"mmmturkeybacon Numbered Google Results with Easy Copy","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":["http*://www.google.*/search?*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"sandbox":null,"tab_types":null,"unwrap":null},"storage":{"ts":1685466179602,"data":{}},"enabled":true,"position":20,"file_url":"https://greasyfork.org/scripts/3108-mmmturkeybacon-numbered-google-results-with-easy-copy/code/mmmturkeybacon%20Numbered%20Google%20Results%20with%20Easy%20Copy.user.js","uuid":"e83f85b6-429b-4793-b599-49511b273278","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIG1tbXR1cmtleWJhY29uIE51bWJlcmVkIEdvb2dsZSBSZXN1bHRzIHdpdGggRWFzeSBDb3B5Ci8vIEB2ZXJzaW9uICAgICAxLjEzCi8vIEBkZXNjcmlwdGlvbiBOdW1iZXJzIHJlc3VsdHMgaW4gdGhlIGZvcm1hdCBNLk4gdG8gc2hvdyB0aGUgcmVzdWx0IG51bWJlci4gSWYgeW91IGFyZSBvbiB0aGUgZmlyc3QgcGFnZSBpdCBkaXZpZGVzIHRoZSByZXN1bHRzIHVwIGludG8gZ3JvdXBzIG9mIDEwIGFuZCBhZnRlciBldmVyeSAxMCByZXN1bHRzIE0gaXMgaW5jcmVhc2VkIGJ5IDEuIFRoaXMgYWxsb3dzIHlvdSB0byBxdWlja2x5IHNlZSB3aGljaCBwYWdlIGEgcmVzdWx0IHdvdWxkIGJlIG9uIGlmIHRoZXJlIHdlcmUgMTAgcmVzdWx0cyBwZXIgcGFnZS4gRm9yIGFueSBwYWdlIGFmdGVyIHRoZSBmaXJzdCwgTSBpcyB0aGUgcGFnZSBudW1iZXIgYW5kIE4gaXMgdGhlIHJlc3VsdCBudW1iZXIuIEhvbGQgdGhlIHBvaW50ZXIgb3ZlciBhIGJ1dHRvbiBmb3IgaW5zdHJ1Y3Rpb25zIG9uIGNvcHlpbmcuIERpc2FibGUgR29vZ2xlIEluc3RhbnQgKEdlYXI+U2VhcmNoIHNldHRpbmdzPk5ldmVyIHNob3cgSW5zdGFudCByZXN1bHRzKS4KLy8gQ2xpY2sgYnV0dG9uIHRvIGNvcHkgbGluayBVUkwsIEN0cmwtY2xpY2sgdG8gY29weSBsaW5rIHRpdGxlLCBTaGlmdC1jbGljayB0byBjb3B5IGxpbmsgdGl0bGUgYW5kIFVSTC4KLy8gQGF1dGhvciAgICAgIG1tbXR1cmtleWJhY29uCi8vIEBuYW1lc3BhY2UgICBodHRwOi8vdXNlcnNjcmlwdHMub3JnL3VzZXJzLzUyMzM2NwovLyBAaW5jbHVkZSAgICAgaHR0cCo6Ly93d3cuZ29vZ2xlLiovc2VhcmNoPyoKLy8gQHJlcXVpcmUgICAgIGh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzIuMS4zL2pxdWVyeS5taW4uanMKLy8gQGdyYW50ICAgICAgIEdNX3NldENsaXBib2FyZAovLyA9PS9Vc2VyU2NyaXB0PT0KCi8vIElmIHlvdSBoYXZlIEdvb2dsZSBzZXQgdG8gcmV0dXJuIDEwIHJlc3VsdHMgcGVyIHBhZ2UgKGRlZmF1bHQpLCB0aGUgZmlyc3QKLy8gcGFnZSB1c3VhbGx5IGhhcyAxMCByZXN1bHRzIGJ1dCBub3Qgc29tZXRpbWVzIGl0IHdpbGwgaGF2ZSBmZXdlci4KCi8vIElmIHlvdSBjaGFuZ2UgUmVzdWx0cyBwZXIgcGFnZSB1bmRlciBTZWFyY2ggU2V0dGluZ3MsIEdvb2dsZSB3aWxsIHJldHVybgovLyBtb3JlIHJlc3VsdHMgcGVyIHBhZ2UuIFRoZSBudW1iZXIgb2YgbGlua3Mgb24gdGhlIHBhZ2UgbWlnaHQgbm90IGFsd2F5cyBiZQovLyB0aGUgc2FtZSBhcyB0aGUgbnVtYmVyIG9mIHJlc3VsdHMgcGVyIHBhZ2UgeW91IGNob3NlLiBUaGF0J3MgYmVjYXVzZSBHb29nbGUKLy8gZG9lc24ndCBjb3VudCBldmVyeSBsaW5rIGl0IHNob3dzIHlvdSBhcyBhIHJlc3VsdC4KLy8gQWRzIGFyZW4ndCBjb3VudGVkCi8vICJNb3JlIHJlc3VsdHMgZnJvbSAuLi4iIGFyZSBncm91cGVkIHdpdGggdGhlIGxpbmsgdGhleSBhcmUgdW5kZXIuIEdvb2dsZQovLyBjb3VudHMgdGhpcyBhcyBvbmUgcmVzdWx0LgovLyAiSW1hZ2VzIGZvciAuLi4iIGFyZW4ndCBjb3VudGVkLiAoaW1hZ2Vib3hfYmlnaW1hZ2VzKQovLyAiTmV3cyBmb3IgLi4uIiBhbmQgYWxsIHRoZSB0aGUgbGlua3MgZ3JvdXBlZCB3aXRoIGl0IGFyZSBjb3VudGVkIGFzIG9uZQovLyByZXN1bHQ/PyAobmV3c2JveCkKCi8vIHNjcm9sbCB0byBmaXJzdCByZXN1bHQgaWYgdGhlIGZvbGxvd2luZyBpcyB0cnVlIG9yIHRoZSBnb29nbGUgVVJMIGNvbnRhaW5zICZtdGJfc2Nyb2xsCnZhciBTQ1JPTExfVE9fRklSU1QgPSBmYWxzZTsKCiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkKewogICAgLy8gSWYgaW5zdGFudCBzZWFyY2ggaGFzIGJlZW4gZW5hYmxlZAogICAgLy9pZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc3BlbGwnKSkgcmV0dXJuOwoKICAgIHZhciAkcmVzdWx0c19kaXYgPSAkKCdkaXZbaWQ9InJlcyJdJyk7CiAgICBpZiAoJHJlc3VsdHNfZGl2Lmxlbmd0aCA9PSAwKQogICAgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiTm8gcmVzdWx0cy4iKTsKICAgIH0KCiAgICB2YXIgcmVzdWx0X251bSA9IDA7CiAgICB2YXIgcGFnZV9udW0gPSBOdW1iZXIoJCgndGRbY2xhc3M9ImN1ciJdJykudGV4dCgpKTsKICAgIHBhZ2VfbnVtID0gKHBhZ2VfbnVtID09IDApID8gMSA6IHBhZ2VfbnVtOwogICAgdmFyIHBhZ2Vfc3RyID0gcGFnZV9udW0gKyAnLic7CiAgICB2YXIgaXNfZmlyc3RfcGFnZSA9IChwYWdlX251bSA9PSAxKTsKCiAgICB2YXIgJHJlc3VsdHMgPSAkKCdsaVtjbGFzcz0iZyJdLGxpW2NsYXNzPSJnIHcwIl0nKS5ub3QoJ1tpZD0iaW1hZ2Vib3hfYmlnaW1hZ2VzIl0nKS5ub3QoJ1tpZD0ibmV3c2JveCJdJykuZmluZCgnaDMnKTsKICAgICRyZXN1bHRzLmVhY2goZnVuY3Rpb24oaSkKICAgIHsKICAgICAgICByZXN1bHRfbnVtKys7CiAgICAgICAgaWYgKHJlc3VsdF9udW0gPiAxMCAmJiBpc19maXJzdF9wYWdlKQogICAgICAgIHsKICAgICAgICAgICAgcGFnZV9udW0rKzsKICAgICAgICAgICAgcGFnZV9zdHIgPSBwYWdlX251bSArICcuJwogICAgICAgICAgICByZXN1bHRfbnVtID0gcmVzdWx0X251bSAtIDEwOwogICAgICAgIH0KCiAgICAgICAgJCh0aGlzKS5odG1sKCc8YnV0dG9uIHRpdGxlPSJDbGljayB0byBjb3B5IFVSTC5cbkN0cmwtY2xpY2sgdG8gY29weSB0aXRsZS5cblNoaWZ0LWNsaWNrIHRvIGNvcHkgdGl0bGUgYW5kIFVSTC4iIGlkPW10Yl9idG4nK3BhZ2Vfc3RyK3Jlc3VsdF9udW0rJz4nK3BhZ2Vfc3RyICsgcmVzdWx0X251bSsnPC9idXR0b24+JyArICcmbmJzcDsnICsgJCh0aGlzKS5odG1sKCkpOwogICAgICAgIHZhciAkYnV0dG9uID0gJCh0aGlzKS5maW5kKCdidXR0b25baWRePSJtdGJfYnRuIl0nKTsKICAgICAgICB2YXIgJGxpbmsgPSAkKHRoaXMpLmZpbmQoJ2EnKTsKCiAgICAgICAgdmFyIGJ1dHRvbl9oYW5kbGVyID0gKGZ1bmN0aW9uKHRpdGxlLCBVUkwpe3JldHVybiBmdW5jdGlvbihldmVudCkKICAgICAgICB7CiAgICAgICAgICAgIGlmIChldmVudC5jdHJsS2V5KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBHTV9zZXRDbGlwYm9hcmQodGl0bGUpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnQuc2hpZnRLZXkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIEdNX3NldENsaXBib2FyZCh0aXRsZSArJyAnKyBVUkwpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBHTV9zZXRDbGlwYm9hcmQoVVJMKQogICAgICAgICAgICB9CiAgICAgICAgfX0pKCRsaW5rLmh0bWwoKSwgJGxpbmsuYXR0cignaHJlZicpKTsKCiAgICAgICAgJGJ1dHRvbi5iaW5kKCdjbGljaycsIGJ1dHRvbl9oYW5kbGVyKTsKCiAgICB9KTsKCiAgICAvLyBzY3JvbGwgdG8gZmlyc3QgYnV0dG9uIHVubGVzcyBpbmZvIGJveCBpcyBwcmVzZW50CiAgICBpZiAoJCgnbGkuZy50cG8ua25hdmkub2Jjb250YWluZXInKS5sZW5ndGggPT0gMCAmJiAoU0NST0xMX1RPX0ZJUlNUID09IHRydWUgfHwgZG9jdW1lbnQubG9jYXRpb24uaHJlZi5pbmRleE9mKCcmbXRiX3Njcm9sbCcpID4gLTEpKQogICAgewogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbltpZF49Im10Yl9idG4iXScpLnNjcm9sbEludG9WaWV3KCk7CiAgICB9Cn0pOw==","requires":[{"meta":{"name":"jquery.min.js","url":"https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js","ts":1685466180035,"mimetype":"text/javascript"},"source":"LyohIGpRdWVyeSB2Mi4xLjMgfCAoYykgMjAwNSwgMjAxNCBqUXVlcnkgRm91bmRhdGlvbiwgSW5jLiB8IGpxdWVyeS5vcmcvbGljZW5zZSAqLwohZnVuY3Rpb24oYSxiKXsib2JqZWN0Ij09dHlwZW9mIG1vZHVsZSYmIm9iamVjdCI9PXR5cGVvZiBtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1hLmRvY3VtZW50P2IoYSwhMCk6ZnVuY3Rpb24oYSl7aWYoIWEuZG9jdW1lbnQpdGhyb3cgbmV3IEVycm9yKCJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50Iik7cmV0dXJuIGIoYSl9OmIoYSl9KCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzp0aGlzLGZ1bmN0aW9uKGEsYil7dmFyIGM9W10sZD1jLnNsaWNlLGU9Yy5jb25jYXQsZj1jLnB1c2gsZz1jLmluZGV4T2YsaD17fSxpPWgudG9TdHJpbmcsaj1oLmhhc093blByb3BlcnR5LGs9e30sbD1hLmRvY3VtZW50LG09IjIuMS4zIixuPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBuLmZuLmluaXQoYSxiKX0sbz0vXltcc1x1RkVGRlx4QTBdK3xbXHNcdUZFRkZceEEwXSskL2cscD0vXi1tcy0vLHE9Ly0oW1xkYS16XSkvZ2kscj1mdW5jdGlvbihhLGIpe3JldHVybiBiLnRvVXBwZXJDYXNlKCl9O24uZm49bi5wcm90b3R5cGU9e2pxdWVyeTptLGNvbnN0cnVjdG9yOm4sc2VsZWN0b3I6IiIsbGVuZ3RoOjAsdG9BcnJheTpmdW5jdGlvbigpe3JldHVybiBkLmNhbGwodGhpcyl9LGdldDpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9YT8wPmE/dGhpc1thK3RoaXMubGVuZ3RoXTp0aGlzW2FdOmQuY2FsbCh0aGlzKX0scHVzaFN0YWNrOmZ1bmN0aW9uKGEpe3ZhciBiPW4ubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLGEpO3JldHVybiBiLnByZXZPYmplY3Q9dGhpcyxiLmNvbnRleHQ9dGhpcy5jb250ZXh0LGJ9LGVhY2g6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbi5lYWNoKHRoaXMsYSxiKX0sbWFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhuLm1hcCh0aGlzLGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGEuY2FsbChiLGMsYil9KSl9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGQuYXBwbHkodGhpcyxhcmd1bWVudHMpKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sZXE6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5sZW5ndGgsYz0rYSsoMD5hP2I6MCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGM+PTAmJmI+Yz9bdGhpc1tjXV06W10pfSxlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2T2JqZWN0fHx0aGlzLmNvbnN0cnVjdG9yKG51bGwpfSxwdXNoOmYsc29ydDpjLnNvcnQsc3BsaWNlOmMuc3BsaWNlfSxuLmV4dGVuZD1uLmZuLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBhLGIsYyxkLGUsZixnPWFyZ3VtZW50c1swXXx8e30saD0xLGk9YXJndW1lbnRzLmxlbmd0aCxqPSExO2ZvcigiYm9vbGVhbiI9PXR5cGVvZiBnJiYoaj1nLGc9YXJndW1lbnRzW2hdfHx7fSxoKyspLCJvYmplY3QiPT10eXBlb2YgZ3x8bi5pc0Z1bmN0aW9uKGcpfHwoZz17fSksaD09PWkmJihnPXRoaXMsaC0tKTtpPmg7aCsrKWlmKG51bGwhPShhPWFyZ3VtZW50c1toXSkpZm9yKGIgaW4gYSljPWdbYl0sZD1hW2JdLGchPT1kJiYoaiYmZCYmKG4uaXNQbGFpbk9iamVjdChkKXx8KGU9bi5pc0FycmF5KGQpKSk/KGU/KGU9ITEsZj1jJiZuLmlzQXJyYXkoYyk/YzpbXSk6Zj1jJiZuLmlzUGxhaW5PYmplY3QoYyk/Yzp7fSxnW2JdPW4uZXh0ZW5kKGosZixkKSk6dm9pZCAwIT09ZCYmKGdbYl09ZCkpO3JldHVybiBnfSxuLmV4dGVuZCh7ZXhwYW5kbzoialF1ZXJ5IisobStNYXRoLnJhbmRvbSgpKS5yZXBsYWNlKC9cRC9nLCIiKSxpc1JlYWR5OiEwLGVycm9yOmZ1bmN0aW9uKGEpe3Rocm93IG5ldyBFcnJvcihhKX0sbm9vcDpmdW5jdGlvbigpe30saXNGdW5jdGlvbjpmdW5jdGlvbihhKXtyZXR1cm4iZnVuY3Rpb24iPT09bi50eXBlKGEpfSxpc0FycmF5OkFycmF5LmlzQXJyYXksaXNXaW5kb3c6ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGwhPWEmJmE9PT1hLndpbmRvd30saXNOdW1lcmljOmZ1bmN0aW9uKGEpe3JldHVybiFuLmlzQXJyYXkoYSkmJmEtcGFyc2VGbG9hdChhKSsxPj0wfSxpc1BsYWluT2JqZWN0OmZ1bmN0aW9uKGEpe3JldHVybiJvYmplY3QiIT09bi50eXBlKGEpfHxhLm5vZGVUeXBlfHxuLmlzV2luZG93KGEpPyExOmEuY29uc3RydWN0b3ImJiFqLmNhbGwoYS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsImlzUHJvdG90eXBlT2YiKT8hMTohMH0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihhKXt2YXIgYjtmb3IoYiBpbiBhKXJldHVybiExO3JldHVybiEwfSx0eXBlOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hP2ErIiI6Im9iamVjdCI9PXR5cGVvZiBhfHwiZnVuY3Rpb24iPT10eXBlb2YgYT9oW2kuY2FsbChhKV18fCJvYmplY3QiOnR5cGVvZiBhfSxnbG9iYWxFdmFsOmZ1bmN0aW9uKGEpe3ZhciBiLGM9ZXZhbDthPW4udHJpbShhKSxhJiYoMT09PWEuaW5kZXhPZigidXNlIHN0cmljdCIpPyhiPWwuY3JlYXRlRWxlbWVudCgic2NyaXB0IiksYi50ZXh0PWEsbC5oZWFkLmFwcGVuZENoaWxkKGIpLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYikpOmMoYSkpfSxjYW1lbENhc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZShwLCJtcy0iKS5yZXBsYWNlKHEscil9LG5vZGVOYW1lOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWIudG9Mb3dlckNhc2UoKX0sZWFjaDpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT0wLGY9YS5sZW5ndGgsZz1zKGEpO2lmKGMpe2lmKGcpe2Zvcig7Zj5lO2UrKylpZihkPWIuYXBwbHkoYVtlXSxjKSxkPT09ITEpYnJlYWt9ZWxzZSBmb3IoZSBpbiBhKWlmKGQ9Yi5hcHBseShhW2VdLGMpLGQ9PT0hMSlicmVha31lbHNlIGlmKGcpe2Zvcig7Zj5lO2UrKylpZihkPWIuY2FsbChhW2VdLGUsYVtlXSksZD09PSExKWJyZWFrfWVsc2UgZm9yKGUgaW4gYSlpZihkPWIuY2FsbChhW2VdLGUsYVtlXSksZD09PSExKWJyZWFrO3JldHVybiBhfSx0cmltOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hPyIiOihhKyIiKS5yZXBsYWNlKG8sIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1ifHxbXTtyZXR1cm4gbnVsbCE9YSYmKHMoT2JqZWN0KGEpKT9uLm1lcmdlKGMsInN0cmluZyI9PXR5cGVvZiBhP1thXTphKTpmLmNhbGwoYyxhKSksY30saW5BcnJheTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGw9PWI/LTE6Zy5jYWxsKGIsYSxjKX0sbWVyZ2U6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9K2IubGVuZ3RoLGQ9MCxlPWEubGVuZ3RoO2M+ZDtkKyspYVtlKytdPWJbZF07cmV0dXJuIGEubGVuZ3RoPWUsYX0sZ3JlcDpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkLGU9W10sZj0wLGc9YS5sZW5ndGgsaD0hYztnPmY7ZisrKWQ9IWIoYVtmXSxmKSxkIT09aCYmZS5wdXNoKGFbZl0pO3JldHVybiBlfSxtYXA6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGY9MCxnPWEubGVuZ3RoLGg9cyhhKSxpPVtdO2lmKGgpZm9yKDtnPmY7ZisrKWQ9YihhW2ZdLGYsYyksbnVsbCE9ZCYmaS5wdXNoKGQpO2Vsc2UgZm9yKGYgaW4gYSlkPWIoYVtmXSxmLGMpLG51bGwhPWQmJmkucHVzaChkKTtyZXR1cm4gZS5hcHBseShbXSxpKX0sZ3VpZDoxLHByb3h5OmZ1bmN0aW9uKGEsYil7dmFyIGMsZSxmO3JldHVybiJzdHJpbmciPT10eXBlb2YgYiYmKGM9YVtiXSxiPWEsYT1jKSxuLmlzRnVuY3Rpb24oYSk/KGU9ZC5jYWxsKGFyZ3VtZW50cywyKSxmPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYnx8dGhpcyxlLmNvbmNhdChkLmNhbGwoYXJndW1lbnRzKSkpfSxmLmd1aWQ9YS5ndWlkPWEuZ3VpZHx8bi5ndWlkKyssZik6dm9pZCAwfSxub3c6RGF0ZS5ub3csc3VwcG9ydDprfSksbi5lYWNoKCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yIi5zcGxpdCgiICIpLGZ1bmN0aW9uKGEsYil7aFsiW29iamVjdCAiK2IrIl0iXT1iLnRvTG93ZXJDYXNlKCl9KTtmdW5jdGlvbiBzKGEpe3ZhciBiPWEubGVuZ3RoLGM9bi50eXBlKGEpO3JldHVybiJmdW5jdGlvbiI9PT1jfHxuLmlzV2luZG93KGEpPyExOjE9PT1hLm5vZGVUeXBlJiZiPyEwOiJhcnJheSI9PT1jfHwwPT09Ynx8Im51bWJlciI9PXR5cGVvZiBiJiZiPjAmJmItMSBpbiBhfXZhciB0PWZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlLGYsZyxoLGksaixrLGwsbSxuLG8scCxxLHIscyx0LHU9InNpenpsZSIrMSpuZXcgRGF0ZSx2PWEuZG9jdW1lbnQsdz0wLHg9MCx5PWhiKCksej1oYigpLEE9aGIoKSxCPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9PT1iJiYobD0hMCksMH0sQz0xPDwzMSxEPXt9Lmhhc093blByb3BlcnR5LEU9W10sRj1FLnBvcCxHPUUucHVzaCxIPUUucHVzaCxJPUUuc2xpY2UsSj1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7ZD5jO2MrKylpZihhW2NdPT09YilyZXR1cm4gYztyZXR1cm4tMX0sSz0iY2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWQiLEw9IltcXHgyMFxcdFxcclxcblxcZl0iLE09Iig/OlxcXFwufFtcXHctXXxbXlxceDAwLVxceGEwXSkrIixOPU0ucmVwbGFjZSgidyIsIncjIiksTz0iXFxbIitMKyIqKCIrTSsiKSg/OiIrTCsiKihbKl4kfCF+XT89KSIrTCsiKig/OicoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwifCgiK04rIikpfCkiK0wrIipcXF0iLFA9IjooIitNKyIpKD86XFwoKCgnKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcIil8KCg/OlxcXFwufFteXFxcXCgpW1xcXV18IitPKyIpKil8LiopXFwpfCkiLFE9bmV3IFJlZ0V4cChMKyIrIiwiZyIpLFI9bmV3IFJlZ0V4cCgiXiIrTCsiK3woKD86XnxbXlxcXFxdKSg/OlxcXFwuKSopIitMKyIrJCIsImciKSxTPW5ldyBSZWdFeHAoIl4iK0wrIiosIitMKyIqIiksVD1uZXcgUmVnRXhwKCJeIitMKyIqKFs+K35dfCIrTCsiKSIrTCsiKiIpLFU9bmV3IFJlZ0V4cCgiPSIrTCsiKihbXlxcXSdcIl0qPykiK0wrIipcXF0iLCJnIiksVj1uZXcgUmVnRXhwKFApLFc9bmV3IFJlZ0V4cCgiXiIrTisiJCIpLFg9e0lEOm5ldyBSZWdFeHAoIl4jKCIrTSsiKSIpLENMQVNTOm5ldyBSZWdFeHAoIl5cXC4oIitNKyIpIiksVEFHOm5ldyBSZWdFeHAoIl4oIitNLnJlcGxhY2UoInciLCJ3KiIpKyIpIiksQVRUUjpuZXcgUmVnRXhwKCJeIitPKSxQU0VVRE86bmV3IFJlZ0V4cCgiXiIrUCksQ0hJTEQ6bmV3IFJlZ0V4cCgiXjoob25seXxmaXJzdHxsYXN0fG50aHxudGgtbGFzdCktKGNoaWxkfG9mLXR5cGUpKD86XFwoIitMKyIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIitMKyIqKD86KFsrLV18KSIrTCsiKihcXGQrKXwpKSIrTCsiKlxcKXwpIiwiaSIpLGJvb2w6bmV3IFJlZ0V4cCgiXig/OiIrSysiKSQiLCJpIiksbmVlZHNDb250ZXh0Om5ldyBSZWdFeHAoIl4iK0wrIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIrTCsiKigoPzotXFxkKT9cXGQqKSIrTCsiKlxcKXwpKD89W14tXXwkKSIsImkiKX0sWT0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLFo9L15oXGQkL2ksJD0vXltee10rXHtccypcW25hdGl2ZSBcdy8sXz0vXig/OiMoW1x3LV0rKXwoXHcrKXxcLihbXHctXSspKSQvLGFiPS9bK35dLyxiYj0vJ3xcXC9nLGNiPW5ldyBSZWdFeHAoIlxcXFwoW1xcZGEtZl17MSw2fSIrTCsiP3woIitMKyIpfC4pIiwiaWciKSxkYj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9IjB4IitiLTY1NTM2O3JldHVybiBkIT09ZHx8Yz9iOjA+ZD9TdHJpbmcuZnJvbUNoYXJDb2RlKGQrNjU1MzYpOlN0cmluZy5mcm9tQ2hhckNvZGUoZD4+MTB8NTUyOTYsMTAyMyZkfDU2MzIwKX0sZWI9ZnVuY3Rpb24oKXttKCl9O3RyeXtILmFwcGx5KEU9SS5jYWxsKHYuY2hpbGROb2Rlcyksdi5jaGlsZE5vZGVzKSxFW3YuY2hpbGROb2Rlcy5sZW5ndGhdLm5vZGVUeXBlfWNhdGNoKGZiKXtIPXthcHBseTpFLmxlbmd0aD9mdW5jdGlvbihhLGIpe0cuYXBwbHkoYSxJLmNhbGwoYikpfTpmdW5jdGlvbihhLGIpe3ZhciBjPWEubGVuZ3RoLGQ9MDt3aGlsZShhW2MrK109YltkKytdKTthLmxlbmd0aD1jLTF9fX1mdW5jdGlvbiBnYihhLGIsZCxlKXt2YXIgZixoLGosayxsLG8scixzLHcseDtpZigoYj9iLm93bmVyRG9jdW1lbnR8fGI6dikhPT1uJiZtKGIpLGI9Ynx8bixkPWR8fFtdLGs9Yi5ub2RlVHlwZSwic3RyaW5nIiE9dHlwZW9mIGF8fCFhfHwxIT09ayYmOSE9PWsmJjExIT09aylyZXR1cm4gZDtpZighZSYmcCl7aWYoMTEhPT1rJiYoZj1fLmV4ZWMoYSkpKWlmKGo9ZlsxXSl7aWYoOT09PWspe2lmKGg9Yi5nZXRFbGVtZW50QnlJZChqKSwhaHx8IWgucGFyZW50Tm9kZSlyZXR1cm4gZDtpZihoLmlkPT09ailyZXR1cm4gZC5wdXNoKGgpLGR9ZWxzZSBpZihiLm93bmVyRG9jdW1lbnQmJihoPWIub3duZXJEb2N1bWVudC5nZXRFbGVtZW50QnlJZChqKSkmJnQoYixoKSYmaC5pZD09PWopcmV0dXJuIGQucHVzaChoKSxkfWVsc2V7aWYoZlsyXSlyZXR1cm4gSC5hcHBseShkLGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYSkpLGQ7aWYoKGo9ZlszXSkmJmMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSlyZXR1cm4gSC5hcHBseShkLGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShqKSksZH1pZihjLnFzYSYmKCFxfHwhcS50ZXN0KGEpKSl7aWYocz1yPXUsdz1iLHg9MSE9PWsmJmEsMT09PWsmJiJvYmplY3QiIT09Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKXtvPWcoYSksKHI9Yi5nZXRBdHRyaWJ1dGUoImlkIikpP3M9ci5yZXBsYWNlKGJiLCJcXCQmIik6Yi5zZXRBdHRyaWJ1dGUoImlkIixzKSxzPSJbaWQ9JyIrcysiJ10gIixsPW8ubGVuZ3RoO3doaWxlKGwtLSlvW2xdPXMrcmIob1tsXSk7dz1hYi50ZXN0KGEpJiZwYihiLnBhcmVudE5vZGUpfHxiLHg9by5qb2luKCIsIil9aWYoeCl0cnl7cmV0dXJuIEguYXBwbHkoZCx3LnF1ZXJ5U2VsZWN0b3JBbGwoeCkpLGR9Y2F0Y2goeSl7fWZpbmFsbHl7cnx8Yi5yZW1vdmVBdHRyaWJ1dGUoImlkIil9fX1yZXR1cm4gaShhLnJlcGxhY2UoUiwiJDEiKSxiLGQsZSl9ZnVuY3Rpb24gaGIoKXt2YXIgYT1bXTtmdW5jdGlvbiBiKGMsZSl7cmV0dXJuIGEucHVzaChjKyIgIik+ZC5jYWNoZUxlbmd0aCYmZGVsZXRlIGJbYS5zaGlmdCgpXSxiW2MrIiAiXT1lfXJldHVybiBifWZ1bmN0aW9uIGliKGEpe3JldHVybiBhW3VdPSEwLGF9ZnVuY3Rpb24gamIoYSl7dmFyIGI9bi5jcmVhdGVFbGVtZW50KCJkaXYiKTt0cnl7cmV0dXJuISFhKGIpfWNhdGNoKGMpe3JldHVybiExfWZpbmFsbHl7Yi5wYXJlbnROb2RlJiZiLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYiksYj1udWxsfX1mdW5jdGlvbiBrYihhLGIpe3ZhciBjPWEuc3BsaXQoInwiKSxlPWEubGVuZ3RoO3doaWxlKGUtLSlkLmF0dHJIYW5kbGVbY1tlXV09Yn1mdW5jdGlvbiBsYihhLGIpe3ZhciBjPWImJmEsZD1jJiYxPT09YS5ub2RlVHlwZSYmMT09PWIubm9kZVR5cGUmJih+Yi5zb3VyY2VJbmRleHx8QyktKH5hLnNvdXJjZUluZGV4fHxDKTtpZihkKXJldHVybiBkO2lmKGMpd2hpbGUoYz1jLm5leHRTaWJsaW5nKWlmKGM9PT1iKXJldHVybi0xO3JldHVybiBhPzE6LTF9ZnVuY3Rpb24gbWIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3ZhciBjPWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09YyYmYi50eXBlPT09YX19ZnVuY3Rpb24gbmIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3ZhciBjPWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4oImlucHV0Ij09PWN8fCJidXR0b24iPT09YykmJmIudHlwZT09PWF9fWZ1bmN0aW9uIG9iKGEpe3JldHVybiBpYihmdW5jdGlvbihiKXtyZXR1cm4gYj0rYixpYihmdW5jdGlvbihjLGQpe3ZhciBlLGY9YShbXSxjLmxlbmd0aCxiKSxnPWYubGVuZ3RoO3doaWxlKGctLSljW2U9ZltnXV0mJihjW2VdPSEoZFtlXT1jW2VdKSl9KX0pfWZ1bmN0aW9uIHBiKGEpe3JldHVybiBhJiYidW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWUmJmF9Yz1nYi5zdXBwb3J0PXt9LGY9Z2IuaXNYTUw9ZnVuY3Rpb24oYSl7dmFyIGI9YSYmKGEub3duZXJEb2N1bWVudHx8YSkuZG9jdW1lbnRFbGVtZW50O3JldHVybiBiPyJIVE1MIiE9PWIubm9kZU5hbWU6ITF9LG09Z2Iuc2V0RG9jdW1lbnQ9ZnVuY3Rpb24oYSl7dmFyIGIsZSxnPWE/YS5vd25lckRvY3VtZW50fHxhOnY7cmV0dXJuIGchPT1uJiY5PT09Zy5ub2RlVHlwZSYmZy5kb2N1bWVudEVsZW1lbnQ/KG49ZyxvPWcuZG9jdW1lbnRFbGVtZW50LGU9Zy5kZWZhdWx0VmlldyxlJiZlIT09ZS50b3AmJihlLmFkZEV2ZW50TGlzdGVuZXI/ZS5hZGRFdmVudExpc3RlbmVyKCJ1bmxvYWQiLGViLCExKTplLmF0dGFjaEV2ZW50JiZlLmF0dGFjaEV2ZW50KCJvbnVubG9hZCIsZWIpKSxwPSFmKGcpLGMuYXR0cmlidXRlcz1qYihmdW5jdGlvbihhKXtyZXR1cm4gYS5jbGFzc05hbWU9ImkiLCFhLmdldEF0dHJpYnV0ZSgiY2xhc3NOYW1lIil9KSxjLmdldEVsZW1lbnRzQnlUYWdOYW1lPWpiKGZ1bmN0aW9uKGEpe3JldHVybiBhLmFwcGVuZENoaWxkKGcuY3JlYXRlQ29tbWVudCgiIikpLCFhLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RofSksYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lPSQudGVzdChnLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpLGMuZ2V0QnlJZD1qYihmdW5jdGlvbihhKXtyZXR1cm4gby5hcHBlbmRDaGlsZChhKS5pZD11LCFnLmdldEVsZW1lbnRzQnlOYW1lfHwhZy5nZXRFbGVtZW50c0J5TmFtZSh1KS5sZW5ndGh9KSxjLmdldEJ5SWQ/KGQuZmluZC5JRD1mdW5jdGlvbihhLGIpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgYi5nZXRFbGVtZW50QnlJZCYmcCl7dmFyIGM9Yi5nZXRFbGVtZW50QnlJZChhKTtyZXR1cm4gYyYmYy5wYXJlbnROb2RlP1tjXTpbXX19LGQuZmlsdGVyLklEPWZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShjYixkYik7cmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybiBhLmdldEF0dHJpYnV0ZSgiaWQiKT09PWJ9fSk6KGRlbGV0ZSBkLmZpbmQuSUQsZC5maWx0ZXIuSUQ9ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXBsYWNlKGNiLGRiKTtyZXR1cm4gZnVuY3Rpb24oYSl7dmFyIGM9InVuZGVmaW5lZCIhPXR5cGVvZiBhLmdldEF0dHJpYnV0ZU5vZGUmJmEuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKTtyZXR1cm4gYyYmYy52YWx1ZT09PWJ9fSksZC5maW5kLlRBRz1jLmdldEVsZW1lbnRzQnlUYWdOYW1lP2Z1bmN0aW9uKGEsYil7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBiLmdldEVsZW1lbnRzQnlUYWdOYW1lP2IuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYSk6Yy5xc2E/Yi5xdWVyeVNlbGVjdG9yQWxsKGEpOnZvaWQgMH06ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPVtdLGU9MCxmPWIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYSk7aWYoIioiPT09YSl7d2hpbGUoYz1mW2UrK10pMT09PWMubm9kZVR5cGUmJmQucHVzaChjKTtyZXR1cm4gZH1yZXR1cm4gZn0sZC5maW5kLkNMQVNTPWMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmZnVuY3Rpb24oYSxiKXtyZXR1cm4gcD9iLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYSk6dm9pZCAwfSxyPVtdLHE9W10sKGMucXNhPSQudGVzdChnLnF1ZXJ5U2VsZWN0b3JBbGwpKSYmKGpiKGZ1bmN0aW9uKGEpe28uYXBwZW5kQ2hpbGQoYSkuaW5uZXJIVE1MPSI8YSBpZD0nIit1KyInPjwvYT48c2VsZWN0IGlkPSciK3UrIi1cZl0nIG1zYWxsb3djYXB0dXJlPScnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IixhLnF1ZXJ5U2VsZWN0b3JBbGwoIlttc2FsbG93Y2FwdHVyZV49JyddIikubGVuZ3RoJiZxLnB1c2goIlsqXiRdPSIrTCsiKig/OicnfFwiXCIpIiksYS5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RofHxxLnB1c2goIlxcWyIrTCsiKig/OnZhbHVlfCIrSysiKSIpLGEucXVlcnlTZWxlY3RvckFsbCgiW2lkfj0iK3UrIi1dIikubGVuZ3RofHxxLnB1c2goIn49IiksYS5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aHx8cS5wdXNoKCI6Y2hlY2tlZCIpLGEucXVlcnlTZWxlY3RvckFsbCgiYSMiK3UrIisqIikubGVuZ3RofHxxLnB1c2goIi4jLitbK35dIil9KSxqYihmdW5jdGlvbihhKXt2YXIgYj1nLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7Yi5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKSxhLmFwcGVuZENoaWxkKGIpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPWRdIikubGVuZ3RoJiZxLnB1c2goIm5hbWUiK0wrIipbKl4kfCF+XT89IiksYS5xdWVyeVNlbGVjdG9yQWxsKCI6ZW5hYmxlZCIpLmxlbmd0aHx8cS5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLGEucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpLHEucHVzaCgiLC4qOiIpfSkpLChjLm1hdGNoZXNTZWxlY3Rvcj0kLnRlc3Qocz1vLm1hdGNoZXN8fG8ud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxvLm1vek1hdGNoZXNTZWxlY3Rvcnx8by5vTWF0Y2hlc1NlbGVjdG9yfHxvLm1zTWF0Y2hlc1NlbGVjdG9yKSkmJmpiKGZ1bmN0aW9uKGEpe2MuZGlzY29ubmVjdGVkTWF0Y2g9cy5jYWxsKGEsImRpdiIpLHMuY2FsbChhLCJbcyE9JyddOngiKSxyLnB1c2goIiE9IixQKX0pLHE9cS5sZW5ndGgmJm5ldyBSZWdFeHAocS5qb2luKCJ8IikpLHI9ci5sZW5ndGgmJm5ldyBSZWdFeHAoci5qb2luKCJ8IikpLGI9JC50ZXN0KG8uY29tcGFyZURvY3VtZW50UG9zaXRpb24pLHQ9Ynx8JC50ZXN0KG8uY29udGFpbnMpP2Z1bmN0aW9uKGEsYil7dmFyIGM9OT09PWEubm9kZVR5cGU/YS5kb2N1bWVudEVsZW1lbnQ6YSxkPWImJmIucGFyZW50Tm9kZTtyZXR1cm4gYT09PWR8fCEoIWR8fDEhPT1kLm5vZGVUeXBlfHwhKGMuY29udGFpbnM/Yy5jb250YWlucyhkKTphLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiYxNiZhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGQpKSl9OmZ1bmN0aW9uKGEsYil7aWYoYil3aGlsZShiPWIucGFyZW50Tm9kZSlpZihiPT09YSlyZXR1cm4hMDtyZXR1cm4hMX0sQj1iP2Z1bmN0aW9uKGEsYil7aWYoYT09PWIpcmV0dXJuIGw9ITAsMDt2YXIgZD0hYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbi0hYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbjtyZXR1cm4gZD9kOihkPShhLm93bmVyRG9jdW1lbnR8fGEpPT09KGIub3duZXJEb2N1bWVudHx8Yik/YS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihiKToxLDEmZHx8IWMuc29ydERldGFjaGVkJiZiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGEpPT09ZD9hPT09Z3x8YS5vd25lckRvY3VtZW50PT09diYmdCh2LGEpPy0xOmI9PT1nfHxiLm93bmVyRG9jdW1lbnQ9PT12JiZ0KHYsYik/MTprP0ooayxhKS1KKGssYik6MDo0JmQ/LTE6MSl9OmZ1bmN0aW9uKGEsYil7aWYoYT09PWIpcmV0dXJuIGw9ITAsMDt2YXIgYyxkPTAsZT1hLnBhcmVudE5vZGUsZj1iLnBhcmVudE5vZGUsaD1bYV0saT1bYl07aWYoIWV8fCFmKXJldHVybiBhPT09Zz8tMTpiPT09Zz8xOmU/LTE6Zj8xOms/SihrLGEpLUooayxiKTowO2lmKGU9PT1mKXJldHVybiBsYihhLGIpO2M9YTt3aGlsZShjPWMucGFyZW50Tm9kZSloLnVuc2hpZnQoYyk7Yz1iO3doaWxlKGM9Yy5wYXJlbnROb2RlKWkudW5zaGlmdChjKTt3aGlsZShoW2RdPT09aVtkXSlkKys7cmV0dXJuIGQ/bGIoaFtkXSxpW2RdKTpoW2RdPT09dj8tMTppW2RdPT09dj8xOjB9LGcpOm59LGdiLm1hdGNoZXM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2IoYSxudWxsLG51bGwsYil9LGdiLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihhLGIpe2lmKChhLm93bmVyRG9jdW1lbnR8fGEpIT09biYmbShhKSxiPWIucmVwbGFjZShVLCI9JyQxJ10iKSwhKCFjLm1hdGNoZXNTZWxlY3Rvcnx8IXB8fHImJnIudGVzdChiKXx8cSYmcS50ZXN0KGIpKSl0cnl7dmFyIGQ9cy5jYWxsKGEsYik7aWYoZHx8Yy5kaXNjb25uZWN0ZWRNYXRjaHx8YS5kb2N1bWVudCYmMTEhPT1hLmRvY3VtZW50Lm5vZGVUeXBlKXJldHVybiBkfWNhdGNoKGUpe31yZXR1cm4gZ2IoYixuLG51bGwsW2FdKS5sZW5ndGg+MH0sZ2IuY29udGFpbnM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4oYS5vd25lckRvY3VtZW50fHxhKSE9PW4mJm0oYSksdChhLGIpfSxnYi5hdHRyPWZ1bmN0aW9uKGEsYil7KGEub3duZXJEb2N1bWVudHx8YSkhPT1uJiZtKGEpO3ZhciBlPWQuYXR0ckhhbmRsZVtiLnRvTG93ZXJDYXNlKCldLGY9ZSYmRC5jYWxsKGQuYXR0ckhhbmRsZSxiLnRvTG93ZXJDYXNlKCkpP2UoYSxiLCFwKTp2b2lkIDA7cmV0dXJuIHZvaWQgMCE9PWY/ZjpjLmF0dHJpYnV0ZXN8fCFwP2EuZ2V0QXR0cmlidXRlKGIpOihmPWEuZ2V0QXR0cmlidXRlTm9kZShiKSkmJmYuc3BlY2lmaWVkP2YudmFsdWU6bnVsbH0sZ2IuZXJyb3I9ZnVuY3Rpb24oYSl7dGhyb3cgbmV3IEVycm9yKCJTeW50YXggZXJyb3IsIHVucmVjb2duaXplZCBleHByZXNzaW9uOiAiK2EpfSxnYi51bmlxdWVTb3J0PWZ1bmN0aW9uKGEpe3ZhciBiLGQ9W10sZT0wLGY9MDtpZihsPSFjLmRldGVjdER1cGxpY2F0ZXMsaz0hYy5zb3J0U3RhYmxlJiZhLnNsaWNlKDApLGEuc29ydChCKSxsKXt3aGlsZShiPWFbZisrXSliPT09YVtmXSYmKGU9ZC5wdXNoKGYpKTt3aGlsZShlLS0pYS5zcGxpY2UoZFtlXSwxKX1yZXR1cm4gaz1udWxsLGF9LGU9Z2IuZ2V0VGV4dD1mdW5jdGlvbihhKXt2YXIgYixjPSIiLGQ9MCxmPWEubm9kZVR5cGU7aWYoZil7aWYoMT09PWZ8fDk9PT1mfHwxMT09PWYpe2lmKCJzdHJpbmciPT10eXBlb2YgYS50ZXh0Q29udGVudClyZXR1cm4gYS50ZXh0Q29udGVudDtmb3IoYT1hLmZpcnN0Q2hpbGQ7YTthPWEubmV4dFNpYmxpbmcpYys9ZShhKX1lbHNlIGlmKDM9PT1mfHw0PT09ZilyZXR1cm4gYS5ub2RlVmFsdWV9ZWxzZSB3aGlsZShiPWFbZCsrXSljKz1lKGIpO3JldHVybiBjfSxkPWdiLnNlbGVjdG9ycz17Y2FjaGVMZW5ndGg6NTAsY3JlYXRlUHNldWRvOmliLG1hdGNoOlgsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6ITB9LCIgIjp7ZGlyOiJwYXJlbnROb2RlIn0sIisiOntkaXI6InByZXZpb3VzU2libGluZyIsZmlyc3Q6ITB9LCJ+Ijp7ZGlyOiJwcmV2aW91c1NpYmxpbmcifX0scHJlRmlsdGVyOntBVFRSOmZ1bmN0aW9uKGEpe3JldHVybiBhWzFdPWFbMV0ucmVwbGFjZShjYixkYiksYVszXT0oYVszXXx8YVs0XXx8YVs1XXx8IiIpLnJlcGxhY2UoY2IsZGIpLCJ+PSI9PT1hWzJdJiYoYVszXT0iICIrYVszXSsiICIpLGEuc2xpY2UoMCw0KX0sQ0hJTEQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGFbMV09YVsxXS50b0xvd2VyQ2FzZSgpLCJudGgiPT09YVsxXS5zbGljZSgwLDMpPyhhWzNdfHxnYi5lcnJvcihhWzBdKSxhWzRdPSsoYVs0XT9hWzVdKyhhWzZdfHwxKToyKigiZXZlbiI9PT1hWzNdfHwib2RkIj09PWFbM10pKSxhWzVdPSsoYVs3XSthWzhdfHwib2RkIj09PWFbM10pKTphWzNdJiZnYi5lcnJvcihhWzBdKSxhfSxQU0VVRE86ZnVuY3Rpb24oYSl7dmFyIGIsYz0hYVs2XSYmYVsyXTtyZXR1cm4gWC5DSElMRC50ZXN0KGFbMF0pP251bGw6KGFbM10/YVsyXT1hWzRdfHxhWzVdfHwiIjpjJiZWLnRlc3QoYykmJihiPWcoYywhMCkpJiYoYj1jLmluZGV4T2YoIikiLGMubGVuZ3RoLWIpLWMubGVuZ3RoKSYmKGFbMF09YVswXS5zbGljZSgwLGIpLGFbMl09Yy5zbGljZSgwLGIpKSxhLnNsaWNlKDAsMykpfX0sZmlsdGVyOntUQUc6ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXBsYWNlKGNiLGRiKS50b0xvd2VyQ2FzZSgpO3JldHVybiIqIj09PWE/ZnVuY3Rpb24oKXtyZXR1cm4hMH06ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWJ9fSxDTEFTUzpmdW5jdGlvbihhKXt2YXIgYj15W2ErIiAiXTtyZXR1cm4gYnx8KGI9bmV3IFJlZ0V4cCgiKF58IitMKyIpIithKyIoIitMKyJ8JCkiKSkmJnkoYSxmdW5jdGlvbihhKXtyZXR1cm4gYi50ZXN0KCJzdHJpbmciPT10eXBlb2YgYS5jbGFzc05hbWUmJmEuY2xhc3NOYW1lfHwidW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0QXR0cmlidXRlJiZhLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIpfSl9LEFUVFI6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmdW5jdGlvbihkKXt2YXIgZT1nYi5hdHRyKGQsYSk7cmV0dXJuIG51bGw9PWU/IiE9Ij09PWI6Yj8oZSs9IiIsIj0iPT09Yj9lPT09YzoiIT0iPT09Yj9lIT09YzoiXj0iPT09Yj9jJiYwPT09ZS5pbmRleE9mKGMpOiIqPSI9PT1iP2MmJmUuaW5kZXhPZihjKT4tMToiJD0iPT09Yj9jJiZlLnNsaWNlKC1jLmxlbmd0aCk9PT1jOiJ+PSI9PT1iPygiICIrZS5yZXBsYWNlKFEsIiAiKSsiICIpLmluZGV4T2YoYyk+LTE6Inw9Ij09PWI/ZT09PWN8fGUuc2xpY2UoMCxjLmxlbmd0aCsxKT09PWMrIi0iOiExKTohMH19LENISUxEOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9Im50aCIhPT1hLnNsaWNlKDAsMyksZz0ibGFzdCIhPT1hLnNsaWNlKC00KSxoPSJvZi10eXBlIj09PWI7cmV0dXJuIDE9PT1kJiYwPT09ZT9mdW5jdGlvbihhKXtyZXR1cm4hIWEucGFyZW50Tm9kZX06ZnVuY3Rpb24oYixjLGkpe3ZhciBqLGssbCxtLG4sbyxwPWYhPT1nPyJuZXh0U2libGluZyI6InByZXZpb3VzU2libGluZyIscT1iLnBhcmVudE5vZGUscj1oJiZiLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkscz0haSYmIWg7aWYocSl7aWYoZil7d2hpbGUocCl7bD1iO3doaWxlKGw9bFtwXSlpZihoP2wubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXI6MT09PWwubm9kZVR5cGUpcmV0dXJuITE7bz1wPSJvbmx5Ij09PWEmJiFvJiYibmV4dFNpYmxpbmcifXJldHVybiEwfWlmKG89W2c/cS5maXJzdENoaWxkOnEubGFzdENoaWxkXSxnJiZzKXtrPXFbdV18fChxW3VdPXt9KSxqPWtbYV18fFtdLG49alswXT09PXcmJmpbMV0sbT1qWzBdPT09dyYmalsyXSxsPW4mJnEuY2hpbGROb2Rlc1tuXTt3aGlsZShsPSsrbiYmbCYmbFtwXXx8KG09bj0wKXx8by5wb3AoKSlpZigxPT09bC5ub2RlVHlwZSYmKyttJiZsPT09Yil7a1thXT1bdyxuLG1dO2JyZWFrfX1lbHNlIGlmKHMmJihqPShiW3VdfHwoYlt1XT17fSkpW2FdKSYmalswXT09PXcpbT1qWzFdO2Vsc2Ugd2hpbGUobD0rK24mJmwmJmxbcF18fChtPW49MCl8fG8ucG9wKCkpaWYoKGg/bC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09cjoxPT09bC5ub2RlVHlwZSkmJisrbSYmKHMmJigobFt1XXx8KGxbdV09e30pKVthXT1bdyxtXSksbD09PWIpKWJyZWFrO3JldHVybiBtLT1lLG09PT1kfHxtJWQ9PT0wJiZtL2Q+PTB9fX0sUFNFVURPOmZ1bmN0aW9uKGEsYil7dmFyIGMsZT1kLnBzZXVkb3NbYV18fGQuc2V0RmlsdGVyc1thLnRvTG93ZXJDYXNlKCldfHxnYi5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiK2EpO3JldHVybiBlW3VdP2UoYik6ZS5sZW5ndGg+MT8oYz1bYSxhLCIiLGJdLGQuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShhLnRvTG93ZXJDYXNlKCkpP2liKGZ1bmN0aW9uKGEsYyl7dmFyIGQsZj1lKGEsYiksZz1mLmxlbmd0aDt3aGlsZShnLS0pZD1KKGEsZltnXSksYVtkXT0hKGNbZF09ZltnXSl9KTpmdW5jdGlvbihhKXtyZXR1cm4gZShhLDAsYyl9KTplfX0scHNldWRvczp7bm90OmliKGZ1bmN0aW9uKGEpe3ZhciBiPVtdLGM9W10sZD1oKGEucmVwbGFjZShSLCIkMSIpKTtyZXR1cm4gZFt1XT9pYihmdW5jdGlvbihhLGIsYyxlKXt2YXIgZixnPWQoYSxudWxsLGUsW10pLGg9YS5sZW5ndGg7d2hpbGUoaC0tKShmPWdbaF0pJiYoYVtoXT0hKGJbaF09ZikpfSk6ZnVuY3Rpb24oYSxlLGYpe3JldHVybiBiWzBdPWEsZChiLG51bGwsZixjKSxiWzBdPW51bGwsIWMucG9wKCl9fSksaGFzOmliKGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gZ2IoYSxiKS5sZW5ndGg+MH19KSxjb250YWluczppYihmdW5jdGlvbihhKXtyZXR1cm4gYT1hLnJlcGxhY2UoY2IsZGIpLGZ1bmN0aW9uKGIpe3JldHVybihiLnRleHRDb250ZW50fHxiLmlubmVyVGV4dHx8ZShiKSkuaW5kZXhPZihhKT4tMX19KSxsYW5nOmliKGZ1bmN0aW9uKGEpe3JldHVybiBXLnRlc3QoYXx8IiIpfHxnYi5lcnJvcigidW5zdXBwb3J0ZWQgbGFuZzogIithKSxhPWEucmVwbGFjZShjYixkYikudG9Mb3dlckNhc2UoKSxmdW5jdGlvbihiKXt2YXIgYztkbyBpZihjPXA/Yi5sYW5nOmIuZ2V0QXR0cmlidXRlKCJ4bWw6bGFuZyIpfHxiLmdldEF0dHJpYnV0ZSgibGFuZyIpKXJldHVybiBjPWMudG9Mb3dlckNhc2UoKSxjPT09YXx8MD09PWMuaW5kZXhPZihhKyItIik7d2hpbGUoKGI9Yi5wYXJlbnROb2RlKSYmMT09PWIubm9kZVR5cGUpO3JldHVybiExfX0pLHRhcmdldDpmdW5jdGlvbihiKXt2YXIgYz1hLmxvY2F0aW9uJiZhLmxvY2F0aW9uLmhhc2g7cmV0dXJuIGMmJmMuc2xpY2UoMSk9PT1iLmlkfSxyb290OmZ1bmN0aW9uKGEpe3JldHVybiBhPT09b30sZm9jdXM6ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1uLmFjdGl2ZUVsZW1lbnQmJighbi5oYXNGb2N1c3x8bi5oYXNGb2N1cygpKSYmISEoYS50eXBlfHxhLmhyZWZ8fH5hLnRhYkluZGV4KX0sZW5hYmxlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5kaXNhYmxlZD09PSExfSxkaXNhYmxlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5kaXNhYmxlZD09PSEwfSxjaGVja2VkOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09YiYmISFhLmNoZWNrZWR8fCJvcHRpb24iPT09YiYmISFhLnNlbGVjdGVkfSxzZWxlY3RlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5wYXJlbnROb2RlJiZhLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxhLnNlbGVjdGVkPT09ITB9LGVtcHR5OmZ1bmN0aW9uKGEpe2ZvcihhPWEuZmlyc3RDaGlsZDthO2E9YS5uZXh0U2libGluZylpZihhLm5vZGVUeXBlPDYpcmV0dXJuITE7cmV0dXJuITB9LHBhcmVudDpmdW5jdGlvbihhKXtyZXR1cm4hZC5wc2V1ZG9zLmVtcHR5KGEpfSxoZWFkZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIFoudGVzdChhLm5vZGVOYW1lKX0saW5wdXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIFkudGVzdChhLm5vZGVOYW1lKX0sYnV0dG9uOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09YiYmImJ1dHRvbiI9PT1hLnR5cGV8fCJidXR0b24iPT09Yn0sdGV4dDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4iaW5wdXQiPT09YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiYidGV4dCI9PT1hLnR5cGUmJihudWxsPT0oYj1hLmdldEF0dHJpYnV0ZSgidHlwZSIpKXx8InRleHQiPT09Yi50b0xvd2VyQ2FzZSgpKX0sZmlyc3Q6b2IoZnVuY3Rpb24oKXtyZXR1cm5bMF19KSxsYXN0Om9iKGZ1bmN0aW9uKGEsYil7cmV0dXJuW2ItMV19KSxlcTpvYihmdW5jdGlvbihhLGIsYyl7cmV0dXJuWzA+Yz9jK2I6Y119KSxldmVuOm9iKGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTA7Yj5jO2MrPTIpYS5wdXNoKGMpO3JldHVybiBhfSksb2RkOm9iKGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTE7Yj5jO2MrPTIpYS5wdXNoKGMpO3JldHVybiBhfSksbHQ6b2IoZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD0wPmM/YytiOmM7LS1kPj0wOylhLnB1c2goZCk7cmV0dXJuIGF9KSxndDpvYihmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPTA+Yz9jK2I6YzsrK2Q8YjspYS5wdXNoKGQpO3JldHVybiBhfSl9fSxkLnBzZXVkb3MubnRoPWQucHNldWRvcy5lcTtmb3IoYiBpbntyYWRpbzohMCxjaGVja2JveDohMCxmaWxlOiEwLHBhc3N3b3JkOiEwLGltYWdlOiEwfSlkLnBzZXVkb3NbYl09bWIoYik7Zm9yKGIgaW57c3VibWl0OiEwLHJlc2V0OiEwfSlkLnBzZXVkb3NbYl09bmIoYik7ZnVuY3Rpb24gcWIoKXt9cWIucHJvdG90eXBlPWQuZmlsdGVycz1kLnBzZXVkb3MsZC5zZXRGaWx0ZXJzPW5ldyBxYixnPWdiLnRva2VuaXplPWZ1bmN0aW9uKGEsYil7dmFyIGMsZSxmLGcsaCxpLGosaz16W2ErIiAiXTtpZihrKXJldHVybiBiPzA6ay5zbGljZSgwKTtoPWEsaT1bXSxqPWQucHJlRmlsdGVyO3doaWxlKGgpeyghY3x8KGU9Uy5leGVjKGgpKSkmJihlJiYoaD1oLnNsaWNlKGVbMF0ubGVuZ3RoKXx8aCksaS5wdXNoKGY9W10pKSxjPSExLChlPVQuZXhlYyhoKSkmJihjPWUuc2hpZnQoKSxmLnB1c2goe3ZhbHVlOmMsdHlwZTplWzBdLnJlcGxhY2UoUiwiICIpfSksaD1oLnNsaWNlKGMubGVuZ3RoKSk7Zm9yKGcgaW4gZC5maWx0ZXIpIShlPVhbZ10uZXhlYyhoKSl8fGpbZ10mJiEoZT1qW2ddKGUpKXx8KGM9ZS5zaGlmdCgpLGYucHVzaCh7dmFsdWU6Yyx0eXBlOmcsbWF0Y2hlczplfSksaD1oLnNsaWNlKGMubGVuZ3RoKSk7aWYoIWMpYnJlYWt9cmV0dXJuIGI/aC5sZW5ndGg6aD9nYi5lcnJvcihhKTp6KGEsaSkuc2xpY2UoMCl9O2Z1bmN0aW9uIHJiKGEpe2Zvcih2YXIgYj0wLGM9YS5sZW5ndGgsZD0iIjtjPmI7YisrKWQrPWFbYl0udmFsdWU7cmV0dXJuIGR9ZnVuY3Rpb24gc2IoYSxiLGMpe3ZhciBkPWIuZGlyLGU9YyYmInBhcmVudE5vZGUiPT09ZCxmPXgrKztyZXR1cm4gYi5maXJzdD9mdW5jdGlvbihiLGMsZil7d2hpbGUoYj1iW2RdKWlmKDE9PT1iLm5vZGVUeXBlfHxlKXJldHVybiBhKGIsYyxmKX06ZnVuY3Rpb24oYixjLGcpe3ZhciBoLGksaj1bdyxmXTtpZihnKXt3aGlsZShiPWJbZF0paWYoKDE9PT1iLm5vZGVUeXBlfHxlKSYmYShiLGMsZykpcmV0dXJuITB9ZWxzZSB3aGlsZShiPWJbZF0paWYoMT09PWIubm9kZVR5cGV8fGUpe2lmKGk9Ylt1XXx8KGJbdV09e30pLChoPWlbZF0pJiZoWzBdPT09dyYmaFsxXT09PWYpcmV0dXJuIGpbMl09aFsyXTtpZihpW2RdPWosalsyXT1hKGIsYyxnKSlyZXR1cm4hMH19fWZ1bmN0aW9uIHRiKGEpe3JldHVybiBhLmxlbmd0aD4xP2Z1bmN0aW9uKGIsYyxkKXt2YXIgZT1hLmxlbmd0aDt3aGlsZShlLS0paWYoIWFbZV0oYixjLGQpKXJldHVybiExO3JldHVybiEwfTphWzBdfWZ1bmN0aW9uIHViKGEsYixjKXtmb3IodmFyIGQ9MCxlPWIubGVuZ3RoO2U+ZDtkKyspZ2IoYSxiW2RdLGMpO3JldHVybiBjfWZ1bmN0aW9uIHZiKGEsYixjLGQsZSl7Zm9yKHZhciBmLGc9W10saD0wLGk9YS5sZW5ndGgsaj1udWxsIT1iO2k+aDtoKyspKGY9YVtoXSkmJighY3x8YyhmLGQsZSkpJiYoZy5wdXNoKGYpLGomJmIucHVzaChoKSk7cmV0dXJuIGd9ZnVuY3Rpb24gd2IoYSxiLGMsZCxlLGYpe3JldHVybiBkJiYhZFt1XSYmKGQ9d2IoZCkpLGUmJiFlW3VdJiYoZT13YihlLGYpKSxpYihmdW5jdGlvbihmLGcsaCxpKXt2YXIgaixrLGwsbT1bXSxuPVtdLG89Zy5sZW5ndGgscD1mfHx1YihifHwiKiIsaC5ub2RlVHlwZT9baF06aCxbXSkscT0hYXx8IWYmJmI/cDp2YihwLG0sYSxoLGkpLHI9Yz9lfHwoZj9hOm98fGQpP1tdOmc6cTtpZihjJiZjKHEscixoLGkpLGQpe2o9dmIocixuKSxkKGosW10saCxpKSxrPWoubGVuZ3RoO3doaWxlKGstLSkobD1qW2tdKSYmKHJbbltrXV09IShxW25ba11dPWwpKX1pZihmKXtpZihlfHxhKXtpZihlKXtqPVtdLGs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiZqLnB1c2gocVtrXT1sKTtlKG51bGwscj1bXSxqLGkpfWs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiYoaj1lP0ooZixsKTptW2tdKT4tMSYmKGZbal09IShnW2pdPWwpKX19ZWxzZSByPXZiKHI9PT1nP3Iuc3BsaWNlKG8sci5sZW5ndGgpOnIpLGU/ZShudWxsLGcscixpKTpILmFwcGx5KGcscil9KX1mdW5jdGlvbiB4YihhKXtmb3IodmFyIGIsYyxlLGY9YS5sZW5ndGgsZz1kLnJlbGF0aXZlW2FbMF0udHlwZV0saD1nfHxkLnJlbGF0aXZlWyIgIl0saT1nPzE6MCxrPXNiKGZ1bmN0aW9uKGEpe3JldHVybiBhPT09Yn0saCwhMCksbD1zYihmdW5jdGlvbihhKXtyZXR1cm4gSihiLGEpPi0xfSxoLCEwKSxtPVtmdW5jdGlvbihhLGMsZCl7dmFyIGU9IWcmJihkfHxjIT09ail8fCgoYj1jKS5ub2RlVHlwZT9rKGEsYyxkKTpsKGEsYyxkKSk7cmV0dXJuIGI9bnVsbCxlfV07Zj5pO2krKylpZihjPWQucmVsYXRpdmVbYVtpXS50eXBlXSltPVtzYih0YihtKSxjKV07ZWxzZXtpZihjPWQuZmlsdGVyW2FbaV0udHlwZV0uYXBwbHkobnVsbCxhW2ldLm1hdGNoZXMpLGNbdV0pe2ZvcihlPSsraTtmPmU7ZSsrKWlmKGQucmVsYXRpdmVbYVtlXS50eXBlXSlicmVhaztyZXR1cm4gd2IoaT4xJiZ0YihtKSxpPjEmJnJiKGEuc2xpY2UoMCxpLTEpLmNvbmNhdCh7dmFsdWU6IiAiPT09YVtpLTJdLnR5cGU/IioiOiIifSkpLnJlcGxhY2UoUiwiJDEiKSxjLGU+aSYmeGIoYS5zbGljZShpLGUpKSxmPmUmJnhiKGE9YS5zbGljZShlKSksZj5lJiZyYihhKSl9bS5wdXNoKGMpfXJldHVybiB0YihtKX1mdW5jdGlvbiB5YihhLGIpe3ZhciBjPWIubGVuZ3RoPjAsZT1hLmxlbmd0aD4wLGY9ZnVuY3Rpb24oZixnLGgsaSxrKXt2YXIgbCxtLG8scD0wLHE9IjAiLHI9ZiYmW10scz1bXSx0PWosdT1mfHxlJiZkLmZpbmQuVEFHKCIqIixrKSx2PXcrPW51bGw9PXQ/MTpNYXRoLnJhbmRvbSgpfHwuMSx4PXUubGVuZ3RoO2ZvcihrJiYoaj1nIT09biYmZyk7cSE9PXgmJm51bGwhPShsPXVbcV0pO3ErKyl7aWYoZSYmbCl7bT0wO3doaWxlKG89YVttKytdKWlmKG8obCxnLGgpKXtpLnB1c2gobCk7YnJlYWt9ayYmKHc9dil9YyYmKChsPSFvJiZsKSYmcC0tLGYmJnIucHVzaChsKSl9aWYocCs9cSxjJiZxIT09cCl7bT0wO3doaWxlKG89YlttKytdKW8ocixzLGcsaCk7aWYoZil7aWYocD4wKXdoaWxlKHEtLSlyW3FdfHxzW3FdfHwoc1txXT1GLmNhbGwoaSkpO3M9dmIocyl9SC5hcHBseShpLHMpLGsmJiFmJiZzLmxlbmd0aD4wJiZwK2IubGVuZ3RoPjEmJmdiLnVuaXF1ZVNvcnQoaSl9cmV0dXJuIGsmJih3PXYsaj10KSxyfTtyZXR1cm4gYz9pYihmKTpmfXJldHVybiBoPWdiLmNvbXBpbGU9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPVtdLGU9W10sZj1BW2ErIiAiXTtpZighZil7Ynx8KGI9ZyhhKSksYz1iLmxlbmd0aDt3aGlsZShjLS0pZj14YihiW2NdKSxmW3VdP2QucHVzaChmKTplLnB1c2goZik7Zj1BKGEseWIoZSxkKSksZi5zZWxlY3Rvcj1hfXJldHVybiBmfSxpPWdiLnNlbGVjdD1mdW5jdGlvbihhLGIsZSxmKXt2YXIgaSxqLGssbCxtLG49ImZ1bmN0aW9uIj09dHlwZW9mIGEmJmEsbz0hZiYmZyhhPW4uc2VsZWN0b3J8fGEpO2lmKGU9ZXx8W10sMT09PW8ubGVuZ3RoKXtpZihqPW9bMF09b1swXS5zbGljZSgwKSxqLmxlbmd0aD4yJiYiSUQiPT09KGs9alswXSkudHlwZSYmYy5nZXRCeUlkJiY5PT09Yi5ub2RlVHlwZSYmcCYmZC5yZWxhdGl2ZVtqWzFdLnR5cGVdKXtpZihiPShkLmZpbmQuSUQoay5tYXRjaGVzWzBdLnJlcGxhY2UoY2IsZGIpLGIpfHxbXSlbMF0sIWIpcmV0dXJuIGU7biYmKGI9Yi5wYXJlbnROb2RlKSxhPWEuc2xpY2Uoai5zaGlmdCgpLnZhbHVlLmxlbmd0aCl9aT1YLm5lZWRzQ29udGV4dC50ZXN0KGEpPzA6ai5sZW5ndGg7d2hpbGUoaS0tKXtpZihrPWpbaV0sZC5yZWxhdGl2ZVtsPWsudHlwZV0pYnJlYWs7aWYoKG09ZC5maW5kW2xdKSYmKGY9bShrLm1hdGNoZXNbMF0ucmVwbGFjZShjYixkYiksYWIudGVzdChqWzBdLnR5cGUpJiZwYihiLnBhcmVudE5vZGUpfHxiKSkpe2lmKGouc3BsaWNlKGksMSksYT1mLmxlbmd0aCYmcmIoaiksIWEpcmV0dXJuIEguYXBwbHkoZSxmKSxlO2JyZWFrfX19cmV0dXJuKG58fGgoYSxvKSkoZixiLCFwLGUsYWIudGVzdChhKSYmcGIoYi5wYXJlbnROb2RlKXx8YiksZX0sYy5zb3J0U3RhYmxlPXUuc3BsaXQoIiIpLnNvcnQoQikuam9pbigiIik9PT11LGMuZGV0ZWN0RHVwbGljYXRlcz0hIWwsbSgpLGMuc29ydERldGFjaGVkPWpiKGZ1bmN0aW9uKGEpe3JldHVybiAxJmEuY29tcGFyZURvY3VtZW50UG9zaXRpb24obi5jcmVhdGVFbGVtZW50KCJkaXYiKSl9KSxqYihmdW5jdGlvbihhKXtyZXR1cm4gYS5pbm5lckhUTUw9IjxhIGhyZWY9JyMnPjwvYT4iLCIjIj09PWEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImhyZWYiKX0pfHxrYigidHlwZXxocmVmfGhlaWdodHx3aWR0aCIsZnVuY3Rpb24oYSxiLGMpe3JldHVybiBjP3ZvaWQgMDphLmdldEF0dHJpYnV0ZShiLCJ0eXBlIj09PWIudG9Mb3dlckNhc2UoKT8xOjIpfSksYy5hdHRyaWJ1dGVzJiZqYihmdW5jdGlvbihhKXtyZXR1cm4gYS5pbm5lckhUTUw9IjxpbnB1dC8+IixhLmZpcnN0Q2hpbGQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsIiIpLCIiPT09YS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgidmFsdWUiKX0pfHxrYigidmFsdWUiLGZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gY3x8ImlucHV0IiE9PWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT92b2lkIDA6YS5kZWZhdWx0VmFsdWV9KSxqYihmdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09YS5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIil9KXx8a2IoSyxmdW5jdGlvbihhLGIsYyl7dmFyIGQ7cmV0dXJuIGM/dm9pZCAwOmFbYl09PT0hMD9iLnRvTG93ZXJDYXNlKCk6KGQ9YS5nZXRBdHRyaWJ1dGVOb2RlKGIpKSYmZC5zcGVjaWZpZWQ/ZC52YWx1ZTpudWxsfSksZ2J9KGEpO24uZmluZD10LG4uZXhwcj10LnNlbGVjdG9ycyxuLmV4cHJbIjoiXT1uLmV4cHIucHNldWRvcyxuLnVuaXF1ZT10LnVuaXF1ZVNvcnQsbi50ZXh0PXQuZ2V0VGV4dCxuLmlzWE1MRG9jPXQuaXNYTUwsbi5jb250YWlucz10LmNvbnRhaW5zO3ZhciB1PW4uZXhwci5tYXRjaC5uZWVkc0NvbnRleHQsdj0vXjwoXHcrKVxzKlwvPz4oPzo8XC9cMT58KSQvLHc9L14uW146I1xbXC4sXSokLztmdW5jdGlvbiB4KGEsYixjKXtpZihuLmlzRnVuY3Rpb24oYikpcmV0dXJuIG4uZ3JlcChhLGZ1bmN0aW9uKGEsZCl7cmV0dXJuISFiLmNhbGwoYSxkLGEpIT09Y30pO2lmKGIubm9kZVR5cGUpcmV0dXJuIG4uZ3JlcChhLGZ1bmN0aW9uKGEpe3JldHVybiBhPT09YiE9PWN9KTtpZigic3RyaW5nIj09dHlwZW9mIGIpe2lmKHcudGVzdChiKSlyZXR1cm4gbi5maWx0ZXIoYixhLGMpO2I9bi5maWx0ZXIoYixhKX1yZXR1cm4gbi5ncmVwKGEsZnVuY3Rpb24oYSl7cmV0dXJuIGcuY2FsbChiLGEpPj0wIT09Y30pfW4uZmlsdGVyPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iWzBdO3JldHVybiBjJiYoYT0iOm5vdCgiK2ErIikiKSwxPT09Yi5sZW5ndGgmJjE9PT1kLm5vZGVUeXBlP24uZmluZC5tYXRjaGVzU2VsZWN0b3IoZCxhKT9bZF06W106bi5maW5kLm1hdGNoZXMoYSxuLmdyZXAoYixmdW5jdGlvbihhKXtyZXR1cm4gMT09PWEubm9kZVR5cGV9KSl9LG4uZm4uZXh0ZW5kKHtmaW5kOmZ1bmN0aW9uKGEpe3ZhciBiLGM9dGhpcy5sZW5ndGgsZD1bXSxlPXRoaXM7aWYoInN0cmluZyIhPXR5cGVvZiBhKXJldHVybiB0aGlzLnB1c2hTdGFjayhuKGEpLmZpbHRlcihmdW5jdGlvbigpe2ZvcihiPTA7Yz5iO2IrKylpZihuLmNvbnRhaW5zKGVbYl0sdGhpcykpcmV0dXJuITB9KSk7Zm9yKGI9MDtjPmI7YisrKW4uZmluZChhLGVbYl0sZCk7cmV0dXJuIGQ9dGhpcy5wdXNoU3RhY2soYz4xP24udW5pcXVlKGQpOmQpLGQuc2VsZWN0b3I9dGhpcy5zZWxlY3Rvcj90aGlzLnNlbGVjdG9yKyIgIithOmEsZH0sZmlsdGVyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayh4KHRoaXMsYXx8W10sITEpKX0sbm90OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayh4KHRoaXMsYXx8W10sITApKX0saXM6ZnVuY3Rpb24oYSl7cmV0dXJuISF4KHRoaXMsInN0cmluZyI9PXR5cGVvZiBhJiZ1LnRlc3QoYSk/bihhKTphfHxbXSwhMSkubGVuZ3RofX0pO3ZhciB5LHo9L14oPzpccyooPFtcd1xXXSs+KVtePl0qfCMoW1x3LV0qKSkkLyxBPW4uZm4uaW5pdD1mdW5jdGlvbihhLGIpe3ZhciBjLGQ7aWYoIWEpcmV0dXJuIHRoaXM7aWYoInN0cmluZyI9PXR5cGVvZiBhKXtpZihjPSI8Ij09PWFbMF0mJiI+Ij09PWFbYS5sZW5ndGgtMV0mJmEubGVuZ3RoPj0zP1tudWxsLGEsbnVsbF06ei5leGVjKGEpLCFjfHwhY1sxXSYmYilyZXR1cm4hYnx8Yi5qcXVlcnk/KGJ8fHkpLmZpbmQoYSk6dGhpcy5jb25zdHJ1Y3RvcihiKS5maW5kKGEpO2lmKGNbMV0pe2lmKGI9YiBpbnN0YW5jZW9mIG4/YlswXTpiLG4ubWVyZ2UodGhpcyxuLnBhcnNlSFRNTChjWzFdLGImJmIubm9kZVR5cGU/Yi5vd25lckRvY3VtZW50fHxiOmwsITApKSx2LnRlc3QoY1sxXSkmJm4uaXNQbGFpbk9iamVjdChiKSlmb3IoYyBpbiBiKW4uaXNGdW5jdGlvbih0aGlzW2NdKT90aGlzW2NdKGJbY10pOnRoaXMuYXR0cihjLGJbY10pO3JldHVybiB0aGlzfXJldHVybiBkPWwuZ2V0RWxlbWVudEJ5SWQoY1syXSksZCYmZC5wYXJlbnROb2RlJiYodGhpcy5sZW5ndGg9MSx0aGlzWzBdPWQpLHRoaXMuY29udGV4dD1sLHRoaXMuc2VsZWN0b3I9YSx0aGlzfXJldHVybiBhLm5vZGVUeXBlPyh0aGlzLmNvbnRleHQ9dGhpc1swXT1hLHRoaXMubGVuZ3RoPTEsdGhpcyk6bi5pc0Z1bmN0aW9uKGEpPyJ1bmRlZmluZWQiIT10eXBlb2YgeS5yZWFkeT95LnJlYWR5KGEpOmEobik6KHZvaWQgMCE9PWEuc2VsZWN0b3ImJih0aGlzLnNlbGVjdG9yPWEuc2VsZWN0b3IsdGhpcy5jb250ZXh0PWEuY29udGV4dCksbi5tYWtlQXJyYXkoYSx0aGlzKSl9O0EucHJvdG90eXBlPW4uZm4seT1uKGwpO3ZhciBCPS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLEM9e2NoaWxkcmVuOiEwLGNvbnRlbnRzOiEwLG5leHQ6ITAscHJldjohMH07bi5leHRlbmQoe2RpcjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9W10sZT12b2lkIDAhPT1jO3doaWxlKChhPWFbYl0pJiY5IT09YS5ub2RlVHlwZSlpZigxPT09YS5ub2RlVHlwZSl7aWYoZSYmbihhKS5pcyhjKSlicmVhaztkLnB1c2goYSl9cmV0dXJuIGR9LHNpYmxpbmc6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W107YTthPWEubmV4dFNpYmxpbmcpMT09PWEubm9kZVR5cGUmJmEhPT1iJiZjLnB1c2goYSk7cmV0dXJuIGN9fSksbi5mbi5leHRlbmQoe2hhczpmdW5jdGlvbihhKXt2YXIgYj1uKGEsdGhpcyksYz1iLmxlbmd0aDtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodmFyIGE9MDtjPmE7YSsrKWlmKG4uY29udGFpbnModGhpcyxiW2FdKSlyZXR1cm4hMH0pfSxjbG9zZXN0OmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjLGQ9MCxlPXRoaXMubGVuZ3RoLGY9W10sZz11LnRlc3QoYSl8fCJzdHJpbmciIT10eXBlb2YgYT9uKGEsYnx8dGhpcy5jb250ZXh0KTowO2U+ZDtkKyspZm9yKGM9dGhpc1tkXTtjJiZjIT09YjtjPWMucGFyZW50Tm9kZSlpZihjLm5vZGVUeXBlPDExJiYoZz9nLmluZGV4KGMpPi0xOjE9PT1jLm5vZGVUeXBlJiZuLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGMsYSkpKXtmLnB1c2goYyk7YnJlYWt9cmV0dXJuIHRoaXMucHVzaFN0YWNrKGYubGVuZ3RoPjE/bi51bmlxdWUoZik6Zil9LGluZGV4OmZ1bmN0aW9uKGEpe3JldHVybiBhPyJzdHJpbmciPT10eXBlb2YgYT9nLmNhbGwobihhKSx0aGlzWzBdKTpnLmNhbGwodGhpcyxhLmpxdWVyeT9hWzBdOmEpOnRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZT90aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aDotMX0sYWRkOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMucHVzaFN0YWNrKG4udW5pcXVlKG4ubWVyZ2UodGhpcy5nZXQoKSxuKGEsYikpKSl9LGFkZEJhY2s6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYWRkKG51bGw9PWE/dGhpcy5wcmV2T2JqZWN0OnRoaXMucHJldk9iamVjdC5maWx0ZXIoYSkpfX0pO2Z1bmN0aW9uIEQoYSxiKXt3aGlsZSgoYT1hW2JdKSYmMSE9PWEubm9kZVR5cGUpO3JldHVybiBhfW4uZWFjaCh7cGFyZW50OmZ1bmN0aW9uKGEpe3ZhciBiPWEucGFyZW50Tm9kZTtyZXR1cm4gYiYmMTEhPT1iLm5vZGVUeXBlP2I6bnVsbH0scGFyZW50czpmdW5jdGlvbihhKXtyZXR1cm4gbi5kaXIoYSwicGFyZW50Tm9kZSIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuLmRpcihhLCJwYXJlbnROb2RlIixjKX0sbmV4dDpmdW5jdGlvbihhKXtyZXR1cm4gRChhLCJuZXh0U2libGluZyIpfSxwcmV2OmZ1bmN0aW9uKGEpe3JldHVybiBEKGEsInByZXZpb3VzU2libGluZyIpfSxuZXh0QWxsOmZ1bmN0aW9uKGEpe3JldHVybiBuLmRpcihhLCJuZXh0U2libGluZyIpfSxwcmV2QWxsOmZ1bmN0aW9uKGEpe3JldHVybiBuLmRpcihhLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dFVudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbi5kaXIoYSwibmV4dFNpYmxpbmciLGMpfSxwcmV2VW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuLmRpcihhLCJwcmV2aW91c1NpYmxpbmciLGMpfSxzaWJsaW5nczpmdW5jdGlvbihhKXtyZXR1cm4gbi5zaWJsaW5nKChhLnBhcmVudE5vZGV8fHt9KS5maXJzdENoaWxkLGEpfSxjaGlsZHJlbjpmdW5jdGlvbihhKXtyZXR1cm4gbi5zaWJsaW5nKGEuZmlyc3RDaGlsZCl9LGNvbnRlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBhLmNvbnRlbnREb2N1bWVudHx8bi5tZXJnZShbXSxhLmNoaWxkTm9kZXMpfX0sZnVuY3Rpb24oYSxiKXtuLmZuW2FdPWZ1bmN0aW9uKGMsZCl7dmFyIGU9bi5tYXAodGhpcyxiLGMpO3JldHVybiJVbnRpbCIhPT1hLnNsaWNlKC01KSYmKGQ9YyksZCYmInN0cmluZyI9PXR5cGVvZiBkJiYoZT1uLmZpbHRlcihkLGUpKSx0aGlzLmxlbmd0aD4xJiYoQ1thXXx8bi51bmlxdWUoZSksQi50ZXN0KGEpJiZlLnJldmVyc2UoKSksdGhpcy5wdXNoU3RhY2soZSl9fSk7dmFyIEU9L1xTKy9nLEY9e307ZnVuY3Rpb24gRyhhKXt2YXIgYj1GW2FdPXt9O3JldHVybiBuLmVhY2goYS5tYXRjaChFKXx8W10sZnVuY3Rpb24oYSxjKXtiW2NdPSEwfSksYn1uLkNhbGxiYWNrcz1mdW5jdGlvbihhKXthPSJzdHJpbmciPT10eXBlb2YgYT9GW2FdfHxHKGEpOm4uZXh0ZW5kKHt9LGEpO3ZhciBiLGMsZCxlLGYsZyxoPVtdLGk9IWEub25jZSYmW10saj1mdW5jdGlvbihsKXtmb3IoYj1hLm1lbW9yeSYmbCxjPSEwLGc9ZXx8MCxlPTAsZj1oLmxlbmd0aCxkPSEwO2gmJmY+ZztnKyspaWYoaFtnXS5hcHBseShsWzBdLGxbMV0pPT09ITEmJmEuc3RvcE9uRmFsc2Upe2I9ITE7YnJlYWt9ZD0hMSxoJiYoaT9pLmxlbmd0aCYmaihpLnNoaWZ0KCkpOmI/aD1bXTprLmRpc2FibGUoKSl9LGs9e2FkZDpmdW5jdGlvbigpe2lmKGgpe3ZhciBjPWgubGVuZ3RoOyFmdW5jdGlvbiBnKGIpe24uZWFjaChiLGZ1bmN0aW9uKGIsYyl7dmFyIGQ9bi50eXBlKGMpOyJmdW5jdGlvbiI9PT1kP2EudW5pcXVlJiZrLmhhcyhjKXx8aC5wdXNoKGMpOmMmJmMubGVuZ3RoJiYic3RyaW5nIiE9PWQmJmcoYyl9KX0oYXJndW1lbnRzKSxkP2Y9aC5sZW5ndGg6YiYmKGU9YyxqKGIpKX1yZXR1cm4gdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIGgmJm4uZWFjaChhcmd1bWVudHMsZnVuY3Rpb24oYSxiKXt2YXIgYzt3aGlsZSgoYz1uLmluQXJyYXkoYixoLGMpKT4tMSloLnNwbGljZShjLDEpLGQmJihmPj1jJiZmLS0sZz49YyYmZy0tKX0pLHRoaXN9LGhhczpmdW5jdGlvbihhKXtyZXR1cm4gYT9uLmluQXJyYXkoYSxoKT4tMTohKCFofHwhaC5sZW5ndGgpfSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiBoPVtdLGY9MCx0aGlzfSxkaXNhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIGg9aT1iPXZvaWQgMCx0aGlzfSxkaXNhYmxlZDpmdW5jdGlvbigpe3JldHVybiFofSxsb2NrOmZ1bmN0aW9uKCl7cmV0dXJuIGk9dm9pZCAwLGJ8fGsuZGlzYWJsZSgpLHRoaXN9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiFpfSxmaXJlV2l0aDpmdW5jdGlvbihhLGIpe3JldHVybiFofHxjJiYhaXx8KGI9Ynx8W10sYj1bYSxiLnNsaWNlP2Iuc2xpY2UoKTpiXSxkP2kucHVzaChiKTpqKGIpKSx0aGlzfSxmaXJlOmZ1bmN0aW9uKCl7cmV0dXJuIGsuZmlyZVdpdGgodGhpcyxhcmd1bWVudHMpLHRoaXN9LGZpcmVkOmZ1bmN0aW9uKCl7cmV0dXJuISFjfX07cmV0dXJuIGt9LG4uZXh0ZW5kKHtEZWZlcnJlZDpmdW5jdGlvbihhKXt2YXIgYj1bWyJyZXNvbHZlIiwiZG9uZSIsbi5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksInJlc29sdmVkIl0sWyJyZWplY3QiLCJmYWlsIixuLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwicmVqZWN0ZWQiXSxbIm5vdGlmeSIsInByb2dyZXNzIixuLkNhbGxiYWNrcygibWVtb3J5IildXSxjPSJwZW5kaW5nIixkPXtzdGF0ZTpmdW5jdGlvbigpe3JldHVybiBjfSxhbHdheXM6ZnVuY3Rpb24oKXtyZXR1cm4gZS5kb25lKGFyZ3VtZW50cykuZmFpbChhcmd1bWVudHMpLHRoaXN9LHRoZW46ZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHM7cmV0dXJuIG4uRGVmZXJyZWQoZnVuY3Rpb24oYyl7bi5lYWNoKGIsZnVuY3Rpb24oYixmKXt2YXIgZz1uLmlzRnVuY3Rpb24oYVtiXSkmJmFbYl07ZVtmWzFdXShmdW5jdGlvbigpe3ZhciBhPWcmJmcuYXBwbHkodGhpcyxhcmd1bWVudHMpO2EmJm4uaXNGdW5jdGlvbihhLnByb21pc2UpP2EucHJvbWlzZSgpLmRvbmUoYy5yZXNvbHZlKS5mYWlsKGMucmVqZWN0KS5wcm9ncmVzcyhjLm5vdGlmeSk6Y1tmWzBdKyJXaXRoIl0odGhpcz09PWQ/Yy5wcm9taXNlKCk6dGhpcyxnP1thXTphcmd1bWVudHMpfSl9KSxhPW51bGx9KS5wcm9taXNlKCl9LHByb21pc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGwhPWE/bi5leHRlbmQoYSxkKTpkfX0sZT17fTtyZXR1cm4gZC5waXBlPWQudGhlbixuLmVhY2goYixmdW5jdGlvbihhLGYpe3ZhciBnPWZbMl0saD1mWzNdO2RbZlsxXV09Zy5hZGQsaCYmZy5hZGQoZnVuY3Rpb24oKXtjPWh9LGJbMV5hXVsyXS5kaXNhYmxlLGJbMl1bMl0ubG9jayksZVtmWzBdXT1mdW5jdGlvbigpe3JldHVybiBlW2ZbMF0rIldpdGgiXSh0aGlzPT09ZT9kOnRoaXMsYXJndW1lbnRzKSx0aGlzfSxlW2ZbMF0rIldpdGgiXT1nLmZpcmVXaXRofSksZC5wcm9taXNlKGUpLGEmJmEuY2FsbChlLGUpLGV9LHdoZW46ZnVuY3Rpb24oYSl7dmFyIGI9MCxjPWQuY2FsbChhcmd1bWVudHMpLGU9Yy5sZW5ndGgsZj0xIT09ZXx8YSYmbi5pc0Z1bmN0aW9uKGEucHJvbWlzZSk/ZTowLGc9MT09PWY/YTpuLkRlZmVycmVkKCksaD1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKGUpe2JbYV09dGhpcyxjW2FdPWFyZ3VtZW50cy5sZW5ndGg+MT9kLmNhbGwoYXJndW1lbnRzKTplLGM9PT1pP2cubm90aWZ5V2l0aChiLGMpOi0tZnx8Zy5yZXNvbHZlV2l0aChiLGMpfX0saSxqLGs7aWYoZT4xKWZvcihpPW5ldyBBcnJheShlKSxqPW5ldyBBcnJheShlKSxrPW5ldyBBcnJheShlKTtlPmI7YisrKWNbYl0mJm4uaXNGdW5jdGlvbihjW2JdLnByb21pc2UpP2NbYl0ucHJvbWlzZSgpLmRvbmUoaChiLGssYykpLmZhaWwoZy5yZWplY3QpLnByb2dyZXNzKGgoYixqLGkpKTotLWY7cmV0dXJuIGZ8fGcucmVzb2x2ZVdpdGgoayxjKSxnLnByb21pc2UoKX19KTt2YXIgSDtuLmZuLnJlYWR5PWZ1bmN0aW9uKGEpe3JldHVybiBuLnJlYWR5LnByb21pc2UoKS5kb25lKGEpLHRoaXN9LG4uZXh0ZW5kKHtpc1JlYWR5OiExLHJlYWR5V2FpdDoxLGhvbGRSZWFkeTpmdW5jdGlvbihhKXthP24ucmVhZHlXYWl0Kys6bi5yZWFkeSghMCl9LHJlYWR5OmZ1bmN0aW9uKGEpeyhhPT09ITA/LS1uLnJlYWR5V2FpdDpuLmlzUmVhZHkpfHwobi5pc1JlYWR5PSEwLGEhPT0hMCYmLS1uLnJlYWR5V2FpdD4wfHwoSC5yZXNvbHZlV2l0aChsLFtuXSksbi5mbi50cmlnZ2VySGFuZGxlciYmKG4obCkudHJpZ2dlckhhbmRsZXIoInJlYWR5IiksbihsKS5vZmYoInJlYWR5IikpKSl9fSk7ZnVuY3Rpb24gSSgpe2wucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsSSwhMSksYS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixJLCExKSxuLnJlYWR5KCl9bi5yZWFkeS5wcm9taXNlPWZ1bmN0aW9uKGIpe3JldHVybiBIfHwoSD1uLkRlZmVycmVkKCksImNvbXBsZXRlIj09PWwucmVhZHlTdGF0ZT9zZXRUaW1lb3V0KG4ucmVhZHkpOihsLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLEksITEpLGEuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsSSwhMSkpKSxILnByb21pc2UoYil9LG4ucmVhZHkucHJvbWlzZSgpO3ZhciBKPW4uYWNjZXNzPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe3ZhciBoPTAsaT1hLmxlbmd0aCxqPW51bGw9PWM7aWYoIm9iamVjdCI9PT1uLnR5cGUoYykpe2U9ITA7Zm9yKGggaW4gYyluLmFjY2VzcyhhLGIsaCxjW2hdLCEwLGYsZyl9ZWxzZSBpZih2b2lkIDAhPT1kJiYoZT0hMCxuLmlzRnVuY3Rpb24oZCl8fChnPSEwKSxqJiYoZz8oYi5jYWxsKGEsZCksYj1udWxsKTooaj1iLGI9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBqLmNhbGwobihhKSxjKX0pKSxiKSlmb3IoO2k+aDtoKyspYihhW2hdLGMsZz9kOmQuY2FsbChhW2hdLGgsYihhW2hdLGMpKSk7cmV0dXJuIGU/YTpqP2IuY2FsbChhKTppP2IoYVswXSxjKTpmfTtuLmFjY2VwdERhdGE9ZnVuY3Rpb24oYSl7cmV0dXJuIDE9PT1hLm5vZGVUeXBlfHw5PT09YS5ub2RlVHlwZXx8ISthLm5vZGVUeXBlfTtmdW5jdGlvbiBLKCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuY2FjaGU9e30sMCx7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJue319fSksdGhpcy5leHBhbmRvPW4uZXhwYW5kbytLLnVpZCsrfUsudWlkPTEsSy5hY2NlcHRzPW4uYWNjZXB0RGF0YSxLLnByb3RvdHlwZT17a2V5OmZ1bmN0aW9uKGEpe2lmKCFLLmFjY2VwdHMoYSkpcmV0dXJuIDA7dmFyIGI9e30sYz1hW3RoaXMuZXhwYW5kb107aWYoIWMpe2M9Sy51aWQrKzt0cnl7Ylt0aGlzLmV4cGFuZG9dPXt2YWx1ZTpjfSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhhLGIpfWNhdGNoKGQpe2JbdGhpcy5leHBhbmRvXT1jLG4uZXh0ZW5kKGEsYil9fXJldHVybiB0aGlzLmNhY2hlW2NdfHwodGhpcy5jYWNoZVtjXT17fSksY30sc2V0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPXRoaXMua2V5KGEpLGY9dGhpcy5jYWNoZVtlXTtpZigic3RyaW5nIj09dHlwZW9mIGIpZltiXT1jO2Vsc2UgaWYobi5pc0VtcHR5T2JqZWN0KGYpKW4uZXh0ZW5kKHRoaXMuY2FjaGVbZV0sYik7ZWxzZSBmb3IoZCBpbiBiKWZbZF09YltkXTtyZXR1cm4gZn0sZ2V0OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jYWNoZVt0aGlzLmtleShhKV07cmV0dXJuIHZvaWQgMD09PWI/YzpjW2JdfSxhY2Nlc3M6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkO3JldHVybiB2b2lkIDA9PT1ifHxiJiYic3RyaW5nIj09dHlwZW9mIGImJnZvaWQgMD09PWM/KGQ9dGhpcy5nZXQoYSxiKSx2b2lkIDAhPT1kP2Q6dGhpcy5nZXQoYSxuLmNhbWVsQ2FzZShiKSkpOih0aGlzLnNldChhLGIsYyksdm9pZCAwIT09Yz9jOmIpfSxyZW1vdmU6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZj10aGlzLmtleShhKSxnPXRoaXMuY2FjaGVbZl07aWYodm9pZCAwPT09Yil0aGlzLmNhY2hlW2ZdPXt9O2Vsc2V7bi5pc0FycmF5KGIpP2Q9Yi5jb25jYXQoYi5tYXAobi5jYW1lbENhc2UpKTooZT1uLmNhbWVsQ2FzZShiKSxiIGluIGc/ZD1bYixlXTooZD1lLGQ9ZCBpbiBnP1tkXTpkLm1hdGNoKEUpfHxbXSkpLGM9ZC5sZW5ndGg7d2hpbGUoYy0tKWRlbGV0ZSBnW2RbY11dfX0saGFzRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4hbi5pc0VtcHR5T2JqZWN0KHRoaXMuY2FjaGVbYVt0aGlzLmV4cGFuZG9dXXx8e30pfSxkaXNjYXJkOmZ1bmN0aW9uKGEpe2FbdGhpcy5leHBhbmRvXSYmZGVsZXRlIHRoaXMuY2FjaGVbYVt0aGlzLmV4cGFuZG9dXX19O3ZhciBMPW5ldyBLLE09bmV3IEssTj0vXig/Olx7W1x3XFddKlx9fFxbW1x3XFddKlxdKSQvLE89LyhbQS1aXSkvZztmdW5jdGlvbiBQKGEsYixjKXt2YXIgZDtpZih2b2lkIDA9PT1jJiYxPT09YS5ub2RlVHlwZSlpZihkPSJkYXRhLSIrYi5yZXBsYWNlKE8sIi0kMSIpLnRvTG93ZXJDYXNlKCksYz1hLmdldEF0dHJpYnV0ZShkKSwic3RyaW5nIj09dHlwZW9mIGMpe3RyeXtjPSJ0cnVlIj09PWM/ITA6ImZhbHNlIj09PWM/ITE6Im51bGwiPT09Yz9udWxsOitjKyIiPT09Yz8rYzpOLnRlc3QoYyk/bi5wYXJzZUpTT04oYyk6Y31jYXRjaChlKXt9TS5zZXQoYSxiLGMpfWVsc2UgYz12b2lkIDA7cmV0dXJuIGN9bi5leHRlbmQoe2hhc0RhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuIE0uaGFzRGF0YShhKXx8TC5oYXNEYXRhKGEpfSxkYXRhOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gTS5hY2Nlc3MoYSxiLGMpCn0scmVtb3ZlRGF0YTpmdW5jdGlvbihhLGIpe00ucmVtb3ZlKGEsYil9LF9kYXRhOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gTC5hY2Nlc3MoYSxiLGMpfSxfcmVtb3ZlRGF0YTpmdW5jdGlvbihhLGIpe0wucmVtb3ZlKGEsYil9fSksbi5mbi5leHRlbmQoe2RhdGE6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZj10aGlzWzBdLGc9ZiYmZi5hdHRyaWJ1dGVzO2lmKHZvaWQgMD09PWEpe2lmKHRoaXMubGVuZ3RoJiYoZT1NLmdldChmKSwxPT09Zi5ub2RlVHlwZSYmIUwuZ2V0KGYsImhhc0RhdGFBdHRycyIpKSl7Yz1nLmxlbmd0aDt3aGlsZShjLS0pZ1tjXSYmKGQ9Z1tjXS5uYW1lLDA9PT1kLmluZGV4T2YoImRhdGEtIikmJihkPW4uY2FtZWxDYXNlKGQuc2xpY2UoNSkpLFAoZixkLGVbZF0pKSk7TC5zZXQoZiwiaGFzRGF0YUF0dHJzIiwhMCl9cmV0dXJuIGV9cmV0dXJuIm9iamVjdCI9PXR5cGVvZiBhP3RoaXMuZWFjaChmdW5jdGlvbigpe00uc2V0KHRoaXMsYSl9KTpKKHRoaXMsZnVuY3Rpb24oYil7dmFyIGMsZD1uLmNhbWVsQ2FzZShhKTtpZihmJiZ2b2lkIDA9PT1iKXtpZihjPU0uZ2V0KGYsYSksdm9pZCAwIT09YylyZXR1cm4gYztpZihjPU0uZ2V0KGYsZCksdm9pZCAwIT09YylyZXR1cm4gYztpZihjPVAoZixkLHZvaWQgMCksdm9pZCAwIT09YylyZXR1cm4gY31lbHNlIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBjPU0uZ2V0KHRoaXMsZCk7TS5zZXQodGhpcyxkLGIpLC0xIT09YS5pbmRleE9mKCItIikmJnZvaWQgMCE9PWMmJk0uc2V0KHRoaXMsYSxiKX0pfSxudWxsLGIsYXJndW1lbnRzLmxlbmd0aD4xLG51bGwsITApfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtNLnJlbW92ZSh0aGlzLGEpfSl9fSksbi5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZDtyZXR1cm4gYT8oYj0oYnx8ImZ4IikrInF1ZXVlIixkPUwuZ2V0KGEsYiksYyYmKCFkfHxuLmlzQXJyYXkoYyk/ZD1MLmFjY2VzcyhhLGIsbi5tYWtlQXJyYXkoYykpOmQucHVzaChjKSksZHx8W10pOnZvaWQgMH0sZGVxdWV1ZTpmdW5jdGlvbihhLGIpe2I9Ynx8ImZ4Ijt2YXIgYz1uLnF1ZXVlKGEsYiksZD1jLmxlbmd0aCxlPWMuc2hpZnQoKSxmPW4uX3F1ZXVlSG9va3MoYSxiKSxnPWZ1bmN0aW9uKCl7bi5kZXF1ZXVlKGEsYil9OyJpbnByb2dyZXNzIj09PWUmJihlPWMuc2hpZnQoKSxkLS0pLGUmJigiZngiPT09YiYmYy51bnNoaWZ0KCJpbnByb2dyZXNzIiksZGVsZXRlIGYuc3RvcCxlLmNhbGwoYSxnLGYpKSwhZCYmZiYmZi5lbXB0eS5maXJlKCl9LF9xdWV1ZUhvb2tzOmZ1bmN0aW9uKGEsYil7dmFyIGM9YisicXVldWVIb29rcyI7cmV0dXJuIEwuZ2V0KGEsYyl8fEwuYWNjZXNzKGEsYyx7ZW1wdHk6bi5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IikuYWRkKGZ1bmN0aW9uKCl7TC5yZW1vdmUoYSxbYisicXVldWUiLGNdKX0pfSl9fSksbi5mbi5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGEsYil7dmFyIGM9MjtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGEmJihiPWEsYT0iZngiLGMtLSksYXJndW1lbnRzLmxlbmd0aDxjP24ucXVldWUodGhpc1swXSxhKTp2b2lkIDA9PT1iP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGM9bi5xdWV1ZSh0aGlzLGEsYik7bi5fcXVldWVIb29rcyh0aGlzLGEpLCJmeCI9PT1hJiYiaW5wcm9ncmVzcyIhPT1jWzBdJiZuLmRlcXVldWUodGhpcyxhKX0pfSxkZXF1ZXVlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtuLmRlcXVldWUodGhpcyxhKX0pfSxjbGVhclF1ZXVlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnF1ZXVlKGF8fCJmeCIsW10pfSxwcm9taXNlOmZ1bmN0aW9uKGEsYil7dmFyIGMsZD0xLGU9bi5EZWZlcnJlZCgpLGY9dGhpcyxnPXRoaXMubGVuZ3RoLGg9ZnVuY3Rpb24oKXstLWR8fGUucmVzb2x2ZVdpdGgoZixbZl0pfTsic3RyaW5nIiE9dHlwZW9mIGEmJihiPWEsYT12b2lkIDApLGE9YXx8ImZ4Ijt3aGlsZShnLS0pYz1MLmdldChmW2ddLGErInF1ZXVlSG9va3MiKSxjJiZjLmVtcHR5JiYoZCsrLGMuZW1wdHkuYWRkKGgpKTtyZXR1cm4gaCgpLGUucHJvbWlzZShiKX19KTt2YXIgUT0vWystXT8oPzpcZCpcLnwpXGQrKD86W2VFXVsrLV0/XGQrfCkvLnNvdXJjZSxSPVsiVG9wIiwiUmlnaHQiLCJCb3R0b20iLCJMZWZ0Il0sUz1mdW5jdGlvbihhLGIpe3JldHVybiBhPWJ8fGEsIm5vbmUiPT09bi5jc3MoYSwiZGlzcGxheSIpfHwhbi5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSl9LFQ9L14oPzpjaGVja2JveHxyYWRpbykkL2k7IWZ1bmN0aW9uKCl7dmFyIGE9bC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksYj1hLmFwcGVuZENoaWxkKGwuY3JlYXRlRWxlbWVudCgiZGl2IikpLGM9bC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO2Muc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSxjLnNldEF0dHJpYnV0ZSgiY2hlY2tlZCIsImNoZWNrZWQiKSxjLnNldEF0dHJpYnV0ZSgibmFtZSIsInQiKSxiLmFwcGVuZENoaWxkKGMpLGsuY2hlY2tDbG9uZT1iLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCxiLmlubmVySFRNTD0iPHRleHRhcmVhPng8L3RleHRhcmVhPiIsay5ub0Nsb25lQ2hlY2tlZD0hIWIuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlfSgpO3ZhciBVPSJ1bmRlZmluZWQiO2suZm9jdXNpbkJ1YmJsZXM9Im9uZm9jdXNpbiJpbiBhO3ZhciBWPS9ea2V5LyxXPS9eKD86bW91c2V8cG9pbnRlcnxjb250ZXh0bWVudSl8Y2xpY2svLFg9L14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLFk9L14oW14uXSopKD86XC4oLispfCkkLztmdW5jdGlvbiBaKCl7cmV0dXJuITB9ZnVuY3Rpb24gJCgpe3JldHVybiExfWZ1bmN0aW9uIF8oKXt0cnl7cmV0dXJuIGwuYWN0aXZlRWxlbWVudH1jYXRjaChhKXt9fW4uZXZlbnQ9e2dsb2JhbDp7fSxhZGQ6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZixnLGgsaSxqLGssbCxtLG8scCxxLHI9TC5nZXQoYSk7aWYocil7Yy5oYW5kbGVyJiYoZj1jLGM9Zi5oYW5kbGVyLGU9Zi5zZWxlY3RvciksYy5ndWlkfHwoYy5ndWlkPW4uZ3VpZCsrKSwoaT1yLmV2ZW50cyl8fChpPXIuZXZlbnRzPXt9KSwoZz1yLmhhbmRsZSl8fChnPXIuaGFuZGxlPWZ1bmN0aW9uKGIpe3JldHVybiB0eXBlb2YgbiE9PVUmJm4uZXZlbnQudHJpZ2dlcmVkIT09Yi50eXBlP24uZXZlbnQuZGlzcGF0Y2guYXBwbHkoYSxhcmd1bWVudHMpOnZvaWQgMH0pLGI9KGJ8fCIiKS5tYXRjaChFKXx8WyIiXSxqPWIubGVuZ3RoO3doaWxlKGotLSloPVkuZXhlYyhiW2pdKXx8W10sbz1xPWhbMV0scD0oaFsyXXx8IiIpLnNwbGl0KCIuIikuc29ydCgpLG8mJihsPW4uZXZlbnQuc3BlY2lhbFtvXXx8e30sbz0oZT9sLmRlbGVnYXRlVHlwZTpsLmJpbmRUeXBlKXx8byxsPW4uZXZlbnQuc3BlY2lhbFtvXXx8e30saz1uLmV4dGVuZCh7dHlwZTpvLG9yaWdUeXBlOnEsZGF0YTpkLGhhbmRsZXI6YyxndWlkOmMuZ3VpZCxzZWxlY3RvcjplLG5lZWRzQ29udGV4dDplJiZuLmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3QoZSksbmFtZXNwYWNlOnAuam9pbigiLiIpfSxmKSwobT1pW29dKXx8KG09aVtvXT1bXSxtLmRlbGVnYXRlQ291bnQ9MCxsLnNldHVwJiZsLnNldHVwLmNhbGwoYSxkLHAsZykhPT0hMXx8YS5hZGRFdmVudExpc3RlbmVyJiZhLmFkZEV2ZW50TGlzdGVuZXIobyxnLCExKSksbC5hZGQmJihsLmFkZC5jYWxsKGEsayksay5oYW5kbGVyLmd1aWR8fChrLmhhbmRsZXIuZ3VpZD1jLmd1aWQpKSxlP20uc3BsaWNlKG0uZGVsZWdhdGVDb3VudCsrLDAsayk6bS5wdXNoKGspLG4uZXZlbnQuZ2xvYmFsW29dPSEwKX19LHJlbW92ZTpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmLGcsaCxpLGosayxsLG0sbyxwLHEscj1MLmhhc0RhdGEoYSkmJkwuZ2V0KGEpO2lmKHImJihpPXIuZXZlbnRzKSl7Yj0oYnx8IiIpLm1hdGNoKEUpfHxbIiJdLGo9Yi5sZW5ndGg7d2hpbGUoai0tKWlmKGg9WS5leGVjKGJbal0pfHxbXSxvPXE9aFsxXSxwPShoWzJdfHwiIikuc3BsaXQoIi4iKS5zb3J0KCksbyl7bD1uLmV2ZW50LnNwZWNpYWxbb118fHt9LG89KGQ/bC5kZWxlZ2F0ZVR5cGU6bC5iaW5kVHlwZSl8fG8sbT1pW29dfHxbXSxoPWhbMl0mJm5ldyBSZWdFeHAoIihefFxcLikiK3Auam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIiksZz1mPW0ubGVuZ3RoO3doaWxlKGYtLSlrPW1bZl0sIWUmJnEhPT1rLm9yaWdUeXBlfHxjJiZjLmd1aWQhPT1rLmd1aWR8fGgmJiFoLnRlc3Qoay5uYW1lc3BhY2UpfHxkJiZkIT09ay5zZWxlY3RvciYmKCIqKiIhPT1kfHwhay5zZWxlY3Rvcil8fChtLnNwbGljZShmLDEpLGsuc2VsZWN0b3ImJm0uZGVsZWdhdGVDb3VudC0tLGwucmVtb3ZlJiZsLnJlbW92ZS5jYWxsKGEsaykpO2cmJiFtLmxlbmd0aCYmKGwudGVhcmRvd24mJmwudGVhcmRvd24uY2FsbChhLHAsci5oYW5kbGUpIT09ITF8fG4ucmVtb3ZlRXZlbnQoYSxvLHIuaGFuZGxlKSxkZWxldGUgaVtvXSl9ZWxzZSBmb3IobyBpbiBpKW4uZXZlbnQucmVtb3ZlKGEsbytiW2pdLGMsZCwhMCk7bi5pc0VtcHR5T2JqZWN0KGkpJiYoZGVsZXRlIHIuaGFuZGxlLEwucmVtb3ZlKGEsImV2ZW50cyIpKX19LHRyaWdnZXI6ZnVuY3Rpb24oYixjLGQsZSl7dmFyIGYsZyxoLGksayxtLG8scD1bZHx8bF0scT1qLmNhbGwoYiwidHlwZSIpP2IudHlwZTpiLHI9ai5jYWxsKGIsIm5hbWVzcGFjZSIpP2IubmFtZXNwYWNlLnNwbGl0KCIuIik6W107aWYoZz1oPWQ9ZHx8bCwzIT09ZC5ub2RlVHlwZSYmOCE9PWQubm9kZVR5cGUmJiFYLnRlc3QocStuLmV2ZW50LnRyaWdnZXJlZCkmJihxLmluZGV4T2YoIi4iKT49MCYmKHI9cS5zcGxpdCgiLiIpLHE9ci5zaGlmdCgpLHIuc29ydCgpKSxrPXEuaW5kZXhPZigiOiIpPDAmJiJvbiIrcSxiPWJbbi5leHBhbmRvXT9iOm5ldyBuLkV2ZW50KHEsIm9iamVjdCI9PXR5cGVvZiBiJiZiKSxiLmlzVHJpZ2dlcj1lPzI6MyxiLm5hbWVzcGFjZT1yLmpvaW4oIi4iKSxiLm5hbWVzcGFjZV9yZT1iLm5hbWVzcGFjZT9uZXcgUmVnRXhwKCIoXnxcXC4pIityLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpOm51bGwsYi5yZXN1bHQ9dm9pZCAwLGIudGFyZ2V0fHwoYi50YXJnZXQ9ZCksYz1udWxsPT1jP1tiXTpuLm1ha2VBcnJheShjLFtiXSksbz1uLmV2ZW50LnNwZWNpYWxbcV18fHt9LGV8fCFvLnRyaWdnZXJ8fG8udHJpZ2dlci5hcHBseShkLGMpIT09ITEpKXtpZighZSYmIW8ubm9CdWJibGUmJiFuLmlzV2luZG93KGQpKXtmb3IoaT1vLmRlbGVnYXRlVHlwZXx8cSxYLnRlc3QoaStxKXx8KGc9Zy5wYXJlbnROb2RlKTtnO2c9Zy5wYXJlbnROb2RlKXAucHVzaChnKSxoPWc7aD09PShkLm93bmVyRG9jdW1lbnR8fGwpJiZwLnB1c2goaC5kZWZhdWx0Vmlld3x8aC5wYXJlbnRXaW5kb3d8fGEpfWY9MDt3aGlsZSgoZz1wW2YrK10pJiYhYi5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKWIudHlwZT1mPjE/aTpvLmJpbmRUeXBlfHxxLG09KEwuZ2V0KGcsImV2ZW50cyIpfHx7fSlbYi50eXBlXSYmTC5nZXQoZywiaGFuZGxlIiksbSYmbS5hcHBseShnLGMpLG09ayYmZ1trXSxtJiZtLmFwcGx5JiZuLmFjY2VwdERhdGEoZykmJihiLnJlc3VsdD1tLmFwcGx5KGcsYyksYi5yZXN1bHQ9PT0hMSYmYi5wcmV2ZW50RGVmYXVsdCgpKTtyZXR1cm4gYi50eXBlPXEsZXx8Yi5pc0RlZmF1bHRQcmV2ZW50ZWQoKXx8by5fZGVmYXVsdCYmby5fZGVmYXVsdC5hcHBseShwLnBvcCgpLGMpIT09ITF8fCFuLmFjY2VwdERhdGEoZCl8fGsmJm4uaXNGdW5jdGlvbihkW3FdKSYmIW4uaXNXaW5kb3coZCkmJihoPWRba10saCYmKGRba109bnVsbCksbi5ldmVudC50cmlnZ2VyZWQ9cSxkW3FdKCksbi5ldmVudC50cmlnZ2VyZWQ9dm9pZCAwLGgmJihkW2tdPWgpKSxiLnJlc3VsdH19LGRpc3BhdGNoOmZ1bmN0aW9uKGEpe2E9bi5ldmVudC5maXgoYSk7dmFyIGIsYyxlLGYsZyxoPVtdLGk9ZC5jYWxsKGFyZ3VtZW50cyksaj0oTC5nZXQodGhpcywiZXZlbnRzIil8fHt9KVthLnR5cGVdfHxbXSxrPW4uZXZlbnQuc3BlY2lhbFthLnR5cGVdfHx7fTtpZihpWzBdPWEsYS5kZWxlZ2F0ZVRhcmdldD10aGlzLCFrLnByZURpc3BhdGNofHxrLnByZURpc3BhdGNoLmNhbGwodGhpcyxhKSE9PSExKXtoPW4uZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLGEsaiksYj0wO3doaWxlKChmPWhbYisrXSkmJiFhLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe2EuY3VycmVudFRhcmdldD1mLmVsZW0sYz0wO3doaWxlKChnPWYuaGFuZGxlcnNbYysrXSkmJiFhLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpKCFhLm5hbWVzcGFjZV9yZXx8YS5uYW1lc3BhY2VfcmUudGVzdChnLm5hbWVzcGFjZSkpJiYoYS5oYW5kbGVPYmo9ZyxhLmRhdGE9Zy5kYXRhLGU9KChuLmV2ZW50LnNwZWNpYWxbZy5vcmlnVHlwZV18fHt9KS5oYW5kbGV8fGcuaGFuZGxlcikuYXBwbHkoZi5lbGVtLGkpLHZvaWQgMCE9PWUmJihhLnJlc3VsdD1lKT09PSExJiYoYS5wcmV2ZW50RGVmYXVsdCgpLGEuc3RvcFByb3BhZ2F0aW9uKCkpKX1yZXR1cm4gay5wb3N0RGlzcGF0Y2gmJmsucG9zdERpc3BhdGNoLmNhbGwodGhpcyxhKSxhLnJlc3VsdH19LGhhbmRsZXJzOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGYsZz1bXSxoPWIuZGVsZWdhdGVDb3VudCxpPWEudGFyZ2V0O2lmKGgmJmkubm9kZVR5cGUmJighYS5idXR0b258fCJjbGljayIhPT1hLnR5cGUpKWZvcig7aSE9PXRoaXM7aT1pLnBhcmVudE5vZGV8fHRoaXMpaWYoaS5kaXNhYmxlZCE9PSEwfHwiY2xpY2siIT09YS50eXBlKXtmb3IoZD1bXSxjPTA7aD5jO2MrKylmPWJbY10sZT1mLnNlbGVjdG9yKyIgIix2b2lkIDA9PT1kW2VdJiYoZFtlXT1mLm5lZWRzQ29udGV4dD9uKGUsdGhpcykuaW5kZXgoaSk+PTA6bi5maW5kKGUsdGhpcyxudWxsLFtpXSkubGVuZ3RoKSxkW2VdJiZkLnB1c2goZik7ZC5sZW5ndGgmJmcucHVzaCh7ZWxlbTppLGhhbmRsZXJzOmR9KX1yZXR1cm4gaDxiLmxlbmd0aCYmZy5wdXNoKHtlbGVtOnRoaXMsaGFuZGxlcnM6Yi5zbGljZShoKX0pLGd9LHByb3BzOiJhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2giLnNwbGl0KCIgIiksZml4SG9va3M6e30sa2V5SG9va3M6e3Byb3BzOiJjaGFyIGNoYXJDb2RlIGtleSBrZXlDb2RlIi5zcGxpdCgiICIpLGZpbHRlcjpmdW5jdGlvbihhLGIpe3JldHVybiBudWxsPT1hLndoaWNoJiYoYS53aGljaD1udWxsIT1iLmNoYXJDb2RlP2IuY2hhckNvZGU6Yi5rZXlDb2RlKSxhfX0sbW91c2VIb29rczp7cHJvcHM6ImJ1dHRvbiBidXR0b25zIGNsaWVudFggY2xpZW50WSBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudCIuc3BsaXQoIiAiKSxmaWx0ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZj1iLmJ1dHRvbjtyZXR1cm4gbnVsbD09YS5wYWdlWCYmbnVsbCE9Yi5jbGllbnRYJiYoYz1hLnRhcmdldC5vd25lckRvY3VtZW50fHxsLGQ9Yy5kb2N1bWVudEVsZW1lbnQsZT1jLmJvZHksYS5wYWdlWD1iLmNsaWVudFgrKGQmJmQuc2Nyb2xsTGVmdHx8ZSYmZS5zY3JvbGxMZWZ0fHwwKS0oZCYmZC5jbGllbnRMZWZ0fHxlJiZlLmNsaWVudExlZnR8fDApLGEucGFnZVk9Yi5jbGllbnRZKyhkJiZkLnNjcm9sbFRvcHx8ZSYmZS5zY3JvbGxUb3B8fDApLShkJiZkLmNsaWVudFRvcHx8ZSYmZS5jbGllbnRUb3B8fDApKSxhLndoaWNofHx2b2lkIDA9PT1mfHwoYS53aGljaD0xJmY/MToyJmY/Mzo0JmY/MjowKSxhfX0sZml4OmZ1bmN0aW9uKGEpe2lmKGFbbi5leHBhbmRvXSlyZXR1cm4gYTt2YXIgYixjLGQsZT1hLnR5cGUsZj1hLGc9dGhpcy5maXhIb29rc1tlXTtnfHwodGhpcy5maXhIb29rc1tlXT1nPVcudGVzdChlKT90aGlzLm1vdXNlSG9va3M6Vi50ZXN0KGUpP3RoaXMua2V5SG9va3M6e30pLGQ9Zy5wcm9wcz90aGlzLnByb3BzLmNvbmNhdChnLnByb3BzKTp0aGlzLnByb3BzLGE9bmV3IG4uRXZlbnQoZiksYj1kLmxlbmd0aDt3aGlsZShiLS0pYz1kW2JdLGFbY109ZltjXTtyZXR1cm4gYS50YXJnZXR8fChhLnRhcmdldD1sKSwzPT09YS50YXJnZXQubm9kZVR5cGUmJihhLnRhcmdldD1hLnRhcmdldC5wYXJlbnROb2RlKSxnLmZpbHRlcj9nLmZpbHRlcihhLGYpOmF9LHNwZWNpYWw6e2xvYWQ6e25vQnViYmxlOiEwfSxmb2N1czp7dHJpZ2dlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzIT09XygpJiZ0aGlzLmZvY3VzPyh0aGlzLmZvY3VzKCksITEpOnZvaWQgMH0sZGVsZWdhdGVUeXBlOiJmb2N1c2luIn0sYmx1cjp7dHJpZ2dlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzPT09XygpJiZ0aGlzLmJsdXI/KHRoaXMuYmx1cigpLCExKTp2b2lkIDB9LGRlbGVnYXRlVHlwZToiZm9jdXNvdXQifSxjbGljazp7dHJpZ2dlcjpmdW5jdGlvbigpe3JldHVybiJjaGVja2JveCI9PT10aGlzLnR5cGUmJnRoaXMuY2xpY2smJm4ubm9kZU5hbWUodGhpcywiaW5wdXQiKT8odGhpcy5jbGljaygpLCExKTp2b2lkIDB9LF9kZWZhdWx0OmZ1bmN0aW9uKGEpe3JldHVybiBuLm5vZGVOYW1lKGEudGFyZ2V0LCJhIil9fSxiZWZvcmV1bmxvYWQ6e3Bvc3REaXNwYXRjaDpmdW5jdGlvbihhKXt2b2lkIDAhPT1hLnJlc3VsdCYmYS5vcmlnaW5hbEV2ZW50JiYoYS5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlPWEucmVzdWx0KX19fSxzaW11bGF0ZTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1uLmV4dGVuZChuZXcgbi5FdmVudCxjLHt0eXBlOmEsaXNTaW11bGF0ZWQ6ITAsb3JpZ2luYWxFdmVudDp7fX0pO2Q/bi5ldmVudC50cmlnZ2VyKGUsbnVsbCxiKTpuLmV2ZW50LmRpc3BhdGNoLmNhbGwoYixlKSxlLmlzRGVmYXVsdFByZXZlbnRlZCgpJiZjLnByZXZlbnREZWZhdWx0KCl9fSxuLnJlbW92ZUV2ZW50PWZ1bmN0aW9uKGEsYixjKXthLnJlbW92ZUV2ZW50TGlzdGVuZXImJmEucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLGMsITEpfSxuLkV2ZW50PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBuLkV2ZW50PyhhJiZhLnR5cGU/KHRoaXMub3JpZ2luYWxFdmVudD1hLHRoaXMudHlwZT1hLnR5cGUsdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9YS5kZWZhdWx0UHJldmVudGVkfHx2b2lkIDA9PT1hLmRlZmF1bHRQcmV2ZW50ZWQmJmEucmV0dXJuVmFsdWU9PT0hMT9aOiQpOnRoaXMudHlwZT1hLGImJm4uZXh0ZW5kKHRoaXMsYiksdGhpcy50aW1lU3RhbXA9YSYmYS50aW1lU3RhbXB8fG4ubm93KCksdm9pZCh0aGlzW24uZXhwYW5kb109ITApKTpuZXcgbi5FdmVudChhLGIpfSxuLkV2ZW50LnByb3RvdHlwZT17aXNEZWZhdWx0UHJldmVudGVkOiQsaXNQcm9wYWdhdGlvblN0b3BwZWQ6JCxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDokLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNEZWZhdWx0UHJldmVudGVkPVosYSYmYS5wcmV2ZW50RGVmYXVsdCYmYS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1aLGEmJmEuc3RvcFByb3BhZ2F0aW9uJiZhLnN0b3BQcm9wYWdhdGlvbigpfSxzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1aLGEmJmEuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uJiZhLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHRoaXMuc3RvcFByb3BhZ2F0aW9uKCl9fSxuLmVhY2goe21vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQiLHBvaW50ZXJlbnRlcjoicG9pbnRlcm92ZXIiLHBvaW50ZXJsZWF2ZToicG9pbnRlcm91dCJ9LGZ1bmN0aW9uKGEsYil7bi5ldmVudC5zcGVjaWFsW2FdPXtkZWxlZ2F0ZVR5cGU6YixiaW5kVHlwZTpiLGhhbmRsZTpmdW5jdGlvbihhKXt2YXIgYyxkPXRoaXMsZT1hLnJlbGF0ZWRUYXJnZXQsZj1hLmhhbmRsZU9iajtyZXR1cm4oIWV8fGUhPT1kJiYhbi5jb250YWlucyhkLGUpKSYmKGEudHlwZT1mLm9yaWdUeXBlLGM9Zi5oYW5kbGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxhLnR5cGU9YiksY319fSksay5mb2N1c2luQnViYmxlc3x8bi5lYWNoKHtmb2N1czoiZm9jdXNpbiIsYmx1cjoiZm9jdXNvdXQifSxmdW5jdGlvbihhLGIpe3ZhciBjPWZ1bmN0aW9uKGEpe24uZXZlbnQuc2ltdWxhdGUoYixhLnRhcmdldCxuLmV2ZW50LmZpeChhKSwhMCl9O24uZXZlbnQuc3BlY2lhbFtiXT17c2V0dXA6ZnVuY3Rpb24oKXt2YXIgZD10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsZT1MLmFjY2VzcyhkLGIpO2V8fGQuYWRkRXZlbnRMaXN0ZW5lcihhLGMsITApLEwuYWNjZXNzKGQsYiwoZXx8MCkrMSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGU9TC5hY2Nlc3MoZCxiKS0xO2U/TC5hY2Nlc3MoZCxiLGUpOihkLnJlbW92ZUV2ZW50TGlzdGVuZXIoYSxjLCEwKSxMLnJlbW92ZShkLGIpKX19fSksbi5mbi5leHRlbmQoe29uOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGYsZztpZigib2JqZWN0Ij09dHlwZW9mIGEpeyJzdHJpbmciIT10eXBlb2YgYiYmKGM9Y3x8YixiPXZvaWQgMCk7Zm9yKGcgaW4gYSl0aGlzLm9uKGcsYixjLGFbZ10sZSk7cmV0dXJuIHRoaXN9aWYobnVsbD09YyYmbnVsbD09ZD8oZD1iLGM9Yj12b2lkIDApOm51bGw9PWQmJigic3RyaW5nIj09dHlwZW9mIGI/KGQ9YyxjPXZvaWQgMCk6KGQ9YyxjPWIsYj12b2lkIDApKSxkPT09ITEpZD0kO2Vsc2UgaWYoIWQpcmV0dXJuIHRoaXM7cmV0dXJuIDE9PT1lJiYoZj1kLGQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG4oKS5vZmYoYSksZi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGQuZ3VpZD1mLmd1aWR8fChmLmd1aWQ9bi5ndWlkKyspKSx0aGlzLmVhY2goZnVuY3Rpb24oKXtuLmV2ZW50LmFkZCh0aGlzLGEsZCxjLGIpfSl9LG9uZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5vbihhLGIsYyxkLDEpfSxvZmY6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU7aWYoYSYmYS5wcmV2ZW50RGVmYXVsdCYmYS5oYW5kbGVPYmopcmV0dXJuIGQ9YS5oYW5kbGVPYmosbihhLmRlbGVnYXRlVGFyZ2V0KS5vZmYoZC5uYW1lc3BhY2U/ZC5vcmlnVHlwZSsiLiIrZC5uYW1lc3BhY2U6ZC5vcmlnVHlwZSxkLnNlbGVjdG9yLGQuaGFuZGxlciksdGhpcztpZigib2JqZWN0Ij09dHlwZW9mIGEpe2ZvcihlIGluIGEpdGhpcy5vZmYoZSxiLGFbZV0pO3JldHVybiB0aGlzfXJldHVybihiPT09ITF8fCJmdW5jdGlvbiI9PXR5cGVvZiBiKSYmKGM9YixiPXZvaWQgMCksYz09PSExJiYoYz0kKSx0aGlzLmVhY2goZnVuY3Rpb24oKXtuLmV2ZW50LnJlbW92ZSh0aGlzLGEsYyxiKX0pfSx0cmlnZ2VyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe24uZXZlbnQudHJpZ2dlcihhLGIsdGhpcyl9KX0sdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzWzBdO3JldHVybiBjP24uZXZlbnQudHJpZ2dlcihhLGIsYywhMCk6dm9pZCAwfX0pO3ZhciBhYj0vPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXHc6XSspW14+XSopXC8+L2dpLGJiPS88KFtcdzpdKykvLGNiPS88fCYjP1x3KzsvLGRiPS88KD86c2NyaXB0fHN0eWxlfGxpbmspL2ksZWI9L2NoZWNrZWRccyooPzpbXj1dfD1ccyouY2hlY2tlZC4pL2ksZmI9L14kfFwvKD86amF2YXxlY21hKXNjcmlwdC9pLGdiPS9edHJ1ZVwvKC4qKS8saGI9L15ccyo8ISg/OlxbQ0RBVEFcW3wtLSl8KD86XF1cXXwtLSk+XHMqJC9nLGliPXtvcHRpb246WzEsIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCI8L3NlbGVjdD4iXSx0aGVhZDpbMSwiPHRhYmxlPiIsIjwvdGFibGU+Il0sY29sOlsyLCI8dGFibGU+PGNvbGdyb3VwPiIsIjwvY29sZ3JvdXA+PC90YWJsZT4iXSx0cjpbMiwiPHRhYmxlPjx0Ym9keT4iLCI8L3Rib2R5PjwvdGFibGU+Il0sdGQ6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLF9kZWZhdWx0OlswLCIiLCIiXX07aWIub3B0Z3JvdXA9aWIub3B0aW9uLGliLnRib2R5PWliLnRmb290PWliLmNvbGdyb3VwPWliLmNhcHRpb249aWIudGhlYWQsaWIudGg9aWIudGQ7ZnVuY3Rpb24gamIoYSxiKXtyZXR1cm4gbi5ub2RlTmFtZShhLCJ0YWJsZSIpJiZuLm5vZGVOYW1lKDExIT09Yi5ub2RlVHlwZT9iOmIuZmlyc3RDaGlsZCwidHIiKT9hLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpWzBdfHxhLmFwcGVuZENoaWxkKGEub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0Ym9keSIpKTphfWZ1bmN0aW9uIGtiKGEpe3JldHVybiBhLnR5cGU9KG51bGwhPT1hLmdldEF0dHJpYnV0ZSgidHlwZSIpKSsiLyIrYS50eXBlLGF9ZnVuY3Rpb24gbGIoYSl7dmFyIGI9Z2IuZXhlYyhhLnR5cGUpO3JldHVybiBiP2EudHlwZT1iWzFdOmEucmVtb3ZlQXR0cmlidXRlKCJ0eXBlIiksYX1mdW5jdGlvbiBtYihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7ZD5jO2MrKylMLnNldChhW2NdLCJnbG9iYWxFdmFsIiwhYnx8TC5nZXQoYltjXSwiZ2xvYmFsRXZhbCIpKX1mdW5jdGlvbiBuYihhLGIpe3ZhciBjLGQsZSxmLGcsaCxpLGo7aWYoMT09PWIubm9kZVR5cGUpe2lmKEwuaGFzRGF0YShhKSYmKGY9TC5hY2Nlc3MoYSksZz1MLnNldChiLGYpLGo9Zi5ldmVudHMpKXtkZWxldGUgZy5oYW5kbGUsZy5ldmVudHM9e307Zm9yKGUgaW4gailmb3IoYz0wLGQ9altlXS5sZW5ndGg7ZD5jO2MrKyluLmV2ZW50LmFkZChiLGUsaltlXVtjXSl9TS5oYXNEYXRhKGEpJiYoaD1NLmFjY2VzcyhhKSxpPW4uZXh0ZW5kKHt9LGgpLE0uc2V0KGIsaSkpfX1mdW5jdGlvbiBvYihhLGIpe3ZhciBjPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWU/YS5nZXRFbGVtZW50c0J5VGFnTmFtZShifHwiKiIpOmEucXVlcnlTZWxlY3RvckFsbD9hLnF1ZXJ5U2VsZWN0b3JBbGwoYnx8IioiKTpbXTtyZXR1cm4gdm9pZCAwPT09Ynx8YiYmbi5ub2RlTmFtZShhLGIpP24ubWVyZ2UoW2FdLGMpOmN9ZnVuY3Rpb24gcGIoYSxiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7ImlucHV0Ij09PWMmJlQudGVzdChhLnR5cGUpP2IuY2hlY2tlZD1hLmNoZWNrZWQ6KCJpbnB1dCI9PT1jfHwidGV4dGFyZWEiPT09YykmJihiLmRlZmF1bHRWYWx1ZT1hLmRlZmF1bHRWYWx1ZSl9bi5leHRlbmQoe2Nsb25lOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGYsZyxoPWEuY2xvbmVOb2RlKCEwKSxpPW4uY29udGFpbnMoYS5vd25lckRvY3VtZW50LGEpO2lmKCEoay5ub0Nsb25lQ2hlY2tlZHx8MSE9PWEubm9kZVR5cGUmJjExIT09YS5ub2RlVHlwZXx8bi5pc1hNTERvYyhhKSkpZm9yKGc9b2IoaCksZj1vYihhKSxkPTAsZT1mLmxlbmd0aDtlPmQ7ZCsrKXBiKGZbZF0sZ1tkXSk7aWYoYilpZihjKWZvcihmPWZ8fG9iKGEpLGc9Z3x8b2IoaCksZD0wLGU9Zi5sZW5ndGg7ZT5kO2QrKyluYihmW2RdLGdbZF0pO2Vsc2UgbmIoYSxoKTtyZXR1cm4gZz1vYihoLCJzY3JpcHQiKSxnLmxlbmd0aD4wJiZtYihnLCFpJiZvYihhLCJzY3JpcHQiKSksaH0sYnVpbGRGcmFnbWVudDpmdW5jdGlvbihhLGIsYyxkKXtmb3IodmFyIGUsZixnLGgsaSxqLGs9Yi5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksbD1bXSxtPTAsbz1hLmxlbmd0aDtvPm07bSsrKWlmKGU9YVttXSxlfHwwPT09ZSlpZigib2JqZWN0Ij09PW4udHlwZShlKSluLm1lcmdlKGwsZS5ub2RlVHlwZT9bZV06ZSk7ZWxzZSBpZihjYi50ZXN0KGUpKXtmPWZ8fGsuYXBwZW5kQ2hpbGQoYi5jcmVhdGVFbGVtZW50KCJkaXYiKSksZz0oYmIuZXhlYyhlKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKSxoPWliW2ddfHxpYi5fZGVmYXVsdCxmLmlubmVySFRNTD1oWzFdK2UucmVwbGFjZShhYiwiPCQxPjwvJDI+IikraFsyXSxqPWhbMF07d2hpbGUoai0tKWY9Zi5sYXN0Q2hpbGQ7bi5tZXJnZShsLGYuY2hpbGROb2RlcyksZj1rLmZpcnN0Q2hpbGQsZi50ZXh0Q29udGVudD0iIn1lbHNlIGwucHVzaChiLmNyZWF0ZVRleHROb2RlKGUpKTtrLnRleHRDb250ZW50PSIiLG09MDt3aGlsZShlPWxbbSsrXSlpZigoIWR8fC0xPT09bi5pbkFycmF5KGUsZCkpJiYoaT1uLmNvbnRhaW5zKGUub3duZXJEb2N1bWVudCxlKSxmPW9iKGsuYXBwZW5kQ2hpbGQoZSksInNjcmlwdCIpLGkmJm1iKGYpLGMpKXtqPTA7d2hpbGUoZT1mW2orK10pZmIudGVzdChlLnR5cGV8fCIiKSYmYy5wdXNoKGUpfXJldHVybiBrfSxjbGVhbkRhdGE6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiLGMsZCxlLGY9bi5ldmVudC5zcGVjaWFsLGc9MDt2b2lkIDAhPT0oYz1hW2ddKTtnKyspe2lmKG4uYWNjZXB0RGF0YShjKSYmKGU9Y1tMLmV4cGFuZG9dLGUmJihiPUwuY2FjaGVbZV0pKSl7aWYoYi5ldmVudHMpZm9yKGQgaW4gYi5ldmVudHMpZltkXT9uLmV2ZW50LnJlbW92ZShjLGQpOm4ucmVtb3ZlRXZlbnQoYyxkLGIuaGFuZGxlKTtMLmNhY2hlW2VdJiZkZWxldGUgTC5jYWNoZVtlXX1kZWxldGUgTS5jYWNoZVtjW00uZXhwYW5kb11dfX19KSxuLmZuLmV4dGVuZCh7dGV4dDpmdW5jdGlvbihhKXtyZXR1cm4gSih0aGlzLGZ1bmN0aW9uKGEpe3JldHVybiB2b2lkIDA9PT1hP24udGV4dCh0aGlzKTp0aGlzLmVtcHR5KCkuZWFjaChmdW5jdGlvbigpeygxPT09dGhpcy5ub2RlVHlwZXx8MTE9PT10aGlzLm5vZGVUeXBlfHw5PT09dGhpcy5ub2RlVHlwZSkmJih0aGlzLnRleHRDb250ZW50PWEpfSl9LG51bGwsYSxhcmd1bWVudHMubGVuZ3RoKX0sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgYj1qYih0aGlzLGEpO2IuYXBwZW5kQ2hpbGQoYSl9fSl9LHByZXBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsZnVuY3Rpb24oYSl7aWYoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpe3ZhciBiPWpiKHRoaXMsYSk7Yi5pbnNlcnRCZWZvcmUoYSxiLmZpcnN0Q2hpbGQpfX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsdGhpcyl9KX0sYWZ0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsdGhpcy5uZXh0U2libGluZyl9KX0scmVtb3ZlOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjLGQ9YT9uLmZpbHRlcihhLHRoaXMpOnRoaXMsZT0wO251bGwhPShjPWRbZV0pO2UrKylifHwxIT09Yy5ub2RlVHlwZXx8bi5jbGVhbkRhdGEob2IoYykpLGMucGFyZW50Tm9kZSYmKGImJm4uY29udGFpbnMoYy5vd25lckRvY3VtZW50LGMpJiZtYihvYihjLCJzY3JpcHQiKSksYy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGMpKTtyZXR1cm4gdGhpc30sZW1wdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGEsYj0wO251bGwhPShhPXRoaXNbYl0pO2IrKykxPT09YS5ub2RlVHlwZSYmKG4uY2xlYW5EYXRhKG9iKGEsITEpKSxhLnRleHRDb250ZW50PSIiKTtyZXR1cm4gdGhpc30sY2xvbmU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1udWxsPT1hPyExOmEsYj1udWxsPT1iP2E6Yix0aGlzLm1hcChmdW5jdGlvbigpe3JldHVybiBuLmNsb25lKHRoaXMsYSxiKX0pfSxodG1sOmZ1bmN0aW9uKGEpe3JldHVybiBKKHRoaXMsZnVuY3Rpb24oYSl7dmFyIGI9dGhpc1swXXx8e30sYz0wLGQ9dGhpcy5sZW5ndGg7aWYodm9pZCAwPT09YSYmMT09PWIubm9kZVR5cGUpcmV0dXJuIGIuaW5uZXJIVE1MO2lmKCJzdHJpbmciPT10eXBlb2YgYSYmIWRiLnRlc3QoYSkmJiFpYlsoYmIuZXhlYyhhKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKV0pe2E9YS5yZXBsYWNlKGFiLCI8JDE+PC8kMj4iKTt0cnl7Zm9yKDtkPmM7YysrKWI9dGhpc1tjXXx8e30sMT09PWIubm9kZVR5cGUmJihuLmNsZWFuRGF0YShvYihiLCExKSksYi5pbm5lckhUTUw9YSk7Yj0wfWNhdGNoKGUpe319YiYmdGhpcy5lbXB0eSgpLmFwcGVuZChhKX0sbnVsbCxhLGFyZ3VtZW50cy5sZW5ndGgpfSxyZXBsYWNlV2l0aDpmdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50c1swXTtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsZnVuY3Rpb24oYil7YT10aGlzLnBhcmVudE5vZGUsbi5jbGVhbkRhdGEob2IodGhpcykpLGEmJmEucmVwbGFjZUNoaWxkKGIsdGhpcyl9KSxhJiYoYS5sZW5ndGh8fGEubm9kZVR5cGUpP3RoaXM6dGhpcy5yZW1vdmUoKX0sZGV0YWNoOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnJlbW92ZShhLCEwKX0sZG9tTWFuaXA6ZnVuY3Rpb24oYSxiKXthPWUuYXBwbHkoW10sYSk7dmFyIGMsZCxmLGcsaCxpLGo9MCxsPXRoaXMubGVuZ3RoLG09dGhpcyxvPWwtMSxwPWFbMF0scT1uLmlzRnVuY3Rpb24ocCk7aWYocXx8bD4xJiYic3RyaW5nIj09dHlwZW9mIHAmJiFrLmNoZWNrQ2xvbmUmJmViLnRlc3QocCkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihjKXt2YXIgZD1tLmVxKGMpO3EmJihhWzBdPXAuY2FsbCh0aGlzLGMsZC5odG1sKCkpKSxkLmRvbU1hbmlwKGEsYil9KTtpZihsJiYoYz1uLmJ1aWxkRnJhZ21lbnQoYSx0aGlzWzBdLm93bmVyRG9jdW1lbnQsITEsdGhpcyksZD1jLmZpcnN0Q2hpbGQsMT09PWMuY2hpbGROb2Rlcy5sZW5ndGgmJihjPWQpLGQpKXtmb3IoZj1uLm1hcChvYihjLCJzY3JpcHQiKSxrYiksZz1mLmxlbmd0aDtsPmo7aisrKWg9YyxqIT09byYmKGg9bi5jbG9uZShoLCEwLCEwKSxnJiZuLm1lcmdlKGYsb2IoaCwic2NyaXB0IikpKSxiLmNhbGwodGhpc1tqXSxoLGopO2lmKGcpZm9yKGk9ZltmLmxlbmd0aC0xXS5vd25lckRvY3VtZW50LG4ubWFwKGYsbGIpLGo9MDtnPmo7aisrKWg9ZltqXSxmYi50ZXN0KGgudHlwZXx8IiIpJiYhTC5hY2Nlc3MoaCwiZ2xvYmFsRXZhbCIpJiZuLmNvbnRhaW5zKGksaCkmJihoLnNyYz9uLl9ldmFsVXJsJiZuLl9ldmFsVXJsKGguc3JjKTpuLmdsb2JhbEV2YWwoaC50ZXh0Q29udGVudC5yZXBsYWNlKGhiLCIiKSkpfXJldHVybiB0aGlzfX0pLG4uZWFjaCh7YXBwZW5kVG86ImFwcGVuZCIscHJlcGVuZFRvOiJwcmVwZW5kIixpbnNlcnRCZWZvcmU6ImJlZm9yZSIsaW5zZXJ0QWZ0ZXI6ImFmdGVyIixyZXBsYWNlQWxsOiJyZXBsYWNlV2l0aCJ9LGZ1bmN0aW9uKGEsYil7bi5mblthXT1mdW5jdGlvbihhKXtmb3IodmFyIGMsZD1bXSxlPW4oYSksZz1lLmxlbmd0aC0xLGg9MDtnPj1oO2grKyljPWg9PT1nP3RoaXM6dGhpcy5jbG9uZSghMCksbihlW2hdKVtiXShjKSxmLmFwcGx5KGQsYy5nZXQoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGQpfX0pO3ZhciBxYixyYj17fTtmdW5jdGlvbiBzYihiLGMpe3ZhciBkLGU9bihjLmNyZWF0ZUVsZW1lbnQoYikpLmFwcGVuZFRvKGMuYm9keSksZj1hLmdldERlZmF1bHRDb21wdXRlZFN0eWxlJiYoZD1hLmdldERlZmF1bHRDb21wdXRlZFN0eWxlKGVbMF0pKT9kLmRpc3BsYXk6bi5jc3MoZVswXSwiZGlzcGxheSIpO3JldHVybiBlLmRldGFjaCgpLGZ9ZnVuY3Rpb24gdGIoYSl7dmFyIGI9bCxjPXJiW2FdO3JldHVybiBjfHwoYz1zYihhLGIpLCJub25lIiE9PWMmJmN8fChxYj0ocWJ8fG4oIjxpZnJhbWUgZnJhbWVib3JkZXI9JzAnIHdpZHRoPScwJyBoZWlnaHQ9JzAnLz4iKSkuYXBwZW5kVG8oYi5kb2N1bWVudEVsZW1lbnQpLGI9cWJbMF0uY29udGVudERvY3VtZW50LGIud3JpdGUoKSxiLmNsb3NlKCksYz1zYihhLGIpLHFiLmRldGFjaCgpKSxyYlthXT1jKSxjfXZhciB1Yj0vXm1hcmdpbi8sdmI9bmV3IFJlZ0V4cCgiXigiK1ErIikoPyFweClbYS16JV0rJCIsImkiKSx3Yj1mdW5jdGlvbihiKXtyZXR1cm4gYi5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3Lm9wZW5lcj9iLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShiLG51bGwpOmEuZ2V0Q29tcHV0ZWRTdHlsZShiLG51bGwpfTtmdW5jdGlvbiB4YihhLGIsYyl7dmFyIGQsZSxmLGcsaD1hLnN0eWxlO3JldHVybiBjPWN8fHdiKGEpLGMmJihnPWMuZ2V0UHJvcGVydHlWYWx1ZShiKXx8Y1tiXSksYyYmKCIiIT09Z3x8bi5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSl8fChnPW4uc3R5bGUoYSxiKSksdmIudGVzdChnKSYmdWIudGVzdChiKSYmKGQ9aC53aWR0aCxlPWgubWluV2lkdGgsZj1oLm1heFdpZHRoLGgubWluV2lkdGg9aC5tYXhXaWR0aD1oLndpZHRoPWcsZz1jLndpZHRoLGgud2lkdGg9ZCxoLm1pbldpZHRoPWUsaC5tYXhXaWR0aD1mKSksdm9pZCAwIT09Zz9nKyIiOmd9ZnVuY3Rpb24geWIoYSxiKXtyZXR1cm57Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGEoKT92b2lkIGRlbGV0ZSB0aGlzLmdldDoodGhpcy5nZXQ9YikuYXBwbHkodGhpcyxhcmd1bWVudHMpfX19IWZ1bmN0aW9uKCl7dmFyIGIsYyxkPWwuZG9jdW1lbnRFbGVtZW50LGU9bC5jcmVhdGVFbGVtZW50KCJkaXYiKSxmPWwuY3JlYXRlRWxlbWVudCgiZGl2Iik7aWYoZi5zdHlsZSl7Zi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iY29udGVudC1ib3giLGYuY2xvbmVOb2RlKCEwKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iIixrLmNsZWFyQ2xvbmVTdHlsZT0iY29udGVudC1ib3giPT09Zi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCxlLnN0eWxlLmNzc1RleHQ9ImJvcmRlcjowO3dpZHRoOjA7aGVpZ2h0OjA7dG9wOjA7bGVmdDotOTk5OXB4O21hcmdpbi10b3A6MXB4O3Bvc2l0aW9uOmFic29sdXRlIixlLmFwcGVuZENoaWxkKGYpO2Z1bmN0aW9uIGcoKXtmLnN0eWxlLmNzc1RleHQ9Ii13ZWJraXQtYm94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O2JveC1zaXppbmc6Ym9yZGVyLWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbi10b3A6MSU7dG9wOjElO2JvcmRlcjoxcHg7cGFkZGluZzoxcHg7d2lkdGg6NHB4O3Bvc2l0aW9uOmFic29sdXRlIixmLmlubmVySFRNTD0iIixkLmFwcGVuZENoaWxkKGUpO3ZhciBnPWEuZ2V0Q29tcHV0ZWRTdHlsZShmLG51bGwpO2I9IjElIiE9PWcudG9wLGM9IjRweCI9PT1nLndpZHRoLGQucmVtb3ZlQ2hpbGQoZSl9YS5nZXRDb21wdXRlZFN0eWxlJiZuLmV4dGVuZChrLHtwaXhlbFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGcoKSxifSxib3hTaXppbmdSZWxpYWJsZTpmdW5jdGlvbigpe3JldHVybiBudWxsPT1jJiZnKCksY30scmVsaWFibGVNYXJnaW5SaWdodDpmdW5jdGlvbigpe3ZhciBiLGM9Zi5hcHBlbmRDaGlsZChsLmNyZWF0ZUVsZW1lbnQoImRpdiIpKTtyZXR1cm4gYy5zdHlsZS5jc3NUZXh0PWYuc3R5bGUuY3NzVGV4dD0iLXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94Oy1tb3otYm94LXNpemluZzpjb250ZW50LWJveDtib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzowIixjLnN0eWxlLm1hcmdpblJpZ2h0PWMuc3R5bGUud2lkdGg9IjAiLGYuc3R5bGUud2lkdGg9IjFweCIsZC5hcHBlbmRDaGlsZChlKSxiPSFwYXJzZUZsb2F0KGEuZ2V0Q29tcHV0ZWRTdHlsZShjLG51bGwpLm1hcmdpblJpZ2h0KSxkLnJlbW92ZUNoaWxkKGUpLGYucmVtb3ZlQ2hpbGQoYyksYn19KX19KCksbi5zd2FwPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlLGYsZz17fTtmb3IoZiBpbiBiKWdbZl09YS5zdHlsZVtmXSxhLnN0eWxlW2ZdPWJbZl07ZT1jLmFwcGx5KGEsZHx8W10pO2ZvcihmIGluIGIpYS5zdHlsZVtmXT1nW2ZdO3JldHVybiBlfTt2YXIgemI9L14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLEFiPW5ldyBSZWdFeHAoIl4oIitRKyIpKC4qKSQiLCJpIiksQmI9bmV3IFJlZ0V4cCgiXihbKy1dKT0oIitRKyIpIiwiaSIpLENiPXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxEYj17bGV0dGVyU3BhY2luZzoiMCIsZm9udFdlaWdodDoiNDAwIn0sRWI9WyJXZWJraXQiLCJPIiwiTW96IiwibXMiXTtmdW5jdGlvbiBGYihhLGIpe2lmKGIgaW4gYSlyZXR1cm4gYjt2YXIgYz1iWzBdLnRvVXBwZXJDYXNlKCkrYi5zbGljZSgxKSxkPWIsZT1FYi5sZW5ndGg7d2hpbGUoZS0tKWlmKGI9RWJbZV0rYyxiIGluIGEpcmV0dXJuIGI7cmV0dXJuIGR9ZnVuY3Rpb24gR2IoYSxiLGMpe3ZhciBkPUFiLmV4ZWMoYik7cmV0dXJuIGQ/TWF0aC5tYXgoMCxkWzFdLShjfHwwKSkrKGRbMl18fCJweCIpOmJ9ZnVuY3Rpb24gSGIoYSxiLGMsZCxlKXtmb3IodmFyIGY9Yz09PShkPyJib3JkZXIiOiJjb250ZW50Iik/NDoid2lkdGgiPT09Yj8xOjAsZz0wOzQ+ZjtmKz0yKSJtYXJnaW4iPT09YyYmKGcrPW4uY3NzKGEsYytSW2ZdLCEwLGUpKSxkPygiY29udGVudCI9PT1jJiYoZy09bi5jc3MoYSwicGFkZGluZyIrUltmXSwhMCxlKSksIm1hcmdpbiIhPT1jJiYoZy09bi5jc3MoYSwiYm9yZGVyIitSW2ZdKyJXaWR0aCIsITAsZSkpKTooZys9bi5jc3MoYSwicGFkZGluZyIrUltmXSwhMCxlKSwicGFkZGluZyIhPT1jJiYoZys9bi5jc3MoYSwiYm9yZGVyIitSW2ZdKyJXaWR0aCIsITAsZSkpKTtyZXR1cm4gZ31mdW5jdGlvbiBJYihhLGIsYyl7dmFyIGQ9ITAsZT0id2lkdGgiPT09Yj9hLm9mZnNldFdpZHRoOmEub2Zmc2V0SGVpZ2h0LGY9d2IoYSksZz0iYm9yZGVyLWJveCI9PT1uLmNzcyhhLCJib3hTaXppbmciLCExLGYpO2lmKDA+PWV8fG51bGw9PWUpe2lmKGU9eGIoYSxiLGYpLCgwPmV8fG51bGw9PWUpJiYoZT1hLnN0eWxlW2JdKSx2Yi50ZXN0KGUpKXJldHVybiBlO2Q9ZyYmKGsuYm94U2l6aW5nUmVsaWFibGUoKXx8ZT09PWEuc3R5bGVbYl0pLGU9cGFyc2VGbG9hdChlKXx8MH1yZXR1cm4gZStIYihhLGIsY3x8KGc/ImJvcmRlciI6ImNvbnRlbnQiKSxkLGYpKyJweCJ9ZnVuY3Rpb24gSmIoYSxiKXtmb3IodmFyIGMsZCxlLGY9W10sZz0wLGg9YS5sZW5ndGg7aD5nO2crKylkPWFbZ10sZC5zdHlsZSYmKGZbZ109TC5nZXQoZCwib2xkZGlzcGxheSIpLGM9ZC5zdHlsZS5kaXNwbGF5LGI/KGZbZ118fCJub25lIiE9PWN8fChkLnN0eWxlLmRpc3BsYXk9IiIpLCIiPT09ZC5zdHlsZS5kaXNwbGF5JiZTKGQpJiYoZltnXT1MLmFjY2VzcyhkLCJvbGRkaXNwbGF5Iix0YihkLm5vZGVOYW1lKSkpKTooZT1TKGQpLCJub25lIj09PWMmJmV8fEwuc2V0KGQsIm9sZGRpc3BsYXkiLGU/YzpuLmNzcyhkLCJkaXNwbGF5IikpKSk7Zm9yKGc9MDtoPmc7ZysrKWQ9YVtnXSxkLnN0eWxlJiYoYiYmIm5vbmUiIT09ZC5zdHlsZS5kaXNwbGF5JiYiIiE9PWQuc3R5bGUuZGlzcGxheXx8KGQuc3R5bGUuZGlzcGxheT1iP2ZbZ118fCIiOiJub25lIikpO3JldHVybiBhfW4uZXh0ZW5kKHtjc3NIb29rczp7b3BhY2l0eTp7Z2V0OmZ1bmN0aW9uKGEsYil7aWYoYil7dmFyIGM9eGIoYSwib3BhY2l0eSIpO3JldHVybiIiPT09Yz8iMSI6Y319fX0sY3NzTnVtYmVyOntjb2x1bW5Db3VudDohMCxmaWxsT3BhY2l0eTohMCxmbGV4R3JvdzohMCxmbGV4U2hyaW5rOiEwLGZvbnRXZWlnaHQ6ITAsbGluZUhlaWdodDohMCxvcGFjaXR5OiEwLG9yZGVyOiEwLG9ycGhhbnM6ITAsd2lkb3dzOiEwLHpJbmRleDohMCx6b29tOiEwfSxjc3NQcm9wczp7ImZsb2F0IjoiY3NzRmxvYXQifSxzdHlsZTpmdW5jdGlvbihhLGIsYyxkKXtpZihhJiYzIT09YS5ub2RlVHlwZSYmOCE9PWEubm9kZVR5cGUmJmEuc3R5bGUpe3ZhciBlLGYsZyxoPW4uY2FtZWxDYXNlKGIpLGk9YS5zdHlsZTtyZXR1cm4gYj1uLmNzc1Byb3BzW2hdfHwobi5jc3NQcm9wc1toXT1GYihpLGgpKSxnPW4uY3NzSG9va3NbYl18fG4uY3NzSG9va3NbaF0sdm9pZCAwPT09Yz9nJiYiZ2V0ImluIGcmJnZvaWQgMCE9PShlPWcuZ2V0KGEsITEsZCkpP2U6aVtiXTooZj10eXBlb2YgYywic3RyaW5nIj09PWYmJihlPUJiLmV4ZWMoYykpJiYoYz0oZVsxXSsxKSplWzJdK3BhcnNlRmxvYXQobi5jc3MoYSxiKSksZj0ibnVtYmVyIiksbnVsbCE9YyYmYz09PWMmJigibnVtYmVyIiE9PWZ8fG4uY3NzTnVtYmVyW2hdfHwoYys9InB4Iiksay5jbGVhckNsb25lU3R5bGV8fCIiIT09Y3x8MCE9PWIuaW5kZXhPZigiYmFja2dyb3VuZCIpfHwoaVtiXT0iaW5oZXJpdCIpLGcmJiJzZXQiaW4gZyYmdm9pZCAwPT09KGM9Zy5zZXQoYSxjLGQpKXx8KGlbYl09YykpLHZvaWQgMCl9fSxjc3M6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGUsZixnLGg9bi5jYW1lbENhc2UoYik7cmV0dXJuIGI9bi5jc3NQcm9wc1toXXx8KG4uY3NzUHJvcHNbaF09RmIoYS5zdHlsZSxoKSksZz1uLmNzc0hvb2tzW2JdfHxuLmNzc0hvb2tzW2hdLGcmJiJnZXQiaW4gZyYmKGU9Zy5nZXQoYSwhMCxjKSksdm9pZCAwPT09ZSYmKGU9eGIoYSxiLGQpKSwibm9ybWFsIj09PWUmJmIgaW4gRGImJihlPURiW2JdKSwiIj09PWN8fGM/KGY9cGFyc2VGbG9hdChlKSxjPT09ITB8fG4uaXNOdW1lcmljKGYpP2Z8fDA6ZSk6ZX19KSxuLmVhY2goWyJoZWlnaHQiLCJ3aWR0aCJdLGZ1bmN0aW9uKGEsYil7bi5jc3NIb29rc1tiXT17Z2V0OmZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gYz96Yi50ZXN0KG4uY3NzKGEsImRpc3BsYXkiKSkmJjA9PT1hLm9mZnNldFdpZHRoP24uc3dhcChhLENiLGZ1bmN0aW9uKCl7cmV0dXJuIEliKGEsYixkKX0pOkliKGEsYixkKTp2b2lkIDB9LHNldDpmdW5jdGlvbihhLGMsZCl7dmFyIGU9ZCYmd2IoYSk7cmV0dXJuIEdiKGEsYyxkP0hiKGEsYixkLCJib3JkZXItYm94Ij09PW4uY3NzKGEsImJveFNpemluZyIsITEsZSksZSk6MCl9fX0pLG4uY3NzSG9va3MubWFyZ2luUmlnaHQ9eWIoay5yZWxpYWJsZU1hcmdpblJpZ2h0LGZ1bmN0aW9uKGEsYil7cmV0dXJuIGI/bi5zd2FwKGEse2Rpc3BsYXk6ImlubGluZS1ibG9jayJ9LHhiLFthLCJtYXJnaW5SaWdodCJdKTp2b2lkIDB9KSxuLmVhY2goe21hcmdpbjoiIixwYWRkaW5nOiIiLGJvcmRlcjoiV2lkdGgifSxmdW5jdGlvbihhLGIpe24uY3NzSG9va3NbYStiXT17ZXhwYW5kOmZ1bmN0aW9uKGMpe2Zvcih2YXIgZD0wLGU9e30sZj0ic3RyaW5nIj09dHlwZW9mIGM/Yy5zcGxpdCgiICIpOltjXTs0PmQ7ZCsrKWVbYStSW2RdK2JdPWZbZF18fGZbZC0yXXx8ZlswXTtyZXR1cm4gZX19LHViLnRlc3QoYSl8fChuLmNzc0hvb2tzW2ErYl0uc2V0PUdiKX0pLG4uZm4uZXh0ZW5kKHtjc3M6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gSih0aGlzLGZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGY9e30sZz0wO2lmKG4uaXNBcnJheShiKSl7Zm9yKGQ9d2IoYSksZT1iLmxlbmd0aDtlPmc7ZysrKWZbYltnXV09bi5jc3MoYSxiW2ddLCExLGQpO3JldHVybiBmfXJldHVybiB2b2lkIDAhPT1jP24uc3R5bGUoYSxiLGMpOm4uY3NzKGEsYil9LGEsYixhcmd1bWVudHMubGVuZ3RoPjEpfSxzaG93OmZ1bmN0aW9uKCl7cmV0dXJuIEpiKHRoaXMsITApfSxoaWRlOmZ1bmN0aW9uKCl7cmV0dXJuIEpiKHRoaXMpfSx0b2dnbGU6ZnVuY3Rpb24oYSl7cmV0dXJuImJvb2xlYW4iPT10eXBlb2YgYT9hP3RoaXMuc2hvdygpOnRoaXMuaGlkZSgpOnRoaXMuZWFjaChmdW5jdGlvbigpe1ModGhpcyk/bih0aGlzKS5zaG93KCk6bih0aGlzKS5oaWRlKCl9KX19KTtmdW5jdGlvbiBLYihhLGIsYyxkLGUpe3JldHVybiBuZXcgS2IucHJvdG90eXBlLmluaXQoYSxiLGMsZCxlKX1uLlR3ZWVuPUtiLEtiLnByb3RvdHlwZT17Y29uc3RydWN0b3I6S2IsaW5pdDpmdW5jdGlvbihhLGIsYyxkLGUsZil7dGhpcy5lbGVtPWEsdGhpcy5wcm9wPWMsdGhpcy5lYXNpbmc9ZXx8InN3aW5nIix0aGlzLm9wdGlvbnM9Yix0aGlzLnN0YXJ0PXRoaXMubm93PXRoaXMuY3VyKCksdGhpcy5lbmQ9ZCx0aGlzLnVuaXQ9Znx8KG4uY3NzTnVtYmVyW2NdPyIiOiJweCIpfSxjdXI6ZnVuY3Rpb24oKXt2YXIgYT1LYi5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gYSYmYS5nZXQ/YS5nZXQodGhpcyk6S2IucHJvcEhvb2tzLl9kZWZhdWx0LmdldCh0aGlzKX0scnVuOmZ1bmN0aW9uKGEpe3ZhciBiLGM9S2IucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIHRoaXMucG9zPWI9dGhpcy5vcHRpb25zLmR1cmF0aW9uP24uZWFzaW5nW3RoaXMuZWFzaW5nXShhLHRoaXMub3B0aW9ucy5kdXJhdGlvbiphLDAsMSx0aGlzLm9wdGlvbnMuZHVyYXRpb24pOmEsdGhpcy5ub3c9KHRoaXMuZW5kLXRoaXMuc3RhcnQpKmIrdGhpcy5zdGFydCx0aGlzLm9wdGlvbnMuc3RlcCYmdGhpcy5vcHRpb25zLnN0ZXAuY2FsbCh0aGlzLmVsZW0sdGhpcy5ub3csdGhpcyksYyYmYy5zZXQ/Yy5zZXQodGhpcyk6S2IucHJvcEhvb2tzLl9kZWZhdWx0LnNldCh0aGlzKSx0aGlzfX0sS2IucHJvdG90eXBlLmluaXQucHJvdG90eXBlPUtiLnByb3RvdHlwZSxLYi5wcm9wSG9va3M9e19kZWZhdWx0OntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI7cmV0dXJuIG51bGw9PWEuZWxlbVthLnByb3BdfHxhLmVsZW0uc3R5bGUmJm51bGwhPWEuZWxlbS5zdHlsZVthLnByb3BdPyhiPW4uY3NzKGEuZWxlbSxhLnByb3AsIiIpLGImJiJhdXRvIiE9PWI/YjowKTphLmVsZW1bYS5wcm9wXX0sc2V0OmZ1bmN0aW9uKGEpe24uZnguc3RlcFthLnByb3BdP24uZnguc3RlcFthLnByb3BdKGEpOmEuZWxlbS5zdHlsZSYmKG51bGwhPWEuZWxlbS5zdHlsZVtuLmNzc1Byb3BzW2EucHJvcF1dfHxuLmNzc0hvb2tzW2EucHJvcF0pP24uc3R5bGUoYS5lbGVtLGEucHJvcCxhLm5vdythLnVuaXQpOmEuZWxlbVthLnByb3BdPWEubm93fX19LEtiLnByb3BIb29rcy5zY3JvbGxUb3A9S2IucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihhKXthLmVsZW0ubm9kZVR5cGUmJmEuZWxlbS5wYXJlbnROb2RlJiYoYS5lbGVtW2EucHJvcF09YS5ub3cpfX0sbi5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihhKXtyZXR1cm4gYX0sc3dpbmc6ZnVuY3Rpb24oYSl7cmV0dXJuLjUtTWF0aC5jb3MoYSpNYXRoLlBJKS8yfX0sbi5meD1LYi5wcm90b3R5cGUuaW5pdCxuLmZ4LnN0ZXA9e307dmFyIExiLE1iLE5iPS9eKD86dG9nZ2xlfHNob3d8aGlkZSkkLyxPYj1uZXcgUmVnRXhwKCJeKD86KFsrLV0pPXwpKCIrUSsiKShbYS16JV0qKSQiLCJpIiksUGI9L3F1ZXVlSG9va3MkLyxRYj1bVmJdLFJiPXsiKiI6W2Z1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jcmVhdGVUd2VlbihhLGIpLGQ9Yy5jdXIoKSxlPU9iLmV4ZWMoYiksZj1lJiZlWzNdfHwobi5jc3NOdW1iZXJbYV0/IiI6InB4IiksZz0obi5jc3NOdW1iZXJbYV18fCJweCIhPT1mJiYrZCkmJk9iLmV4ZWMobi5jc3MoYy5lbGVtLGEpKSxoPTEsaT0yMDtpZihnJiZnWzNdIT09Zil7Zj1mfHxnWzNdLGU9ZXx8W10sZz0rZHx8MTtkbyBoPWh8fCIuNSIsZy89aCxuLnN0eWxlKGMuZWxlbSxhLGcrZik7d2hpbGUoaCE9PShoPWMuY3VyKCkvZCkmJjEhPT1oJiYtLWkpfXJldHVybiBlJiYoZz1jLnN0YXJ0PStnfHwrZHx8MCxjLnVuaXQ9ZixjLmVuZD1lWzFdP2crKGVbMV0rMSkqZVsyXTorZVsyXSksY31dfTtmdW5jdGlvbiBTYigpe3JldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7TGI9dm9pZCAwfSksTGI9bi5ub3coKX1mdW5jdGlvbiBUYihhLGIpe3ZhciBjLGQ9MCxlPXtoZWlnaHQ6YX07Zm9yKGI9Yj8xOjA7ND5kO2QrPTItYiljPVJbZF0sZVsibWFyZ2luIitjXT1lWyJwYWRkaW5nIitjXT1hO3JldHVybiBiJiYoZS5vcGFjaXR5PWUud2lkdGg9YSksZX1mdW5jdGlvbiBVYihhLGIsYyl7Zm9yKHZhciBkLGU9KFJiW2JdfHxbXSkuY29uY2F0KFJiWyIqIl0pLGY9MCxnPWUubGVuZ3RoO2c+ZjtmKyspaWYoZD1lW2ZdLmNhbGwoYyxiLGEpKXJldHVybiBkfWZ1bmN0aW9uIFZiKGEsYixjKXt2YXIgZCxlLGYsZyxoLGksaixrLGw9dGhpcyxtPXt9LG89YS5zdHlsZSxwPWEubm9kZVR5cGUmJlMoYSkscT1MLmdldChhLCJmeHNob3ciKTtjLnF1ZXVlfHwoaD1uLl9xdWV1ZUhvb2tzKGEsImZ4IiksbnVsbD09aC51bnF1ZXVlZCYmKGgudW5xdWV1ZWQ9MCxpPWguZW1wdHkuZmlyZSxoLmVtcHR5LmZpcmU9ZnVuY3Rpb24oKXtoLnVucXVldWVkfHxpKCl9KSxoLnVucXVldWVkKyssbC5hbHdheXMoZnVuY3Rpb24oKXtsLmFsd2F5cyhmdW5jdGlvbigpe2gudW5xdWV1ZWQtLSxuLnF1ZXVlKGEsImZ4IikubGVuZ3RofHxoLmVtcHR5LmZpcmUoKX0pfSkpLDE9PT1hLm5vZGVUeXBlJiYoImhlaWdodCJpbiBifHwid2lkdGgiaW4gYikmJihjLm92ZXJmbG93PVtvLm92ZXJmbG93LG8ub3ZlcmZsb3dYLG8ub3ZlcmZsb3dZXSxqPW4uY3NzKGEsImRpc3BsYXkiKSxrPSJub25lIj09PWo/TC5nZXQoYSwib2xkZGlzcGxheSIpfHx0YihhLm5vZGVOYW1lKTpqLCJpbmxpbmUiPT09ayYmIm5vbmUiPT09bi5jc3MoYSwiZmxvYXQiKSYmKG8uZGlzcGxheT0iaW5saW5lLWJsb2NrIikpLGMub3ZlcmZsb3cmJihvLm92ZXJmbG93PSJoaWRkZW4iLGwuYWx3YXlzKGZ1bmN0aW9uKCl7by5vdmVyZmxvdz1jLm92ZXJmbG93WzBdLG8ub3ZlcmZsb3dYPWMub3ZlcmZsb3dbMV0sby5vdmVyZmxvd1k9Yy5vdmVyZmxvd1syXX0pKTtmb3IoZCBpbiBiKWlmKGU9YltkXSxOYi5leGVjKGUpKXtpZihkZWxldGUgYltkXSxmPWZ8fCJ0b2dnbGUiPT09ZSxlPT09KHA/ImhpZGUiOiJzaG93Iikpe2lmKCJzaG93IiE9PWV8fCFxfHx2b2lkIDA9PT1xW2RdKWNvbnRpbnVlO3A9ITB9bVtkXT1xJiZxW2RdfHxuLnN0eWxlKGEsZCl9ZWxzZSBqPXZvaWQgMDtpZihuLmlzRW1wdHlPYmplY3QobSkpImlubGluZSI9PT0oIm5vbmUiPT09aj90YihhLm5vZGVOYW1lKTpqKSYmKG8uZGlzcGxheT1qKTtlbHNle3E/ImhpZGRlbiJpbiBxJiYocD1xLmhpZGRlbik6cT1MLmFjY2VzcyhhLCJmeHNob3ciLHt9KSxmJiYocS5oaWRkZW49IXApLHA/bihhKS5zaG93KCk6bC5kb25lKGZ1bmN0aW9uKCl7bihhKS5oaWRlKCl9KSxsLmRvbmUoZnVuY3Rpb24oKXt2YXIgYjtMLnJlbW92ZShhLCJmeHNob3ciKTtmb3IoYiBpbiBtKW4uc3R5bGUoYSxiLG1bYl0pfSk7Zm9yKGQgaW4gbSlnPVViKHA/cVtkXTowLGQsbCksZCBpbiBxfHwocVtkXT1nLnN0YXJ0LHAmJihnLmVuZD1nLnN0YXJ0LGcuc3RhcnQ9IndpZHRoIj09PWR8fCJoZWlnaHQiPT09ZD8xOjApKX19ZnVuY3Rpb24gV2IoYSxiKXt2YXIgYyxkLGUsZixnO2ZvcihjIGluIGEpaWYoZD1uLmNhbWVsQ2FzZShjKSxlPWJbZF0sZj1hW2NdLG4uaXNBcnJheShmKSYmKGU9ZlsxXSxmPWFbY109ZlswXSksYyE9PWQmJihhW2RdPWYsZGVsZXRlIGFbY10pLGc9bi5jc3NIb29rc1tkXSxnJiYiZXhwYW5kImluIGcpe2Y9Zy5leHBhbmQoZiksZGVsZXRlIGFbZF07Zm9yKGMgaW4gZiljIGluIGF8fChhW2NdPWZbY10sYltjXT1lKX1lbHNlIGJbZF09ZX1mdW5jdGlvbiBYYihhLGIsYyl7dmFyIGQsZSxmPTAsZz1RYi5sZW5ndGgsaD1uLkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCl7ZGVsZXRlIGkuZWxlbX0pLGk9ZnVuY3Rpb24oKXtpZihlKXJldHVybiExO2Zvcih2YXIgYj1MYnx8U2IoKSxjPU1hdGgubWF4KDAsai5zdGFydFRpbWUrai5kdXJhdGlvbi1iKSxkPWMvai5kdXJhdGlvbnx8MCxmPTEtZCxnPTAsaT1qLnR3ZWVucy5sZW5ndGg7aT5nO2crKylqLnR3ZWVuc1tnXS5ydW4oZik7cmV0dXJuIGgubm90aWZ5V2l0aChhLFtqLGYsY10pLDE+ZiYmaT9jOihoLnJlc29sdmVXaXRoKGEsW2pdKSwhMSl9LGo9aC5wcm9taXNlKHtlbGVtOmEscHJvcHM6bi5leHRlbmQoe30sYiksb3B0czpuLmV4dGVuZCghMCx7c3BlY2lhbEVhc2luZzp7fX0sYyksb3JpZ2luYWxQcm9wZXJ0aWVzOmIsb3JpZ2luYWxPcHRpb25zOmMsc3RhcnRUaW1lOkxifHxTYigpLGR1cmF0aW9uOmMuZHVyYXRpb24sdHdlZW5zOltdLGNyZWF0ZVR3ZWVuOmZ1bmN0aW9uKGIsYyl7dmFyIGQ9bi5Ud2VlbihhLGoub3B0cyxiLGMsai5vcHRzLnNwZWNpYWxFYXNpbmdbYl18fGoub3B0cy5lYXNpbmcpO3JldHVybiBqLnR3ZWVucy5wdXNoKGQpLGR9LHN0b3A6ZnVuY3Rpb24oYil7dmFyIGM9MCxkPWI/ai50d2VlbnMubGVuZ3RoOjA7aWYoZSlyZXR1cm4gdGhpcztmb3IoZT0hMDtkPmM7YysrKWoudHdlZW5zW2NdLnJ1bigxKTtyZXR1cm4gYj9oLnJlc29sdmVXaXRoKGEsW2osYl0pOmgucmVqZWN0V2l0aChhLFtqLGJdKSx0aGlzfX0pLGs9ai5wcm9wcztmb3IoV2IoayxqLm9wdHMuc3BlY2lhbEVhc2luZyk7Zz5mO2YrKylpZihkPVFiW2ZdLmNhbGwoaixhLGssai5vcHRzKSlyZXR1cm4gZDtyZXR1cm4gbi5tYXAoayxVYixqKSxuLmlzRnVuY3Rpb24oai5vcHRzLnN0YXJ0KSYmai5vcHRzLnN0YXJ0LmNhbGwoYSxqKSxuLmZ4LnRpbWVyKG4uZXh0ZW5kKGkse2VsZW06YSxhbmltOmoscXVldWU6ai5vcHRzLnF1ZXVlfSkpLGoucHJvZ3Jlc3Moai5vcHRzLnByb2dyZXNzKS5kb25lKGoub3B0cy5kb25lLGoub3B0cy5jb21wbGV0ZSkuZmFpbChqLm9wdHMuZmFpbCkuYWx3YXlzKGoub3B0cy5hbHdheXMpfW4uQW5pbWF0aW9uPW4uZXh0ZW5kKFhiLHt0d2VlbmVyOmZ1bmN0aW9uKGEsYil7bi5pc0Z1bmN0aW9uKGEpPyhiPWEsYT1bIioiXSk6YT1hLnNwbGl0KCIgIik7Zm9yKHZhciBjLGQ9MCxlPWEubGVuZ3RoO2U+ZDtkKyspYz1hW2RdLFJiW2NdPVJiW2NdfHxbXSxSYltjXS51bnNoaWZ0KGIpfSxwcmVmaWx0ZXI6ZnVuY3Rpb24oYSxiKXtiP1FiLnVuc2hpZnQoYSk6UWIucHVzaChhKX19KSxuLnNwZWVkPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hJiYib2JqZWN0Ij09dHlwZW9mIGE/bi5leHRlbmQoe30sYSk6e2NvbXBsZXRlOmN8fCFjJiZifHxuLmlzRnVuY3Rpb24oYSkmJmEsZHVyYXRpb246YSxlYXNpbmc6YyYmYnx8YiYmIW4uaXNGdW5jdGlvbihiKSYmYn07cmV0dXJuIGQuZHVyYXRpb249bi5meC5vZmY/MDoibnVtYmVyIj09dHlwZW9mIGQuZHVyYXRpb24/ZC5kdXJhdGlvbjpkLmR1cmF0aW9uIGluIG4uZnguc3BlZWRzP24uZnguc3BlZWRzW2QuZHVyYXRpb25dOm4uZnguc3BlZWRzLl9kZWZhdWx0LChudWxsPT1kLnF1ZXVlfHxkLnF1ZXVlPT09ITApJiYoZC5xdWV1ZT0iZngiKSxkLm9sZD1kLmNvbXBsZXRlLGQuY29tcGxldGU9ZnVuY3Rpb24oKXtuLmlzRnVuY3Rpb24oZC5vbGQpJiZkLm9sZC5jYWxsKHRoaXMpLGQucXVldWUmJm4uZGVxdWV1ZSh0aGlzLGQucXVldWUpfSxkfSxuLmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmZpbHRlcihTKS5jc3MoIm9wYWNpdHkiLDApLnNob3coKS5lbmQoKS5hbmltYXRlKHtvcGFjaXR5OmJ9LGEsYyxkKX0sYW5pbWF0ZTpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1uLmlzRW1wdHlPYmplY3QoYSksZj1uLnNwZWVkKGIsYyxkKSxnPWZ1bmN0aW9uKCl7dmFyIGI9WGIodGhpcyxuLmV4dGVuZCh7fSxhKSxmKTsoZXx8TC5nZXQodGhpcywiZmluaXNoIikpJiZiLnN0b3AoITApfTtyZXR1cm4gZy5maW5pc2g9ZyxlfHxmLnF1ZXVlPT09ITE/dGhpcy5lYWNoKGcpOnRoaXMucXVldWUoZi5xdWV1ZSxnKX0sc3RvcDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9ZnVuY3Rpb24oYSl7dmFyIGI9YS5zdG9wO2RlbGV0ZSBhLnN0b3AsYihjKX07cmV0dXJuInN0cmluZyIhPXR5cGVvZiBhJiYoYz1iLGI9YSxhPXZvaWQgMCksYiYmYSE9PSExJiZ0aGlzLnF1ZXVlKGF8fCJmeCIsW10pLHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiPSEwLGU9bnVsbCE9YSYmYSsicXVldWVIb29rcyIsZj1uLnRpbWVycyxnPUwuZ2V0KHRoaXMpO2lmKGUpZ1tlXSYmZ1tlXS5zdG9wJiZkKGdbZV0pO2Vsc2UgZm9yKGUgaW4gZylnW2VdJiZnW2VdLnN0b3AmJlBiLnRlc3QoZSkmJmQoZ1tlXSk7Zm9yKGU9Zi5sZW5ndGg7ZS0tOylmW2VdLmVsZW0hPT10aGlzfHxudWxsIT1hJiZmW2VdLnF1ZXVlIT09YXx8KGZbZV0uYW5pbS5zdG9wKGMpLGI9ITEsZi5zcGxpY2UoZSwxKSk7KGJ8fCFjKSYmbi5kZXF1ZXVlKHRoaXMsYSl9KX0sZmluaXNoOmZ1bmN0aW9uKGEpe3JldHVybiBhIT09ITEmJihhPWF8fCJmeCIpLHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiLGM9TC5nZXQodGhpcyksZD1jW2ErInF1ZXVlIl0sZT1jW2ErInF1ZXVlSG9va3MiXSxmPW4udGltZXJzLGc9ZD9kLmxlbmd0aDowO2ZvcihjLmZpbmlzaD0hMCxuLnF1ZXVlKHRoaXMsYSxbXSksZSYmZS5zdG9wJiZlLnN0b3AuY2FsbCh0aGlzLCEwKSxiPWYubGVuZ3RoO2ItLTspZltiXS5lbGVtPT09dGhpcyYmZltiXS5xdWV1ZT09PWEmJihmW2JdLmFuaW0uc3RvcCghMCksZi5zcGxpY2UoYiwxKSk7Zm9yKGI9MDtnPmI7YisrKWRbYl0mJmRbYl0uZmluaXNoJiZkW2JdLmZpbmlzaC5jYWxsKHRoaXMpO2RlbGV0ZSBjLmZpbmlzaH0pfX0pLG4uZWFjaChbInRvZ2dsZSIsInNob3ciLCJoaWRlIl0sZnVuY3Rpb24oYSxiKXt2YXIgYz1uLmZuW2JdO24uZm5bYl09ZnVuY3Rpb24oYSxkLGUpe3JldHVybiBudWxsPT1hfHwiYm9vbGVhbiI9PXR5cGVvZiBhP2MuYXBwbHkodGhpcyxhcmd1bWVudHMpOnRoaXMuYW5pbWF0ZShUYihiLCEwKSxhLGQsZSl9fSksbi5lYWNoKHtzbGlkZURvd246VGIoInNob3ciKSxzbGlkZVVwOlRiKCJoaWRlIiksc2xpZGVUb2dnbGU6VGIoInRvZ2dsZSIpLGZhZGVJbjp7b3BhY2l0eToic2hvdyJ9LGZhZGVPdXQ6e29wYWNpdHk6ImhpZGUifSxmYWRlVG9nZ2xlOntvcGFjaXR5OiJ0b2dnbGUifX0sZnVuY3Rpb24oYSxiKXtuLmZuW2FdPWZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gdGhpcy5hbmltYXRlKGIsYSxjLGQpfX0pLG4udGltZXJzPVtdLG4uZngudGljaz1mdW5jdGlvbigpe3ZhciBhLGI9MCxjPW4udGltZXJzO2ZvcihMYj1uLm5vdygpO2I8Yy5sZW5ndGg7YisrKWE9Y1tiXSxhKCl8fGNbYl0hPT1hfHxjLnNwbGljZShiLS0sMSk7Yy5sZW5ndGh8fG4uZnguc3RvcCgpLExiPXZvaWQgMH0sbi5meC50aW1lcj1mdW5jdGlvbihhKXtuLnRpbWVycy5wdXNoKGEpLGEoKT9uLmZ4LnN0YXJ0KCk6bi50aW1lcnMucG9wKCl9LG4uZnguaW50ZXJ2YWw9MTMsbi5meC5zdGFydD1mdW5jdGlvbigpe01ifHwoTWI9c2V0SW50ZXJ2YWwobi5meC50aWNrLG4uZnguaW50ZXJ2YWwpKX0sbi5meC5zdG9wPWZ1bmN0aW9uKCl7Y2xlYXJJbnRlcnZhbChNYiksTWI9bnVsbH0sbi5meC5zcGVlZHM9e3Nsb3c6NjAwLGZhc3Q6MjAwLF9kZWZhdWx0OjQwMH0sbi5mbi5kZWxheT1mdW5jdGlvbihhLGIpe3JldHVybiBhPW4uZng/bi5meC5zcGVlZHNbYV18fGE6YSxiPWJ8fCJmeCIsdGhpcy5xdWV1ZShiLGZ1bmN0aW9uKGIsYyl7dmFyIGQ9c2V0VGltZW91dChiLGEpO2Muc3RvcD1mdW5jdGlvbigpe2NsZWFyVGltZW91dChkKX19KX0sZnVuY3Rpb24oKXt2YXIgYT1sLmNyZWF0ZUVsZW1lbnQoImlucHV0IiksYj1sLmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpLGM9Yi5hcHBlbmRDaGlsZChsLmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpKTthLnR5cGU9ImNoZWNrYm94IixrLmNoZWNrT249IiIhPT1hLnZhbHVlLGsub3B0U2VsZWN0ZWQ9Yy5zZWxlY3RlZCxiLmRpc2FibGVkPSEwLGsub3B0RGlzYWJsZWQ9IWMuZGlzYWJsZWQsYT1sLmNyZWF0ZUVsZW1lbnQoImlucHV0IiksYS52YWx1ZT0idCIsYS50eXBlPSJyYWRpbyIsay5yYWRpb1ZhbHVlPSJ0Ij09PWEudmFsdWV9KCk7dmFyIFliLFpiLCRiPW4uZXhwci5hdHRySGFuZGxlO24uZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIEoodGhpcyxuLmF0dHIsYSxiLGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe24ucmVtb3ZlQXR0cih0aGlzLGEpfSl9fSksbi5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj1hLm5vZGVUeXBlO2lmKGEmJjMhPT1mJiY4IT09ZiYmMiE9PWYpcmV0dXJuIHR5cGVvZiBhLmdldEF0dHJpYnV0ZT09PVU/bi5wcm9wKGEsYixjKTooMT09PWYmJm4uaXNYTUxEb2MoYSl8fChiPWIudG9Mb3dlckNhc2UoKSxkPW4uYXR0ckhvb2tzW2JdfHwobi5leHByLm1hdGNoLmJvb2wudGVzdChiKT9aYjpZYikpLHZvaWQgMD09PWM/ZCYmImdldCJpbiBkJiZudWxsIT09KGU9ZC5nZXQoYSxiKSk/ZTooZT1uLmZpbmQuYXR0cihhLGIpLG51bGw9PWU/dm9pZCAwOmUpOm51bGwhPT1jP2QmJiJzZXQiaW4gZCYmdm9pZCAwIT09KGU9ZC5zZXQoYSxjLGIpKT9lOihhLnNldEF0dHJpYnV0ZShiLGMrIiIpLGMpOnZvaWQgbi5yZW1vdmVBdHRyKGEsYikpCn0scmVtb3ZlQXR0cjpmdW5jdGlvbihhLGIpe3ZhciBjLGQsZT0wLGY9YiYmYi5tYXRjaChFKTtpZihmJiYxPT09YS5ub2RlVHlwZSl3aGlsZShjPWZbZSsrXSlkPW4ucHJvcEZpeFtjXXx8YyxuLmV4cHIubWF0Y2guYm9vbC50ZXN0KGMpJiYoYVtkXT0hMSksYS5yZW1vdmVBdHRyaWJ1dGUoYyl9LGF0dHJIb29rczp7dHlwZTp7c2V0OmZ1bmN0aW9uKGEsYil7aWYoIWsucmFkaW9WYWx1ZSYmInJhZGlvIj09PWImJm4ubm9kZU5hbWUoYSwiaW5wdXQiKSl7dmFyIGM9YS52YWx1ZTtyZXR1cm4gYS5zZXRBdHRyaWJ1dGUoInR5cGUiLGIpLGMmJihhLnZhbHVlPWMpLGJ9fX19fSksWmI9e3NldDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGI9PT0hMT9uLnJlbW92ZUF0dHIoYSxjKTphLnNldEF0dHJpYnV0ZShjLGMpLGN9fSxuLmVhY2gobi5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksZnVuY3Rpb24oYSxiKXt2YXIgYz0kYltiXXx8bi5maW5kLmF0dHI7JGJbYl09ZnVuY3Rpb24oYSxiLGQpe3ZhciBlLGY7cmV0dXJuIGR8fChmPSRiW2JdLCRiW2JdPWUsZT1udWxsIT1jKGEsYixkKT9iLnRvTG93ZXJDYXNlKCk6bnVsbCwkYltiXT1mKSxlfX0pO3ZhciBfYj0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pO24uZm4uZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGEsYil7cmV0dXJuIEoodGhpcyxuLnByb3AsYSxiLGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZVByb3A6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2RlbGV0ZSB0aGlzW24ucHJvcEZpeFthXXx8YV19KX19KSxuLmV4dGVuZCh7cHJvcEZpeDp7ImZvciI6Imh0bWxGb3IiLCJjbGFzcyI6ImNsYXNzTmFtZSJ9LHByb3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnPWEubm9kZVR5cGU7aWYoYSYmMyE9PWcmJjghPT1nJiYyIT09ZylyZXR1cm4gZj0xIT09Z3x8IW4uaXNYTUxEb2MoYSksZiYmKGI9bi5wcm9wRml4W2JdfHxiLGU9bi5wcm9wSG9va3NbYl0pLHZvaWQgMCE9PWM/ZSYmInNldCJpbiBlJiZ2b2lkIDAhPT0oZD1lLnNldChhLGMsYikpP2Q6YVtiXT1jOmUmJiJnZXQiaW4gZSYmbnVsbCE9PShkPWUuZ2V0KGEsYikpP2Q6YVtiXX0scHJvcEhvb2tzOnt0YWJJbmRleDp7Z2V0OmZ1bmN0aW9uKGEpe3JldHVybiBhLmhhc0F0dHJpYnV0ZSgidGFiaW5kZXgiKXx8X2IudGVzdChhLm5vZGVOYW1lKXx8YS5ocmVmP2EudGFiSW5kZXg6LTF9fX19KSxrLm9wdFNlbGVjdGVkfHwobi5wcm9wSG9va3Muc2VsZWN0ZWQ9e2dldDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7cmV0dXJuIGImJmIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsbnVsbH19KSxuLmVhY2goWyJ0YWJJbmRleCIsInJlYWRPbmx5IiwibWF4TGVuZ3RoIiwiY2VsbFNwYWNpbmciLCJjZWxsUGFkZGluZyIsInJvd1NwYW4iLCJjb2xTcGFuIiwidXNlTWFwIiwiZnJhbWVCb3JkZXIiLCJjb250ZW50RWRpdGFibGUiXSxmdW5jdGlvbigpe24ucHJvcEZpeFt0aGlzLnRvTG93ZXJDYXNlKCldPXRoaXN9KTt2YXIgYWM9L1tcdFxyXG5cZl0vZztuLmZuLmV4dGVuZCh7YWRkQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGg9InN0cmluZyI9PXR5cGVvZiBhJiZhLGk9MCxqPXRoaXMubGVuZ3RoO2lmKG4uaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe24odGhpcykuYWRkQ2xhc3MoYS5jYWxsKHRoaXMsYix0aGlzLmNsYXNzTmFtZSkpfSk7aWYoaClmb3IoYj0oYXx8IiIpLm1hdGNoKEUpfHxbXTtqPmk7aSsrKWlmKGM9dGhpc1tpXSxkPTE9PT1jLm5vZGVUeXBlJiYoYy5jbGFzc05hbWU/KCIgIitjLmNsYXNzTmFtZSsiICIpLnJlcGxhY2UoYWMsIiAiKToiICIpKXtmPTA7d2hpbGUoZT1iW2YrK10pZC5pbmRleE9mKCIgIitlKyIgIik8MCYmKGQrPWUrIiAiKTtnPW4udHJpbShkKSxjLmNsYXNzTmFtZSE9PWcmJihjLmNsYXNzTmFtZT1nKX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGg9MD09PWFyZ3VtZW50cy5sZW5ndGh8fCJzdHJpbmciPT10eXBlb2YgYSYmYSxpPTAsaj10aGlzLmxlbmd0aDtpZihuLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihiKXtuKHRoaXMpLnJlbW92ZUNsYXNzKGEuY2FsbCh0aGlzLGIsdGhpcy5jbGFzc05hbWUpKX0pO2lmKGgpZm9yKGI9KGF8fCIiKS5tYXRjaChFKXx8W107aj5pO2krKylpZihjPXRoaXNbaV0sZD0xPT09Yy5ub2RlVHlwZSYmKGMuY2xhc3NOYW1lPygiICIrYy5jbGFzc05hbWUrIiAiKS5yZXBsYWNlKGFjLCIgIik6IiIpKXtmPTA7d2hpbGUoZT1iW2YrK10pd2hpbGUoZC5pbmRleE9mKCIgIitlKyIgIik+PTApZD1kLnJlcGxhY2UoIiAiK2UrIiAiLCIgIik7Zz1hP24udHJpbShkKToiIixjLmNsYXNzTmFtZSE9PWcmJihjLmNsYXNzTmFtZT1nKX1yZXR1cm4gdGhpc30sdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oYSxiKXt2YXIgYz10eXBlb2YgYTtyZXR1cm4iYm9vbGVhbiI9PXR5cGVvZiBiJiYic3RyaW5nIj09PWM/Yj90aGlzLmFkZENsYXNzKGEpOnRoaXMucmVtb3ZlQ2xhc3MoYSk6dGhpcy5lYWNoKG4uaXNGdW5jdGlvbihhKT9mdW5jdGlvbihjKXtuKHRoaXMpLnRvZ2dsZUNsYXNzKGEuY2FsbCh0aGlzLGMsdGhpcy5jbGFzc05hbWUsYiksYil9OmZ1bmN0aW9uKCl7aWYoInN0cmluZyI9PT1jKXt2YXIgYixkPTAsZT1uKHRoaXMpLGY9YS5tYXRjaChFKXx8W107d2hpbGUoYj1mW2QrK10pZS5oYXNDbGFzcyhiKT9lLnJlbW92ZUNsYXNzKGIpOmUuYWRkQ2xhc3MoYil9ZWxzZShjPT09VXx8ImJvb2xlYW4iPT09YykmJih0aGlzLmNsYXNzTmFtZSYmTC5zZXQodGhpcywiX19jbGFzc05hbWVfXyIsdGhpcy5jbGFzc05hbWUpLHRoaXMuY2xhc3NOYW1lPXRoaXMuY2xhc3NOYW1lfHxhPT09ITE/IiI6TC5nZXQodGhpcywiX19jbGFzc05hbWVfXyIpfHwiIil9KX0saGFzQ2xhc3M6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPSIgIithKyIgIixjPTAsZD10aGlzLmxlbmd0aDtkPmM7YysrKWlmKDE9PT10aGlzW2NdLm5vZGVUeXBlJiYoIiAiK3RoaXNbY10uY2xhc3NOYW1lKyIgIikucmVwbGFjZShhYywiICIpLmluZGV4T2YoYik+PTApcmV0dXJuITA7cmV0dXJuITF9fSk7dmFyIGJjPS9cci9nO24uZm4uZXh0ZW5kKHt2YWw6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGU9dGhpc1swXTt7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gZD1uLmlzRnVuY3Rpb24oYSksdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe3ZhciBlOzE9PT10aGlzLm5vZGVUeXBlJiYoZT1kP2EuY2FsbCh0aGlzLGMsbih0aGlzKS52YWwoKSk6YSxudWxsPT1lP2U9IiI6Im51bWJlciI9PXR5cGVvZiBlP2UrPSIiOm4uaXNBcnJheShlKSYmKGU9bi5tYXAoZSxmdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09YT8iIjphKyIifSkpLGI9bi52YWxIb29rc1t0aGlzLnR5cGVdfHxuLnZhbEhvb2tzW3RoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0sYiYmInNldCJpbiBiJiZ2b2lkIDAhPT1iLnNldCh0aGlzLGUsInZhbHVlIil8fCh0aGlzLnZhbHVlPWUpKX0pO2lmKGUpcmV0dXJuIGI9bi52YWxIb29rc1tlLnR5cGVdfHxuLnZhbEhvb2tzW2Uubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0sYiYmImdldCJpbiBiJiZ2b2lkIDAhPT0oYz1iLmdldChlLCJ2YWx1ZSIpKT9jOihjPWUudmFsdWUsInN0cmluZyI9PXR5cGVvZiBjP2MucmVwbGFjZShiYywiIik6bnVsbD09Yz8iIjpjKX19fSksbi5leHRlbmQoe3ZhbEhvb2tzOntvcHRpb246e2dldDpmdW5jdGlvbihhKXt2YXIgYj1uLmZpbmQuYXR0cihhLCJ2YWx1ZSIpO3JldHVybiBudWxsIT1iP2I6bi50cmltKG4udGV4dChhKSl9fSxzZWxlY3Q6e2dldDpmdW5jdGlvbihhKXtmb3IodmFyIGIsYyxkPWEub3B0aW9ucyxlPWEuc2VsZWN0ZWRJbmRleCxmPSJzZWxlY3Qtb25lIj09PWEudHlwZXx8MD5lLGc9Zj9udWxsOltdLGg9Zj9lKzE6ZC5sZW5ndGgsaT0wPmU/aDpmP2U6MDtoPmk7aSsrKWlmKGM9ZFtpXSwhKCFjLnNlbGVjdGVkJiZpIT09ZXx8KGsub3B0RGlzYWJsZWQ/Yy5kaXNhYmxlZDpudWxsIT09Yy5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIikpfHxjLnBhcmVudE5vZGUuZGlzYWJsZWQmJm4ubm9kZU5hbWUoYy5wYXJlbnROb2RlLCJvcHRncm91cCIpKSl7aWYoYj1uKGMpLnZhbCgpLGYpcmV0dXJuIGI7Zy5wdXNoKGIpfXJldHVybiBnfSxzZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGU9YS5vcHRpb25zLGY9bi5tYWtlQXJyYXkoYiksZz1lLmxlbmd0aDt3aGlsZShnLS0pZD1lW2ddLChkLnNlbGVjdGVkPW4uaW5BcnJheShkLnZhbHVlLGYpPj0wKSYmKGM9ITApO3JldHVybiBjfHwoYS5zZWxlY3RlZEluZGV4PS0xKSxmfX19fSksbi5lYWNoKFsicmFkaW8iLCJjaGVja2JveCJdLGZ1bmN0aW9uKCl7bi52YWxIb29rc1t0aGlzXT17c2V0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIG4uaXNBcnJheShiKT9hLmNoZWNrZWQ9bi5pbkFycmF5KG4oYSkudmFsKCksYik+PTA6dm9pZCAwfX0say5jaGVja09ufHwobi52YWxIb29rc1t0aGlzXS5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PT1hLmdldEF0dHJpYnV0ZSgidmFsdWUiKT8ib24iOmEudmFsdWV9KX0pLG4uZWFjaCgiYmx1ciBmb2N1cyBmb2N1c2luIGZvY3Vzb3V0IGxvYWQgcmVzaXplIHNjcm9sbCB1bmxvYWQgY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBlcnJvciBjb250ZXh0bWVudSIuc3BsaXQoIiAiKSxmdW5jdGlvbihhLGIpe24uZm5bYl09ZnVuY3Rpb24oYSxjKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4wP3RoaXMub24oYixudWxsLGEsYyk6dGhpcy50cmlnZ2VyKGIpfX0pLG4uZm4uZXh0ZW5kKHtob3ZlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLm1vdXNlZW50ZXIoYSkubW91c2VsZWF2ZShifHxhKX0sYmluZDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIHRoaXMub24oYSxudWxsLGIsYyl9LHVuYmluZDpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLm9mZihhLG51bGwsYil9LGRlbGVnYXRlOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLm9uKGIsYSxjLGQpfSx1bmRlbGVnYXRlOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vZmYoYSwiKioiKTp0aGlzLm9mZihiLGF8fCIqKiIsYyl9fSk7dmFyIGNjPW4ubm93KCksZGM9L1w/LztuLnBhcnNlSlNPTj1mdW5jdGlvbihhKXtyZXR1cm4gSlNPTi5wYXJzZShhKyIiKX0sbi5wYXJzZVhNTD1mdW5jdGlvbihhKXt2YXIgYixjO2lmKCFhfHwic3RyaW5nIiE9dHlwZW9mIGEpcmV0dXJuIG51bGw7dHJ5e2M9bmV3IERPTVBhcnNlcixiPWMucGFyc2VGcm9tU3RyaW5nKGEsInRleHQveG1sIil9Y2F0Y2goZCl7Yj12b2lkIDB9cmV0dXJuKCFifHxiLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwYXJzZXJlcnJvciIpLmxlbmd0aCkmJm4uZXJyb3IoIkludmFsaWQgWE1MOiAiK2EpLGJ9O3ZhciBlYz0vIy4qJC8sZmM9LyhbPyZdKV89W14mXSovLGdjPS9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKSQvZ20saGM9L14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8saWM9L14oPzpHRVR8SEVBRCkkLyxqYz0vXlwvXC8vLGtjPS9eKFtcdy4rLV0rOikoPzpcL1wvKD86W15cLz8jXSpAfCkoW15cLz8jOl0qKSg/OjooXGQrKXwpfCkvLGxjPXt9LG1jPXt9LG5jPSIqLyIuY29uY2F0KCIqIiksb2M9YS5sb2NhdGlvbi5ocmVmLHBjPWtjLmV4ZWMob2MudG9Mb3dlckNhc2UoKSl8fFtdO2Z1bmN0aW9uIHFjKGEpe3JldHVybiBmdW5jdGlvbihiLGMpeyJzdHJpbmciIT10eXBlb2YgYiYmKGM9YixiPSIqIik7dmFyIGQsZT0wLGY9Yi50b0xvd2VyQ2FzZSgpLm1hdGNoKEUpfHxbXTtpZihuLmlzRnVuY3Rpb24oYykpd2hpbGUoZD1mW2UrK10pIisiPT09ZFswXT8oZD1kLnNsaWNlKDEpfHwiKiIsKGFbZF09YVtkXXx8W10pLnVuc2hpZnQoYykpOihhW2RdPWFbZF18fFtdKS5wdXNoKGMpfX1mdW5jdGlvbiByYyhhLGIsYyxkKXt2YXIgZT17fSxmPWE9PT1tYztmdW5jdGlvbiBnKGgpe3ZhciBpO3JldHVybiBlW2hdPSEwLG4uZWFjaChhW2hdfHxbXSxmdW5jdGlvbihhLGgpe3ZhciBqPWgoYixjLGQpO3JldHVybiJzdHJpbmciIT10eXBlb2Yganx8Znx8ZVtqXT9mPyEoaT1qKTp2b2lkIDA6KGIuZGF0YVR5cGVzLnVuc2hpZnQoaiksZyhqKSwhMSl9KSxpfXJldHVybiBnKGIuZGF0YVR5cGVzWzBdKXx8IWVbIioiXSYmZygiKiIpfWZ1bmN0aW9uIHNjKGEsYil7dmFyIGMsZCxlPW4uYWpheFNldHRpbmdzLmZsYXRPcHRpb25zfHx7fTtmb3IoYyBpbiBiKXZvaWQgMCE9PWJbY10mJigoZVtjXT9hOmR8fChkPXt9KSlbY109YltjXSk7cmV0dXJuIGQmJm4uZXh0ZW5kKCEwLGEsZCksYX1mdW5jdGlvbiB0YyhhLGIsYyl7dmFyIGQsZSxmLGcsaD1hLmNvbnRlbnRzLGk9YS5kYXRhVHlwZXM7d2hpbGUoIioiPT09aVswXSlpLnNoaWZ0KCksdm9pZCAwPT09ZCYmKGQ9YS5taW1lVHlwZXx8Yi5nZXRSZXNwb25zZUhlYWRlcigiQ29udGVudC1UeXBlIikpO2lmKGQpZm9yKGUgaW4gaClpZihoW2VdJiZoW2VdLnRlc3QoZCkpe2kudW5zaGlmdChlKTticmVha31pZihpWzBdaW4gYylmPWlbMF07ZWxzZXtmb3IoZSBpbiBjKXtpZighaVswXXx8YS5jb252ZXJ0ZXJzW2UrIiAiK2lbMF1dKXtmPWU7YnJlYWt9Z3x8KGc9ZSl9Zj1mfHxnfXJldHVybiBmPyhmIT09aVswXSYmaS51bnNoaWZ0KGYpLGNbZl0pOnZvaWQgMH1mdW5jdGlvbiB1YyhhLGIsYyxkKXt2YXIgZSxmLGcsaCxpLGo9e30saz1hLmRhdGFUeXBlcy5zbGljZSgpO2lmKGtbMV0pZm9yKGcgaW4gYS5jb252ZXJ0ZXJzKWpbZy50b0xvd2VyQ2FzZSgpXT1hLmNvbnZlcnRlcnNbZ107Zj1rLnNoaWZ0KCk7d2hpbGUoZilpZihhLnJlc3BvbnNlRmllbGRzW2ZdJiYoY1thLnJlc3BvbnNlRmllbGRzW2ZdXT1iKSwhaSYmZCYmYS5kYXRhRmlsdGVyJiYoYj1hLmRhdGFGaWx0ZXIoYixhLmRhdGFUeXBlKSksaT1mLGY9ay5zaGlmdCgpKWlmKCIqIj09PWYpZj1pO2Vsc2UgaWYoIioiIT09aSYmaSE9PWYpe2lmKGc9altpKyIgIitmXXx8alsiKiAiK2ZdLCFnKWZvcihlIGluIGopaWYoaD1lLnNwbGl0KCIgIiksaFsxXT09PWYmJihnPWpbaSsiICIraFswXV18fGpbIiogIitoWzBdXSkpe2c9PT0hMD9nPWpbZV06altlXSE9PSEwJiYoZj1oWzBdLGsudW5zaGlmdChoWzFdKSk7YnJlYWt9aWYoZyE9PSEwKWlmKGcmJmFbInRocm93cyJdKWI9ZyhiKTtlbHNlIHRyeXtiPWcoYil9Y2F0Y2gobCl7cmV0dXJue3N0YXRlOiJwYXJzZXJlcnJvciIsZXJyb3I6Zz9sOiJObyBjb252ZXJzaW9uIGZyb20gIitpKyIgdG8gIitmfX19cmV0dXJue3N0YXRlOiJzdWNjZXNzIixkYXRhOmJ9fW4uZXh0ZW5kKHthY3RpdmU6MCxsYXN0TW9kaWZpZWQ6e30sZXRhZzp7fSxhamF4U2V0dGluZ3M6e3VybDpvYyx0eXBlOiJHRVQiLGlzTG9jYWw6aGMudGVzdChwY1sxXSksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLGFjY2VwdHM6eyIqIjpuYyx0ZXh0OiJ0ZXh0L3BsYWluIixodG1sOiJ0ZXh0L2h0bWwiLHhtbDoiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0In0sY29udGVudHM6e3htbDoveG1sLyxodG1sOi9odG1sLyxqc29uOi9qc29uL30scmVzcG9uc2VGaWVsZHM6e3htbDoicmVzcG9uc2VYTUwiLHRleHQ6InJlc3BvbnNlVGV4dCIsanNvbjoicmVzcG9uc2VKU09OIn0sY29udmVydGVyczp7IiogdGV4dCI6U3RyaW5nLCJ0ZXh0IGh0bWwiOiEwLCJ0ZXh0IGpzb24iOm4ucGFyc2VKU09OLCJ0ZXh0IHhtbCI6bi5wYXJzZVhNTH0sZmxhdE9wdGlvbnM6e3VybDohMCxjb250ZXh0OiEwfX0sYWpheFNldHVwOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGI/c2Moc2MoYSxuLmFqYXhTZXR0aW5ncyksYik6c2Mobi5hamF4U2V0dGluZ3MsYSl9LGFqYXhQcmVmaWx0ZXI6cWMobGMpLGFqYXhUcmFuc3BvcnQ6cWMobWMpLGFqYXg6ZnVuY3Rpb24oYSxiKXsib2JqZWN0Ij09dHlwZW9mIGEmJihiPWEsYT12b2lkIDApLGI9Ynx8e307dmFyIGMsZCxlLGYsZyxoLGksaixrPW4uYWpheFNldHVwKHt9LGIpLGw9ay5jb250ZXh0fHxrLG09ay5jb250ZXh0JiYobC5ub2RlVHlwZXx8bC5qcXVlcnkpP24obCk6bi5ldmVudCxvPW4uRGVmZXJyZWQoKSxwPW4uQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHE9ay5zdGF0dXNDb2RlfHx7fSxyPXt9LHM9e30sdD0wLHU9ImNhbmNlbGVkIix2PXtyZWFkeVN0YXRlOjAsZ2V0UmVzcG9uc2VIZWFkZXI6ZnVuY3Rpb24oYSl7dmFyIGI7aWYoMj09PXQpe2lmKCFmKXtmPXt9O3doaWxlKGI9Z2MuZXhlYyhlKSlmW2JbMV0udG9Mb3dlckNhc2UoKV09YlsyXX1iPWZbYS50b0xvd2VyQ2FzZSgpXX1yZXR1cm4gbnVsbD09Yj9udWxsOmJ9LGdldEFsbFJlc3BvbnNlSGVhZGVyczpmdW5jdGlvbigpe3JldHVybiAyPT09dD9lOm51bGx9LHNldFJlcXVlc3RIZWFkZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLnRvTG93ZXJDYXNlKCk7cmV0dXJuIHR8fChhPXNbY109c1tjXXx8YSxyW2FdPWIpLHRoaXN9LG92ZXJyaWRlTWltZVR5cGU6ZnVuY3Rpb24oYSl7cmV0dXJuIHR8fChrLm1pbWVUeXBlPWEpLHRoaXN9LHN0YXR1c0NvZGU6ZnVuY3Rpb24oYSl7dmFyIGI7aWYoYSlpZigyPnQpZm9yKGIgaW4gYSlxW2JdPVtxW2JdLGFbYl1dO2Vsc2Ugdi5hbHdheXMoYVt2LnN0YXR1c10pO3JldHVybiB0aGlzfSxhYm9ydDpmdW5jdGlvbihhKXt2YXIgYj1hfHx1O3JldHVybiBjJiZjLmFib3J0KGIpLHgoMCxiKSx0aGlzfX07aWYoby5wcm9taXNlKHYpLmNvbXBsZXRlPXAuYWRkLHYuc3VjY2Vzcz12LmRvbmUsdi5lcnJvcj12LmZhaWwsay51cmw9KChhfHxrLnVybHx8b2MpKyIiKS5yZXBsYWNlKGVjLCIiKS5yZXBsYWNlKGpjLHBjWzFdKyIvLyIpLGsudHlwZT1iLm1ldGhvZHx8Yi50eXBlfHxrLm1ldGhvZHx8ay50eXBlLGsuZGF0YVR5cGVzPW4udHJpbShrLmRhdGFUeXBlfHwiKiIpLnRvTG93ZXJDYXNlKCkubWF0Y2goRSl8fFsiIl0sbnVsbD09ay5jcm9zc0RvbWFpbiYmKGg9a2MuZXhlYyhrLnVybC50b0xvd2VyQ2FzZSgpKSxrLmNyb3NzRG9tYWluPSEoIWh8fGhbMV09PT1wY1sxXSYmaFsyXT09PXBjWzJdJiYoaFszXXx8KCJodHRwOiI9PT1oWzFdPyI4MCI6IjQ0MyIpKT09PShwY1szXXx8KCJodHRwOiI9PT1wY1sxXT8iODAiOiI0NDMiKSkpKSxrLmRhdGEmJmsucHJvY2Vzc0RhdGEmJiJzdHJpbmciIT10eXBlb2Ygay5kYXRhJiYoay5kYXRhPW4ucGFyYW0oay5kYXRhLGsudHJhZGl0aW9uYWwpKSxyYyhsYyxrLGIsdiksMj09PXQpcmV0dXJuIHY7aT1uLmV2ZW50JiZrLmdsb2JhbCxpJiYwPT09bi5hY3RpdmUrKyYmbi5ldmVudC50cmlnZ2VyKCJhamF4U3RhcnQiKSxrLnR5cGU9ay50eXBlLnRvVXBwZXJDYXNlKCksay5oYXNDb250ZW50PSFpYy50ZXN0KGsudHlwZSksZD1rLnVybCxrLmhhc0NvbnRlbnR8fChrLmRhdGEmJihkPWsudXJsKz0oZGMudGVzdChkKT8iJiI6Ij8iKStrLmRhdGEsZGVsZXRlIGsuZGF0YSksay5jYWNoZT09PSExJiYoay51cmw9ZmMudGVzdChkKT9kLnJlcGxhY2UoZmMsIiQxXz0iK2NjKyspOmQrKGRjLnRlc3QoZCk/IiYiOiI/IikrIl89IitjYysrKSksay5pZk1vZGlmaWVkJiYobi5sYXN0TW9kaWZpZWRbZF0mJnYuc2V0UmVxdWVzdEhlYWRlcigiSWYtTW9kaWZpZWQtU2luY2UiLG4ubGFzdE1vZGlmaWVkW2RdKSxuLmV0YWdbZF0mJnYuc2V0UmVxdWVzdEhlYWRlcigiSWYtTm9uZS1NYXRjaCIsbi5ldGFnW2RdKSksKGsuZGF0YSYmay5oYXNDb250ZW50JiZrLmNvbnRlbnRUeXBlIT09ITF8fGIuY29udGVudFR5cGUpJiZ2LnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsay5jb250ZW50VHlwZSksdi5zZXRSZXF1ZXN0SGVhZGVyKCJBY2NlcHQiLGsuZGF0YVR5cGVzWzBdJiZrLmFjY2VwdHNbay5kYXRhVHlwZXNbMF1dP2suYWNjZXB0c1trLmRhdGFUeXBlc1swXV0rKCIqIiE9PWsuZGF0YVR5cGVzWzBdPyIsICIrbmMrIjsgcT0wLjAxIjoiIik6ay5hY2NlcHRzWyIqIl0pO2ZvcihqIGluIGsuaGVhZGVycyl2LnNldFJlcXVlc3RIZWFkZXIoaixrLmhlYWRlcnNbal0pO2lmKGsuYmVmb3JlU2VuZCYmKGsuYmVmb3JlU2VuZC5jYWxsKGwsdixrKT09PSExfHwyPT09dCkpcmV0dXJuIHYuYWJvcnQoKTt1PSJhYm9ydCI7Zm9yKGogaW57c3VjY2VzczoxLGVycm9yOjEsY29tcGxldGU6MX0pdltqXShrW2pdKTtpZihjPXJjKG1jLGssYix2KSl7di5yZWFkeVN0YXRlPTEsaSYmbS50cmlnZ2VyKCJhamF4U2VuZCIsW3Ysa10pLGsuYXN5bmMmJmsudGltZW91dD4wJiYoZz1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7di5hYm9ydCgidGltZW91dCIpfSxrLnRpbWVvdXQpKTt0cnl7dD0xLGMuc2VuZChyLHgpfWNhdGNoKHcpe2lmKCEoMj50KSl0aHJvdyB3O3goLTEsdyl9fWVsc2UgeCgtMSwiTm8gVHJhbnNwb3J0Iik7ZnVuY3Rpb24geChhLGIsZixoKXt2YXIgaixyLHMsdSx3LHg9YjsyIT09dCYmKHQ9MixnJiZjbGVhclRpbWVvdXQoZyksYz12b2lkIDAsZT1ofHwiIix2LnJlYWR5U3RhdGU9YT4wPzQ6MCxqPWE+PTIwMCYmMzAwPmF8fDMwND09PWEsZiYmKHU9dGMoayx2LGYpKSx1PXVjKGssdSx2LGopLGo/KGsuaWZNb2RpZmllZCYmKHc9di5nZXRSZXNwb25zZUhlYWRlcigiTGFzdC1Nb2RpZmllZCIpLHcmJihuLmxhc3RNb2RpZmllZFtkXT13KSx3PXYuZ2V0UmVzcG9uc2VIZWFkZXIoImV0YWciKSx3JiYobi5ldGFnW2RdPXcpKSwyMDQ9PT1hfHwiSEVBRCI9PT1rLnR5cGU/eD0ibm9jb250ZW50IjozMDQ9PT1hP3g9Im5vdG1vZGlmaWVkIjooeD11LnN0YXRlLHI9dS5kYXRhLHM9dS5lcnJvcixqPSFzKSk6KHM9eCwoYXx8IXgpJiYoeD0iZXJyb3IiLDA+YSYmKGE9MCkpKSx2LnN0YXR1cz1hLHYuc3RhdHVzVGV4dD0oYnx8eCkrIiIsaj9vLnJlc29sdmVXaXRoKGwsW3IseCx2XSk6by5yZWplY3RXaXRoKGwsW3YseCxzXSksdi5zdGF0dXNDb2RlKHEpLHE9dm9pZCAwLGkmJm0udHJpZ2dlcihqPyJhamF4U3VjY2VzcyI6ImFqYXhFcnJvciIsW3YsayxqP3I6c10pLHAuZmlyZVdpdGgobCxbdix4XSksaSYmKG0udHJpZ2dlcigiYWpheENvbXBsZXRlIixbdixrXSksLS1uLmFjdGl2ZXx8bi5ldmVudC50cmlnZ2VyKCJhamF4U3RvcCIpKSl9cmV0dXJuIHZ9LGdldEpTT046ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuLmdldChhLGIsYywianNvbiIpfSxnZXRTY3JpcHQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbi5nZXQoYSx2b2lkIDAsYiwic2NyaXB0Iil9fSksbi5lYWNoKFsiZ2V0IiwicG9zdCJdLGZ1bmN0aW9uKGEsYil7bltiXT1mdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gbi5pc0Z1bmN0aW9uKGMpJiYoZT1lfHxkLGQ9YyxjPXZvaWQgMCksbi5hamF4KHt1cmw6YSx0eXBlOmIsZGF0YVR5cGU6ZSxkYXRhOmMsc3VjY2VzczpkfSl9fSksbi5fZXZhbFVybD1mdW5jdGlvbihhKXtyZXR1cm4gbi5hamF4KHt1cmw6YSx0eXBlOiJHRVQiLGRhdGFUeXBlOiJzY3JpcHQiLGFzeW5jOiExLGdsb2JhbDohMSwidGhyb3dzIjohMH0pfSxuLmZuLmV4dGVuZCh7d3JhcEFsbDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4gbi5pc0Z1bmN0aW9uKGEpP3RoaXMuZWFjaChmdW5jdGlvbihiKXtuKHRoaXMpLndyYXBBbGwoYS5jYWxsKHRoaXMsYikpfSk6KHRoaXNbMF0mJihiPW4oYSx0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKCEwKSx0aGlzWzBdLnBhcmVudE5vZGUmJmIuaW5zZXJ0QmVmb3JlKHRoaXNbMF0pLGIubWFwKGZ1bmN0aW9uKCl7dmFyIGE9dGhpczt3aGlsZShhLmZpcnN0RWxlbWVudENoaWxkKWE9YS5maXJzdEVsZW1lbnRDaGlsZDtyZXR1cm4gYX0pLmFwcGVuZCh0aGlzKSksdGhpcyl9LHdyYXBJbm5lcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKG4uaXNGdW5jdGlvbihhKT9mdW5jdGlvbihiKXtuKHRoaXMpLndyYXBJbm5lcihhLmNhbGwodGhpcyxiKSl9OmZ1bmN0aW9uKCl7dmFyIGI9bih0aGlzKSxjPWIuY29udGVudHMoKTtjLmxlbmd0aD9jLndyYXBBbGwoYSk6Yi5hcHBlbmQoYSl9KX0sd3JhcDpmdW5jdGlvbihhKXt2YXIgYj1uLmlzRnVuY3Rpb24oYSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihjKXtuKHRoaXMpLndyYXBBbGwoYj9hLmNhbGwodGhpcyxjKTphKX0pfSx1bndyYXA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQoKS5lYWNoKGZ1bmN0aW9uKCl7bi5ub2RlTmFtZSh0aGlzLCJib2R5Iil8fG4odGhpcykucmVwbGFjZVdpdGgodGhpcy5jaGlsZE5vZGVzKX0pLmVuZCgpfX0pLG4uZXhwci5maWx0ZXJzLmhpZGRlbj1mdW5jdGlvbihhKXtyZXR1cm4gYS5vZmZzZXRXaWR0aDw9MCYmYS5vZmZzZXRIZWlnaHQ8PTB9LG4uZXhwci5maWx0ZXJzLnZpc2libGU9ZnVuY3Rpb24oYSl7cmV0dXJuIW4uZXhwci5maWx0ZXJzLmhpZGRlbihhKX07dmFyIHZjPS8lMjAvZyx3Yz0vXFtcXSQvLHhjPS9ccj9cbi9nLHljPS9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSx6Yz0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxrZXlnZW4pL2k7ZnVuY3Rpb24gQWMoYSxiLGMsZCl7dmFyIGU7aWYobi5pc0FycmF5KGIpKW4uZWFjaChiLGZ1bmN0aW9uKGIsZSl7Y3x8d2MudGVzdChhKT9kKGEsZSk6QWMoYSsiWyIrKCJvYmplY3QiPT10eXBlb2YgZT9iOiIiKSsiXSIsZSxjLGQpfSk7ZWxzZSBpZihjfHwib2JqZWN0IiE9PW4udHlwZShiKSlkKGEsYik7ZWxzZSBmb3IoZSBpbiBiKUFjKGErIlsiK2UrIl0iLGJbZV0sYyxkKX1uLnBhcmFtPWZ1bmN0aW9uKGEsYil7dmFyIGMsZD1bXSxlPWZ1bmN0aW9uKGEsYil7Yj1uLmlzRnVuY3Rpb24oYik/YigpOm51bGw9PWI/IiI6YixkW2QubGVuZ3RoXT1lbmNvZGVVUklDb21wb25lbnQoYSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudChiKX07aWYodm9pZCAwPT09YiYmKGI9bi5hamF4U2V0dGluZ3MmJm4uYWpheFNldHRpbmdzLnRyYWRpdGlvbmFsKSxuLmlzQXJyYXkoYSl8fGEuanF1ZXJ5JiYhbi5pc1BsYWluT2JqZWN0KGEpKW4uZWFjaChhLGZ1bmN0aW9uKCl7ZSh0aGlzLm5hbWUsdGhpcy52YWx1ZSl9KTtlbHNlIGZvcihjIGluIGEpQWMoYyxhW2NdLGIsZSk7cmV0dXJuIGQuam9pbigiJiIpLnJlcGxhY2UodmMsIisiKX0sbi5mbi5leHRlbmQoe3NlcmlhbGl6ZTpmdW5jdGlvbigpe3JldHVybiBuLnBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSl9LHNlcmlhbGl6ZUFycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGE9bi5wcm9wKHRoaXMsImVsZW1lbnRzIik7cmV0dXJuIGE/bi5tYWtlQXJyYXkoYSk6dGhpc30pLmZpbHRlcihmdW5jdGlvbigpe3ZhciBhPXRoaXMudHlwZTtyZXR1cm4gdGhpcy5uYW1lJiYhbih0aGlzKS5pcygiOmRpc2FibGVkIikmJnpjLnRlc3QodGhpcy5ub2RlTmFtZSkmJiF5Yy50ZXN0KGEpJiYodGhpcy5jaGVja2VkfHwhVC50ZXN0KGEpKX0pLm1hcChmdW5jdGlvbihhLGIpe3ZhciBjPW4odGhpcykudmFsKCk7cmV0dXJuIG51bGw9PWM/bnVsbDpuLmlzQXJyYXkoYyk/bi5tYXAoYyxmdW5jdGlvbihhKXtyZXR1cm57bmFtZTpiLm5hbWUsdmFsdWU6YS5yZXBsYWNlKHhjLCJcclxuIil9fSk6e25hbWU6Yi5uYW1lLHZhbHVlOmMucmVwbGFjZSh4YywiXHJcbiIpfX0pLmdldCgpfX0pLG4uYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0fWNhdGNoKGEpe319O3ZhciBCYz0wLENjPXt9LERjPXswOjIwMCwxMjIzOjIwNH0sRWM9bi5hamF4U2V0dGluZ3MueGhyKCk7YS5hdHRhY2hFdmVudCYmYS5hdHRhY2hFdmVudCgib251bmxvYWQiLGZ1bmN0aW9uKCl7Zm9yKHZhciBhIGluIENjKUNjW2FdKCl9KSxrLmNvcnM9ISFFYyYmIndpdGhDcmVkZW50aWFscyJpbiBFYyxrLmFqYXg9RWM9ISFFYyxuLmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24oYSl7dmFyIGI7cmV0dXJuIGsuY29yc3x8RWMmJiFhLmNyb3NzRG9tYWluP3tzZW5kOmZ1bmN0aW9uKGMsZCl7dmFyIGUsZj1hLnhocigpLGc9KytCYztpZihmLm9wZW4oYS50eXBlLGEudXJsLGEuYXN5bmMsYS51c2VybmFtZSxhLnBhc3N3b3JkKSxhLnhockZpZWxkcylmb3IoZSBpbiBhLnhockZpZWxkcylmW2VdPWEueGhyRmllbGRzW2VdO2EubWltZVR5cGUmJmYub3ZlcnJpZGVNaW1lVHlwZSYmZi5vdmVycmlkZU1pbWVUeXBlKGEubWltZVR5cGUpLGEuY3Jvc3NEb21haW58fGNbIlgtUmVxdWVzdGVkLVdpdGgiXXx8KGNbIlgtUmVxdWVzdGVkLVdpdGgiXT0iWE1MSHR0cFJlcXVlc3QiKTtmb3IoZSBpbiBjKWYuc2V0UmVxdWVzdEhlYWRlcihlLGNbZV0pO2I9ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKCl7YiYmKGRlbGV0ZSBDY1tnXSxiPWYub25sb2FkPWYub25lcnJvcj1udWxsLCJhYm9ydCI9PT1hP2YuYWJvcnQoKToiZXJyb3IiPT09YT9kKGYuc3RhdHVzLGYuc3RhdHVzVGV4dCk6ZChEY1tmLnN0YXR1c118fGYuc3RhdHVzLGYuc3RhdHVzVGV4dCwic3RyaW5nIj09dHlwZW9mIGYucmVzcG9uc2VUZXh0P3t0ZXh0OmYucmVzcG9uc2VUZXh0fTp2b2lkIDAsZi5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpfX0sZi5vbmxvYWQ9YigpLGYub25lcnJvcj1iKCJlcnJvciIpLGI9Q2NbZ109YigiYWJvcnQiKTt0cnl7Zi5zZW5kKGEuaGFzQ29udGVudCYmYS5kYXRhfHxudWxsKX1jYXRjaChoKXtpZihiKXRocm93IGh9fSxhYm9ydDpmdW5jdGlvbigpe2ImJmIoKX19OnZvaWQgMH0pLG4uYWpheFNldHVwKHthY2NlcHRzOntzY3JpcHQ6InRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCwgYXBwbGljYXRpb24vZWNtYXNjcmlwdCwgYXBwbGljYXRpb24veC1lY21hc2NyaXB0In0sY29udGVudHM6e3NjcmlwdDovKD86amF2YXxlY21hKXNjcmlwdC99LGNvbnZlcnRlcnM6eyJ0ZXh0IHNjcmlwdCI6ZnVuY3Rpb24oYSl7cmV0dXJuIG4uZ2xvYmFsRXZhbChhKSxhfX19KSxuLmFqYXhQcmVmaWx0ZXIoInNjcmlwdCIsZnVuY3Rpb24oYSl7dm9pZCAwPT09YS5jYWNoZSYmKGEuY2FjaGU9ITEpLGEuY3Jvc3NEb21haW4mJihhLnR5cGU9IkdFVCIpfSksbi5hamF4VHJhbnNwb3J0KCJzY3JpcHQiLGZ1bmN0aW9uKGEpe2lmKGEuY3Jvc3NEb21haW4pe3ZhciBiLGM7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oZCxlKXtiPW4oIjxzY3JpcHQ+IikucHJvcCh7YXN5bmM6ITAsY2hhcnNldDphLnNjcmlwdENoYXJzZXQsc3JjOmEudXJsfSkub24oImxvYWQgZXJyb3IiLGM9ZnVuY3Rpb24oYSl7Yi5yZW1vdmUoKSxjPW51bGwsYSYmZSgiZXJyb3IiPT09YS50eXBlPzQwNDoyMDAsYS50eXBlKX0pLGwuaGVhZC5hcHBlbmRDaGlsZChiWzBdKX0sYWJvcnQ6ZnVuY3Rpb24oKXtjJiZjKCl9fX19KTt2YXIgRmM9W10sR2M9Lyg9KVw/KD89JnwkKXxcP1w/LztuLmFqYXhTZXR1cCh7anNvbnA6ImNhbGxiYWNrIixqc29ucENhbGxiYWNrOmZ1bmN0aW9uKCl7dmFyIGE9RmMucG9wKCl8fG4uZXhwYW5kbysiXyIrY2MrKztyZXR1cm4gdGhpc1thXT0hMCxhfX0pLG4uYWpheFByZWZpbHRlcigianNvbiBqc29ucCIsZnVuY3Rpb24oYixjLGQpe3ZhciBlLGYsZyxoPWIuanNvbnAhPT0hMSYmKEdjLnRlc3QoYi51cmwpPyJ1cmwiOiJzdHJpbmciPT10eXBlb2YgYi5kYXRhJiYhKGIuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmR2MudGVzdChiLmRhdGEpJiYiZGF0YSIpO3JldHVybiBofHwianNvbnAiPT09Yi5kYXRhVHlwZXNbMF0/KGU9Yi5qc29ucENhbGxiYWNrPW4uaXNGdW5jdGlvbihiLmpzb25wQ2FsbGJhY2spP2IuanNvbnBDYWxsYmFjaygpOmIuanNvbnBDYWxsYmFjayxoP2JbaF09YltoXS5yZXBsYWNlKEdjLCIkMSIrZSk6Yi5qc29ucCE9PSExJiYoYi51cmwrPShkYy50ZXN0KGIudXJsKT8iJiI6Ij8iKStiLmpzb25wKyI9IitlKSxiLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl09ZnVuY3Rpb24oKXtyZXR1cm4gZ3x8bi5lcnJvcihlKyIgd2FzIG5vdCBjYWxsZWQiKSxnWzBdfSxiLmRhdGFUeXBlc1swXT0ianNvbiIsZj1hW2VdLGFbZV09ZnVuY3Rpb24oKXtnPWFyZ3VtZW50c30sZC5hbHdheXMoZnVuY3Rpb24oKXthW2VdPWYsYltlXSYmKGIuanNvbnBDYWxsYmFjaz1jLmpzb25wQ2FsbGJhY2ssRmMucHVzaChlKSksZyYmbi5pc0Z1bmN0aW9uKGYpJiZmKGdbMF0pLGc9Zj12b2lkIDB9KSwic2NyaXB0Iik6dm9pZCAwfSksbi5wYXJzZUhUTUw9ZnVuY3Rpb24oYSxiLGMpe2lmKCFhfHwic3RyaW5nIiE9dHlwZW9mIGEpcmV0dXJuIG51bGw7ImJvb2xlYW4iPT10eXBlb2YgYiYmKGM9YixiPSExKSxiPWJ8fGw7dmFyIGQ9di5leGVjKGEpLGU9IWMmJltdO3JldHVybiBkP1tiLmNyZWF0ZUVsZW1lbnQoZFsxXSldOihkPW4uYnVpbGRGcmFnbWVudChbYV0sYixlKSxlJiZlLmxlbmd0aCYmbihlKS5yZW1vdmUoKSxuLm1lcmdlKFtdLGQuY2hpbGROb2RlcykpfTt2YXIgSGM9bi5mbi5sb2FkO24uZm4ubG9hZD1mdW5jdGlvbihhLGIsYyl7aWYoInN0cmluZyIhPXR5cGVvZiBhJiZIYylyZXR1cm4gSGMuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBkLGUsZixnPXRoaXMsaD1hLmluZGV4T2YoIiAiKTtyZXR1cm4gaD49MCYmKGQ9bi50cmltKGEuc2xpY2UoaCkpLGE9YS5zbGljZSgwLGgpKSxuLmlzRnVuY3Rpb24oYik/KGM9YixiPXZvaWQgMCk6YiYmIm9iamVjdCI9PXR5cGVvZiBiJiYoZT0iUE9TVCIpLGcubGVuZ3RoPjAmJm4uYWpheCh7dXJsOmEsdHlwZTplLGRhdGFUeXBlOiJodG1sIixkYXRhOmJ9KS5kb25lKGZ1bmN0aW9uKGEpe2Y9YXJndW1lbnRzLGcuaHRtbChkP24oIjxkaXY+IikuYXBwZW5kKG4ucGFyc2VIVE1MKGEpKS5maW5kKGQpOmEpfSkuY29tcGxldGUoYyYmZnVuY3Rpb24oYSxiKXtnLmVhY2goYyxmfHxbYS5yZXNwb25zZVRleHQsYixhXSl9KSx0aGlzfSxuLmVhY2goWyJhamF4U3RhcnQiLCJhamF4U3RvcCIsImFqYXhDb21wbGV0ZSIsImFqYXhFcnJvciIsImFqYXhTdWNjZXNzIiwiYWpheFNlbmQiXSxmdW5jdGlvbihhLGIpe24uZm5bYl09ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMub24oYixhKX19KSxuLmV4cHIuZmlsdGVycy5hbmltYXRlZD1mdW5jdGlvbihhKXtyZXR1cm4gbi5ncmVwKG4udGltZXJzLGZ1bmN0aW9uKGIpe3JldHVybiBhPT09Yi5lbGVtfSkubGVuZ3RofTt2YXIgSWM9YS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7ZnVuY3Rpb24gSmMoYSl7cmV0dXJuIG4uaXNXaW5kb3coYSk/YTo5PT09YS5ub2RlVHlwZSYmYS5kZWZhdWx0Vmlld31uLm9mZnNldD17c2V0T2Zmc2V0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGYsZyxoLGksaixrPW4uY3NzKGEsInBvc2l0aW9uIiksbD1uKGEpLG09e307InN0YXRpYyI9PT1rJiYoYS5zdHlsZS5wb3NpdGlvbj0icmVsYXRpdmUiKSxoPWwub2Zmc2V0KCksZj1uLmNzcyhhLCJ0b3AiKSxpPW4uY3NzKGEsImxlZnQiKSxqPSgiYWJzb2x1dGUiPT09a3x8ImZpeGVkIj09PWspJiYoZitpKS5pbmRleE9mKCJhdXRvIik+LTEsaj8oZD1sLnBvc2l0aW9uKCksZz1kLnRvcCxlPWQubGVmdCk6KGc9cGFyc2VGbG9hdChmKXx8MCxlPXBhcnNlRmxvYXQoaSl8fDApLG4uaXNGdW5jdGlvbihiKSYmKGI9Yi5jYWxsKGEsYyxoKSksbnVsbCE9Yi50b3AmJihtLnRvcD1iLnRvcC1oLnRvcCtnKSxudWxsIT1iLmxlZnQmJihtLmxlZnQ9Yi5sZWZ0LWgubGVmdCtlKSwidXNpbmciaW4gYj9iLnVzaW5nLmNhbGwoYSxtKTpsLmNzcyhtKX19LG4uZm4uZXh0ZW5kKHtvZmZzZXQ6ZnVuY3Rpb24oYSl7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdm9pZCAwPT09YT90aGlzOnRoaXMuZWFjaChmdW5jdGlvbihiKXtuLm9mZnNldC5zZXRPZmZzZXQodGhpcyxhLGIpfSk7dmFyIGIsYyxkPXRoaXNbMF0sZT17dG9wOjAsbGVmdDowfSxmPWQmJmQub3duZXJEb2N1bWVudDtpZihmKXJldHVybiBiPWYuZG9jdW1lbnRFbGVtZW50LG4uY29udGFpbnMoYixkKT8odHlwZW9mIGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0IT09VSYmKGU9ZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSksYz1KYyhmKSx7dG9wOmUudG9wK2MucGFnZVlPZmZzZXQtYi5jbGllbnRUb3AsbGVmdDplLmxlZnQrYy5wYWdlWE9mZnNldC1iLmNsaWVudExlZnR9KTplfSxwb3NpdGlvbjpmdW5jdGlvbigpe2lmKHRoaXNbMF0pe3ZhciBhLGIsYz10aGlzWzBdLGQ9e3RvcDowLGxlZnQ6MH07cmV0dXJuImZpeGVkIj09PW4uY3NzKGMsInBvc2l0aW9uIik/Yj1jLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOihhPXRoaXMub2Zmc2V0UGFyZW50KCksYj10aGlzLm9mZnNldCgpLG4ubm9kZU5hbWUoYVswXSwiaHRtbCIpfHwoZD1hLm9mZnNldCgpKSxkLnRvcCs9bi5jc3MoYVswXSwiYm9yZGVyVG9wV2lkdGgiLCEwKSxkLmxlZnQrPW4uY3NzKGFbMF0sImJvcmRlckxlZnRXaWR0aCIsITApKSx7dG9wOmIudG9wLWQudG9wLW4uY3NzKGMsIm1hcmdpblRvcCIsITApLGxlZnQ6Yi5sZWZ0LWQubGVmdC1uLmNzcyhjLCJtYXJnaW5MZWZ0IiwhMCl9fX0sb2Zmc2V0UGFyZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vZmZzZXRQYXJlbnR8fEljO3doaWxlKGEmJiFuLm5vZGVOYW1lKGEsImh0bWwiKSYmInN0YXRpYyI9PT1uLmNzcyhhLCJwb3NpdGlvbiIpKWE9YS5vZmZzZXRQYXJlbnQ7cmV0dXJuIGF8fEljfSl9fSksbi5lYWNoKHtzY3JvbGxMZWZ0OiJwYWdlWE9mZnNldCIsc2Nyb2xsVG9wOiJwYWdlWU9mZnNldCJ9LGZ1bmN0aW9uKGIsYyl7dmFyIGQ9InBhZ2VZT2Zmc2V0Ij09PWM7bi5mbltiXT1mdW5jdGlvbihlKXtyZXR1cm4gSih0aGlzLGZ1bmN0aW9uKGIsZSxmKXt2YXIgZz1KYyhiKTtyZXR1cm4gdm9pZCAwPT09Zj9nP2dbY106YltlXTp2b2lkKGc/Zy5zY3JvbGxUbyhkP2EucGFnZVhPZmZzZXQ6ZixkP2Y6YS5wYWdlWU9mZnNldCk6YltlXT1mKX0sYixlLGFyZ3VtZW50cy5sZW5ndGgsbnVsbCl9fSksbi5lYWNoKFsidG9wIiwibGVmdCJdLGZ1bmN0aW9uKGEsYil7bi5jc3NIb29rc1tiXT15YihrLnBpeGVsUG9zaXRpb24sZnVuY3Rpb24oYSxjKXtyZXR1cm4gYz8oYz14YihhLGIpLHZiLnRlc3QoYyk/bihhKS5wb3NpdGlvbigpW2JdKyJweCI6Yyk6dm9pZCAwfSl9KSxuLmVhY2goe0hlaWdodDoiaGVpZ2h0IixXaWR0aDoid2lkdGgifSxmdW5jdGlvbihhLGIpe24uZWFjaCh7cGFkZGluZzoiaW5uZXIiK2EsY29udGVudDpiLCIiOiJvdXRlciIrYX0sZnVuY3Rpb24oYyxkKXtuLmZuW2RdPWZ1bmN0aW9uKGQsZSl7dmFyIGY9YXJndW1lbnRzLmxlbmd0aCYmKGN8fCJib29sZWFuIiE9dHlwZW9mIGQpLGc9Y3x8KGQ9PT0hMHx8ZT09PSEwPyJtYXJnaW4iOiJib3JkZXIiKTtyZXR1cm4gSih0aGlzLGZ1bmN0aW9uKGIsYyxkKXt2YXIgZTtyZXR1cm4gbi5pc1dpbmRvdyhiKT9iLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsiY2xpZW50IithXTo5PT09Yi5ub2RlVHlwZT8oZT1iLmRvY3VtZW50RWxlbWVudCxNYXRoLm1heChiLmJvZHlbInNjcm9sbCIrYV0sZVsic2Nyb2xsIithXSxiLmJvZHlbIm9mZnNldCIrYV0sZVsib2Zmc2V0IithXSxlWyJjbGllbnQiK2FdKSk6dm9pZCAwPT09ZD9uLmNzcyhiLGMsZyk6bi5zdHlsZShiLGMsZCxnKX0sYixmP2Q6dm9pZCAwLGYsbnVsbCl9fSl9KSxuLmZuLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sZW5ndGh9LG4uZm4uYW5kU2VsZj1uLmZuLmFkZEJhY2ssImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZCYmZGVmaW5lKCJqcXVlcnkiLFtdLGZ1bmN0aW9uKCl7cmV0dXJuIG59KTt2YXIgS2M9YS5qUXVlcnksTGM9YS4kO3JldHVybiBuLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oYil7cmV0dXJuIGEuJD09PW4mJihhLiQ9TGMpLGImJmEualF1ZXJ5PT09biYmKGEualF1ZXJ5PUtjKSxufSx0eXBlb2YgYj09PVUmJihhLmpRdWVyeT1hLiQ9biksbn0pOwo="}]}],"settings":{"enabled":true,"script_blacklist_server":[{"rules":["/https?:\\/\\/userscripts\\.org\\/scripts\\/(source|version)/(102614).*\\.user\\.js/"],"severity":2},{"name":"SaveFrom.net helper","reason":"Shows advertisements","rules":["/https?:\\/\\/sf-addon\\.com\\/.*\\/.*\\.user\\.js/","/https?:\\/\\/.*\\.sf-helper\\.com\\/.*\\.user\\.js/"],"severity":3},{"reasons":{"en":"Used for a phishing compain to compromise users of baon-nutrition.com"},"rules":["/https?:\\/\\/files\\.ulysse\\.travel\\/.*\\.user\\.js/"],"severity":8}]}}